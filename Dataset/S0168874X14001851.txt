@&#MAIN-TITLE@&#A 2D finite element with through the thickness parabolic temperature distribution for heat transfer simulations including welding

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A formulation of a 2D heat transfer element with parabolic through-the-thickness temperature distribution was carried out.


                        
                        
                           
                           An element stabilization procedure was developed.


                        
                        
                           
                           A tungsten arc welding process was simulated using the 2D formulated element and, in addition, using ANSYS software with 3D elements (SOLID70).


                        
                        
                           
                           The results obtained by 2D model, 3D ANSYS model and experimental data showed good agreement.


                        
                        
                           
                           Good results can be obtained with less computational effort by the 2D formulated element.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Finite element

Welding simulation

Thermal analysis

Numerical simulation

@&#ABSTRACT@&#


               
               
                  The arc welding process involves thermal cycles that cause the appearance of undesirable residual stresses. The determination of this thermal cycle is the first step to a thermomechanical analysis that allows the numerical calculation of residual stresses. This study describes the formulation of a 2D finite element with through the thickness parabolic temperature distribution, including an element estabilization procedure. The 2D element described in this paper can be used to perform thermal analysis more economically than 3D elements, especially in plates, because the number of degrees of freedom through the thickness will always be three. A numerical model of a tungsten arc welding (GTAW) setup was made based on published experimental results. Size and distribution of the heat source input, thermal properties dependent on temperature, surface heat losses by convection and latent heat during phase change were considered. In parallel the same setup was modeled using ANSYS software with 3D elements (SOLID70) to compare against 2D numerical results. The results obtained by 2D model, 3D model and experimental data showed good agreement.
               
            

@&#INTRODUCTION@&#

Welding is a fabrication process widely used in industry, being employed in various industries such as petrochemical, aerospace, automotive, marine and others. The fusion welding provides the union between two parts by melting and subsequent solidification of the welding areas. During this process a small area of the part is subjected to very high temperatures, while the temperature in the rest of the parts remains low. This strong thermal gradient is responsible for the appearance of undesirable residual stresses and consequent deformations.

The determination of the residual stresses of welding has been studied by several papers [1]. Rosenthal [2] was one of the pioneers in the study of welded joints with the proposition of an analytical solution for plates with small thicknesses and concentrated heat source. Ueda [3] provided the basis for analyses that consider temperature-dependent properties. The finite element method has proved to be a powerful tool in numerical analysis to predict the temperature field, residual stresses and deformations. Lindgren reviews the use of this tool in simulations of welding, including aspects to be considered in the model [4]. In the majority of analyses a twofold procedure is adopted: a pure thermal analysis followed by a mechanical analysis with the calculated temperatures [5]. The finite element technique was used by Long [6] to investigate distortions and residual stresses induced in a MIG welding process of thin plates. The FE results obtained by Long were compared with experimental data and empirical predictions, showing reasonable agreement. Furthermore, the plate thickness and the welding speed showed to have great influence on residual stresses and welding distortions. Deng and Murakawa [7] used different formulations of thermo-elastic–plastic FE methods to compare welding distortions in a low carbon steel thin plate butt-welded. Zhu and Chao [8] investigated the effect of temperature-dependent material properties on residual stresses, distortions and temperature field in the numerical simulations of welding. They conclude that the thermal conductivity has certain effect on the distribution of transient temperature fields during welding. Barroso et al. [9] studied several simplification hypotheses in numerical welding models and compared the results with experimental data. They reported that, in most cases, the simplifying hypotheses lead to quite acceptable results.

Bergman and Oldenburg [10] proposed a thermal shell element with in-plane linear variation of temperature and quadratic variation along the thickness. This element is similar to the one formulated in this work but the explicit formulation is used to numerically integrate the governing equations in time. Another major difference is that the present element has a stabilization scheme which permits the use of relatively coarse meshes to successfully obtain accurate results in the presence of thermal shocks or in regions where high temperature gradients are known to exist.

Heat transfer finite element analyses of 3D media are necessary if one intends to determine the through-the-thickness temperature distribution in welded structures. The downside of 3D models is the inherent huge number of degrees of freedom and badly conditioned elements if the plate is moderately thin. Turning to 2D elements almost never provides realistic results since the assumption of constant through-the-thickness temperature distribution holds only in regions away from the weldment fillet or groove. However, the most critical regions in the structure are precisely those close to the weldment fillet or groove commonly denominated heat affected zone. In this zone the heat source is located on the top surface of the welded plate whereas the bottom surface is often modeled to be in natural convection.

This work presents a new 2D heat transfer element that has parabolic through-the-thickness temperature distribution. The quadratic nature of the temperature distribution is motivated by findings of previous works that point to parabolic through-the-thickness stress distributions [11–13]. Assuming a linear relation between stresses and temperature increment the parabolic temperature distribution is thereby justified.

It will be shown that the 2D element proposed may be prone to numerical illness. This is due to the different time scales of the heat transfer process. For small thicknesses heat conduction from the hot top plate surface to the cool bottom plate surface is almost instantaneous. On the other hand, in-plane heat conduction takes place at a different time scale since, usually, distances traveled by the heat flow are at least one order of magnitude larger than heat flowing along the transverse direction. A stabilization procedure is therefore necessary to avoid the numerical illnesses mentioned.

The transient heat conduction equation in Cartesian coordinates is given by
                        
                           (1)
                           
                              ρ
                              c
                              
                                 
                                    ∂
                                    T
                                 
                                 
                                    ∂
                                    t
                                 
                              
                              =
                              −
                              
                                 
                                    ∂
                                    
                                       
                                          q
                                       
                                       
                                          x
                                       
                                    
                                 
                                 
                                    ∂
                                    x
                                 
                              
                              −
                              
                                 
                                    ∂
                                    
                                       
                                          q
                                       
                                       
                                          y
                                       
                                    
                                 
                                 
                                    ∂
                                    y
                                 
                              
                              −
                              
                                 
                                    ∂
                                    
                                       
                                          q
                                       
                                       
                                          z
                                       
                                    
                                 
                                 
                                    ∂
                                    z
                                 
                              
                              +
                              Q
                           
                        
                     where T is temperature, ρ is density, c is specific heat, q
                     
                        x
                     , q
                     
                        y
                     , q
                     
                        z
                      are heat fluxes in the x, y and z directions, and Q is internal heat generation per unit volume. The heat fluxes relate to the temperature gradient according to the Fourier law of heat conduction
                        
                           (2)
                           
                              q
                              =
                              
                                 {
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      x
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      y
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      z
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 }
                              
                              =
                              −
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      x
                                                      x
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      x
                                                      y
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      x
                                                      z
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      x
                                                      y
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      y
                                                      y
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      y
                                                      z
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      x
                                                      z
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      y
                                                      z
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      z
                                                      z
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ]
                              
                              
                                 {
                                 
                                    
                                       
                                          
                                             
                                                ∂
                                                T
                                                /
                                                ∂
                                                x
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∂
                                                T
                                                /
                                                ∂
                                                y
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∂
                                                T
                                                /
                                                ∂
                                                z
                                             
                                          
                                       
                                    
                                 
                                 }
                              
                              =
                              −
                              k
                              ∇
                              T
                           
                        
                     where k
                     
                        ij
                      are the Cartesian components of the conductivity tensor 
                        k
                      and the temperature gradient vector is ∇T={∂T/∂x ∂T/∂y ∂T/∂z}
                        T
                     .

The variational principle tied to Eq. (1) is derived multiplying it by a virtual temperature variation δT. It should be clear that δT is arbitrary but it must satisfy all conditions of prescribed temperature, i.e., if T is known for a given point (x, y, z), then δT must be zero at that particular point. Multiplication of Eq. (1) by δT and integration over the plate domain Ω leads to
                        
                           (3)
                           
                              
                                 ∫
                                 Ω
                              
                              
                                 [
                                 
                                    ρ
                                    c
                                    
                                       
                                          ∂
                                          T
                                       
                                       
                                          ∂
                                          t
                                       
                                    
                                    δ
                                    T
                                    +
                                    
                                       (
                                       
                                          
                                             
                                                ∂
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      x
                                                   
                                                
                                             
                                             
                                                ∂
                                                x
                                             
                                          
                                          +
                                          
                                             
                                                ∂
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      y
                                                   
                                                
                                             
                                             
                                                ∂
                                                y
                                             
                                          
                                          +
                                          
                                             
                                                ∂
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      z
                                                   
                                                
                                             
                                             
                                                ∂
                                                z
                                             
                                          
                                       
                                       )
                                    
                                    δ
                                    T
                                    −
                                    Q
                                    δ
                                    T
                                 
                                 ]
                              
                              d
                              Ω
                              =
                              0
                           
                        
                     
                  

Straight application of the divergence theorem yields
                        
                           (4)
                           
                              
                                 ∫
                                 Ω
                              
                              
                                 
                                    (
                                    
                                       
                                          
                                             ∂
                                             
                                                
                                                   q
                                                
                                                
                                                   x
                                                
                                             
                                          
                                          
                                             ∂
                                             x
                                          
                                       
                                       +
                                       
                                          
                                             ∂
                                             
                                                
                                                   q
                                                
                                                
                                                   y
                                                
                                             
                                          
                                          
                                             ∂
                                             y
                                          
                                       
                                       +
                                       
                                          
                                             ∂
                                             
                                                
                                                   q
                                                
                                                
                                                   z
                                                
                                             
                                          
                                          
                                             ∂
                                             z
                                          
                                       
                                    
                                    )
                                 
                                 δ
                                 T
                                 
                                 d
                                 Ω
                              
                              =
                              
                                 ∫
                                 Ω
                              
                              
                                 [
                                 
                                    
                                       
                                          ∂
                                          
                                             (
                                             
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      x
                                                   
                                                
                                                δ
                                                T
                                             
                                             )
                                          
                                       
                                       
                                          ∂
                                          x
                                       
                                    
                                    +
                                    
                                       
                                          ∂
                                          
                                             (
                                             
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      y
                                                   
                                                
                                                δ
                                                T
                                             
                                             )
                                          
                                       
                                       
                                          ∂
                                          y
                                       
                                    
                                    +
                                    
                                       
                                          ∂
                                          
                                             (
                                             
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      z
                                                   
                                                
                                                δ
                                                T
                                             
                                             )
                                          
                                       
                                       
                                          ∂
                                          z
                                       
                                    
                                 
                                 ]
                              
                              d
                              Ω
                              −
                              
                                 ∫
                                 Ω
                              
                              
                                 (
                                 
                                    
                                       
                                          q
                                       
                                       
                                          x
                                       
                                    
                                    
                                       
                                          ∂
                                          δ
                                          T
                                       
                                       
                                          ∂
                                          x
                                       
                                    
                                    +
                                    
                                       
                                          q
                                       
                                       
                                          y
                                       
                                    
                                    
                                       
                                          ∂
                                          δ
                                          T
                                       
                                       
                                          ∂
                                          y
                                       
                                    
                                    +
                                    
                                       
                                          q
                                       
                                       
                                          z
                                       
                                    
                                    
                                       
                                          ∂
                                          δ
                                          T
                                       
                                       
                                          ∂
                                          z
                                       
                                    
                                 
                                 )
                              
                              d
                              Ω
                              =
                              
                                 ∫
                                 Γ
                              
                              
                                 
                                    
                                       q
                                    
                                    T
                                 
                                 n
                                 δ
                                 T
                                 
                                 d
                                 Γ
                              
                              +
                              
                                 ∫
                                 Ω
                              
                              
                                 
                                    
                                       (
                                       
                                          ∇
                                          δ
                                          T
                                       
                                       )
                                    
                                    T
                                 
                                 k
                                 
                                    (
                                    
                                       ∇
                                       T
                                    
                                    )
                                 
                                 d
                                 Ω
                              
                           
                        
                     where 
                        n
                      is the unit normal vector pointing outwards the boundary surface Γ of Ω. Notice that Eq. (2) has been used in the derivation of Eq. (4). Substitution of Eq. (4) into (3) gives
                        
                           (5)
                           
                              
                                 ∫
                                 Ω
                              
                              
                                 ρ
                                 c
                                 
                                    
                                       ∂
                                       T
                                    
                                    
                                       ∂
                                       t
                                    
                                 
                                 δ
                                 T
                                 
                                 d
                                 Ω
                              
                              +
                              
                                 ∫
                                 Ω
                              
                              
                                 
                                    
                                       (
                                       
                                          ∇
                                          δ
                                          T
                                       
                                       )
                                    
                                    T
                                 
                                 k
                                 
                                    (
                                    
                                       ∇
                                       T
                                    
                                    )
                                 
                                 d
                                 Ω
                              
                              =
                              
                                 ∫
                                 Ω
                              
                              
                                 Q
                                 δ
                                 T
                                 
                                 d
                                 Ω
                              
                              −
                              
                                 ∫
                                 Γ
                              
                              
                                 
                                    
                                       q
                                    
                                    T
                                 
                                 n
                                 δ
                                 T
                                 
                                 d
                                 Γ
                              
                           
                        
                     
                  

Eq. (5) is recognized as the variational principle associated with heat transfer problems. In the right-hand side two loading terms appear: internal heat generation and boundary heat exchange. There are basically three common forms of boundary heat exchange: (i) prescribed heat flux where 
                        q
                     
                     
                        T
                     
                     
                        n
                      is a known function, (ii) heat convection where 
                        q
                     
                     
                        T
                     
                     
                        n
                     =h
                     
                        c
                     (T−T
                     ∞), and (iii) radiative flux where 
                        q
                     
                     
                        T
                     
                     
                        n
                     =h
                     
                        r
                     (T−T
                     ∞). The convective heat transfer coefficient h
                     
                        c
                      may depend on T and the radiative heat transfer coefficient h
                     
                        r
                      is definitely a function of the temperature T. T
                     ∞ is the environment temperature.


                        
                        Fig. 1 shows the element topology chosen. In order to be economical in terms of degrees of freedom the element is 4-noded and has bilinear shape functions over its local plane xy.

In the local transverse direction z the temperature distribution is assumed to be parabolic such that, for a given point within the element, the temperature T is
                           
                              (6)
                              
                                 T
                                 
                                    (
                                    
                                       x
                                       ,
                                       y
                                       ,
                                       z
                                       ,
                                       t
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       T
                                    
                                    
                                       a
                                    
                                 
                                 
                                    (
                                    
                                       x
                                       ,
                                       y
                                       ,
                                       t
                                    
                                    )
                                 
                                 +
                                 z
                                 
                                    
                                       T
                                    
                                    
                                       b
                                    
                                 
                                 
                                    (
                                    
                                       x
                                       ,
                                       y
                                       ,
                                       t
                                    
                                    )
                                 
                                 +
                                 
                                    
                                       z
                                    
                                    2
                                 
                                 
                                    
                                       T
                                    
                                    
                                       c
                                    
                                 
                                 
                                    (
                                    
                                       x
                                       ,
                                       y
                                       ,
                                       t
                                    
                                    )
                                 
                              
                           
                        where z is the local transverse coordinate measured along the thickness. T
                        
                           a
                         is the zero order term, zT
                        
                           b
                         is the linear term and z
                        
                           2
                        
                        T
                        
                           c
                         is the quadratic term. These three terms are in turn interpolated using the bilinear shape functions with mapping coordinates ξ∈[−1, +1] and η∈[−1, +1]
                           
                              (7)
                              
                                 
                                    
                                       N
                                    
                                    
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       ξ
                                       ,
                                       η
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       1
                                       4
                                    
                                 
                                 
                                    (
                                    
                                       1
                                       −
                                       ξ
                                    
                                    )
                                 
                                 
                                    (
                                    
                                       1
                                       −
                                       
                                       η
                                    
                                    )
                                 
                                 ,
                                 
                                 
                                    
                                       N
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    
                                       ξ
                                       ,
                                       η
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       1
                                       4
                                    
                                 
                                 
                                    (
                                    
                                       1
                                       +
                                       ξ
                                    
                                    )
                                 
                                 
                                    (
                                    
                                       1
                                       −
                                       
                                       η
                                    
                                    )
                                 
                                 
                                    
                                       N
                                    
                                    
                                       3
                                    
                                 
                                 
                                    (
                                    
                                       ξ
                                       ,
                                       η
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       1
                                       4
                                    
                                 
                                 
                                    (
                                    
                                       1
                                       +
                                       ξ
                                    
                                    )
                                 
                                 
                                    (
                                    
                                       1
                                       +
                                       
                                       η
                                    
                                    )
                                 
                                 ,
                                 
                                 
                                    
                                       N
                                    
                                    
                                       4
                                    
                                 
                                 
                                    (
                                    
                                       ξ
                                       ,
                                       η
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       1
                                       4
                                    
                                 
                                 
                                    (
                                    
                                       1
                                       −
                                       ξ
                                    
                                    )
                                 
                                 
                                    (
                                    
                                       1
                                       +
                                       
                                       η
                                    
                                    )
                                 
                              
                           
                        such that
                           
                              (8)
                              
                                 
                                    
                                       T
                                    
                                    
                                       a
                                    
                                 
                                 =
                                 
                                    
                                       T
                                    
                                    
                                       a
                                       1
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       T
                                    
                                    
                                       a
                                       2
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       T
                                    
                                    
                                       a
                                       3
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       3
                                    
                                 
                                 +
                                 
                                    
                                       T
                                    
                                    
                                       a
                                       4
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       4
                                    
                                 
                                 
                                    
                                       T
                                    
                                    
                                       b
                                    
                                 
                                 =
                                 
                                    
                                       T
                                    
                                    
                                       b
                                       1
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       T
                                    
                                    
                                       b
                                       2
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       T
                                    
                                    
                                       b
                                       3
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       3
                                    
                                 
                                 +
                                 
                                    
                                       T
                                    
                                    
                                       b
                                       4
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       4
                                    
                                 
                                 
                                    
                                       T
                                    
                                    
                                       c
                                    
                                 
                                 =
                                 
                                    
                                       T
                                    
                                    
                                       c
                                       1
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       T
                                    
                                    
                                       c
                                       2
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       T
                                    
                                    
                                       c
                                       3
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       3
                                    
                                 
                                 +
                                 
                                    
                                       T
                                    
                                    
                                       c
                                       4
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       4
                                    
                                 
                              
                           
                        where T
                        
                           a1, …, T
                        
                           c4 are nodal degrees of freedom. The units of T
                        
                           a
                        , T
                        
                           b
                         and T
                        
                           c
                         are not the same since they are multiplied by 1, z and z
                        2, respectively.

Based on Eq. (8) element local vectors of degrees of freedom are defined as: 
                           q
                        
                        
                           a
                        ={T
                        
                           a1 
                        T
                        
                           a2 
                        T
                        
                           a3 
                        T
                        
                           a4}
                           T
                        , 
                           q
                        
                        
                           b
                        ={T
                        
                           b1 
                        T
                        
                           b2 
                        T
                        
                           b3 
                        T
                        
                           b4}
                           T
                         and 
                           q
                        
                        
                           c
                        ={T
                        
                           c1 
                        T
                        
                           c2 
                        T
                        
                           c3 
                        T
                        
                           c4}
                           T
                        . The variation counterparts are then δq
                        
                        
                           a
                        ={δT
                        
                           a1 
                        δT
                        
                           a2 
                        δT
                        
                           a3 
                        δT
                        
                           a4}
                           T
                        , δq
                        
                        
                           b
                        ={δT
                        
                           b1 
                        δT
                        
                           b2 
                        δT
                        
                           b3 
                        δT
                        
                           b4}
                           T
                         and δq
                        
                        
                           c
                        ={δT
                        
                           c1 
                        δT
                        
                           c2 
                        δT
                        
                           c3 
                        δT
                        
                           c4}
                           T
                        . Also, the matrix of in-plane shape functions is defined as 
                           N
                        =[N
                        1 
                        N
                        2 
                        N
                        3 
                        N
                        4]. Using these definitions Eq. (6) and its variational counterpart can be written as
                           
                              (9)
                              
                                 T
                                 
                                    (
                                    
                                       x
                                       ,
                                       y
                                       ,
                                       z
                                       ,
                                       t
                                    
                                    )
                                 
                                 =
                                 N
                                 (
                                 
                                    
                                       q
                                    
                                    
                                       a
                                    
                                 
                                 +
                                 z
                                 
                                    
                                       q
                                    
                                    
                                       b
                                    
                                 
                                 +
                                 
                                    
                                       z
                                    
                                    2
                                 
                                 
                                    
                                       q
                                    
                                    
                                       c
                                    
                                 
                                 )
                                 δ
                                 T
                                 
                                    (
                                    
                                       x
                                       ,
                                       y
                                       ,
                                       z
                                       ,
                                       t
                                    
                                    )
                                 
                                 =
                                 N
                                 (
                                 δ
                                 
                                    
                                       q
                                    
                                    
                                       a
                                    
                                 
                                 +
                                 z
                                 δ
                                 
                                    
                                       q
                                    
                                    
                                       b
                                    
                                 
                                 +
                                 
                                    
                                       z
                                    
                                    2
                                 
                                 δ
                                 
                                    
                                       q
                                    
                                    
                                       c
                                    
                                 
                                 )
                              
                           
                        
                     

Two terms are in the left-hand side of Eq. (5). These can be calculated for each element e and its domain Ω
                        
                           e
                        . Using Eq. (9) the first term is
                           
                              (10)
                              
                                 
                                    ∫
                                    
                                       
                                          
                                             Ω
                                          
                                          
                                             e
                                          
                                       
                                    
                                 
                                 
                                    ρ
                                    c
                                    
                                       
                                          ∂
                                          T
                                       
                                       
                                          ∂
                                          t
                                       
                                    
                                    δ
                                    T
                                    
                                    d
                                    Ω
                                 
                                 =
                                 
                                    ∫
                                    
                                       
                                          
                                             Ω
                                          
                                          
                                             e
                                          
                                       
                                    
                                 
                                 
                                    ρ
                                    c
                                    
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      
                                                         δ
                                                         
                                                            
                                                               q
                                                            
                                                            
                                                               a
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         δ
                                                         
                                                            
                                                               q
                                                            
                                                            
                                                               b
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         δ
                                                         
                                                            
                                                               q
                                                            
                                                            
                                                               c
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          }
                                       
                                       T
                                    
                                 
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         N
                                                      
                                                      T
                                                   
                                                   N
                                                
                                             
                                             
                                                
                                                   z
                                                   
                                                      
                                                         N
                                                      
                                                      T
                                                   
                                                   N
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         z
                                                      
                                                      2
                                                   
                                                   
                                                      
                                                         N
                                                      
                                                      T
                                                   
                                                   N
                                                
                                             
                                          
                                          
                                             
                                                
                                                   z
                                                   
                                                      
                                                         N
                                                      
                                                      T
                                                   
                                                   N
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         z
                                                      
                                                      2
                                                   
                                                   
                                                      
                                                         N
                                                      
                                                      T
                                                   
                                                   N
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         z
                                                      
                                                      3
                                                   
                                                   
                                                      
                                                         N
                                                      
                                                      T
                                                   
                                                   N
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         z
                                                      
                                                      2
                                                   
                                                   
                                                      
                                                         N
                                                      
                                                      T
                                                   
                                                   N
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         z
                                                      
                                                      3
                                                   
                                                   
                                                      
                                                         N
                                                      
                                                      T
                                                   
                                                   N
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         z
                                                      
                                                      4
                                                   
                                                   
                                                      
                                                         N
                                                      
                                                      T
                                                   
                                                   N
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            q
                                                            ̇
                                                         
                                                      
                                                      
                                                         a
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            q
                                                            ̇
                                                         
                                                      
                                                      
                                                         b
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            q
                                                            ̇
                                                         
                                                      
                                                      
                                                         c
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    }
                                 
                                 d
                                 Ω
                              
                           
                        
                     

The second term in the left-hand side of Eq. (5) is more elaborate since it requires computation of ∇T and ∇δT. This is achieved, again, using Eq. (9).
                           
                              (11)
                              
                                 ∇
                                 T
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   ∂
                                                   T
                                                   /
                                                   ∂
                                                   x
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∂
                                                   T
                                                   /
                                                   ∂
                                                   y
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∂
                                                   T
                                                   /
                                                   ∂
                                                   z
                                                
                                             
                                          
                                       
                                    
                                    }
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   ∂
                                                   N
                                                   /
                                                   ∂
                                                   x
                                                
                                             
                                             
                                                
                                                   z
                                                   ∂
                                                   N
                                                   /
                                                   ∂
                                                   x
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         z
                                                      
                                                      2
                                                   
                                                   ∂
                                                   N
                                                   /
                                                   ∂
                                                   x
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∂
                                                   N
                                                   /
                                                   ∂
                                                   y
                                                
                                             
                                             
                                                
                                                   z
                                                   ∂
                                                   N
                                                   /
                                                   ∂
                                                   y
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         z
                                                      
                                                      2
                                                   
                                                   ∂
                                                   N
                                                   /
                                                   ∂
                                                   y
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                N
                                             
                                             
                                                
                                                   2
                                                   z
                                                   N
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         a
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         b
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         c
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    }
                                 
                                 ∇
                                 δ
                                 T
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   ∂
                                                   δ
                                                   T
                                                   /
                                                   ∂
                                                   x
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∂
                                                   δ
                                                   T
                                                   /
                                                   ∂
                                                   y
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∂
                                                   δ
                                                   T
                                                   /
                                                   ∂
                                                   z
                                                
                                             
                                          
                                       
                                    
                                    }
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   ∂
                                                   N
                                                   /
                                                   ∂
                                                   x
                                                
                                             
                                             
                                                
                                                   z
                                                   ∂
                                                   N
                                                   /
                                                   ∂
                                                   x
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         z
                                                      
                                                      2
                                                   
                                                   ∂
                                                   N
                                                   /
                                                   ∂
                                                   x
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∂
                                                   N
                                                   /
                                                   ∂
                                                   y
                                                
                                             
                                             
                                                
                                                   z
                                                   ∂
                                                   N
                                                   /
                                                   ∂
                                                   y
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         z
                                                      
                                                      2
                                                   
                                                   ∂
                                                   N
                                                   /
                                                   ∂
                                                   y
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                N
                                             
                                             
                                                
                                                   2
                                                   z
                                                   N
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   δ
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         a
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   δ
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         b
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   δ
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         c
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    }
                                 
                              
                           
                        
                     

Substitution of Eq. (11) into the second term in the left-hand side of Eq. (5) yields
                           
                              (12)
                              
                                 
                                    ∫
                                    
                                       
                                          
                                             Ω
                                          
                                          
                                             e
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          (
                                          
                                             ∇
                                             δ
                                             T
                                          
                                          )
                                       
                                       T
                                    
                                 
                                 k
                                 
                                    (
                                    
                                       ∇
                                       T
                                    
                                    )
                                 
                                 d
                                 Ω
                                 =
                                 
                                    ∫
                                    
                                       
                                          
                                             Ω
                                          
                                          
                                             e
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      
                                                         δ
                                                         
                                                            
                                                               q
                                                            
                                                            
                                                               a
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         δ
                                                         
                                                            
                                                               q
                                                            
                                                            
                                                               b
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         δ
                                                         
                                                            
                                                               q
                                                            
                                                            
                                                               c
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          }
                                       
                                       T
                                    
                                 
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   ∂
                                                   
                                                      
                                                         N
                                                      
                                                      T
                                                   
                                                   /
                                                   ∂
                                                   x
                                                
                                             
                                             
                                                
                                                   ∂
                                                   
                                                      
                                                         N
                                                      
                                                      T
                                                   
                                                   /
                                                   ∂
                                                   y
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         0
                                                      
                                                      T
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   z
                                                   ∂
                                                   
                                                      
                                                         N
                                                      
                                                      T
                                                   
                                                   /
                                                   ∂
                                                   x
                                                
                                             
                                             
                                                
                                                   z
                                                   ∂
                                                   
                                                      
                                                         N
                                                      
                                                      T
                                                   
                                                   /
                                                   ∂
                                                   y
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         N
                                                      
                                                      T
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         z
                                                      
                                                      2
                                                   
                                                   ∂
                                                   
                                                      
                                                         N
                                                      
                                                      T
                                                   
                                                   /
                                                   ∂
                                                   x
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         z
                                                      
                                                      2
                                                   
                                                   ∂
                                                   
                                                      
                                                         N
                                                      
                                                      T
                                                   
                                                   /
                                                   ∂
                                                   y
                                                
                                             
                                             
                                                
                                                   2
                                                   z
                                                   
                                                      
                                                         N
                                                      
                                                      T
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 ×
                                 k
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   ∂
                                                   N
                                                   /
                                                   ∂
                                                   x
                                                
                                             
                                             
                                                
                                                   z
                                                   ∂
                                                   N
                                                   /
                                                   ∂
                                                   x
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         z
                                                      
                                                      2
                                                   
                                                   ∂
                                                   N
                                                   /
                                                   ∂
                                                   x
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∂
                                                   N
                                                   /
                                                   ∂
                                                   y
                                                
                                             
                                             
                                                
                                                   z
                                                   ∂
                                                   N
                                                   /
                                                   ∂
                                                   y
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         z
                                                      
                                                      2
                                                   
                                                   ∂
                                                   N
                                                   /
                                                   ∂
                                                   y
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                N
                                             
                                             
                                                
                                                   2
                                                   z
                                                   N
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         a
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         b
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         c
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    }
                                 
                                 d
                                 Ω
                              
                           
                        
                     

Based on Eqs. (10) and (12), the element heat capacitance matrix 
                           M
                        
                        
                           e
                         and element conductivity matrices 
                           K
                        
                        
                           e
                         are given by
                           
                              (13)
                              
                                 
                                    
                                       M
                                    
                                    
                                       e
                                    
                                 
                                 =
                                 
                                    ∫
                                    
                                       
                                          
                                             Ω
                                          
                                          
                                             e
                                          
                                       
                                    
                                 
                                 
                                    ρ
                                    c
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         T
                                                      
                                                      N
                                                   
                                                
                                                
                                                   
                                                      z
                                                      
                                                         
                                                            N
                                                         
                                                         T
                                                      
                                                      N
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            z
                                                         
                                                         2
                                                      
                                                      
                                                         
                                                            N
                                                         
                                                         T
                                                      
                                                      N
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      z
                                                      
                                                         
                                                            N
                                                         
                                                         T
                                                      
                                                      N
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            z
                                                         
                                                         2
                                                      
                                                      
                                                         
                                                            N
                                                         
                                                         T
                                                      
                                                      N
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            z
                                                         
                                                         3
                                                      
                                                      
                                                         
                                                            N
                                                         
                                                         T
                                                      
                                                      N
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            z
                                                         
                                                         2
                                                      
                                                      
                                                         
                                                            N
                                                         
                                                         T
                                                      
                                                      N
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            z
                                                         
                                                         3
                                                      
                                                      
                                                         
                                                            N
                                                         
                                                         T
                                                      
                                                      N
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            z
                                                         
                                                         4
                                                      
                                                      
                                                         
                                                            N
                                                         
                                                         T
                                                      
                                                      N
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    d
                                    Ω
                                 
                              
                           
                        
                        
                           
                              (14)
                              
                                 
                                    
                                       K
                                    
                                    
                                       e
                                    
                                 
                                 =
                                 
                                    ∫
                                    
                                       
                                          
                                             Ω
                                          
                                          
                                             e
                                          
                                       
                                    
                                 
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   ∂
                                                   
                                                      
                                                         N
                                                      
                                                      T
                                                   
                                                   /
                                                   ∂
                                                   x
                                                
                                             
                                             
                                                
                                                   ∂
                                                   
                                                      
                                                         N
                                                      
                                                      T
                                                   
                                                   /
                                                   ∂
                                                   y
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         0
                                                      
                                                      T
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   z
                                                   ∂
                                                   
                                                      
                                                         N
                                                      
                                                      T
                                                   
                                                   /
                                                   ∂
                                                   x
                                                
                                             
                                             
                                                
                                                   z
                                                   ∂
                                                   
                                                      
                                                         N
                                                      
                                                      T
                                                   
                                                   /
                                                   ∂
                                                   y
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         N
                                                      
                                                      T
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         z
                                                      
                                                      2
                                                   
                                                   ∂
                                                   
                                                      
                                                         N
                                                      
                                                      T
                                                   
                                                   /
                                                   ∂
                                                   x
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         z
                                                      
                                                      2
                                                   
                                                   ∂
                                                   
                                                      
                                                         N
                                                      
                                                      T
                                                   
                                                   /
                                                   ∂
                                                   y
                                                
                                             
                                             
                                                
                                                   2
                                                   z
                                                   
                                                      
                                                         N
                                                      
                                                      T
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 k
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   ∂
                                                   N
                                                   /
                                                   ∂
                                                   x
                                                
                                             
                                             
                                                
                                                   z
                                                   ∂
                                                   N
                                                   /
                                                   ∂
                                                   x
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         z
                                                      
                                                      2
                                                   
                                                   ∂
                                                   N
                                                   /
                                                   ∂
                                                   x
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∂
                                                   N
                                                   /
                                                   ∂
                                                   y
                                                
                                             
                                             
                                                
                                                   z
                                                   ∂
                                                   N
                                                   /
                                                   ∂
                                                   y
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         z
                                                      
                                                      2
                                                   
                                                   ∂
                                                   N
                                                   /
                                                   ∂
                                                   y
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                N
                                             
                                             
                                                
                                                   2
                                                   z
                                                   N
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 d
                                 Ω
                              
                           
                        
                     

Both 
                           M
                        
                        
                           e
                         and 
                           K
                        
                        
                           e
                         are symmetric and 12×12. Moreover, notice that the local coordinate z is explicitly present in their computations. One might be tempted to integrate analytically through the thickness. However, the thermal properties c and 
                           k
                         are likely to vary with temperature, particularly in welding problems where elevated temperatures are common. Therefore the most indicated method to compute 
                           M
                        
                        
                           e
                         and 
                           K
                        
                        
                           e
                         is numerical integration along x, y and z. The Gauss quadrature recipe applicable to the bilinear isoparametric element requires 2 integration points along x and 2 along y. In the transverse direction z the terms containing z
                        4 require at least 3 integration points.

In order to illustrate a basic flaw of element formulated using parabolic temperature distribution through the thickness consider the simple 1D steady state problem of a beam shown in 
                        Fig. 2. It has total length 2L, thickness h and both ends have T
                        
                           a
                        , T
                        
                           b
                         and T
                        
                           c
                         prescribed.

Considering the practical case of a diagonal conductivity tensor 
                           k
                        =diag(k
                        
                           xx
                         
                        k
                        
                           yy
                         
                        k
                        
                           zz
                        ) and constant thermal properties the differential equations that govern the problem are:
                           
                              (15a)
                              
                                 
                                    
                                       k
                                    
                                    
                                       x
                                       x
                                    
                                 
                                 
                                    
                                       
                                          
                                             ∂
                                          
                                          2
                                       
                                       
                                          
                                             T
                                          
                                          
                                             a
                                          
                                       
                                    
                                    
                                       ∂
                                       
                                          
                                             x
                                          
                                          2
                                       
                                    
                                 
                                 +
                                 
                                    
                                       k
                                    
                                    
                                       x
                                       x
                                    
                                 
                                 
                                    
                                       
                                          
                                             h
                                          
                                          2
                                       
                                    
                                    
                                       12
                                    
                                 
                                 
                                    
                                       
                                          
                                             ∂
                                          
                                          2
                                       
                                       
                                          
                                             T
                                          
                                          
                                             c
                                          
                                       
                                    
                                    
                                       ∂
                                       
                                          
                                             x
                                          
                                          2
                                       
                                    
                                 
                                 =
                                 0
                                 ,
                              
                           
                        
                        
                           
                              (15b)
                              
                                 
                                    
                                       k
                                    
                                    
                                       z
                                       z
                                    
                                 
                                 
                                    
                                       T
                                    
                                    
                                       b
                                    
                                 
                                 −
                                 
                                    
                                       k
                                    
                                    
                                       x
                                       x
                                    
                                 
                                 
                                    
                                       
                                          
                                             h
                                          
                                          2
                                       
                                    
                                    
                                       12
                                    
                                 
                                 
                                    
                                       
                                          
                                             ∂
                                          
                                          2
                                       
                                       
                                          
                                             T
                                          
                                          
                                             b
                                          
                                       
                                    
                                    
                                       ∂
                                       
                                          
                                             x
                                          
                                          2
                                       
                                    
                                 
                                 =
                                 0
                                 ,
                              
                           
                        
                        
                           
                              (15c)
                              
                                 
                                    
                                       k
                                    
                                    
                                       z
                                       z
                                    
                                 
                                 
                                    
                                       T
                                    
                                    
                                       c
                                    
                                 
                                 −
                                 
                                    
                                       k
                                    
                                    
                                       x
                                       x
                                    
                                 
                                 
                                    1
                                    4
                                 
                                 
                                    
                                       
                                          
                                             ∂
                                          
                                          2
                                       
                                       
                                          
                                             T
                                          
                                          
                                             a
                                          
                                       
                                    
                                    
                                       ∂
                                       
                                          
                                             x
                                          
                                          2
                                       
                                    
                                 
                                 −
                                 
                                    
                                       k
                                    
                                    
                                       x
                                       x
                                    
                                 
                                 
                                    
                                       
                                          
                                             h
                                          
                                          2
                                       
                                    
                                    
                                       16
                                    
                                 
                                 
                                    
                                       
                                          
                                             ∂
                                          
                                          2
                                       
                                       
                                          
                                             T
                                          
                                          
                                             c
                                          
                                       
                                    
                                    
                                       ∂
                                       
                                          
                                             x
                                          
                                          2
                                       
                                    
                                 
                                 =
                                 0
                              
                           
                        
                     

Eqs. (15a) and (15c) couple T
                        
                           a
                         and T
                        
                           c
                        . However, decoupling is simple and, in view of the homogeneous boundary conditions for T
                        
                           a
                         and T
                        
                           c
                        , leads to the solution T
                        
                           a
                        (x)=T
                        
                           c
                        (x)=0. The analytical solution for T
                        
                           b
                         is
                           
                              (16)
                              
                                 
                                    
                                       T
                                    
                                    
                                       b
                                    
                                 
                                 
                                    (
                                    x
                                    )
                                 
                                 =
                                 
                                    
                                       T
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       cosh
                                       (
                                       s
                                       x
                                       )
                                    
                                    
                                       cosh
                                       (
                                       s
                                       L
                                       )
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       s
                                    
                                    2
                                 
                                 =
                                 
                                    
                                       12
                                       
                                          
                                             k
                                          
                                          
                                             z
                                             z
                                          
                                       
                                    
                                    
                                       
                                          
                                             h
                                          
                                          2
                                       
                                       
                                          
                                             k
                                          
                                          
                                             x
                                             x
                                          
                                       
                                    
                                 
                              
                           
                        
                     


                        
                        Fig. 3 shows a comparison between the exact solution given in Eq. (16) and the numerical solution obtained with no stabilization. It is obvious from Fig. 3 that wide oscillations occur. Increasing the number of elements in the FE mesh certainly alleviates the numerical problem but it cannot be completely eliminated by that subterfuge alone. Moreover, one of the most attractive features of the FE method is its ability to approximate solutions with a relatively small number of simple elements. Within this context, mesh refinement enhances the results but tends to overburden the numerical procedures.

The question to be answered now is why the proposed element does not deliver accurate results. The answer is obtained by comparing the exact solution of the problem, Eq. (16), against the finite element solution. Considering a uniform FE mesh and two adjacent elements of length l
                        
                           e
                         as shown in 
                        Fig. 4 it is possible to write the stencil of the finite element scheme associated with line i:
                           
                              (17)
                              
                                 
                                    
                                       
                                          
                                             k
                                          
                                          
                                             x
                                             x
                                          
                                       
                                       
                                          
                                             h
                                          
                                          2
                                       
                                    
                                    
                                       12
                                       
                                          
                                             l
                                          
                                          
                                             e
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       −
                                       
                                          
                                             T
                                          
                                          
                                             b
                                             ,
                                             i
                                             −
                                             1
                                          
                                       
                                       +
                                       2
                                       
                                          
                                             T
                                          
                                          
                                             b
                                             ,
                                             i
                                          
                                       
                                       −
                                       
                                          
                                             T
                                          
                                          
                                             b
                                             ,
                                             i
                                             +
                                             1
                                          
                                       
                                    
                                    )
                                 
                                 +
                                 
                                    
                                       
                                          
                                             k
                                          
                                          
                                             z
                                             z
                                          
                                       
                                       
                                          
                                             l
                                          
                                          
                                             e
                                          
                                       
                                    
                                    6
                                 
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       b
                                       ,
                                       i
                                       −
                                       1
                                    
                                 
                                 +
                                 4
                                 
                                    
                                       T
                                    
                                    
                                       b
                                       ,
                                       i
                                    
                                 
                                 +
                                 
                                    
                                       T
                                    
                                    
                                       b
                                       ,
                                       i
                                       +
                                       1
                                    
                                 
                                 )
                                 =
                                 0
                              
                           
                        
                     

After defining
                           
                              (18)
                              
                                 
                                    
                                       r
                                    
                                    2
                                 
                                 =
                                 
                                    
                                       12
                                       
                                          
                                             k
                                          
                                          
                                             z
                                             z
                                          
                                       
                                       
                                          
                                             
                                                l
                                             
                                             
                                                e
                                             
                                          
                                          2
                                       
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             x
                                             x
                                          
                                       
                                       
                                          
                                             h
                                          
                                          2
                                       
                                    
                                 
                              
                           
                        
                     

Eq. (17) can be recast as
                           
                              (19)
                              
                                 
                                    
                                       T
                                    
                                    
                                       b
                                       ,
                                       i
                                       −
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       
                                          1
                                          6
                                       
                                       −
                                       
                                          1
                                          
                                             
                                                
                                                   r
                                                
                                                2
                                             
                                          
                                       
                                    
                                    )
                                 
                                 +
                                 2
                                 
                                    
                                       T
                                    
                                    
                                       b
                                       ,
                                       i
                                    
                                 
                                 
                                    (
                                    
                                       
                                          1
                                          3
                                       
                                       +
                                       
                                          1
                                          
                                             
                                                
                                                   r
                                                
                                                2
                                             
                                          
                                       
                                    
                                    )
                                 
                                 +
                                 
                                    
                                       T
                                    
                                    
                                       b
                                       ,
                                       i
                                       +
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       
                                          1
                                          6
                                       
                                       −
                                       
                                          1
                                          
                                             
                                                
                                                   r
                                                
                                                2
                                             
                                          
                                       
                                    
                                    )
                                 
                                 =
                                 0
                              
                           
                        
                     

In order to compare the exact and the numerical solutions it is important to determine what should have been the FE scheme stencil to precisely reproduce the exact solution given by Eq. (16). Assuming that node i has coordinate x
                        
                           i
                         and using Eq. (16),
                           
                              (20)
                              
                                 
                                    
                                       T
                                    
                                    
                                       b
                                       ,
                                       i
                                       −
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       T
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       cosh
                                       
                                       [
                                       s
                                       
                                          (
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                             
                                             −
                                             
                                                
                                                   l
                                                
                                                
                                                   e
                                                
                                             
                                          
                                          )
                                       
                                       ]
                                    
                                    
                                       cosh
                                       (
                                       s
                                       L
                                       )
                                    
                                 
                                 ,
                                 
                                 
                                 
                                    
                                       T
                                    
                                    
                                       b
                                       ,
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       T
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       cosh
                                       (
                                       s
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       cosh
                                       (
                                       s
                                       L
                                       )
                                    
                                 
                                 ,
                                 
                                 
                                 
                                    
                                       T
                                    
                                    
                                       b
                                       ,
                                       i
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       T
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       cosh
                                       
                                       [
                                       s
                                       
                                          (
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                             
                                             +
                                             
                                                
                                                   l
                                                
                                                
                                                   e
                                                
                                             
                                          
                                          )
                                       
                                       ]
                                    
                                    
                                       cosh
                                       (
                                       s
                                       L
                                       )
                                    
                                 
                              
                           
                        
                     

The stencil presented in Eq. (19) is of the form
                           
                              (21)
                              
                                 
                                    
                                       α
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       T
                                    
                                    
                                       b
                                       ,
                                       i
                                       −
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       α
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       T
                                    
                                    
                                       b
                                       ,
                                       i
                                    
                                 
                                 +
                                 
                                    
                                       α
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       T
                                    
                                    
                                       b
                                       ,
                                       i
                                       +
                                       1
                                    
                                 
                                 =
                                 0
                              
                           
                        where α
                        1, α
                        2, α
                        3 are coefficients to be determined. Substitution of Eq. (20) into (21) and grouping terms the following conditions must be met:
                           
                              (22)
                              
                                 
                                    
                                       α
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       α
                                    
                                    
                                       3
                                    
                                 
                                 ,
                                 
                                    
                                       α
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 −
                                 2
                                 
                                    
                                       α
                                    
                                    
                                       1
                                    
                                 
                                 
                                 cosh
                                 (
                                 s
                                 
                                    
                                       l
                                    
                                    
                                       e
                                    
                                 
                                 )
                              
                           
                        
                     

Hence, substitution of Eq. (22) into (21) yields
                           
                              (23)
                              
                                 −
                                 
                                    
                                       T
                                    
                                    
                                       b
                                       ,
                                       i
                                       −
                                       1
                                    
                                 
                                 +
                                 2
                                 
                                 cosh
                                 
                                    (
                                    
                                       s
                                       
                                          
                                             l
                                          
                                          
                                             e
                                          
                                       
                                    
                                    )
                                 
                                 
                                    
                                       T
                                    
                                    
                                       b
                                       ,
                                       i
                                    
                                 
                                 −
                                 
                                    
                                       T
                                    
                                    
                                       b
                                       ,
                                       i
                                       +
                                       1
                                    
                                 
                                 =
                                 0
                              
                           
                        which can be rewritten as
                           
                              (24)
                              
                                 
                                    
                                       T
                                    
                                    
                                       b
                                       ,
                                       i
                                       −
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       
                                          1
                                          6
                                       
                                       −
                                       
                                          1
                                          
                                             
                                                
                                                   r
                                                
                                                2
                                             
                                          
                                       
                                    
                                    )
                                 
                                 +
                                 2
                                 
                                 cosh
                                 
                                    (
                                    
                                       s
                                       
                                          
                                             l
                                          
                                          
                                             e
                                          
                                       
                                    
                                    )
                                 
                                 
                                    
                                       T
                                    
                                    
                                       b
                                       ,
                                       i
                                    
                                 
                                 
                                    (
                                    
                                       
                                          1
                                          
                                             
                                                
                                                   r
                                                
                                                2
                                             
                                          
                                       
                                       −
                                       
                                          1
                                          6
                                       
                                    
                                    )
                                 
                                 +
                                 
                                    
                                       T
                                    
                                    
                                       b
                                       ,
                                       i
                                       +
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       
                                          1
                                          6
                                       
                                       −
                                       
                                          1
                                          
                                             
                                                
                                                   r
                                                
                                                2
                                             
                                          
                                       
                                    
                                    )
                                 
                                 =
                                 0
                              
                           
                        
                     

Comparison between Eqs. (24) and (19) reveals the error incurred when the numerical FE solution is adopted: the coefficient in T
                        
                           b,i
                         is wrong. The question is now how much must be subtracted from the FE stencil to exactly reproduce Eq. (19). This is given by
                           
                              (25)
                              
                                 
                                    1
                                    3
                                 
                                 +
                                 
                                    1
                                    
                                       
                                          
                                             r
                                          
                                          2
                                       
                                    
                                 
                                 −
                                 α
                                 =
                                 
                                 cosh
                                 
                                    (
                                    r
                                    )
                                 
                                 
                                    (
                                    
                                       
                                          1
                                          
                                             
                                                
                                                   r
                                                
                                                2
                                             
                                          
                                       
                                       −
                                       
                                          1
                                          6
                                       
                                    
                                    )
                                 
                                 ⇒
                                 α
                                 =
                                 
                                    1
                                    3
                                 
                                 +
                                 
                                    1
                                    
                                       
                                          
                                             r
                                          
                                          2
                                       
                                    
                                 
                                 +
                                 
                                 cosh
                                 
                                    (
                                    r
                                    )
                                 
                                 
                                    (
                                    
                                       
                                          1
                                          6
                                       
                                       −
                                       
                                          1
                                          
                                             
                                                
                                                   r
                                                
                                                2
                                             
                                          
                                       
                                    
                                    )
                                 
                              
                           
                        
                     

The value of r given in Eq. (18) is usually large since k
                        
                           xx
                         and k
                        
                           zz
                         are equal and the relation l
                        
                           e
                        /h is very large. Thus one approximation is α≈cosh(r)/6. Additionally, since r is large, it is acceptable that cosh(r)/6 may be replaced by a large number.

In practice the procedure adopted for correction of the FE equations is to subtract α=hl
                        
                           e
                        
                        k
                        
                           zz
                        
                        cosh(r)/6 from the main diagonal related to the T
                        
                           b
                         degrees of freedom of the element conductivity matrix 
                           K
                        
                        
                           e
                        , cosh(r)/6 replaced by a large number (1000). In the case of 2D problems the correction depends on the element area A
                        
                           e
                         and is given by α=hA
                        
                           e
                        
                        k
                        
                           zz
                        
                        cosh(r)/6. Similar reasoning shows that, in general, the main diagonal related to the T
                        
                           c
                         degrees of freedom must also be corrected using the same procedure just presented.

The heat transfer problem posed in Eq. (5) can be discretized in space using the heat capacitance matrix 
                           M
                        
                        
                           e
                         and element conductivity matrices 
                           K
                        
                        
                           e
                         given in Eqs. (13) and (14). Additionally, element thermal load vectors 
                           f
                        
                        
                           e
                         may be derived using Eqs. (6)–(8). When the global matrix equations are assembled they result in
                           
                              (26)
                              
                                 M
                                 
                                    T
                                    ̇
                                 
                                 +
                                 KT
                                 =
                                 f
                              
                           
                        where 
                           M
                        , 
                           K
                         and 
                           f
                         are the global counterparts of 
                           M
                        
                        
                           e
                        , 
                           K
                        
                        
                           e
                         and 
                           f
                        
                        
                           e
                        , and 
                           T
                         is the global vector of nodal temperatures.

In steady state problems the temperature is assumed constant leading to a problem in the form
                           
                              (27)
                              
                                 KT
                                 =
                                 f
                              
                           
                        
                     

Eq. (27) is nonlinear when 
                           K
                         and 
                           f
                         depend on temperature. Nonlinearity may also arise depending on the thermal loading and boundary conditions. A simple recurring scheme to solve the nonlinear Eq. (27) is the Picard method[14] given by
                           
                              (28)
                              
                                 K
                                 (
                                 
                                    
                                       T
                                    
                                    n
                                 
                                 )
                                 
                                    
                                       T
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       f
                                    
                                    n
                                 
                              
                           
                        where the superscript n represents the iteration number. The procedure progresses until the tolerance ε is achieved, computed as follows:
                           
                              (29)
                              
                                 
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   T
                                                
                                                
                                                   n
                                                   +
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   T
                                                
                                                n
                                             
                                             )
                                          
                                          T
                                       
                                       (
                                       
                                          
                                             T
                                          
                                          
                                             n
                                             +
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             T
                                          
                                          n
                                       
                                       )
                                    
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   T
                                                
                                                
                                                   n
                                                   +
                                                   1
                                                
                                             
                                             )
                                          
                                          T
                                       
                                       
                                          
                                             T
                                          
                                          
                                             n
                                             +
                                             1
                                          
                                       
                                    
                                 
                                 <
                                 
                                    
                                       ε
                                    
                                    2
                                 
                              
                           
                        
                     

The Picard method is usually good enough to achieve convergence in a few iterations. However, in highly nonlinear problems, more elaborate schemes may be required that adopt the concept of relaxation. In the problems tackled in this work the Picard method has proven to be good enough.

If 
                           T
                         is time dependent some type of numerical time marching scheme must be employed. The most basic time integration procedure available is the forward Euler method. However, stability issues disavow the forward Euler method because it would require extremely small time steps. A more general approach, called generalized midpoint method, consists in evaluating Eq. (26) in an intermediate time step, in between n and n+1 such that
                           
                              (30)
                              
                                 
                                    
                                       
                                          T
                                          ̇
                                       
                                    
                                    a
                                 
                                 =
                                 
                                    1
                                    
                                       Δ
                                       t
                                    
                                 
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                 
                                 −
                                 
                                    
                                       T
                                    
                                    n
                                 
                                 )
                                 ,
                                 
                                 
                                    
                                       T
                                    
                                    a
                                 
                                 =
                                 
                                    (
                                    
                                       1
                                       −
                                       θ
                                    
                                    )
                                 
                                 
                                    
                                       T
                                    
                                    n
                                 
                                 +
                                 θ
                                 
                                    
                                       T
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                 
                              
                           
                        where θ is an arbitrary parameter with 0≤θ≤1. When Eq. (26) is evaluated at 
                           T
                        
                        
                           a
                         it results in
                           
                              (31)
                              
                                 
                                    1
                                    
                                       Δ
                                       t
                                    
                                 
                                 M
                                 (
                                 
                                    
                                       T
                                    
                                    a
                                 
                                 )
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                 
                                 −
                                 
                                    
                                       T
                                    
                                    n
                                 
                                 )
                                 +
                                 θ
                                 K
                                 (
                                 
                                    
                                       T
                                    
                                    a
                                 
                                 )
                                 
                                    
                                       T
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                 
                                 =
                                 f
                                 (
                                 
                                    
                                       T
                                    
                                    a
                                 
                                 )
                                 −
                                 
                                    (
                                    
                                       1
                                       −
                                       θ
                                    
                                    )
                                 
                                 K
                                 (
                                 
                                    
                                       T
                                    
                                    a
                                 
                                 )
                                 
                                    
                                       T
                                    
                                    n
                                 
                              
                           
                        where Δt=t
                        
                           n+1−t
                        
                           n
                         is the time step. Different values of θ lead to different time marching schemes. When θ=0 the forward Euler method is produced. When θ=1 the backward Euler method is produced which is an implicit method. In general θ>0 produces implicit schemes but the only second order accurate is the Crank–Nicolson obtained with θ=1/2. Substitution of θ=
                           
                              
                                 1
                                 2
                              
                           
                         into (30) and (31) gives:
                           
                              (32)
                              
                                 
                                    
                                       T
                                    
                                    a
                                 
                                 =
                                 
                                    
                                       
                                          
                                             T
                                          
                                          n
                                       
                                       +
                                       
                                          
                                             T
                                          
                                          
                                             n
                                             +
                                             1
                                          
                                       
                                    
                                    2
                                 
                              
                           
                        
                        
                           
                              (33)
                              
                                 
                                    1
                                    
                                       Δ
                                       t
                                    
                                 
                                 M
                                 (
                                 
                                    
                                       T
                                    
                                    a
                                 
                                 )
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                 
                                 −
                                 
                                    
                                       T
                                    
                                    n
                                 
                                 )
                                 +
                                 
                                    1
                                    2
                                 
                                 K
                                 (
                                 
                                    
                                       T
                                    
                                    a
                                 
                                 )
                                 
                                    
                                       T
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                 
                                 +
                                 
                                    1
                                    2
                                 
                                 K
                                 (
                                 
                                    
                                       T
                                    
                                    a
                                 
                                 )
                                 
                                    
                                       T
                                    
                                    n
                                 
                                 =
                                 f
                                 (
                                 
                                    
                                       T
                                    
                                    a
                                 
                                 )
                              
                           
                        
                     

Considering that 
                           
                              
                                 T
                              
                              
                                 n
                                 +
                                 1
                              
                           
                           =
                           2
                           
                              
                                 T
                              
                              a
                           
                           −
                           
                              
                                 T
                              
                              n
                           
                        , the Crank–Nicolson scheme applied to Eq. (31) yields
                           
                              (34)
                              
                                 
                                    [
                                    
                                       
                                          2
                                          
                                             Δ
                                             t
                                          
                                       
                                       M
                                       (
                                       
                                          
                                             T
                                          
                                          a
                                       
                                       )
                                       +
                                       K
                                       (
                                       
                                          
                                             T
                                          
                                          a
                                       
                                       )
                                    
                                    ]
                                 
                                 
                                    
                                       T
                                    
                                    a
                                 
                                 =
                                 f
                                 (
                                 
                                    
                                       T
                                    
                                    a
                                 
                                 )
                                 +
                                 
                                    2
                                    
                                       Δ
                                       t
                                    
                                 
                                 M
                                 (
                                 
                                    
                                       T
                                    
                                    a
                                 
                                 )
                                 
                                    
                                       T
                                    
                                    n
                                 
                              
                           
                        which is an implicit equation whose solution delivers 
                           T
                        
                        
                           a
                        . The Picard method presented in Eq. (28) can be effectively used to solve Eq. (34). Once 
                           T
                        
                        
                           a
                         is computed the algorithm advances in time through 
                           T
                        
                        
                           n+1=2
                           T
                        
                        
                           a
                        −
                           T
                        
                        
                           n
                        . One important aspect of the Crank–Nicolson method is that it is theoretically unconditionally stable, i.e., any Δt is guaranteed not to diverge, although temporal oscillations may occur if Δt is too big.

The phase change process in the weld pool needs to absorb or release thermal energy described by latent heat. There are several methods to take into account the latent heat. These methods are usually divided into fixed and moving mesh methods. In the moving mesh method the phase change interface is determined as a moving boundary and solid and liquid region are analyzed separately. The fixed mesh methods account for the phase change condition implicitly, involving a solution of a continuous system, without attempting to establish the position of the interface. The moving mesh method requires a sophisticated front tracking algorithm, while with a simpler approach is possible to use a fixed grid [15,16].

The enthalpy is defined by
                           
                              (35)
                              
                                 H
                                 =
                                 
                                    ∫
                                    
                                       T
                                       r
                                    
                                    T
                                 
                                 ρ
                                 
                                    (
                                    T
                                    )
                                 
                                 c
                                 
                                    (
                                    T
                                    )
                                 
                                 d
                                 T
                              
                           
                        
                     

And
                           
                              (36)
                              
                                 
                                    
                                       d
                                       H
                                    
                                    
                                       d
                                       T
                                    
                                 
                                 =
                                 
                                    
                                       c
                                    
                                    
                                       e
                                       f
                                       f
                                    
                                 
                                 =
                                 ρ
                                 
                                    (
                                    T
                                    )
                                 
                                 c
                                 
                                    (
                                    T
                                    )
                                 
                              
                           
                        where c
                        
                           eff
                         is the effective heat capacity.

Eq. (1) can be rewritten as
                           
                              (37)
                              
                                 
                                    
                                       d
                                       H
                                    
                                    
                                       d
                                       T
                                    
                                 
                                 
                                    
                                       ∂
                                       T
                                    
                                    
                                       ∂
                                       t
                                    
                                 
                                 =
                                 −
                                 
                                    
                                       ∂
                                       
                                          
                                             q
                                          
                                          
                                             x
                                          
                                       
                                    
                                    
                                       ∂
                                       x
                                    
                                 
                                 −
                                 
                                    
                                       ∂
                                       
                                          
                                             q
                                          
                                          
                                             y
                                          
                                       
                                    
                                    
                                       ∂
                                       y
                                    
                                 
                                 −
                                 
                                    
                                       ∂
                                       
                                          
                                             q
                                          
                                          
                                             z
                                          
                                       
                                    
                                    
                                       ∂
                                       z
                                    
                                 
                                 +
                                 Q
                              
                           
                        
                     

And, 
                           M
                        
                        
                           e
                         is consequently given by
                           
                              (38)
                              
                                 
                                    
                                       M
                                    
                                    
                                       e
                                    
                                 
                                 =
                                 
                                    ∫
                                    
                                       
                                          
                                             Ω
                                          
                                          
                                             e
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          d
                                          H
                                       
                                       
                                          d
                                          T
                                       
                                    
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         T
                                                      
                                                      N
                                                   
                                                
                                                
                                                   
                                                      z
                                                      
                                                         
                                                            N
                                                         
                                                         T
                                                      
                                                      N
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            z
                                                         
                                                         2
                                                      
                                                      
                                                         
                                                            N
                                                         
                                                         T
                                                      
                                                      N
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      z
                                                      
                                                         
                                                            N
                                                         
                                                         T
                                                      
                                                      N
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            z
                                                         
                                                         2
                                                      
                                                      
                                                         
                                                            N
                                                         
                                                         T
                                                      
                                                      N
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            z
                                                         
                                                         3
                                                      
                                                      
                                                         
                                                            N
                                                         
                                                         T
                                                      
                                                      N
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            z
                                                         
                                                         2
                                                      
                                                      
                                                         
                                                            N
                                                         
                                                         T
                                                      
                                                      N
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            z
                                                         
                                                         3
                                                      
                                                      
                                                         
                                                            N
                                                         
                                                         T
                                                      
                                                      N
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            z
                                                         
                                                         4
                                                      
                                                      
                                                         
                                                            N
                                                         
                                                         T
                                                      
                                                      N
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    d
                                    Ω
                                 
                              
                           
                        
                     

Latent heat effect causes a large increase in the heat capacity in the mushy zone, between the liquidus (T
                        
                           l
                        ) and solidus (T
                        
                           s
                        ) temperatures of material, as shown in the scheme in 
                        Fig. 5.

The direct use of c
                        
                           eff
                         on time integration process should be done with caution due to its step-like behavior. A node that is changing phase must be forced to attain a temperature value in the interval ΔT. If a node does not pass through this interval the latent heat effect is lost for that node, resulting in an incorrect energy balance and consequently incorrect temperatures. This may cause numerical oscillations, making difficult the solution convergence [14].

There are several averaging techniques that overcome difficulties of the direct use of c
                        
                           eff
                        . These averaging techniques are generally referred to as enthalpy method. A simple backward difference approximation is an averaging scheme that gives good results and is computationally fast [4,16,17]:
                           
                              (39)
                              
                                 
                                    
                                       d
                                       H
                                    
                                    
                                       d
                                       T
                                    
                                 
                                 =
                                 
                                    
                                       c
                                    
                                    
                                       e
                                       f
                                       f
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             H
                                          
                                          n
                                       
                                       −
                                       
                                          
                                             H
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                    
                                    
                                       
                                          
                                             T
                                          
                                          n
                                       
                                       −
                                       
                                          
                                             T
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                    
                                 
                              
                           
                        
                     

This was the method used in this work.

The welding arc can generally be modeled in two different ways: by prescribing the temperature in the weld or by specifying the heat input. In prescribed temperature techniques the temperature is given in the nodes inside an area or volume that simulates the weld pool. The prescribed temperature in the specific nodes is increased linearly up to the temperature considered necessary for melting the material, and is maintained at this value for a period of time [5]. This procedure is repeated in volumes along the weld bead for simulating the torch movement.

The prescribed heat input method, which is the most commonly used method, can be applied in two most known ways: by a surface heat flux with gaussian distribution or a volumetric heat flux called Goldak׳s double ellipsoid. Pavelic was the first to suggest a gaussian distribution of heat flux applied on the surface of workpiece [1]. Friedman [18] and Krutz [19] extended this model to a moving heat source model by adapting Pavelic׳s disc for use in finite element applications (
                        Fig. 6). It is computed as
                           
                              (40)
                              
                                 q
                                 
                                    (
                                    
                                       x
                                       ,
                                       y
                                       ,
                                       t
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       3
                                       Q
                                    
                                    
                                       π
                                       
                                          
                                             c
                                          
                                          2
                                       
                                    
                                 
                                 
                                 
                                    
                                       e
                                    
                                    
                                       −
                                       3
                                       
                                          
                                             x
                                          
                                          2
                                       
                                       /
                                       
                                          
                                             c
                                          
                                          2
                                       
                                    
                                 
                                 
                                 
                                    
                                       e
                                    
                                    
                                       −
                                       3
                                       
                                          
                                             [
                                             y
                                             +
                                             v
                                             
                                                (
                                                
                                                   τ
                                                   −
                                                   t
                                                
                                                )
                                             
                                             ]
                                          
                                          2
                                       
                                       /
                                       
                                          
                                             c
                                          
                                          2
                                       
                                    
                                 
                              
                           
                        where x and y are system axes as shown in Fig. 6, v is the welding speed, c is the characteristic radius of heat flux distribution and τ is a lag factor that defines the position of the source at time t=0. Q is the power from the arc
                           
                              (41)
                              
                                 Q
                                 =
                                 η
                                 E
                                 I
                              
                           
                        where η is the efficiency of the welding source, E is the arc voltage and I is the welding current.

In order to consider the digging action of the arc, and also the high rate of heat transportation in the weld pool due to convection, Goldak proposed the double ellipsoid model, that distributes, in gaussian way, a power density (W/m3) in two combined ellipsoidal shapes [20]. The heat source is composed of a front half formed with a quadrant of an ellipsoid, and a rear half composed by a quadrant of another ellipsoid (
                        Fig. 7). The power density distribution inside the front half is given by Eqs. (42) and (43) describes the power density in the rear half.
                           
                              (42)
                              
                                 q
                                 
                                    (
                                    
                                       x
                                       ,
                                       y
                                       ,
                                       z
                                       ,
                                       t
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       6
                                       
                                          3
                                       
                                       
                                          
                                             f
                                          
                                          
                                             f
                                          
                                       
                                       Q
                                    
                                    
                                       a
                                       b
                                       
                                          
                                             c
                                          
                                          
                                             1
                                          
                                       
                                       π
                                       
                                          π
                                       
                                    
                                 
                                 
                                 
                                    
                                       e
                                    
                                    
                                       −
                                       3
                                       
                                          
                                             x
                                          
                                          2
                                       
                                       /
                                       
                                          
                                             a
                                          
                                          2
                                       
                                    
                                 
                                 
                                 
                                    
                                       e
                                    
                                    
                                       −
                                       3
                                       
                                          
                                             y
                                          
                                          2
                                       
                                       /
                                       
                                          
                                             b
                                          
                                          2
                                       
                                    
                                 
                                 
                                 
                                    
                                       e
                                    
                                    
                                       −
                                       3
                                       
                                          
                                             [
                                             z
                                             +
                                             v
                                             
                                                (
                                                
                                                   τ
                                                   −
                                                   t
                                                
                                                )
                                             
                                             ]
                                          
                                          2
                                       
                                       /
                                       
                                          
                                             c
                                          
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (43)
                              
                                 q
                                 
                                    (
                                    
                                       x
                                       ,
                                       y
                                       ,
                                       z
                                       ,
                                       t
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       6
                                       
                                          3
                                       
                                       
                                          
                                             f
                                          
                                          
                                             r
                                          
                                       
                                       Q
                                    
                                    
                                       a
                                       b
                                       
                                          
                                             c
                                          
                                          
                                             2
                                          
                                       
                                       π
                                       
                                          π
                                       
                                    
                                 
                                 
                                 
                                    
                                       e
                                    
                                    
                                       −
                                       3
                                       
                                          
                                             x
                                          
                                          2
                                       
                                       /
                                       
                                          
                                             a
                                          
                                          2
                                       
                                    
                                 
                                 
                                 
                                    
                                       e
                                    
                                    
                                       −
                                       3
                                       
                                          
                                             y
                                          
                                          2
                                       
                                       /
                                       
                                          
                                             b
                                          
                                          2
                                       
                                    
                                 
                                 
                                 
                                    
                                       e
                                    
                                    
                                       −
                                       3
                                       
                                          
                                             [
                                             z
                                             +
                                             v
                                             
                                                (
                                                
                                                   τ
                                                   −
                                                   t
                                                
                                                )
                                             
                                             ]
                                          
                                          2
                                       
                                       /
                                       
                                          
                                             c
                                          
                                          
                                             2
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        where f
                        
                           f
                         and f
                        
                           r
                         are the fractions of heat deposited in the front and rear quadrants respectively, and must satisfy f
                        
                           f
                        
                        +f
                        
                           r
                        
                        =2. The ellipsoid parameters a, b, c
                        1 and c
                        2 correspond to dimensions of the weld pool and can be obtained from experimental data. In absence of these data it is possible to approximate the distance in front of heat source, c
                        1, equal to one half weld width a and the distance behind source, c
                        2, equal the double of weld width [20].

The prescribed temperature technique is the simpler way to model the weld arc, but it can be less accurate than the heat flux model. Goldak׳s double ellipsoid is the most widely used model and, among the models presented, is what best describes the heat source. In this work the heat flux surface model with gaussian distribution was used, because it provides reasonably accurate results and is easier to implement than Goldak׳s model.

An application example of the developed element is shown in 
                        Fig. 8. An aluminum plate of 1mm thick is initially subjected in one of the edges to a linear temperature distribution through the thickness such that T
                        
                           a
                        
                        =1000, T
                        
                           b
                        
                        =2×106 and T
                        
                           c
                        
                        =0. The other edges of the plate are kept at 0°C. This heating condition is maintained for 5s, and then the temperature imposition is removed from the hot side, causing the cooling of the plate. In this example the thermal properties were considered constant, making the problem linear: c=900J/kg°C, ρ=2700kg/m3 and k=237W/m°C. The initial plate temperature is 0°C and the convection coefficient h is zero on all surfaces. The mesh used in the spatial discretization was 20×20 elements.

In this example the upper and lower surfaces are isolated, so there is rapid temperature equalization in thickness. The temperature histories at line located at y=250mm on points x=425mm, 450mm and 475mm is shown in 
                        Fig. 9. At these points there is no difference between top and bottom temperatures because even for small time steps of the order 0.01s, T
                        
                           b
                         decreases instantaneously to zero. There is a high temperature gradient near the hot edge, and from the graph it is observed that the temperature evolution in time becomes smoother as the point under analysis is far from the hot side. In the graph it is also possible to observe the natural tendency of stabilization and equalization of temperature until the entire plate is at 0°C.

In this application example it is possible to observe the through-thickness temperature variation. A steel plate with 0.1×0.1×0.002m3 dimension, receives in the midline of the left side a thermal load of 50W equally distributed. The plate is heated for 5s and then is allowed to cool. The initial temperature as well as ambient temperature is 0°C, with h=40W/m2
                        °C applied to all surfaces, except the left surface. The constant thermal properties considered were c=500J/kg°C, ρ=7800kg/m3 and k=40W/m°C. Elements near the hot edge have size 0.001×0.001m2, which gradually increases toward the cold side. The model mesh is illustrated by 
                        Fig. 10.

The temperature history for the thickness located at x=0m and y=0.05m is shown in 
                        Fig. 11. This graph contains temperatures in three different points in the thickness: midplane (z=0m), top surface (z=0.001m) and in a point between these two planes (z=0.0005m). In this graph it is possible to observe a temperature difference up to 4°C. If we consider the symmetry of the problem, the difference between the upper and lower surfaces may reach 8°C. A rapid equalization of temperature through thickness is also noted when the heat input is removed.

The graph of 
                        Fig. 12 shows the temperature history for the thickness located at x=0.001m and y=0.05m. In this region there is no significant variation of temperature through thickness.

A computer code was developed with the new 2D element formulation for solving a transient nonlinear problem. The model was based on Depradeux [21] in order to compare the results of the new element with experimental results. In addition, a 3D model created in ANSYS was used to evaluate the through thickness temperature in comparison with the new element model. A plate of stainless steel AISI 316L with 0.250×0.160×0.010m3 is the part under analysis (
                        Fig. 13).

Considering the enthalpy definition in Eq. (35) the temperature–enthalpy curve (
                        Fig. 14) was obtained with data of ρ(T) and c(T) used in Depradeux. As in Depradeux, the curve was linearly extrapolated up to the T
                        
                           solidus
                         temperature and it is considered that above T
                        
                           liquidus
                         the curve varies linearly with the same slope in the region before the T
                        
                           solidus
                        .

The temperature-dependent thermal conductivity is shown in 
                        Fig. 15. For temperature above the melting point the value of thermal conductivity is doubled to consider fluid flow in weld pool. The convection heat transfer coefficient considered is 10W/m2
                        °C and the ambient temperature 29°C. The radiative heat transfer was not accounted in this article. The consistent nodal loads resulting from the welding torch were accounted by gauss quadrature of the right term of Eq. (5), where the input heat function is described by Eq. (40) applied on top surfaces of elements located in the weld region. The welding parameters are E=10V, I=150A, η=0.68, v=0.001m/s. Based in the weld pool obtained by Depradeux the parameter c of Eq. (40) is equal to 6mm. The welding torch moves through time steps of 1s in both 2D and 3D models, starts at y=10mm and stops at y=240mm.

The mesh used in the 2D model is shown in 
                        Fig. 16. In the weld region the elements have 0.001×0.001m2 dimension and gradually increase to 0.01×0.001m2. Only one half of the plate was modeled because of symmetry.

The 3D model has SOLID70 elements with 0.001×0.001×0.001m3 dimension in the weld region and 0.01×0.001×0.001m3 dimension in the cool edge. 
                        Fig. 17 shows the 3D ANSYS mesh. The latent heat was considered in the ANSYS software by inputting directly enthalpy–temperature curve points.

@&#RESULTS AND DISCUSSION@&#

The 2D model mesh generated 6777 nodes, totaling 20,331 degrees of freedom (dof), while in the 3D model were utilized 74,547 nodes or dof. The temperature field calculated by the new 2D element at 85s and 230s are shown in 
                     Fig. 18.

The section located 95mm from the origin of the y-axis is shown in 
                     Fig. 19 at time 85s. In this time the torch is located on this section, so that the section reaches its peak temperature.

As can be seen in Figs. 18 and 19, there is a high gradient of temperature in the weld zone; furthermore, the through-thickness gradient becomes insignificant when the distance to the weld line is 10mm or bigger.


                     
                     
                     Figs. 20 and 21 show the numerical results obtained with 2D code, 3D Ansys model and experimental setup (Depradeux). It shows the temperature history on specific points at top and bottom surfaces of the section located at y=95mm.

It can be seen in Figs. 20 and 21 that there is a good agreement between the numerical results and the measured data. The results obtained from the 2D code were very close to those obtained with the 3D Ansys model. The greatest variations between the models occurs in the points near weld line, where there is a high gradient of temperature. For points away from the weld line, where the temperature gradient is smaller, the numerical and experimental results have better agreement. This can be explained by the model of the heat source, which has a strong influence on the gradient of the weld zone. The calibration of the source model can approximate the numerical and experimental results in the region of high gradient.


                     
                     Fig. 22 shows the through thickness temperature located at y=95mm and x=0 over time. From this chart, it is possible to compare the evolution of the through thickness temperature in between the 2D and 3D models. As can be seen in Fig. 22, the major difference between temperatures occurs at the time 85s, at which the torch is located on the line in question, creating the largest temperature gradient. Before and also after the passing of the torch, the difference between the curves is small, which is an evidence that the parabolic approximation of temperature on thickness adopted in the development of the 2D model is reasonable.

@&#CONCLUSIONS@&#

A formulation of a 2D heat transfer element with parabolic through-the-thickness temperature distribution was carried out. A 3D model of ANSYS thermal analysis was developed in parallel to compare the numerical results, focusing on the temperature distribution in the thickness. A numerical transient heat transfer analysis of a GTAW process was performed. Nonlinear properties of the steel and heat loss by convection were considered. Furthermore, experimental results obtained from the literature were used to validate the model. The 2D model with parabolic temperature variation in thickness showed a good correlation of results with the 3D model and the experimental data.

Thermal analysis on plates where the through thickness temperature is important can be made more economically when using the 2D element described in this work. The plate discretization using 2D elements (12 degrees of freedom each) needs only one element in the thickness, while in the plate discretization with 3D elements (8 degrees of freedom each) is required more elements in the thickness direction.

@&#REFERENCES@&#

