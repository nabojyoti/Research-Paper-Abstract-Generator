@&#MAIN-TITLE@&#Modelling facial expressions: A framework for simulating nonlinear soft tissue deformations using embedded 3D muscles

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We model the deformation of the human face due to muscle contraction.


                        
                        
                           
                           3-D muscles with anatomical geometry and fibre orientation is used.


                        
                        
                           
                           Muscle forces are represented as discrete point load at the integration points.


                        
                        
                           
                           Increasing the number of embedded muscles does not increase the degrees of freedom.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Facial biomechanics

Embedded muscles

Nonlinear elasticity

Cubic hermite elements

Mixed finite element method

@&#ABSTRACT@&#


               
               
                  Human face can be seen as a soft tissue organ complex with a large investing network of musculature. Due to its complexity, most existing computational models approximate these muscular structures using simple geometries such as 1-D curves or primitive 3-D shapes. This paper presents a new approach to evaluate muscle contribution from anatomically accurate geometries while maintaining the computational complexity at a tractable level. In the proposed method, 3-D muscle structures are embedded inside a facial continuum (encompassing all superficial soft tissue structures), where mechanical contribution of muscles is evaluated independently and transferred to the facial computational domain through a finite element mapping procedure. Muscle forces are decomposed into an array of discrete point loads that are determined at the integration points of an appropriate quadrature scheme. As a result, muscle meshes can be constructed independent from the facial mesh giving two main advantages: (i) the muscle geometries can be refined independent of the facial computational domain, and (ii) it is not required for the computational domain to conform to complex topology of muscle structures.
               
            

@&#INTRODUCTION@&#

Generating facial expressions using anatomically accurate biomechanical models have many applications in entertainment, security and medicine. One important advantage of having a muscle-driven biomechanical face model is that it can produce realistic expressions while interacting with the environment [1]. In facial recognition, a biomechanical model allows detection of an input face with a different expression than available in the training database [2]. Human face models are also used in speech production simulations [3] and to evaluate both aesthetic and functional outcomes of a surgery [4,5]. In all of these, it is important for the numerical predictions of the soft tissue deformation to be reliable and accurate, especially in speech simulations and surgical planning.

Modelling the mechanics of a human face is a computationally challenging task. This is partly due to the fact that facial soft tissues often undergo large local rotations and straining. Thus, nonlinear, finite deformation (large deformation) elasticity theory is required to model these deformations accurately. In addition, facial soft tissues, like many other biological tissues, are structurally complex [6,7], and exhibit nonlinear constitutive behaviour [8]. Analysing muscle contraction at the whole face level presents even more fascinating challenge as computer modellers must also consider the directional mechanical contribution of individual muscle fascicles that are part of a complex muscular network. Almost all early computational models of the human face treated muscular structures as series of line segments [9–11]. However, these linear 1-D models were incapable of recreating the paths of muscles with complex geometry. In addition, they often disregarded the heterogeneous and anisotropic mechanical response resulted from the embedded fibrous structures. Some of these issues have been addressed by more recent muscle models. For example, Gladilin et al. [12] proposed a virtual fibre model where muscle fibres were described as a vector field inside a 3-D ellipsoid. Similarly, Sifakis et al. [1] and Nazari et al. [13] used multiple 1-D spline and cable elements to approximate 3-D geometries. Another common approach is to model these muscles and other facial structures as discrete element regions. For example, Chabanas et al. [14] labelled certain elements inside the face mesh as muscle elements, where forces were applied on the nodes of these elements in direction of muscle fibres. Nevertheless, these techniques require extensive manipulation of the face mesh and often lacked anatomical accuracy.

This paper presents a new approach for modelling complex musculature inside the human face based on the theory of finite elasticity. The governing equations are numerically solved using the finite element method. In the proposed implementation, we treat facial tissues as incompressible and hyperelastic material. 3-D muscle structures are embedded inside a single face continuum through a finite element coordinate mapping procedure. In order to ensure anatomical accuracy, all finite element volume meshes (face continuum and individual muscles) were generated using the data derived from the visible human cryosection images [15].

A brief description pertinent to the theory of finite elasticity and finite element method is presented in the next section. This is followed by the details of constitutive relations of the facial tissues and muscle fibres adapted in our model and the formulation of the finite element model. Creation of anatomically accurate geometries of the model structures is outlined next. In the subsequent section, simulation results are presented. Finally a discussion highlighting strengths and weaknesses of the framework is provided.

Finite elasticity theory with finite element implementation is a common mathematical approach for describing the principles of continuum mechanics applied to biological soft tissues. In contrast to linear elasticity, finite elasticity theory is able to accurately predict nonlinear kinematics of mechanically nonlinear materials that undergo large local rotations and large straining. For a comprehensive introduction to the nonlinear continuum mechanics, the reader is referred to [16]. This section provides a brief summary of the theory, which is fundamental to modelling the biomechanics of the human face.

In order to describe the large deformations of a body, we first need to consider the kinematic relationship between the body in the reference (undeformed) configuration, described by 
                        X
                        =
                        (
                        
                           
                              X
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              X
                           
                           
                              2
                           
                        
                        ,
                        
                           
                              X
                           
                           
                              3
                           
                        
                        )
                      and the current (deformed) configuration, described by 
                        x
                        =
                        (
                        
                           
                              x
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              x
                           
                           
                              2
                           
                        
                        ,
                        
                           
                              x
                           
                           
                              3
                           
                        
                        )
                     , in the spatial Cartesian coordinate system. Here, 
                        x
                      is a continuous, differentiable and a single-valued function of 
                        X
                     : 
                        x
                        =
                        X
                        +
                        u
                        (
                        X
                        )
                     , with 
                        u
                      being the displacement from the reference to the current configuration. The deformation gradient tensor 
                        F
                        =
                        ∂
                        x
                        /
                        ∂
                        X
                      quantifies this spatial transformation. According to the principle of virtual work, the external virtual work (
                        δ
                        
                           
                              W
                           
                           
                              e
                              x
                              t
                           
                        
                     ) due to an arbitrary virtual displacement (
                        δ
                        u
                     ), is equal to the internal virtual work (
                        δ
                        
                           
                              W
                           
                           
                              int
                           
                        
                     ) stored in the body: 
                        δ
                        
                           
                              W
                           
                           
                              e
                              x
                              t
                           
                        
                        =
                        δ
                        
                           
                              W
                           
                           
                              int
                           
                        
                     . For a static equilibrium, the virtual work statements can be described as
                        
                           (1)
                           
                              δ
                              
                                 
                                    W
                                 
                                 
                                    int
                                 
                              
                              =
                              
                                 ∫
                                 v
                              
                              
                                 σ
                                 :
                                 
                                    [
                                    
                                       
                                          
                                             ∂
                                             δ
                                             u
                                          
                                          
                                             ∂
                                             x
                                          
                                       
                                    
                                    ]
                                 
                                 d
                                 v
                              
                              δ
                              
                                 
                                    W
                                 
                                 
                                    e
                                    x
                                    t
                                 
                              
                              =
                              
                                 ∫
                                 v
                              
                              
                                 f
                                 ⋅
                                 δ
                                 u
                                 d
                                 v
                              
                              +
                              
                                 ∫
                                 s
                              
                              
                                 t
                                 ⋅
                                 δ
                                 u
                                 d
                                 s
                              
                           
                        
                     Here, 
                        σ
                      is the Cauchy stress tensor, 
                        f
                      and 
                        t
                      are the body force and boundary traction vectors in the current configuration, 
                        v
                      and 
                        s
                      are the current volume and surface area of the body respectively.

In order to solve Eq. (1), the finite element method (FEM) is used. In the FEM, all variables are approximated as piecewise polynomials controlled by a finite number of nodal parameters. Moreover, in the case of finite elasticity with incompressible materials, mixed-FEM (displacement–pressure) implementation is required [17], Thus, the two dependent fields, displacement u and pressure p (a detailed description of p is given in Section 3) are given by the following finite element interpolation scheme.
                           
                              (2)
                              
                                 u
                                 =
                                 
                                    
                                       ∑
                                       n
                                    
                                    
                                       
                                          
                                             ψ
                                          
                                          
                                             n
                                          
                                          
                                             (
                                             u
                                             )
                                          
                                       
                                       (
                                       ξ
                                       )
                                       ⋅
                                       
                                          
                                             u
                                          
                                          
                                             n
                                          
                                       
                                    
                                 
                                 p
                                 =
                                 
                                    
                                       ∑
                                       n
                                    
                                    
                                       
                                          
                                             ψ
                                          
                                          
                                             n
                                          
                                          
                                             (
                                             p
                                             )
                                          
                                       
                                       (
                                       ξ
                                       )
                                       ⋅
                                       
                                          
                                             p
                                          
                                          
                                             n
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 u
                              
                              
                                 n
                              
                           
                         and 
                           
                              
                                 p
                              
                              
                                 n
                              
                           
                         are nodal parameters of displacement and pressure fields respectively. 
                           
                              
                                 ψ
                              
                              
                                 n
                              
                              
                                 (
                                 u
                                 )
                              
                           
                         and 
                           
                              
                                 ψ
                              
                              
                                 n
                              
                              
                                 (
                                 p
                                 )
                              
                           
                         are associated basis functions and 
                           ξ
                           =
                           (
                           
                              
                                 ξ
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 ξ
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 ξ
                              
                              
                                 3
                              
                           
                           )
                         are the normalised element coordinates. In order to better satisfy the physical conditions for realistic soft tissue deformations such as large bending and torsion, derivative continuous (C1-continuous) cubic Hermite basis functions are used to interpolate the displacement field [18]. Furthermore, to avoid ill-conditioning, basis functions for the pressure field are required to be at least one order of polynomial lower than that used for the geometric field [16]. In this study, the pressure field is interpolated using linear Lagrange basis functions.

The human face primarily consists of mechanically passive adipose and connective tissues. These materials are often approximated as isotropic and hyperelastic [4,13,19]. In this paper, we model facial tissues as incompressible Mooney–Rivlin solid whose constitutive properties can be expressed using a scalar strain energy density function as follows:
                              
                                 (3)
                                 
                                    w
                                    =
                                    
                                       
                                          c
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          
                                             I
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          1
                                       
                                    
                                    −
                                    3
                                    )
                                    +
                                    
                                       
                                          c
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    
                                       
                                          
                                             I
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    3
                                    )
                                    −
                                    p
                                    (
                                    J
                                    −
                                    1
                                    )
                                 
                              
                           where 
                              
                                 
                                    c
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    c
                                 
                                 
                                    2
                                 
                              
                            are the parameters related to the elastic distortion of the material, 
                              
                                 
                                    
                                       I
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    
                                       I
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                            are the isochoric strain invariants derived from the isochoric deformation tensor [20]. It shall be noted that the use of isochoric strain invariants provides better numerical characteristics when modelling incompressible bodies that undergo large deformations [21]. The derivatives of 
                              w
                            with respect to energetically conjugated strain give stress tensor:
                              
                                 (4)
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          f
                                          a
                                          c
                                          e
                                       
                                    
                                    =
                                    2
                                    
                                       (
                                       
                                          
                                             
                                                c
                                             
                                             
                                                1
                                             
                                          
                                          B
                                          +
                                          
                                             
                                                c
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          
                                             
                                                I
                                             
                                             
                                                1
                                             
                                          
                                          B
                                          −
                                          
                                             
                                                B
                                             
                                             2
                                          
                                          )
                                          −
                                          
                                             (
                                             
                                                
                                                   1
                                                   3
                                                
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   
                                                      
                                                         I
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                
                                                   2
                                                   3
                                                
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      
                                                         I
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             )
                                          
                                          I
                                       
                                       )
                                    
                                    −
                                    p
                                 
                              
                           where 
                              
                                 
                                    σ
                                 
                                 
                                    f
                                    a
                                    c
                                    e
                                 
                              
                            is the Cauchy stress tensor that is used to describe the mechanical behaviour of the passive facial tissues. 
                              B
                              =
                              F
                              
                                 
                                    F
                                 
                                 T
                              
                           is the Finger deformation tensor and 
                              I
                            is the identity tensor. To enforce incompressibility during the deformation, a Lagrange multiplier constraint is used:
                              
                                 (5)
                                 
                                    δ
                                    
                                       
                                          W
                                       
                                       
                                          v
                                          o
                                          l
                                       
                                    
                                    =
                                    
                                       ∫
                                       v
                                    
                                    
                                       (
                                       J
                                       −
                                       1
                                       )
                                       δ
                                       p
                                       d
                                       v
                                    
                                    =
                                    0
                                 
                              
                           where 
                              J
                              =
                              det
                              F
                            is the Jacobian of transformation, and 
                              δ
                              p
                            is the variation of the pressure variable. Using this constraint, 
                              p
                            can be evaluated such that zero volume change (
                              J
                              =
                              1
                           ) is imposed over the integrated domain.

The mechanical contribution of the muscle structure depends primarily on the response of its constituents, namely, the muscle fibres and surrounding matrix. In this study, the surrounding matrix of the muscle was assumed to be hyperelastic and isotropic, and therefore can be approximated as a Mooney–Rivlin material (Eq. 4) together with the rest of the passive facial tissues (fat and connective tissues etc.). The muscle fibres however, have direction-dependent mechanical passive response, and they constitute the mechanically active component inside a muscle structure.

The process of force generation inside a muscle fibre is well documented and can be described by the sliding filament model [22] and cross-bridge theory [23]. During contraction, the overlaps between the actin and myosin filaments increase, causing an overall shortening and thickening of the muscle fibre. In isometric contraction, the muscle fibre length is held constant, but produces increasing active force as the level of activation increases. The term tetanic tension refers to the active tension force produced from a muscle tetanised under isometric conditions.

The tetanic tension is known to be directly related to muscle fibre stretch (
                              λ
                              =
                              L
                              /
                              
                                 
                                    L
                                 
                                 
                                    0
                                 
                              
                           ), where 
                              
                                 
                                    L
                                 
                                 
                                    0
                                 
                              
                            and 
                              L
                            are the reference and current fibre lengths respectively; for skeletal muscles, tetanic tension curve has a local maximum at the experimentally determined optimal fibre stretch 
                              
                                 
                                    λ
                                 
                                 
                                    o
                                    f
                                    l
                                 
                              
                           . In addition, it is also observed that muscle fibres developed passive restorative forces when elongated beyond the optimal fibre length [24]. The following piecewise functions given by Blemker et al. [25] reproduce the classical force–stretch relationship observed in human skeletal muscles:
                              
                                 (6)
                                 
                                    
                                       
                                          f
                                       
                                       
                                          a
                                          c
                                          t
                                          i
                                          v
                                          e
                                       
                                       
                                          f
                                          i
                                          b
                                          r
                                          e
                                       
                                    
                                    (
                                    λ
                                    )
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  9
                                                                  
                                                                     
                                                                        (
                                                                        λ
                                                                        /
                                                                        
                                                                           
                                                                              λ
                                                                           
                                                                           
                                                                              o
                                                                              f
                                                                              l
                                                                           
                                                                        
                                                                        −
                                                                        0.4
                                                                        )
                                                                     
                                                                     2
                                                                  
                                                                  ,
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  1
                                                                  −
                                                                  4
                                                                  
                                                                     
                                                                        (
                                                                        1
                                                                        −
                                                                        λ
                                                                        /
                                                                        
                                                                           
                                                                              λ
                                                                           
                                                                           
                                                                              o
                                                                              f
                                                                              l
                                                                           
                                                                        
                                                                        )
                                                                     
                                                                     2
                                                                  
                                                                  ,
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  9
                                                                  
                                                                     
                                                                        (
                                                                        λ
                                                                        /
                                                                        
                                                                           
                                                                              λ
                                                                           
                                                                           
                                                                              o
                                                                              f
                                                                              l
                                                                           
                                                                        
                                                                        −
                                                                        1.6
                                                                        )
                                                                     
                                                                     2
                                                                  
                                                                  ,
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  0
                                                                  ,
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  0.4
                                                                  
                                                                     
                                                                        λ
                                                                     
                                                                     
                                                                        o
                                                                        f
                                                                        l
                                                                     
                                                                  
                                                                  <
                                                                  λ
                                                                  ≤
                                                                  0.6
                                                                  
                                                                     
                                                                        λ
                                                                     
                                                                     
                                                                        o
                                                                        f
                                                                        l
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  0.6
                                                                  
                                                                     
                                                                        λ
                                                                     
                                                                     
                                                                        o
                                                                        f
                                                                        l
                                                                     
                                                                  
                                                                  <
                                                                  λ
                                                                  <
                                                                  1.4
                                                                  
                                                                     
                                                                        λ
                                                                     
                                                                     
                                                                        o
                                                                        f
                                                                        l
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  1.4
                                                                  
                                                                     
                                                                        λ
                                                                     
                                                                     
                                                                        o
                                                                        f
                                                                        l
                                                                     
                                                                  
                                                                  ≤
                                                                  λ
                                                                  <
                                                                  1.6
                                                                  
                                                                     
                                                                        λ
                                                                     
                                                                     
                                                                        o
                                                                        f
                                                                        l
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  otherwise
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          p
                                          a
                                          s
                                          s
                                          i
                                          v
                                          e
                                       
                                       
                                          f
                                          i
                                          b
                                          r
                                          e
                                       
                                    
                                    (
                                    λ
                                    )
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        P
                                                                     
                                                                     
                                                                        1
                                                                     
                                                                  
                                                                  (
                                                                  
                                                                     
                                                                        e
                                                                     
                                                                     
                                                                        
                                                                           
                                                                              P
                                                                           
                                                                           
                                                                              2
                                                                           
                                                                        
                                                                        (
                                                                        λ
                                                                        /
                                                                        
                                                                           
                                                                              λ
                                                                           
                                                                           
                                                                              o
                                                                              f
                                                                              l
                                                                           
                                                                        
                                                                        −
                                                                        1
                                                                        )
                                                                     
                                                                  
                                                                  −
                                                                  1
                                                                  )
                                                                  ,
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        P
                                                                     
                                                                     
                                                                        3
                                                                     
                                                                  
                                                                  λ
                                                                  /
                                                                  
                                                                     
                                                                        λ
                                                                     
                                                                     
                                                                        o
                                                                        f
                                                                        l
                                                                     
                                                                  
                                                                  +
                                                                  
                                                                     
                                                                        P
                                                                     
                                                                     
                                                                        4
                                                                     
                                                                  
                                                                  ,
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  0
                                                                  ,
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        λ
                                                                     
                                                                     
                                                                        o
                                                                        f
                                                                        l
                                                                     
                                                                  
                                                                  <
                                                                  λ
                                                                  <
                                                                  
                                                                     
                                                                        λ
                                                                     
                                                                     ⁎
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  λ
                                                                  ≥
                                                                  
                                                                     
                                                                        λ
                                                                     
                                                                     ⁎
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  otherwise
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           In Eq. (6), 
                              
                                 
                                    f
                                 
                                 
                                    a
                                    c
                                    t
                                    i
                                    v
                                    e
                                 
                                 
                                    f
                                    i
                                    b
                                    r
                                    e
                                 
                              
                            and 
                              
                                 
                                    f
                                 
                                 
                                    p
                                    a
                                    s
                                    s
                                    i
                                    v
                                    e
                                 
                                 
                                    f
                                    i
                                    b
                                    r
                                    e
                                 
                              
                            are the fibre force normalised to the tetanic (maximum active) tension at the optimal fibre stretch, 
                              
                                 
                                    λ
                                 
                                 ⁎
                              
                            represents the fibre stretch at which 
                              
                                 
                                    f
                                 
                                 
                                    p
                                    a
                                    s
                                    s
                                    i
                                    v
                                    e
                                 
                                 
                                    f
                                    i
                                    b
                                    r
                                    e
                                 
                              
                            becomes linear, 
                              
                                 
                                    P
                                 
                                 
                                    3
                                 
                              
                            and 
                              
                                 
                                    P
                                 
                                 
                                    4
                                 
                              
                            are defined such that 
                              
                                 
                                    f
                                 
                                 
                                    p
                                    a
                                    s
                                    s
                                    i
                                    v
                                    e
                                 
                                 
                                    f
                                    i
                                    b
                                    r
                                    e
                                 
                              
                            is C0- and C1-continuous at 
                              λ
                              =
                              
                                 
                                    λ
                                 
                                 ⁎
                              
                           .

To model the directional response resulting from the organised structure of muscle fibres, it is more convenient to introduce a structure-based mutually-orthogonal, curvilinear coordinate system 
                              υ
                              =
                              (
                              
                                 
                                    υ
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    υ
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    υ
                                 
                                 
                                    3
                                 
                              
                              )
                           . Here 
                              
                                 
                                    υ
                                 
                                 
                                    1
                                 
                              
                            axis is defined to align with the muscle fibre direction while 
                              
                                 
                                    υ
                                 
                                 
                                    2
                                 
                              
                            and 
                              
                                 
                                    υ
                                 
                                 
                                    3
                                 
                              
                            axes (which are orthogonal to each other) are in a plane normal to the 
                              
                                 
                                    υ
                                 
                                 
                                    1
                                 
                              
                            direction. Hence, the total stress due to active fibre contraction and passive stretch in the fibre direction is given by,
                              
                                 (7)
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          m
                                          u
                                          s
                                          c
                                          l
                                          e
                                       
                                    
                                    =
                                    (
                                    
                                       
                                          σ
                                       
                                       
                                          a
                                          c
                                          t
                                          i
                                          v
                                          e
                                       
                                       
                                          f
                                          i
                                          b
                                          r
                                          e
                                       
                                    
                                    +
                                    
                                       
                                          σ
                                       
                                       
                                          p
                                          a
                                          a
                                          s
                                          i
                                          v
                                          e
                                       
                                       
                                          f
                                          i
                                          b
                                          r
                                          e
                                       
                                    
                                    )
                                    
                                       [
                                       
                                          
                                             
                                                ∂
                                                x
                                             
                                             
                                                ∂
                                                
                                                   
                                                      υ
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    ⊗
                                    
                                       
                                          [
                                          
                                             
                                                
                                                   ∂
                                                   x
                                                
                                                
                                                   ∂
                                                   
                                                      
                                                         υ
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                       T
                                    
                                 
                              
                           where 
                              
                                 
                                    σ
                                 
                                 
                                    a
                                    c
                                    t
                                    i
                                    v
                                    e
                                 
                                 
                                    f
                                    i
                                    b
                                    r
                                    e
                                 
                              
                            and 
                              
                                 
                                    σ
                                 
                                 
                                    p
                                    a
                                    a
                                    s
                                    i
                                    v
                                    e
                                 
                                 
                                    f
                                    i
                                    b
                                    r
                                    e
                                 
                              
                            are the active and passive muscle fibre stress defined along the fibre direction. These stresses can be evaluated from Eq. (6) for a given tetanic stress (
                              
                                 
                                    σ
                                 
                                 
                                    max
                                 
                              
                           ):
                              
                                 (8)
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          a
                                          c
                                          t
                                          i
                                          v
                                          e
                                       
                                       
                                          f
                                          i
                                          b
                                          r
                                          e
                                       
                                    
                                    =
                                    a
                                    (
                                    
                                       
                                          σ
                                       
                                       
                                          max
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          a
                                          c
                                          t
                                          i
                                          v
                                          e
                                       
                                       
                                          f
                                          i
                                          b
                                          r
                                          e
                                       
                                    
                                    (
                                    λ
                                    )
                                    (
                                    λ
                                    /
                                    
                                       
                                          λ
                                       
                                       
                                          o
                                          f
                                          l
                                       
                                    
                                    )
                                    )
                                    
                                       
                                          σ
                                       
                                       
                                          p
                                          a
                                          s
                                          s
                                          i
                                          v
                                          e
                                       
                                       
                                          f
                                          i
                                          b
                                          r
                                          e
                                       
                                    
                                    =
                                    
                                       
                                          σ
                                       
                                       
                                          max
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          p
                                          a
                                          s
                                          s
                                          i
                                          v
                                          e
                                       
                                       
                                          f
                                          i
                                          b
                                          r
                                          e
                                       
                                    
                                    (
                                    λ
                                    )
                                    (
                                    λ
                                    /
                                    
                                       
                                          λ
                                       
                                       
                                          o
                                          f
                                          l
                                       
                                    
                                    )
                                 
                              
                           In Eq. (8), 
                              a
                              ∈
                              [
                              0
                              ,
                              1
                              ]
                            is the level of activation of the muscle fibre, it is assumed that the active fibre stress scales linearly with muscle activation. The ratio 
                              λ
                              /
                              
                                 
                                    λ
                                 
                                 
                                    o
                                    f
                                    l
                                 
                              
                            reflects the change in the tetanic stress due to the change of the sarcomere density from the deformation [25]. Specifically, as the muscle shortens and thickens, the number of fibres across the physiological cross sectional area (PCSA) remains the same. However, the fibre density reduces as a result of increased PCSA.

In order to accurately model the mechanical contribution of muscle fibres inside the face continuum, fibre stresses need to be evaluated separately over their respective volume space. Hence the internal virtual work statement becomes:
                           
                              (9)
                              
                                 δ
                                 
                                    
                                       W
                                    
                                    
                                       int
                                    
                                 
                                 =
                                 
                                    ∫
                                    
                                       
                                          
                                             v
                                          
                                          
                                             f
                                             a
                                             c
                                             e
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          f
                                          a
                                          c
                                          e
                                       
                                    
                                    :
                                    
                                       [
                                       
                                          
                                             
                                                ∂
                                                δ
                                                u
                                             
                                             
                                                ∂
                                                x
                                             
                                          
                                       
                                       ]
                                    
                                    d
                                    v
                                 
                                 +
                                 
                                    
                                       ∑
                                       m
                                    
                                    
                                       {
                                       
                                          
                                             ∫
                                             
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      m
                                                      u
                                                      s
                                                      c
                                                      l
                                                      e
                                                   
                                                   
                                                      (
                                                      m
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   m
                                                   u
                                                   s
                                                   c
                                                   l
                                                   e
                                                
                                                
                                                   (
                                                   m
                                                   )
                                                
                                             
                                          
                                          :
                                          
                                             [
                                             
                                                
                                                   
                                                      ∂
                                                      δ
                                                      u
                                                   
                                                   
                                                      ∂
                                                      x
                                                   
                                                
                                             
                                             ]
                                          
                                          d
                                          v
                                       
                                       }
                                    
                                 
                              
                           
                        It shall be noted that the first term of Eq. (9) is related to the isotropic part of facial tissue including the surrounding matrix of muscles, whereas the second term describes the internal work generated by muscle fibres. Using FEM, we can describe the muscle volume as a system of finite element coordinates 
                           
                              
                                 η
                              
                              
                                 (
                                 m
                                 )
                              
                           
                           =
                           (
                           
                              
                                 η
                              
                              
                                 1
                              
                              
                                 (
                                 m
                                 )
                              
                           
                           ,
                           
                              
                                 η
                              
                              
                                 2
                              
                              
                                 (
                                 m
                                 )
                              
                           
                           ,
                           
                              
                                 η
                              
                              
                                 3
                              
                              
                                 (
                                 m
                                 )
                              
                           
                           )
                        . Since the space occupied by muscle fibres are contained inside the face continuum: 
                           
                              
                                 v
                              
                              
                                 m
                                 u
                                 s
                                 c
                                 l
                                 e
                              
                           
                           ∈
                           
                              
                                 v
                              
                              
                                 f
                                 a
                                 c
                                 e
                              
                           
                        , a unique mapping between the face continuum and each muscle structure can be determined, such that 
                           
                              
                                 ξ
                              
                              
                                 (
                                 m
                                 )
                              
                           
                           =
                           (
                           
                              
                                 ξ
                              
                              
                                 1
                              
                              
                                 (
                                 m
                                 )
                              
                           
                           ,
                           
                              
                                 ξ
                              
                              
                                 2
                              
                              
                                 (
                                 m
                                 )
                              
                           
                           ,
                           
                              
                                 ξ
                              
                              
                                 3
                              
                              
                                 (
                                 m
                                 )
                              
                           
                           )
                         corresponds to 
                           
                              
                                 η
                              
                              
                                 (
                                 m
                                 )
                              
                           
                         but defined with respect to the element coordinate system of the face mesh. Specifically, the mapping between element coordinates 
                           (
                           
                              
                                 η
                              
                              
                                 (
                                 m
                                 )
                              
                           
                           ⇔
                           
                              
                                 ξ
                              
                              
                                 (
                                 m
                                 )
                              
                           
                           )
                         can be obtained by solving 
                           X
                           (
                           ξ
                           )
                           −
                           
                              
                                 X
                              
                              
                                 (
                                 m
                                 )
                              
                           
                           (
                           η
                           )
                           =
                           0
                        . This enables fibre induced stresses to be transferred to the facial computational domain:
                           
                              (10)
                              
                                 δ
                                 
                                    
                                       W
                                    
                                    
                                       int
                                    
                                 
                                 =
                                 δ
                                 u
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   ∭
                                                   
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            f
                                                            a
                                                            c
                                                            e
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      [
                                                      
                                                         
                                                            
                                                               ∂
                                                               Ψ
                                                               (
                                                               ξ
                                                               )
                                                            
                                                            
                                                               ∂
                                                               x
                                                            
                                                         
                                                      
                                                      ]
                                                   
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         f
                                                         a
                                                         c
                                                         e
                                                      
                                                   
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         (
                                                         ξ
                                                         )
                                                      
                                                   
                                                   d
                                                   
                                                      
                                                         ξ
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   d
                                                   
                                                      
                                                         ξ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   d
                                                   
                                                      
                                                         ξ
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                +
                                                
                                                   
                                                      ∑
                                                      m
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            ∭
                                                            
                                                               
                                                                  
                                                                     v
                                                                  
                                                                  
                                                                     m
                                                                     u
                                                                     s
                                                                     c
                                                                     l
                                                                     e
                                                                  
                                                                  
                                                                     (
                                                                     m
                                                                     )
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               [
                                                               
                                                                  
                                                                     
                                                                        ∂
                                                                        Ψ
                                                                        (
                                                                        
                                                                           
                                                                              ξ
                                                                           
                                                                           
                                                                              (
                                                                              m
                                                                              )
                                                                           
                                                                        
                                                                        )
                                                                     
                                                                     
                                                                        ∂
                                                                        x
                                                                     
                                                                  
                                                               
                                                               ]
                                                            
                                                            
                                                               
                                                                  σ
                                                               
                                                               
                                                                  m
                                                                  u
                                                                  s
                                                                  c
                                                                  l
                                                                  e
                                                               
                                                               
                                                                  (
                                                                  m
                                                                  )
                                                               
                                                            
                                                            
                                                               
                                                                  g
                                                               
                                                               
                                                                  (
                                                                  η
                                                                  )
                                                               
                                                            
                                                            d
                                                            
                                                               
                                                                  η
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                            d
                                                            
                                                               
                                                                  η
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            d
                                                            
                                                               
                                                                  η
                                                               
                                                               
                                                                  3
                                                               
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                    }
                                 
                              
                           
                        Eq. (10) presents the finite element formulation of the internal virtual work statement used in this study. In this equation, 
                           
                              
                                 g
                              
                              
                                 (
                                 ξ
                                 )
                              
                           
                         and 
                           
                              
                                 g
                              
                              
                                 (
                                 η
                                 )
                              
                           
                         are the Jacobian of coordinate transformations from the finite element coordinate systems to the spatial Cartesian coordinate system:
                           
                              (11)
                              
                                 
                                    
                                       g
                                    
                                    
                                       (
                                       ξ
                                       )
                                    
                                 
                                 =
                                 det
                                 
                                    [
                                    
                                       
                                          
                                             ∂
                                             x
                                          
                                          
                                             ∂
                                             ξ
                                          
                                       
                                    
                                    ]
                                 
                                 
                                    
                                       g
                                    
                                    
                                       (
                                       η
                                       )
                                    
                                 
                                 =
                                 det
                                 
                                    [
                                    
                                       
                                          
                                             ∂
                                             x
                                          
                                          
                                             ∂
                                             η
                                          
                                       
                                    
                                    ]
                                 
                              
                           
                        Notice that in the internal virtual work statement, muscle stresses are evaluated over the muscle domain, independent to the face continuum. This allows an accurate depiction of the muscle functions irrespective to the face mesh discretisation. The integrations can be evaluated using Gaussian quadrature or other appropriate numerical integration method. Essentially, the integration points from the muscle meshes are mapped to the face mesh as discrete point loads, hence the extra computation lies in evaluating muscle stresses at these additional integration points, but there are no additional degrees of freedom to the problem.

Fibres in certain muscles, such as convergent and pennate muscles, are oriented at an angle to its longitudinal axis [26]. In order to address this issue, we use three Eulerian angles to perform three sequential rotations on the original reference material coordinate system (see Section 3.1.2). Furthermore, to allow local variations, the Euler angles are prescribed at nodes and treated as a continuous finite element field which is interpolated using linear Lagrange basis functions. The details of this method are described in [27]. 
                        Fig. 1 illustrates the dependence of varying muscle fibre orientation on the deformation of a rectangular beam of soft tissue. Due to the orientation of the fibres, the deformation varies from bending to torsional distortion. Notice that the element density of the muscle mesh is independent to that of the beam mesh, this is made possible due to the fact that we handle the numerical integration on the muscle and beam domains separately.

The main mesh representing the facial continuum is a FE discretisation of the superficial fascia (SF) of the face [28] (
                     Fig. 2), located between the external skin surface and the deep fascia. The superficial fascial layer is extracted from the Visible Human (VH) cryosection images [15]. Anatomically, the SF can be considered as superimposition of three distinct layers of structures [7], namely (from the external to internal layer), the dermis, subcutaneous tissues and the superficial musculoaponeurotic system (SMAS). An ultrasound study by Wu et al. [29] has revealed that these structures are kinematically coupled, hence a single continuous mesh is sufficient to model the deformation of the SF. This mesh is discretised into 560 hexahedral elements containing 1180 nodes, which resulted in 28320 geometric degrees of freedom when cubic Hermite interpolations are used. In order to reduce the number of degrees of freedom in our simulations, it was assumed that the anatomy and the deformation is planar symmetric in the mid-sagittal plane, and therefore only half of the face was solved with symmetric boundary conditions added to the nodes on the plane of symmetry.

15 pairs of facial muscles (
                        Table 1) were considered in this study. Their respective mesh geometries were generated using the procedures documented in [30]. Platysma muscles were not included as they arise from the clavicle, outside the coverage of the SF volume mesh. In addition, several other smaller muscles were also neglected. 
                        Fig. 3 shows the position, geometry and the fibre orientation of all muscles that were included in the computational model. Detail close-up views of the zygomaticus major (parallel), orbicularis oris (circular) and buccinators (convergent) muscles are depicted in 
                        Fig. 4.

Underneath the SF is the deep fascia (DF) consisting of deep masticatory muscles, salivary glands and fat pads. In some regions of the face, the SF is in direct contact with the mandible and maxilla. Consequently, a surface corresponding to the deep contact plane is required to simulate the physical contact conditions. Since soft tissues underneath the SF have less contribution to the formation of facial gestures, they are regarded as non-mobile rigid bodies in our current implementation. Two types of contact are considered here. At the perioral region, collision detections are implemented between the SF and bones, as well as between the upper and lower lips. At the fascial interfaces (superficial and deep), sliding interaction prevents the SF from detaching from the deep soft tissues. Both of these contact conditions assume zero friction.

Facial retaining ligaments [31] and muscles attachment points are included in our mechanical model as nodal boundary conditions. These constraints prevent excessive movement of the SF and provide integrity to the overall structure. 
                        Table 2 shows the material parameters (as described in Section 3.1) used in the simulation. Since the effect of gravity is negligible, it was not considered in the current implementation.

This section demonstrates the numerical simulations of various facial expressions by activating relevant facial muscles using the presented model. The results are consistent with other numerically studies [1,4,13] as well as descriptions reported in the anatomical literature [26]. 
                     Fig. 5 demonstrates the simulation results from activating six distinct muscles independently, which includes the levator labii superioris, depressor labii inferioris, risorius, zygomaticus major, orbicularis oris and corrugator supercilii muscles. Although simulating individual muscle actions can be a useful task to determine their relative contribution, however, most complex facial expressions and emotional gestures are the result of coordinated activations of several muscle groups. Earlier models approximated them by superpositioning the elementary deformations of single muscle actions [32]. Nevertheless, the mechanical responses (both passive and active responses) of the facial soft tissues are highly nonlinear, and therefore deformations obtained from the superpositioning principle were often erroneous and misleading. Consequently, it is necessary for the entire nonlinear system to be re-evaluated for every new combination of muscle inputs. 
                     Fig. 6a illustrates a smiling expression generated from the coordinated activation of four facial muscles (zygomaticus major, zygomaticus minor, risorius and levator labii superioris muscles); Fig. 6b presents the frowning expression formed from the contraction of risorius, depressor labii inferioris, mentalis and corrugator supercilii muscles.

@&#DISCUSSION AND CONCLUSION@&#

The main objective of this work is to introduce a finite element framework for embedding complex, 3-D musculature for simulating and analysing mechanical deformation of the facial tissues due to muscle activation.

In comparison to models with 1-D muscles, 3-D muscle geometries have the ability to represent the curved path and shape of muscles with complex topology more accurately. In addition, the moment arms of each individual fascicles can also be more accurately reproduced, resulting in a better representation of the muscle forces acting on the bone [33]. Moreover, the use of realistic muscle geometry eliminates the need to assign heuristic parameters such as the number of virtual fibre bundles per muscle or the estimated PCSA of the muscle geometry. Another advantage of our proposed framework is that the face mesh discretisation is independent of the muscle mesh topology. Therefore, the face mesh can be modified without changing the geometry of the muscle structure. Similarly, the muscle anatomy or other embedded structures can also be manipulated without affecting the face geometry. This can be especially useful when adding new structures to the face model, such as missing muscles, aponeurosis and tendon complexes.

Previous studies in numerical modelling of muscle contractions have also demonstrated the importance of 3-D geometry in generating non-uniform strain distribution observed in experiments [25]. Since the force generated by a muscle fibre varies as a function of its stretch, the non-uniform strain of muscle fibres must be accommodated when evaluating their active and passive stresses at various activation levels. In addition to obtaining non-uniform strain along fascicles, a 3-D model is also able to predict the change of the PCSA of fascicles during deformation, thus improving the predictability when tissues undergo large straining.

In formulating the muscle models, a continuous locally varying finite element field of Euler angles is used to describe fibre pennations in pennate and convergent muscles. A further advantage of using piecewise polynomial representation is that parameters defining these angles (at element nodes) can be accurately fitted to match anatomical measurements using linear least square methods. The challenge is to obtain anatomical fibre orientations in vivo; one possibility is to use diffusion tensor magnetic resonance imaging (DT-MRI) and studies on reconstructing myocardial fibres using DT-MRI have already shown some promising results [34]. In addition to fibre angles, activations levels can also be interpolated using piecewise polynomials. This allows us to investigate spatially varying activation patterns and make effective use of measurements such as facial surface electromyography [35].

In summary, accurate 3-D representation of muscle geometry is necessary to achieve reliable simulations of facial expressions. Despite this, there have not been many face models that incoporate 3-D muscle structures. This is primarily due to the complexity of facial musculatures, which can significantly increase the computational cost of an already expensive problem. We have solved this problem by evaluating 3-D muscle structures as an array of discrete point loads defined at the integration points of the quadrature scheme (e.g. Gauss–Legendre quadrature). The method introduced here can potentially improve the accuracy of predictions without adding too much computational cost. The major assumption made in our method is that the facial tissue mass behaves as a single continuum thus neglecting interactions between different facial structures (e.g. between muscles and the surrounding connective tissues). In our future work, we intend to allow sliding and contact interactions between internal structures by using the extended finite element method to decouple the stresses and strains at the muscle boundaries.

@&#ACKNOWLEDGEMENT@&#

The work presented in this paper was funded by Foundation for Research, Science and Technology of New Zealand under the Grant no. UOAX0712.

@&#REFERENCES@&#

