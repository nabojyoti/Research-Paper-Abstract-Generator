@&#MAIN-TITLE@&#A multiscale finite element technique for nonlinear multi-phase materials

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           Multiscale finite element homogenization technique for modelling deformation in multi-phase materials.


                        
                        
                           
                           Effective macroscopic tangent modulus consistent with the periodic boundary condition in the microstructure.


                        
                        
                           
                           Numerical tests concerning plastic materials with different voids distributions proved the effectiveness of the technique.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Finite Element Method (FEM)

Voids

Plasticity

Multiscale

Homogenisation

Condensation technique

@&#ABSTRACT@&#


               
               
                  This paper presents a multiscale finite element homogenization technique (MFEH) for modelling nonlinear deformation of multi-phase materials. A novel condensation technique to relate force variations acting on the representative volume element (RVE) – involving antiperiodicity of traction forces at RVE corners – and displacement variations on boundary-nodes is proposed. The formulation to accommodate the condensation technique and overall tangent modulus is presented in detail. In this context, the effective homogenised tangent modulus is computed as a function of microstructure stiffness matrix which, in turn, depends upon the material properties and geometrical distribution of the micro-constituents. Numerical tests concerning plastic materials with different voids distributions are presented to show the robustness of the proposed MFEH.
               
            

@&#INTRODUCTION@&#

The heterogeneous nature of materials has a significant impact on the observed macroscopic behaviour of multi-phase materials. Their properties depend upon the size, shape, spatial distribution and material parameters of microconstituents and their respective interfaces. For instance, in reinforced composites, stiff and strong phase inclusions of glass, graphite, boron, or aluminium oxide, are added to epoxy resin, steel, titanium, or aluminium matrices to enhance strength, thermal expansion coefficient and wear resistance of structures.

From an economical point of view, performing straight forward experimental measures on a number of material samples of different sizes, for various geometrical and physical phase properties, volume fractions and loading paths is hardly feasible task. Therefore, there is a clear need for modelling strategies that provide a better understanding of micro–macro-structure property relations in multi-phase heterogeneous materials. The last four decades have seen a development of improved analytical and numerical models for heterogeneous materials.

A transition fro the microscopic properties to their macroscopic counterparts based on an averaging principles is termed homogenisation. The simplest method leading to homogenised modulus of heterogeneous material is based on the rule of mixture. This approach takes only one microstructural characteristic into consideration: the volume ratio of the heterogeneities. A more sophisticated method is the effective medium approximation, as established by Eshelby [1] and further developed by Hashin [2], Mori and Tanaka [3] and more recently by Nan and Clarke [4].

Although some work has been done on extension of the self-consistent approach to non-linear cases, significantly more progress in estimating advanced properties of composites has been achieved by variational bounding methods (see [5,6]). The variational bounding methods are based on suitable variational (minimum energy) principles and provide upper and lower bounds for the overall properties of the composite. Another approach is based on mathematical Asymptotic Expansion Homogenization (AEH) theory [7–9]. AEH is a perturbation technique based on the asymptotic series expansion in 
                        ε
                     , a scale parameter of a primary variable. The scale parameter is a ratio between the length scales, represented by the relation between micro heterogeneities size and a measure of macrostructure. It is represented by a very small positive number 
                        ε
                        =
                        l
                        /
                        L
                        ⪯¡
                        1
                     , see [10–13]. The asymptotic homogenisation technique gives effective overall properties plus local stress and strain values. However, the considerations are restricted to very simple microscopic geometries and simple material models, mostly at small strains.

The unit cell methods represent another way to approach the analysis of multi-phase materials. They appeared due to the complexity of microstructural mechanical and physical behaviour along with the developments of computational techniques. These approaches have been used in a large number of applications, see [14–18]. The unit cell methods provide information on the local microstructural fields and effective material properties. Once the constitutive behaviour becomes nonlinear, it is extremely difficult to make assumption on a suitable macroscopic constitutive format, see [19–21].

Most of the homogenisation techniques aforementioned are not suitable for finite deformations or complex loading paths, since they do not account for geometrical and physical changes in the microstructure. In the Finite Element Method (FEM), the use of a single element capturing all microstructural details in a numerical solution of macroscopic BVP becomes impractical. An alternative approach for homogenisation of multi-phase heterogeneous materials, known as Multi-Scale Computational Homogenisation or Micro–Macro Modelling has been gaining considerable popularity in the computational mechanics circles. Since the basic principles for the micro–macro modelling of heterogeneous materials were introduced (see [22,11,23–25]), this technique has proved to be the most effective way to deal with arbitrary physically non-linear and time dependent material behaviour at micro-level. A number of recent works deal with various approaches and techniques for the micro–macro simulation of heterogeneous materials. Among these, the contributions [26,27] are highlighted for analysis of polycrystalline materials. The multiscale modelling techniques above do not lead to closed-form overall constitutive equations. However, they compute the stress–deformation relationship at every macropoint of interest by modelling of the microstructure RVE corresponding to the macroscopic point. The advantages of multiscale techniques are the following:
                        
                           •
                           They do not require constitutive assumptions on the macrolevel.

They enable the incorporation of finite deformations and rotations at both micro- and macro-levels.

They are suitable for nonlinear material behaviour.

They provide the possibility to introduce detailed microstructural information, including geometrical and physical evolution, into the macroscopic analysis.

Although our study is confined to the finite element method, they allow any modelling technique on the microlevel.

Herein, two of the forces in one node representing antiperiodic traction are condensed. This approach leads to an innovative treatment of the problem. The paper is structured as follows: Firstly, the necessary background is presented. Secondly, the novel condensation technique, associated tangent modulus, etc, are described and formulation is developed in detail. Finally, numerical tests are presented and compared with other results from the literature.

A homogenised macro-continuum with locally attached microstructures is considered herein. The microstructure is denoted by 
                        B
                        ⊂
                        
                           
                              R
                           
                           
                              3
                           
                        
                      with overall properties related to the macrocontinuum 
                        
                           
                              B
                           
                           
                              ¯
                           
                        
                        ⊂
                        
                           
                              R
                           
                           
                              3
                           
                        
                     .

A point 
                        x
                        ∈
                        
                           
                              B
                           
                           
                              ¯
                           
                        
                      of the homogenised macromedium 
                        
                           
                              B
                           
                           
                              ¯
                           
                        
                        ⊂
                        
                           
                              R
                           
                           
                              3
                           
                        
                      is represented as a microstructure 
                        B
                        ⊂
                        
                           
                              R
                           
                           
                              3
                           
                        
                     . The tensors 
                        
                           
                              σ
                           
                           
                              ¯
                           
                        
                      and 
                        
                           
                              σ
                           
                           
                              μ
                           
                        
                      denote the macro and microCauchy stress tensor at 
                        x
                        ∈
                        
                           
                              B
                           
                           
                              ¯
                           
                        
                      and 
                        y
                        ∈
                        B
                     , respectively. The Representative Volume Element (RVE) of the microstructure 
                        V
                        ⊂
                        
                           
                              R
                           
                           
                              3
                           
                        
                      represents the part of the heterogeneous material consisting of the solid part 
                        B
                      and the hole 
                        H
                     , i.e. 
                        V
                        =
                        B
                        ∪
                        H
                      and 
                        ∂
                        B
                        =
                        ∂
                        V
                        ∪
                        ∂
                        H
                     . It is assumed that the traction field on the surface of the holes in the interior of RVE vanishes, i.e.
                        
                           (1)
                           
                              t
                              (
                              y
                              ,
                              t
                              )
                              =
                              0
                              
                              at
                              
                              y
                              ∈
                              ∂
                              H
                           
                        
                     where 
                        t
                        ≡
                        
                           
                              σ
                           
                           
                              μ
                           
                        
                        ·
                        n
                        on
                        
                        ∂
                        B
                      is the traction field vector on the surface with outward normal 
                        n
                      at 
                        y
                        ∈
                        ∂
                        B
                     .

A discrete model of the macro and microstructure is considered in Fig. 1
                     . The overall macroscopic deformation 
                        
                           
                              ϵ
                           
                           
                              ¯
                           
                        
                      is prescribed over the discretised RVE. The main idea of this procedure is based on finite element (F.E.) discretisation. At every integration Gauss point of the macrostructure, a discrete RVE microstructure is considered as representation of the macroGauss point. Based on the Finite Elements discretisation of the microstructure, the goal is to develop a procedure for computing the overall tangent modulus 
                        
                           
                              C
                           
                           
                              ¯
                           
                        
                      and macroscopic average stress 
                        
                           
                              σ
                           
                           
                              ¯
                           
                        
                      at each macroscopic integration point with locally attached microstructure.

The displacement field is divided into two parts 
                        u
                        =
                        
                           
                              u
                           
                           
                              ⁎
                           
                        
                        +
                        
                           
                              u
                           
                           
                              ˜
                           
                        
                      where 
                        
                           
                              u
                           
                           
                              ⁎
                           
                        
                      is the so-called Taylor displacement which is expressed in its discrete form as
                        
                           (2)
                           
                              
                                 
                                    u
                                 
                                 
                                    j
                                 
                                 
                                    ⁎
                                 
                              
                              ≡
                              
                                 
                                    ϵ
                                 
                                 
                                    ¯
                                 
                              
                              
                                 
                                    y
                                 
                                 
                                    j
                                 
                              
                              
                              j
                              =
                              1
                              …
                              n
                           
                        
                     for the 
                        n
                      nodes of the microstructure RVE. The displacement fluctuation 
                     
                        
                           
                              u
                           
                           
                              ˜
                           
                        
                      is the unknown for every node of the discretised microstructure unit cell.

Henceforth, standard Finite Element matrix notation will be used, where the tensor entities so far used, can be identified now in the form:
                        
                           (3)
                           
                              
                                 
                                    ϵ
                                 
                                 
                                    ¯
                                 
                              
                              ≡
                              {
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ε
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                11
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ε
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                22
                                             
                                          
                                       
                                    
                                    
                                       
                                          2
                                          
                                          
                                          
                                             
                                                
                                                   
                                                      ε
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                12
                                             
                                          
                                       
                                    
                                 
                              
                              }
                              
                              and
                              
                              
                                 
                                    u
                                 
                                 
                                    j
                                 
                              
                              ≡
                              
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                    }
                                 
                                 
                                    j
                                 
                              
                           
                        
                     with 
                        
                           
                              ϵ
                           
                           
                              ¯
                           
                        
                      as matrix representation of macrostrain tensor and 
                        
                           
                              u
                           
                           
                              j
                           
                        
                      is the displacement field at node 
                        j
                      of the discretised unit cell 
                        V
                     . Moreover, the averaged stress field 
                        
                           
                              σ
                           
                           
                              ¯
                           
                        
                      and the force vector 
                        
                           
                              f
                           
                           
                              j
                           
                        
                      associated with the microcell node 
                        j
                     , are also defined in this notation as follows:
                        
                           (4)
                           
                              
                                 
                                    σ
                                 
                                 
                                    ¯
                                 
                              
                              ≡
                              {
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                11
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                22
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                12
                                             
                                          
                                       
                                    
                                 
                              
                              }
                              
                              and
                              
                              
                                 
                                    f
                                 
                                 
                                    j
                                 
                              
                              ≡
                              
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                    }
                                 
                                 
                                    j
                                 
                              
                           
                        
                     
                  

The Taylor displacement 
                     
                        
                           
                              u
                           
                           
                              j
                           
                           
                              ⁎
                           
                        
                      of the node j is computed in the following matrix form:
                        
                           (5)
                           
                              
                                 
                                    u
                                 
                                 
                                    j
                                 
                                 
                                    ⁎
                                 
                              
                              =
                              
                                 
                                    D
                                 
                                 
                                    j
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    ϵ
                                 
                                 
                                    ¯
                                 
                              
                              ,
                              
                              j
                              =
                              1
                              ⋯
                              n
                              .
                           
                        
                     where 
                        
                           
                              D
                           
                           
                              j
                           
                        
                      is the coordinate matrix at node 
                        j
                      of the microstructure is defined as
                        
                           (6)
                           
                              
                                 
                                    D
                                 
                                 
                                    j
                                 
                              
                              ≡
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    [
                                    
                                       
                                          
                                             
                                                2
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                2
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 
                                    j
                                 
                              
                           
                        
                     
                  

A procedure based in a Newton–Raphson scheme is given to find the equilibrium at the microstructure RVE at time step n+1 assuming the system is already in equilibrium at time step n. The general idea consists in taking the microstructure as ‘frozen’ with macroscopic strain 
                        
                           
                              ϵ
                           
                           
                              ¯
                           
                        
                        =
                        constant
                     . Therefore, the variation of the Taylor displacement is zero during the iteration 
                        d
                        
                           
                              u
                           
                           
                              ⁎
                           
                        
                        =
                        0
                     , because it is applied at the beginning of the process.

Before proceeding with description of the scheme, the incremental displacement field 
                        Δ
                        u
                        =
                        
                           
                              u
                           
                           
                              n
                              +
                              1
                           
                        
                        −
                        
                           
                              u
                           
                           
                              n
                           
                        
                      can be additively decomposed thanks to the additive properties of the strain tensor 
                        
                           
                              ϵ
                           
                           
                              ¯
                           
                        
                      as follows:
                        
                           (7)
                           
                              Δ
                              u
                              =
                              Δ
                              
                                 
                                    u
                                 
                                 
                                    ⁎
                                 
                              
                              +
                              Δ
                              
                                 
                                    u
                                 
                                 
                                    ˜
                                 
                              
                              =
                              Δ
                              
                                 
                                    ϵ
                                 
                                 
                                    ¯
                                 
                              
                              y
                              +
                              Δ
                              
                                 
                                    u
                                 
                                 
                                    ˜
                                 
                              
                           
                        
                     where 
                        Δ
                        
                           
                              u
                           
                           
                              ⁎
                           
                        
                      is the incremental Taylor displacement and 
                        Δ
                        
                           
                              u
                           
                           
                              ˜
                           
                        
                      is the incremental displacement fluctuation. The general solution procedure is described as follows:
                        
                           1.
                           The initial incremental displacement guess 
                                 Δ
                                 
                                    
                                       u
                                    
                                    
                                       0
                                    
                                 
                               is given as the incremental Taylor displacement:
                                 
                                    (8)
                                    
                                       Δ
                                       
                                          
                                             u
                                          
                                          
                                             0
                                          
                                       
                                       =
                                       Δ
                                       
                                          
                                             u
                                          
                                          
                                             ⁎
                                          
                                       
                                       =
                                       Δ
                                       
                                          
                                             ϵ
                                          
                                          
                                             ¯
                                          
                                       
                                       y
                                    
                                 
                              In other words, the incremental macrostrain 
                                 Δ
                                 
                                    
                                       ϵ
                                    
                                    
                                       ¯
                                    
                                 
                               is fully prescribed at the first pseudo step, so that, the Taylor displacement is fully prescribed as the initial guess. This means that the initial displacement guess at time step n+1, 
                                 
                                    
                                       u
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                    
                                       0
                                    
                                 
                              , is given by
                                 
                                    (9)
                                    
                                       
                                          
                                             u
                                          
                                          
                                             n
                                             +
                                             1
                                          
                                          
                                             0
                                          
                                       
                                       =
                                       
                                          
                                             u
                                          
                                          
                                             n
                                          
                                       
                                       +
                                       Δ
                                       
                                          
                                             u
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                              Using the split displacement 
                                 u
                                 =
                                 
                                    
                                       u
                                    
                                    
                                       ⁎
                                    
                                 
                                 +
                                 
                                    
                                       u
                                    
                                    
                                       ˜
                                    
                                 
                               at time step n, the initial guess displacement is then expressed as
                                 
                                    (10)
                                    
                                       
                                          
                                             u
                                          
                                          
                                             n
                                             +
                                             1
                                          
                                          
                                             0
                                          
                                       
                                       =
                                       
                                          
                                             u
                                          
                                          
                                             n
                                             +
                                             1
                                          
                                          
                                             ⁎
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             n
                                          
                                       
                                    
                                 
                              In the above it can be observed that the incremental Taylor displacement 
                                 Δ
                                 
                                    
                                       u
                                    
                                    
                                       ⁎
                                    
                                 
                               is prescribed entirely at the beginning of the procedure. Moreover, the initial displacement fluctuation is taken as the converged from the previous time step n. Therefore, 
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       n
                                    
                                 
                               or in another words the incremental fluctuation is zero during the initial guess 
                                 Δ
                                 
                                    
                                       u
                                    
                                    
                                       ˜
                                    
                                 
                                 =
                                 0
                              .

Computation of the internal forces 
                                 
                                    
                                       f
                                    
                                    
                                       int
                                    
                                 
                              . This is computed with the incremental displacement 
                                 Δ
                                 u
                               and the set of state variables 
                                 {
                                 
                                    
                                       E
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       α
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                 
                                 }
                               at microscopic Gauss point level.

Check convergence 
                                 ∥
                                 r
                                 ∥
                                 <
                                 
                                    
                                       ε
                                    
                                    
                                       tolerance
                                    
                                 
                              . This residual force r depends on the boundary constraint applied on the RVE.
                                 
                                    
                                       
                                          •
                                       
                                    
                                    IF 
                                          ∥
                                          r
                                          ∥
                                          <
                                          
                                             
                                                ε
                                             
                                             
                                                tolerance
                                             
                                          
                                       . EQUILIBRIUM. The solution is 
                                          
                                             
                                                u
                                             
                                             
                                                n
                                                +
                                                1
                                             
                                             
                                                k
                                             
                                          
                                       . END OF ITERATION

ELSE GO TO NEXT STEP

Computation of the incremental internal fluctuation. Let us assume that the differential fluctuation is divided in two parts:
                                 
                                    (11)
                                    
                                       δ
                                       
                                          
                                             u
                                          
                                          
                                             ˜
                                          
                                       
                                       =
                                       {
                                       
                                          
                                             
                                                
                                                   δ
                                                   
                                                      
                                                         
                                                            
                                                               u
                                                            
                                                            
                                                               ˜
                                                            
                                                         
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   δ
                                                   
                                                      
                                                         
                                                            
                                                               u
                                                            
                                                            
                                                               ˜
                                                            
                                                         
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       }
                                    
                                 
                              where 
                                 δ
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       r
                                    
                                 
                               are the independent d.o.f. and 
                                 δ
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       d
                                    
                                 
                               are the dependent d.o.f. displacements of the microstructure. Therefore 
                                 δ
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       d
                                    
                                 
                               is known once 
                                 δ
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       r
                                    
                                 
                               is computed. They are different depending on the micro boundary constraint (Linear or Periodic b.c.). The Newton–Raphson iteration is defined by
                                 
                                    (12)
                                    
                                       
                                          
                                             K
                                          
                                          
                                             r
                                          
                                       
                                       δ
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             r
                                          
                                       
                                       =
                                       −
                                       r
                                       
                                       →
                                       
                                       δ
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             r
                                          
                                       
                                       =
                                       −
                                       
                                          
                                             K
                                          
                                          
                                             r
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       r
                                    
                                 
                              where 
                                 r
                               is the residual force and 
                                 
                                    
                                       K
                                    
                                    
                                       r
                                    
                                 
                               is the reduced matrix of the system. In Sections 6.5 and 7.7 particularisations for Linear and Periodic b.c. are given, respectively.

The updating of the incremental fluctuation is 
                                 Δ
                                 
                                    
                                       u
                                    
                                    
                                       ˜
                                    
                                 
                                 
                                 ←
                                 Δ
                                 
                                    
                                       u
                                    
                                    
                                       ˜
                                    
                                 
                                 +
                                 δ
                                 
                                    
                                       u
                                    
                                    
                                       ˜
                                    
                                 
                               and the incremental displacement 
                                 Δ
                                 u
                                 
                                 ←
                                 Δ
                                 u
                                 +
                                 δ
                                 
                                    
                                       u
                                    
                                    
                                       ˜
                                    
                                 
                              
                           

GO TO step 2.

Finally, when the microequilibrium is reached, the macroCauchy stress 
                        
                           
                              
                                 
                                    σ
                                 
                                 
                                    ¯
                                 
                              
                           
                           
                              n
                              +
                              1
                           
                        
                      is computed from the value of the boundary forces. This macrostress is used to compute the internal forces at the macrolevel.

Assuming no body forces in the expression for the average stress, in the discrete setting, 
                           t
                           d
                           A
                           →
                           
                              
                                 f
                              
                              
                                 j
                              
                              
                                 ext
                              
                           
                        , that is the infinitesimal force 
                           t
                           
                           d
                           A
                         becomes the finite force 
                           
                              
                                 f
                              
                              
                                 j
                              
                              
                                 ext
                              
                           
                         at nodal position 
                           
                              
                                 y
                              
                              
                                 j
                              
                           
                         on the boundary 
                           ∂
                           V
                        . Therefore, the average stress degenerates into the discrete sum:
                           
                              (13)
                              
                                 
                                    
                                       σ
                                    
                                    
                                       ¯
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       |
                                       V
                                       |
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             b
                                          
                                       
                                    
                                 
                                 sym
                                 [
                                 
                                    
                                       f
                                    
                                    
                                       j
                                    
                                    
                                       ext
                                    
                                 
                                 ⊗
                                 
                                    
                                       y
                                    
                                    
                                       j
                                    
                                 
                                 ]
                              
                           
                        where 
                           
                              
                                 n
                              
                              
                                 b
                              
                           
                         is the number of nodes on the boundary 
                           ∂
                           V
                        . Using matrix representation this expression becomes
                           
                              (14)
                              
                                 
                                    
                                       σ
                                    
                                    
                                       ¯
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       |
                                       V
                                       |
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             b
                                          
                                       
                                    
                                 
                                 
                                    
                                       D
                                    
                                    
                                       j
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       j
                                    
                                    
                                       ext
                                    
                                 
                              
                           
                        where 
                           
                              
                                 D
                              
                              
                                 j
                              
                           
                         is the coordinate matrix (6) evaluated at node j on the boundary of the discretised microstructure RVE 
                           ∂
                           V
                        . The above expression can be rearranged in the following global expression:
                           
                              (15)
                              
                                 
                                    
                                       σ
                                    
                                    
                                       ¯
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       |
                                       V
                                       |
                                    
                                 
                                 
                                    
                                       D
                                    
                                    
                                       b
                                    
                                 
                                 
                                 
                                    
                                       f
                                    
                                    
                                       b
                                    
                                    
                                       ext
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 f
                              
                              
                                 b
                              
                              
                                 ext
                              
                           
                         is the external nodal force vector of the boundary nodes, and 
                           
                              
                                 D
                              
                              
                                 b
                              
                           
                         is the boundary coordinate matrix defined by 
                           
                              
                                 D
                              
                              
                                 b
                              
                           
                           ≡
                           [
                           
                              
                                 D
                              
                              
                                 1
                              
                              
                                 b
                              
                           
                           
                           
                              
                                 D
                              
                              
                                 2
                              
                              
                                 b
                              
                           
                           
                           …
                           
                           
                              
                                 D
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       b
                                    
                                 
                              
                              
                                 b
                              
                           
                           ]
                        .

In the computational homogenisation approach no explicit form of the constitutive behaviour on the macro-level is assumed a priori, so that the tangent modulus has to be determined numerically by relations between variations of the macroscopic stress and variations of the macroscopic strain at such integration macroGauss point. This can be accomplished by numerical differentiation of the numerical macroscopic stress–strain relation, for instance, by using forward difference approximations as suggested in [27]. Another approach is to condense the microstructural stiffness matrix to the macroscopic matrix tangent modulus. This task is achieved by reducing the total RVE system of equations to the relation between the forces acting on the boundary 
                           ∂
                           V
                         and the displacement on the boundary. The innovative modelling of the anti-symmetry traction vectors at the nodes at the corners leads to a nonconventional condensation, obtaining a novel effective macroscopic tangent modulus. It is a direct condensation to obtain a relation between the variation of the forces acting on the boundary (
                           ∂
                           V
                        ) and the variation of the Taylor displacement on the boundary nodes (
                           d
                           
                              
                                 u
                              
                              
                                 ⁎
                              
                           
                        ), which depends linearly of the macroscopic strain (
                           d
                           
                              
                                 ϵ
                              
                              
                                 ¯
                              
                           
                        ). The total microstructural system of equations that gives the relation between the iterative nodal displacement 
                           d
                           u
                         and iterative nodal external force vectors is
                           
                              (16)
                              
                                 K
                                 
                                 d
                                 u
                                 =
                                 d
                                 
                                    
                                       f
                                    
                                    
                                       ext
                                    
                                 
                                 .
                              
                           
                        With the displacement partition 
                           u
                           =
                           
                              
                                 u
                              
                              
                                 ⁎
                              
                           
                           +
                           
                              
                                 u
                              
                              
                                 ˜
                              
                           
                         the system can be rearranged as follows: 
                           
                              
                                 K
                                 
                                 d
                                 u
                                 =
                                 d
                                 
                                    
                                       f
                                    
                                    
                                       ext
                                    
                                 
                                 ⇒
                                 K
                                 
                                 d
                                 
                                    
                                       u
                                    
                                    
                                       ⁎
                                    
                                 
                                 +
                                 K
                                 
                                 d
                                 
                                    
                                       u
                                    
                                    
                                       ˜
                                    
                                 
                                 =
                                 d
                                 
                                    
                                       f
                                    
                                    
                                       ext
                                    
                                 
                              
                           
                        The boundary constraints are then applied to this system in the following sections to condense the system. This procedure gives the expression that relates the variation boundary external forces 
                           d
                           
                              
                                 f
                              
                              
                                 b
                              
                              
                                 ext
                              
                           
                         against the variation of the Taylor displacement 
                           d
                           
                              
                                 u
                              
                              
                                 ⁎
                              
                           
                        .

Finally, the overall tangent modulus 
                           
                              
                                 C
                              
                              
                                 ¯
                              
                           
                         can be computed in its discretised F.E. matrix form, using previous averaged stress expression (15), in the following way:
                           
                              (17)
                              
                                 
                                    
                                       C
                                    
                                    
                                       ¯
                                    
                                 
                                 =
                                 
                                    
                                       d
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       d
                                       
                                          
                                             ϵ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       |
                                       V
                                       |
                                    
                                 
                                 
                                    
                                       D
                                    
                                    
                                       b
                                    
                                 
                                 
                                    
                                       d
                                       
                                          
                                             f
                                          
                                          
                                             b
                                          
                                          
                                             ext
                                          
                                       
                                    
                                    
                                       d
                                       
                                          
                                             ϵ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Particularisations of the computation of average macrostress and overall tangent modulus are given for Taylor assumption, Linear b.c. and Periodic b.c. below.

In view of the discrete formulation of the boundary conditions outlined, the nodes of the mesh are partitioned into those on the surface 
                        ∂
                        V
                      of RVE and those in the interior of 
                        V
                     , see Fig. 2
                     . In this mesh 
                        
                           
                              n
                           
                           
                              b
                           
                        
                      boundary nodes and 
                        
                           
                              n
                           
                           
                              i
                           
                        
                      internal nodes are distinguished.

Partitioning of the current nodal displacements and nodal forces is given as
                           
                              (18)
                              
                                 u
                                 =
                                 {
                                 
                                    
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   b
                                                
                                             
                                          
                                       
                                    
                                 
                                 }
                                 ≡
                                 {
                                 
                                    
                                       
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   i
                                                
                                             
                                             u
                                          
                                       
                                       
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   b
                                                
                                             
                                             u
                                          
                                       
                                    
                                 
                                 }
                                 
                                 and
                                 
                                 f
                                 =
                                 {
                                 
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   b
                                                
                                             
                                          
                                       
                                    
                                 
                                 }
                                 ≡
                                 {
                                 
                                    
                                       
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   i
                                                
                                             
                                             
                                             f
                                          
                                       
                                       
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   b
                                                
                                             
                                             
                                             f
                                          
                                       
                                    
                                 
                                 }
                              
                           
                        
                     

Here 
                           
                              
                                 L
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 L
                              
                              
                                 b
                              
                           
                         are the connectivity matrices, which define the interior contribution and the contributions of the boundary nodes, respectively. These are Boolean matrices, i.e. they consist of integers 0 and 1. Displacements 
                           
                              
                                 u
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 u
                              
                              
                                 b
                              
                           
                         are gathered from 
                           u
                        . Using these two vectors, a new 
                           u
                         is obtained as shown in (18).

In line with (18), the tangent stiffness matrix is rearranged as
                           
                              (19)
                              
                                 K
                                 =
                                 
                                    
                                       d
                                       
                                          
                                             f
                                          
                                          
                                             int
                                          
                                       
                                    
                                    
                                       d
                                       u
                                    
                                 
                                 =
                                 [
                                 
                                    
                                       
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   ii
                                                
                                             
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   ib
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   bi
                                                
                                             
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   bb
                                                
                                             
                                          
                                       
                                    
                                 
                                 ]
                                 ≡
                                 [
                                 
                                    
                                       
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   i
                                                
                                             
                                             K
                                             
                                                
                                                   L
                                                
                                                
                                                   i
                                                
                                                
                                                   T
                                                
                                             
                                          
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   i
                                                
                                             
                                             K
                                             
                                                
                                                   L
                                                
                                                
                                                   b
                                                
                                                
                                                   T
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   b
                                                
                                             
                                             K
                                             
                                                
                                                   L
                                                
                                                
                                                   i
                                                
                                                
                                                   T
                                                
                                             
                                          
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   b
                                                
                                             
                                             K
                                             
                                                
                                                   L
                                                
                                                
                                                   b
                                                
                                                
                                                   T
                                                
                                             
                                          
                                       
                                    
                                 
                                 ]
                              
                           
                        comprising contributions associated with internal nodes and nodes on the surface of the RVE.

At each node 
                           j
                         of the boundary 
                           ∂
                           V
                         condition induces the discrete constraint, 
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 j
                              
                           
                           =
                           0
                           
                           j
                           =
                           1
                           …
                           
                           
                              
                                 n
                              
                              
                                 b
                              
                           
                        . These constraints can be represented as a global boundary displacement vector 
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 b
                              
                           
                           =
                           0
                        . Following matrix notation, the global coordinate matrix is defined as follows:
                           
                              (20)
                              
                                 
                                    
                                       D
                                    
                                    
                                       global
                                       ,
                                       l
                                    
                                 
                                 
                                 ≡
                                 [
                                 
                                    
                                       D
                                    
                                    
                                       i
                                    
                                 
                                 
                                 
                                    
                                       D
                                    
                                    
                                       b
                                       ,
                                       l
                                    
                                 
                                 ]
                              
                           
                        where 
                           
                              
                                 D
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 D
                              
                              
                                 b
                                 ,
                                 l
                              
                           
                         are the interior coordinate matrix and the boundary coordinate matrix, respectively, given as
                           
                              (21)
                              
                                 
                                    
                                       D
                                    
                                    
                                       i
                                    
                                 
                                 ≡
                                 [
                                 
                                    
                                       D
                                    
                                    
                                       1
                                    
                                    
                                       i
                                    
                                 
                                 
                                 
                                    
                                       D
                                    
                                    
                                       2
                                    
                                    
                                       i
                                    
                                 
                                 
                                 …
                                 
                                 
                                    
                                       D
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 ]
                                 
                                 and
                                 
                                 
                                    
                                       D
                                    
                                    
                                       b
                                       ,
                                       l
                                    
                                 
                                 ≡
                                 [
                                 
                                    
                                       D
                                    
                                    
                                       1
                                    
                                    
                                       b
                                    
                                 
                                 
                                 
                                    
                                       D
                                    
                                    
                                       2
                                    
                                    
                                       b
                                    
                                 
                                 
                                 …
                                 
                                 
                                    
                                       D
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             b
                                          
                                       
                                    
                                    
                                       b
                                    
                                 
                                 ]
                                 .
                              
                           
                        
                     

The matrices 
                           
                              
                                 D
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 D
                              
                              
                                 b
                                 ,
                                 l
                              
                           
                         are defined in terms of node coordinate matrices (6) for the interior and boundary nodes, respectively. The Taylor displacement 
                           
                              
                                 u
                              
                              
                                 ⁎
                              
                           
                         previously defined in 
                           
                              
                                 u
                              
                              
                                 ⁎
                              
                           
                           =
                           
                           
                              
                                 D
                              
                              
                                 global
                              
                              
                                 T
                              
                           
                           
                           
                              
                                 ϵ
                              
                              
                                 ¯
                              
                           
                         for the Taylor assumption, is now represented 
                           
                              
                                 u
                              
                              
                                 ⁎
                              
                           
                           =
                           
                              
                                 D
                              
                              
                                 global
                                 ,
                                 l
                              
                              
                                 T
                              
                           
                           
                              
                                 ϵ
                              
                              
                                 ¯
                              
                           
                         where 
                           
                              
                                 D
                              
                              
                                 global
                                 ,
                                 l
                              
                           
                         is the global coordinate matrix (20) and 
                           
                              
                                 ϵ
                              
                              
                                 ¯
                              
                           
                         is the matrix representation of the prescribed macroscopic strain (3). In this model the variation of the Taylor displacement vector 
                           d
                           
                              
                                 u
                              
                              
                                 ⁎
                              
                           
                         is represented as
                           
                              (22)
                              
                                 d
                                 
                                    
                                       u
                                    
                                    
                                       ⁎
                                    
                                 
                                 =
                                 
                                    
                                       D
                                    
                                    
                                       global
                                       ,
                                       l
                                    
                                    
                                       T
                                    
                                 
                                 d
                                 
                                    
                                       ϵ
                                    
                                    
                                       ¯
                                    
                                 
                              
                           
                        that is, as a function of the variation of the macroscopic average strain vector 
                           d
                           
                              
                                 ϵ
                              
                              
                                 ¯
                              
                           
                        .

For this model the average stress is computed based on the matrix expression for the average stress (15). Making use of the boundary coordinate matrix 
                           
                              
                                 D
                              
                              
                                 b
                                 ,
                                 l
                              
                           
                         defined in (21) it can be rearranged in the following global expression:
                           
                              (23)
                              
                                 
                                    
                                       σ
                                    
                                    
                                       ¯
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       |
                                       V
                                       |
                                    
                                 
                                 
                                    
                                       D
                                    
                                    
                                       b
                                       ,
                                       l
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       b
                                    
                                    
                                       ext
                                    
                                 
                              
                           
                        where 
                           
                              
                                 f
                              
                              
                                 b
                              
                              
                                 ext
                              
                           
                         is the external nodal force vector of the boundary nodes defined in the partition (18).

Using partitioning of the algebraic equations (18) and 19, the system (16) can be rewritten as
                           
                              (24)
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   ii
                                                
                                             
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   ib
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   bi
                                                
                                             
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   bb
                                                
                                             
                                          
                                       
                                    
                                 
                                 ]
                                 {
                                 
                                    
                                       
                                          
                                             d
                                             
                                                
                                                   u
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          
                                             d
                                             
                                                
                                                   u
                                                
                                                
                                                   b
                                                
                                             
                                          
                                       
                                    
                                 
                                 }
                                 =
                                 {
                                 
                                    
                                       
                                          
                                             d
                                             
                                                
                                                   f
                                                
                                                
                                                   i
                                                
                                                
                                                   ext
                                                
                                             
                                          
                                       
                                       
                                          
                                             d
                                             
                                                
                                                   f
                                                
                                                
                                                   b
                                                
                                                
                                                   ext
                                                
                                             
                                          
                                       
                                    
                                 
                                 }
                                 ≡
                                 K
                                 d
                                 u
                                 =
                                 d
                                 
                                    
                                       f
                                    
                                    
                                       ext
                                    
                                 
                              
                           
                        for the case when 
                           d
                           
                              
                                 f
                              
                              
                                 i
                              
                              
                                 ext
                              
                           
                           =
                           0
                        . The general procedure Section 5.2 is leading to the system (24) which is rearranged as
                           
                              (25)
                              
                                 ⇒
                                 K
                                 
                                 d
                                 
                                    
                                       u
                                    
                                    
                                       ˜
                                    
                                 
                                 =
                                 d
                                 
                                    
                                       f
                                    
                                    
                                       ext
                                    
                                 
                                 −
                                 K
                                 
                                 d
                                 
                                    
                                       u
                                    
                                    
                                       ⁎
                                    
                                 
                              
                           
                        where Taylor displacement variation 
                           d
                           
                              
                                 u
                              
                              
                                 ⁎
                              
                           
                         is given by (22) for the linear model. By introducing linear displacement constraint in discrete form 
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 b
                              
                           
                           =
                           0
                         into system (25), internal nodal displacement fluctuation vector can be computed as
                           
                              (26)
                              
                                 d
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 −
                                 
                                    
                                       k
                                    
                                    
                                       ii
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                 
                                    
                                       K
                                    
                                    
                                       I
                                    
                                 
                                 
                                 d
                                 
                                    
                                       u
                                    
                                    
                                       ⁎
                                    
                                 
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       K
                                    
                                    
                                       I
                                    
                                 
                                 ≡
                                 [
                                 
                                    
                                       k
                                    
                                    
                                       ii
                                    
                                 
                                 
                                 
                                    
                                       k
                                    
                                    
                                       ib
                                    
                                 
                                 ]
                                 .
                              
                           
                        
                     

From the system (25), the variation of external boundary force vector is calculated
                           
                              (27)
                              
                                 d
                                 
                                    
                                       f
                                    
                                    
                                       b
                                    
                                    
                                       ext
                                    
                                 
                                 =
                                 
                                    
                                       k
                                    
                                    
                                       bi
                                    
                                 
                                 
                                 d
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 
                                 +
                                 
                                 
                                    
                                       K
                                    
                                    
                                       B
                                    
                                 
                                 
                                 d
                                 
                                    
                                       u
                                    
                                    
                                       ⁎
                                    
                                 
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       K
                                    
                                    
                                       B
                                    
                                 
                                 ≡
                                 [
                                 
                                    
                                       k
                                    
                                    
                                       bi
                                    
                                 
                                 
                                 
                                    
                                       k
                                    
                                    
                                       bb
                                    
                                 
                                 ]
                                 .
                              
                           
                        
                     

Inserting (26) into (27), the 
                           d
                           
                              
                                 f
                              
                              
                                 b
                              
                              
                                 ext
                              
                           
                         vector is obtained
                           
                              (28)
                              
                                 d
                                 
                                    
                                       f
                                    
                                    
                                       b
                                    
                                    
                                       ext
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       K
                                    
                                    
                                       B
                                    
                                 
                                 −
                                 
                                    
                                       k
                                    
                                    
                                       bi
                                    
                                 
                                 
                                 
                                    
                                       k
                                    
                                    
                                       ii
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                 
                                    
                                       K
                                    
                                    
                                       I
                                    
                                 
                                 )
                                 
                                 d
                                 
                                    
                                       u
                                    
                                    
                                       ⁎
                                    
                                 
                              
                           
                        in terms of the variation of the Taylor displacement 
                           d
                           
                              
                                 u
                              
                              
                                 ⁎
                              
                           
                        . Compacting the right hand side of (28), the variation of the external boundary force vector is expressed as
                           
                              (29)
                              
                                 d
                                 
                                    
                                       f
                                    
                                    
                                       b
                                    
                                    
                                       ext
                                    
                                 
                                 =
                                 
                                    
                                       K
                                    
                                    
                                       lin
                                    
                                    
                                       B
                                    
                                 
                                 
                                 d
                                 
                                    
                                       u
                                    
                                    
                                       ⁎
                                    
                                 
                              
                           
                        where the condensed linear stiffness matrix 
                        
                           
                              
                                 K
                              
                              
                                 lin
                              
                              
                                 B
                              
                           
                         is defined as follows:
                           
                              (30)
                              
                                 
                                    
                                       K
                                    
                                    
                                       lin
                                    
                                    
                                       B
                                    
                                 
                                 ≡
                                 
                                    
                                       K
                                    
                                    
                                       B
                                    
                                 
                                 −
                                 
                                    
                                       k
                                    
                                    
                                       bi
                                    
                                 
                                 
                                 
                                    
                                       k
                                    
                                    
                                       ii
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                 
                                    
                                       K
                                    
                                    
                                       I
                                    
                                 
                                 .
                              
                           
                        
                     

Finally, insertion of the variation of the Taylor displacement (22) for the linear model, into (29) identifies the boundary force vector:
                           
                              (31)
                              
                                 d
                                 
                                    
                                       f
                                    
                                    
                                       b
                                    
                                    
                                       ext
                                    
                                 
                                 =
                                 
                                    
                                       K
                                    
                                    
                                       lin
                                    
                                    
                                       B
                                    
                                 
                                 
                                 
                                    
                                       D
                                    
                                    
                                       global
                                       ,
                                       l
                                    
                                    
                                       T
                                    
                                 
                                 
                                 d
                                 
                                    
                                       ϵ
                                    
                                    
                                       ¯
                                    
                                 
                              
                           
                        
                        
                           
                              (32)
                              
                                 
                                    
                                       d
                                       
                                          
                                             f
                                          
                                          
                                             b
                                          
                                          
                                             ext
                                          
                                       
                                    
                                    
                                       d
                                       
                                          
                                             ϵ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       K
                                    
                                    
                                       lin
                                    
                                    
                                       B
                                    
                                 
                                 
                                 
                                    
                                       D
                                    
                                    
                                       global
                                       ,
                                       l
                                    
                                    
                                       T
                                    
                                 
                              
                           
                        which expresses the variation of the external boundary force vector 
                           d
                           
                              
                                 f
                              
                              
                                 b
                              
                              
                                 ext
                              
                           
                         with respect to the variation of macroscopic strain 
                           d
                           
                              
                                 ϵ
                              
                              
                                 ¯
                              
                           
                        .

The overall tangent modulus 
                           
                              
                                 
                                    
                                       C
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 l
                              
                           
                         for linear b.c., can be computed in its discretised F.E. matrix form following the general expression given in (17) as
                           
                              (33)
                              
                                 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       l
                                    
                                 
                                 =
                                 
                                    
                                       d
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       d
                                       
                                          
                                             ϵ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       |
                                       V
                                       |
                                    
                                 
                                 
                                 
                                    
                                       D
                                    
                                    
                                       b
                                       ,
                                       l
                                    
                                 
                                 
                                 
                                    
                                       d
                                       
                                          
                                             f
                                          
                                          
                                             b
                                          
                                          
                                             ext
                                          
                                       
                                    
                                    
                                       d
                                       
                                          
                                             ϵ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

Substituting (32) into (33), the overall tangent modulus representation 
                           
                              
                                 
                                    
                                       C
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 l
                              
                           
                         is obtained
                           
                              (34)
                              
                                 
                                    
                                       
                                          
                                             
                                                C
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          l
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          |
                                          V
                                          |
                                       
                                    
                                    
                                    
                                       
                                          D
                                       
                                       
                                          b
                                          ,
                                          l
                                       
                                    
                                    
                                    
                                       
                                          K
                                       
                                       
                                          lin
                                       
                                       
                                          B
                                       
                                    
                                    
                                    
                                       
                                          D
                                       
                                       
                                          global
                                          ,
                                          l
                                       
                                       
                                          T
                                       
                                    
                                 
                              
                           
                        
                     

Clearly, the overall tangent modulus 
                           
                              
                                 
                                    
                                       C
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 l
                              
                           
                         is given as a function of the boundary coordinate matrix 
                           
                              
                                 D
                              
                              
                                 b
                                 ,
                                 l
                              
                           
                         defined in (21), the condensed linear stiffness matrix 
                           
                              
                                 K
                              
                              
                                 lin
                              
                              
                                 B
                              
                           
                         
                        (30) and the global coordinate matrix 
                           
                              
                                 D
                              
                              
                                 global
                                 ,
                                 l
                              
                              
                                 T
                              
                           
                         outlined in (20).

Note that by using (34) the overall tangent modulus can be computed for heterogeneous material with different microstructures. When using this overall tangent modulus the quadratic rate of convergence is attained at macroscopic level.

In Section 4 a general solution scheme for microequilibrium was given. In this section, the particularisation of the microequilibrium procedure for linear b.c. is given.

The incremental Taylor displacement is given in matrix form as
                           
                              (35)
                              
                                 Δ
                                 
                                    
                                       u
                                    
                                    
                                       ⁎
                                    
                                 
                                 =
                                 
                                    
                                       D
                                    
                                    
                                       global
                                       ,
                                       l
                                    
                                    
                                       T
                                    
                                 
                                 Δ
                                 
                                    
                                       ϵ
                                    
                                    
                                       ¯
                                    
                                 
                                 .
                              
                           
                        
                     

The residual force 
                           r
                         is taken as the difference between the internal and external force vectors for the interior nodes as 
                           r
                           =
                           
                              
                                 f
                              
                              
                                 i
                              
                              
                                 int
                              
                           
                           −
                           
                              
                                 f
                              
                              
                                 i
                              
                              
                                 ext
                              
                           
                        . Assuming that in equilibrium 
                           
                              
                                 f
                              
                              
                                 i
                              
                              
                                 ext
                              
                           
                           =
                           0
                         actual residual used for linear b.c. 
                           r
                           =
                           
                              
                                 f
                              
                              
                                 i
                              
                              
                                 int
                              
                           
                        . Therefore, the differential fluctuation is given by the system (12) which now is taking the following form:
                           
                              (36)
                              
                                 
                                    
                                       K
                                    
                                    
                                       ii
                                    
                                 
                                 
                                 δ
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 −
                                 
                                    
                                       f
                                    
                                    
                                       i
                                    
                                    
                                       int
                                    
                                 
                                 →
                                 δ
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 −
                                 
                                    
                                       K
                                    
                                    
                                       ii
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                 
                                    
                                       f
                                    
                                    
                                       i
                                    
                                    
                                       int
                                    
                                 
                              
                           
                        and 
                           δ
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 b
                              
                           
                           =
                           0
                        . The updated incremental fluctuation is then given by
                           
                              (37)
                              
                                 Δ
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 ←
                                 Δ
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 δ
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        and 
                           Δ
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 b
                              
                           
                           =
                           0
                        . The incremental displacement used to compute the internal force is updated by
                           
                              (38)
                              
                                 Δ
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 ←
                                 Δ
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 δ
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        and 
                           Δ
                           
                              
                                 u
                              
                              
                                 b
                              
                           
                         does not change.

In order to discretise the continuum model of the periodic boundary conditions, the nodes of the mesh are partitioned in four groups outlined in Fig. 3
                     :
                        
                           1.
                           
                              
                                 
                                    
                                       n
                                    
                                    
                                       i
                                    
                                 
                               interior nodes are distinguished.


                              
                                 
                                    
                                       n
                                    
                                    
                                       p
                                    
                                 
                               positive boundary nodes which are located at the top and right side of the microstructure surface 
                                 ∂
                                 V
                               of RVE.


                              
                                 
                                    
                                       n
                                    
                                    
                                       p
                                    
                                 
                               negative boundary nodes which are located at the bottom and left side of the microstructure surface 
                                 ∂
                                 V
                               of RVE.


                              
                                 
                                    
                                       n
                                    
                                    
                                       c
                                    
                                 
                               node at the corners.

The number of node pairs (positive and corresponding negative nodes) on the boundary 
                        ∂
                        V
                      of RVE are
                        
                           (39)
                           
                              
                                 
                                    n
                                 
                                 
                                    p
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          n
                                       
                                       
                                          b
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              −
                              2
                           
                        
                     where 
                        
                           
                              n
                           
                           
                              b
                           
                        
                      is the total number of nodes on the boundary of RVE. Also, the number of corner nodes in a 2D rectangular microstructure is four, i.e.
                        
                           (40)
                           
                              
                                 
                                    n
                                 
                                 
                                    c
                                 
                              
                              =
                              4
                              .
                           
                        
                     
                  

In this case, the partition of the nodal displacements and forces is as follows:
                           
                              (41)
                              
                                 u
                                 =
                                 {
                                 
                                    
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   p
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   n
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   c
                                                
                                             
                                          
                                       
                                    
                                 
                                 }
                                 ≡
                                 {
                                 
                                    
                                       
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   i
                                                
                                             
                                             
                                             u
                                          
                                       
                                       
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   p
                                                
                                             
                                             
                                             u
                                          
                                       
                                       
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   n
                                                
                                             
                                             
                                             u
                                          
                                       
                                       
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   c
                                                
                                             
                                             
                                             u
                                          
                                       
                                    
                                 
                                 }
                                 
                                 and
                                 
                                 f
                                 =
                                 {
                                 
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   p
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   n
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   c
                                                
                                             
                                          
                                       
                                    
                                 
                                 }
                                 ≡
                                 {
                                 
                                    
                                       
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   i
                                                
                                             
                                             
                                             f
                                          
                                       
                                       
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   p
                                                
                                             
                                             
                                             f
                                          
                                       
                                       
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   n
                                                
                                             
                                             
                                             f
                                          
                                       
                                       
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   c
                                                
                                             
                                             
                                             f
                                          
                                       
                                    
                                 
                                 }
                              
                           
                        
                     

Here 
                           
                              
                                 L
                              
                              
                                 i
                              
                           
                        , 
                           
                              
                                 L
                              
                              
                                 p
                              
                           
                        , 
                           
                              
                                 L
                              
                              
                                 n
                              
                           
                         and 
                           
                              
                                 L
                              
                              
                                 c
                              
                           
                         are the connectivity matrices which define respectively: (i) the interior contribution, (ii) the contribution of positive boundary nodes, (iii) the contributions from the corresponding negative boundary nodes, and finally (iv) the contribution from the nodes at the corners. In correspondence to (41), the tangent stiffness matrix is partitioned in the following way:
                           
                              (42)
                              
                                 K
                                 =
                                 
                                    
                                       d
                                       
                                          
                                             f
                                          
                                          
                                             int
                                          
                                       
                                    
                                    
                                       d
                                       u
                                    
                                 
                                 =
                                 [
                                 
                                    
                                       
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   ii
                                                
                                             
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   ip
                                                
                                             
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   in
                                                
                                             
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   ic
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   pi
                                                
                                             
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   pp
                                                
                                             
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   pn
                                                
                                             
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   pc
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   ni
                                                
                                             
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   np
                                                
                                             
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   nn
                                                
                                             
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   nc
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   ci
                                                
                                             
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   cp
                                                
                                             
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   cn
                                                
                                             
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   cc
                                                
                                             
                                          
                                       
                                    
                                 
                                 ]
                                 ≡
                                 [
                                 
                                    
                                       
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   i
                                                
                                             
                                             
                                             K
                                             
                                             
                                                
                                                   L
                                                
                                                
                                                   i
                                                
                                                
                                                   T
                                                
                                             
                                          
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   i
                                                
                                             
                                             
                                             K
                                             
                                             
                                                
                                                   L
                                                
                                                
                                                   p
                                                
                                                
                                                   T
                                                
                                             
                                          
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   i
                                                
                                             
                                             
                                             K
                                             
                                             
                                                
                                                   L
                                                
                                                
                                                   n
                                                
                                                
                                                   T
                                                
                                             
                                          
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   i
                                                
                                             
                                             
                                             K
                                             
                                             
                                                
                                                   L
                                                
                                                
                                                   c
                                                
                                                
                                                   T
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   p
                                                
                                             
                                             
                                             K
                                             
                                             
                                                
                                                   L
                                                
                                                
                                                   i
                                                
                                                
                                                   T
                                                
                                             
                                          
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   p
                                                
                                             
                                             
                                             K
                                             
                                             
                                                
                                                   L
                                                
                                                
                                                   p
                                                
                                                
                                                   T
                                                
                                             
                                          
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   p
                                                
                                             
                                             
                                             K
                                             
                                             
                                                
                                                   L
                                                
                                                
                                                   n
                                                
                                                
                                                   T
                                                
                                             
                                          
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   p
                                                
                                             
                                             
                                             K
                                             
                                             
                                                
                                                   L
                                                
                                                
                                                   c
                                                
                                                
                                                   T
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   n
                                                
                                             
                                             
                                             K
                                             
                                             
                                                
                                                   L
                                                
                                                
                                                   i
                                                
                                                
                                                   T
                                                
                                             
                                          
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   n
                                                
                                             
                                             
                                             K
                                             
                                             
                                                
                                                   L
                                                
                                                
                                                   p
                                                
                                                
                                                   T
                                                
                                             
                                          
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   n
                                                
                                             
                                             
                                             K
                                             
                                             
                                                
                                                   L
                                                
                                                
                                                   n
                                                
                                                
                                                   T
                                                
                                             
                                          
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   n
                                                
                                             
                                             
                                             K
                                             
                                             
                                                
                                                   L
                                                
                                                
                                                   c
                                                
                                                
                                                   T
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   c
                                                
                                             
                                             
                                             K
                                             
                                             
                                                
                                                   L
                                                
                                                
                                                   i
                                                
                                                
                                                   T
                                                
                                             
                                          
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   c
                                                
                                             
                                             
                                             K
                                             
                                             
                                                
                                                   L
                                                
                                                
                                                   p
                                                
                                                
                                                   T
                                                
                                             
                                          
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   c
                                                
                                             
                                             
                                             K
                                             
                                             
                                                
                                                   L
                                                
                                                
                                                   n
                                                
                                                
                                                   T
                                                
                                             
                                          
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   c
                                                
                                             
                                             
                                             K
                                             
                                             
                                                
                                                   L
                                                
                                                
                                                   c
                                                
                                                
                                                   T
                                                
                                             
                                          
                                       
                                    
                                 
                                 ]
                              
                           
                        
                     

At each node pair 
                           j
                         on the boundary 
                           ∂
                           
                              
                                 V
                              
                              
                                 +
                              
                           
                           ∪
                           ∂
                           
                              
                                 V
                              
                              
                                 −
                              
                           
                        , the continuum condition induces the discrete constraint:
                           
                              (43)
                              
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       j
                                    
                                    
                                       +
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       j
                                    
                                    
                                       −
                                    
                                 
                                 ,
                                 
                                 j
                                 =
                                 1
                                 
                                 ⋯
                                 
                                 
                                    
                                       n
                                    
                                    
                                       p
                                    
                                 
                              
                           
                        
                     

The link between constraints for each pair of nodes can be compactly represented in a global form as
                           
                              (44)
                              
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       p
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       n
                                    
                                 
                              
                           
                        
                     

The displacement fluctuation at the corners is prescribed to zero to avoid the rigid body motion:
                           
                              (45)
                              
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       c
                                       i
                                    
                                 
                                 =
                                 0
                                 ,
                                 
                                 i
                                 =
                                 1
                                 
                                 ⋯
                                 
                                 
                                    
                                       n
                                    
                                    
                                       c
                                    
                                 
                              
                           
                        
                     

It can easily be proved that (45) agrees with the periodic continuum condition. The relation (45) can be represented in a global form:
                           
                              (46)
                              
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       c
                                    
                                 
                                 =
                                 0
                              
                           
                        At each node pair 
                           j
                         on the boundary 
                           ∂
                           
                              
                                 V
                              
                              
                                 +
                              
                           
                           ∪
                           ∂
                           
                              
                                 V
                              
                              
                                 −
                              
                           
                        , the continuum antiperiodic traction condition is defined by means of discretisation as
                           
                              (47)
                              
                                 f
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       j
                                    
                                    
                                       +
                                    
                                 
                                 )
                                 =
                                 −
                                 f
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       j
                                    
                                    
                                       −
                                    
                                 
                                 )
                                 ,
                                 
                                 
                                    
                                       f
                                    
                                    
                                       j
                                    
                                    
                                       +
                                    
                                 
                                 =
                                 −
                                 
                                    
                                       f
                                    
                                    
                                       j
                                    
                                    
                                       −
                                    
                                 
                                 ,
                                 
                                 j
                                 =
                                 1
                                 
                                 ⋯
                                 
                                 
                                    
                                       n
                                    
                                    
                                       p
                                    
                                 
                              
                           
                        Again these constraints can be represented in compressed form as
                           
                              (48)
                              
                                 
                                    
                                       f
                                    
                                    
                                       p
                                    
                                    
                                       ext
                                    
                                 
                                 =
                                 −
                                 
                                    
                                       f
                                    
                                    
                                       n
                                    
                                    
                                       ext
                                    
                                 
                              
                           
                        
                     

A very important additional equation to take into consideration is equilibrium condition, i.e.
                           
                              (49)
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       4
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       ci
                                    
                                    
                                       ext
                                    
                                 
                                 =
                                 0
                              
                           
                        This vectorial equation agrees with the continuum antiperiodic traction condition, although, this is not obvious. The underlying idea relies on the antiperiodicity of force in the corners that come from the different continuum distributions.

Using the matrix notation introduced in Section 3, the global coordinate matrix for periodic b.c. is re-defined as
                           
                              (50)
                              
                                 
                                    
                                       D
                                    
                                    
                                       global
                                       ,
                                       p
                                    
                                 
                                 ≡
                                 [
                                 
                                    
                                       D
                                    
                                    
                                       i
                                    
                                 
                                 
                                 
                                    
                                       D
                                    
                                    
                                       b
                                       ,
                                       p
                                    
                                 
                                 ]
                              
                           
                        where 
                           
                              
                                 D
                              
                              
                                 i
                              
                           
                         is the interior coordinate matrix defined in (21) and the 
                           
                              
                                 D
                              
                              
                                 b
                                 ,
                                 p
                              
                           
                         is the boundary coordinate matrix for Periodic b.c. defined as
                           
                              (51)
                              
                                 
                                    
                                       D
                                    
                                    
                                       b
                                       ,
                                       p
                                    
                                 
                                 =
                                 [
                                 
                                    
                                       D
                                    
                                    
                                       p
                                    
                                 
                                 
                                 
                                    
                                       D
                                    
                                    
                                       n
                                    
                                 
                                 
                                 
                                    
                                       D
                                    
                                    
                                       c
                                    
                                 
                                 ]
                              
                           
                        where 
                           
                              
                                 D
                              
                              
                                 p
                              
                           
                           ≡
                           [
                           
                              
                                 D
                              
                              
                                 1
                              
                              
                                 p
                              
                           
                           
                           
                              
                                 D
                              
                              
                                 2
                              
                              
                                 p
                              
                           
                           
                           …
                           
                           
                              
                                 D
                              
                              
                                 np
                              
                              
                                 p
                              
                           
                           ]
                        , 
                           
                              
                                 D
                              
                              
                                 n
                              
                           
                           ≡
                           [
                           
                              
                                 D
                              
                              
                                 1
                              
                              
                                 n
                              
                           
                           
                           
                              
                                 D
                              
                              
                                 2
                              
                              
                                 n
                              
                           
                           
                           …
                           
                           
                              
                                 D
                              
                              
                                 np
                              
                              
                                 n
                              
                           
                           ]
                         and 
                           
                              
                                 D
                              
                              
                                 c
                              
                           
                           ≡
                           [
                           
                              
                                 D
                              
                              
                                 1
                              
                              
                                 c
                              
                           
                           
                           
                              
                                 D
                              
                              
                                 2
                              
                              
                                 c
                              
                           
                           
                           
                              
                                 D
                              
                              
                                 3
                              
                              
                                 c
                              
                           
                           
                           
                              
                                 D
                              
                              
                                 4
                              
                              
                                 c
                              
                           
                           ]
                         are the positive boundary coordinate matrix, negative boundary coordinate matrix and corner coordinate matrix, respectively.

Then, the Taylor displacement and its variation are given by
                           
                              (52)
                              
                                 
                                    
                                       u
                                    
                                    
                                       ⁎
                                    
                                 
                                 =
                                 
                                    
                                       D
                                    
                                    
                                       global
                                       ,
                                       p
                                    
                                    
                                       T
                                    
                                 
                                 
                                 
                                    
                                       ϵ
                                    
                                    
                                       ¯
                                    
                                 
                              
                           
                        
                        
                           
                              (53)
                              
                                 d
                                 
                                    
                                       u
                                    
                                    
                                       ⁎
                                    
                                 
                                 =
                                 
                                    
                                       D
                                    
                                    
                                       global
                                       ,
                                       p
                                    
                                    
                                       T
                                    
                                 
                                 
                                 d
                                 
                                    
                                       ϵ
                                    
                                    
                                       ¯
                                    
                                 
                                 ,
                              
                           
                        
                     

Following the general procedure to compute average stress given in Section 5.1, the average stress is computed, based on the matrix expression for the average stress (14), as follows:
                           
                              (54)
                              
                                 
                                    
                                       σ
                                    
                                    
                                       ¯
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       |
                                       V
                                       |
                                    
                                 
                                 [
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                p
                                             
                                          
                                       
                                    
                                    (
                                    
                                       
                                          D
                                       
                                       
                                          j
                                       
                                       
                                          +
                                       
                                    
                                    −
                                    
                                       
                                          D
                                       
                                       
                                          j
                                       
                                       
                                          −
                                       
                                    
                                    )
                                    
                                       
                                          f
                                       
                                       
                                          j
                                       
                                       
                                          +
                                          ext
                                       
                                    
                                    +
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          4
                                       
                                    
                                    
                                       
                                          D
                                       
                                       
                                          c
                                          i
                                       
                                    
                                    
                                    
                                       
                                          f
                                       
                                       
                                          c
                                          i
                                       
                                       
                                          ext
                                       
                                    
                                 
                                 ]
                              
                           
                        By using the boundary coordinate matrix 
                           
                              
                                 D
                              
                              
                                 b
                                 ,
                                 p
                              
                           
                         defined in (51), the expression for the average stress (54) is rearranged in a global expression given by
                           
                              (55)
                              
                                 
                                    
                                       σ
                                    
                                    
                                       ¯
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       |
                                       V
                                       |
                                    
                                 
                                 
                                 
                                    
                                       D
                                    
                                    
                                       b
                                       ,
                                       p
                                    
                                 
                                 
                                 
                                    
                                       f
                                    
                                    
                                       b
                                    
                                    
                                       ext
                                    
                                 
                              
                           
                        where global matrix notation has been used to gain the compact form (55). Note that 
                           
                              
                                 f
                              
                              
                                 b
                              
                              
                                 ext
                              
                           
                         is the external boundary force vector which is obtained by gathering operation of the external force vector to extract the positive 
                           
                              
                                 f
                              
                              
                                 p
                              
                              
                                 ext
                              
                           
                        , negative 
                           
                              
                                 f
                              
                              
                                 n
                              
                              
                                 ext
                              
                           
                         and corner 
                           
                              
                                 f
                              
                              
                                 c
                              
                              
                                 ext
                              
                           
                         counterpart as in the expression: 
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       b
                                    
                                    
                                       ext
                                    
                                 
                                 =
                                 {
                                 
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   p
                                                
                                                
                                                   ext
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   n
                                                
                                                
                                                   ext
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   c
                                                
                                                
                                                   ext
                                                
                                             
                                          
                                       
                                    
                                 
                                 }
                              
                           
                        
                     

After gathering and rearranging the displacement nodal vector 
                           u
                        , the external nodal force vector 
                           
                              
                                 f
                              
                              
                                 ext
                              
                           
                         and finally the stiffness matrix 
                           K
                        , as defined in (41) and (42), respectively, the general system (16) that relates the variations 
                           d
                           u
                         and 
                           d
                           
                              
                                 f
                              
                              
                                 ext
                              
                           
                         is rearranged as follows:
                           
                              (56)
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   ii
                                                
                                             
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   ip
                                                
                                             
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   in
                                                
                                             
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   ic
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   pi
                                                
                                             
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   pp
                                                
                                             
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   pn
                                                
                                             
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   pc
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   ni
                                                
                                             
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   np
                                                
                                             
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   nn
                                                
                                             
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   nc
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   ci
                                                
                                             
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   cp
                                                
                                             
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   cn
                                                
                                             
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   cc
                                                
                                             
                                          
                                       
                                    
                                 
                                 ]
                                 {
                                 
                                    
                                       
                                          
                                             d
                                             
                                                
                                                   u
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          
                                             d
                                             
                                                
                                                   u
                                                
                                                
                                                   p
                                                
                                             
                                          
                                       
                                       
                                          
                                             d
                                             
                                                
                                                   u
                                                
                                                
                                                   n
                                                
                                             
                                          
                                       
                                       
                                          
                                             d
                                             
                                                
                                                   u
                                                
                                                
                                                   c
                                                
                                             
                                          
                                       
                                    
                                 
                                 }
                                 =
                                 {
                                 
                                    
                                       
                                          
                                             d
                                             
                                                
                                                   f
                                                
                                                
                                                   i
                                                
                                                
                                                   ext
                                                
                                             
                                          
                                       
                                       
                                          
                                             d
                                             
                                                
                                                   f
                                                
                                                
                                                   p
                                                
                                                
                                                   ext
                                                
                                             
                                          
                                       
                                       
                                          
                                             d
                                             
                                                
                                                   f
                                                
                                                
                                                   n
                                                
                                                
                                                   ext
                                                
                                             
                                          
                                       
                                       
                                          
                                             d
                                             
                                                
                                                   f
                                                
                                                
                                                   c
                                                
                                                
                                                   ext
                                                
                                             
                                          
                                       
                                    
                                 
                                 }
                                 ≡
                                 K
                                 
                                 d
                                 u
                                 =
                                 d
                                 
                                    
                                       f
                                    
                                    
                                       ext
                                    
                                 
                              
                           
                        where 
                           d
                           
                              
                                 f
                              
                              
                                 i
                              
                              
                                 ext
                              
                           
                           =
                           0
                         in equilibrium. Splitting the displacement vector 
                           u
                           =
                           
                              
                                 u
                              
                              
                                 ⁎
                              
                           
                           +
                           
                              
                                 u
                              
                              
                                 ˜
                              
                           
                         and rearranging the system (56), leads to
                           
                              (57)
                              
                                 K
                                 
                                 d
                                 
                                    
                                       u
                                    
                                    
                                       ˜
                                    
                                 
                                 =
                                 d
                                 
                                    
                                       f
                                    
                                    
                                       ext
                                    
                                 
                                 −
                                 K
                                 
                                 d
                                 
                                    
                                       u
                                    
                                    
                                       ⁎
                                    
                                 
                              
                           
                        where the variation of Taylor displacement 
                           d
                           
                              
                                 u
                              
                              
                                 ⁎
                              
                           
                         is given by (53). Again the general procedure of Section 5.2 is followed to rearrange the system in the way described in Section 5.2. In this system the displacement fluctuation variation vector 
                           d
                           
                              
                                 u
                              
                              
                                 ˜
                              
                           
                         is considered as unknown. Applying into the above split system (57) the following conditions: (i) periodic displacement condition (44), (ii) prescribed corners displacement (46), (iii) antiperiodic external force condition (48) leads to the following system:
                           
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   ii
                                                
                                             
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   ip
                                                
                                             
                                             +
                                             
                                                
                                                   k
                                                
                                                
                                                   in
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   pi
                                                
                                             
                                             +
                                             
                                                
                                                   k
                                                
                                                
                                                   ni
                                                
                                             
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   pp
                                                
                                             
                                             +
                                             
                                                
                                                   k
                                                
                                                
                                                   pn
                                                
                                             
                                             +
                                             
                                                
                                                   k
                                                
                                                
                                                   np
                                                
                                             
                                             +
                                             
                                                
                                                   k
                                                
                                                
                                                   nn
                                                
                                             
                                          
                                       
                                    
                                 
                                 ]
                                 {
                                 
                                    
                                       
                                          
                                             d
                                             
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          
                                             d
                                             
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   p
                                                
                                             
                                          
                                       
                                    
                                 
                                 }
                                 
                                 =
                                 −
                                 [
                                 
                                    
                                       
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   ii
                                                
                                             
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   ip
                                                
                                             
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   in
                                                
                                             
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   ic
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   pi
                                                
                                             
                                             +
                                             
                                                
                                                   k
                                                
                                                
                                                   ni
                                                
                                             
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   pp
                                                
                                             
                                             +
                                             
                                                
                                                   k
                                                
                                                
                                                   np
                                                
                                             
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   pn
                                                
                                             
                                             +
                                             
                                                
                                                   k
                                                
                                                
                                                   nn
                                                
                                             
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   pc
                                                
                                             
                                             +
                                             
                                                
                                                   k
                                                
                                                
                                                   nc
                                                
                                             
                                          
                                       
                                    
                                 
                                 ]
                                 d
                                 
                                    
                                       u
                                    
                                    
                                       ⁎
                                    
                                 
                              
                           
                        which is described in the following compact form:
                           
                              (58)
                              
                                 
                                    
                                       K
                                    
                                    
                                       2
                                    
                                 
                                 {
                                 
                                    
                                       
                                          
                                             d
                                             
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          
                                             d
                                             
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   p
                                                
                                             
                                          
                                       
                                    
                                 
                                 }
                                 =
                                 −
                                 
                                    
                                       K
                                    
                                    
                                       F
                                       2
                                    
                                 
                                 
                                 d
                                 
                                    
                                       u
                                    
                                    
                                       ⁎
                                    
                                 
                              
                           
                        where 
                           d
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 i
                              
                           
                         and 
                           d
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 p
                              
                           
                         are the unknowns. Matrices 
                           
                              
                                 K
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 K
                              
                              
                                 F
                                 2
                              
                           
                         are defined by 
                           
                              
                                 
                                    
                                       K
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 [
                                 
                                    
                                       
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   ii
                                                
                                             
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   ip
                                                
                                             
                                             +
                                             
                                                
                                                   k
                                                
                                                
                                                   in
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   pi
                                                
                                             
                                             +
                                             
                                                
                                                   k
                                                
                                                
                                                   ni
                                                
                                             
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   pp
                                                
                                             
                                             +
                                             
                                                
                                                   k
                                                
                                                
                                                   pn
                                                
                                             
                                             +
                                             
                                                
                                                   k
                                                
                                                
                                                   np
                                                
                                             
                                             +
                                             
                                                
                                                   k
                                                
                                                
                                                   nn
                                                
                                             
                                          
                                       
                                    
                                 
                                 ]
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       K
                                    
                                    
                                       F
                                       2
                                    
                                 
                                 =
                                 [
                                 
                                    
                                       
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   ii
                                                
                                             
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   ip
                                                
                                             
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   in
                                                
                                             
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   ic
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   pi
                                                
                                             
                                             +
                                             
                                                
                                                   k
                                                
                                                
                                                   ni
                                                
                                             
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   pp
                                                
                                             
                                             +
                                             
                                                
                                                   k
                                                
                                                
                                                   np
                                                
                                             
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   pn
                                                
                                             
                                             +
                                             
                                                
                                                   k
                                                
                                                
                                                   nn
                                                
                                             
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   pc
                                                
                                             
                                             +
                                             
                                                
                                                   k
                                                
                                                
                                                   nc
                                                
                                             
                                          
                                       
                                    
                                 
                                 ]
                              
                           
                        Displacements 
                           d
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 i
                              
                           
                         and 
                           d
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 p
                              
                           
                         are then obtained by a simple matrix inversion of 
                           
                              
                                 K
                              
                              
                                 2
                              
                           
                        . Thus, they are obtained in terms of the Taylor displacement variation 
                           d
                           
                              
                                 u
                              
                              
                                 ⁎
                              
                           
                         as
                           
                              (59)
                              
                                 {
                                 
                                    
                                       
                                          
                                             d
                                             
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          
                                             d
                                             
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   p
                                                
                                             
                                          
                                       
                                    
                                 
                                 }
                                 =
                                 −
                                 
                                    
                                       K
                                    
                                    
                                       2
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                 
                                    
                                       K
                                    
                                    
                                       F
                                       2
                                    
                                 
                                 
                                 d
                                 
                                    
                                       u
                                    
                                    
                                       ⁎
                                    
                                 
                              
                           
                        Variation of boundary forces can be computed explicitly in terms of 
                           d
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 i
                              
                           
                         and 
                           d
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 p
                              
                           
                         and the Taylor displacement variation 
                           d
                           
                              
                                 u
                              
                              
                                 ⁎
                              
                           
                        . Firstly, the external positive nodal force vector is
                           
                              (60)
                              
                                 d
                                 
                                    
                                       f
                                    
                                    
                                       p
                                    
                                    
                                       ext
                                    
                                 
                                 =
                                 [
                                 
                                    
                                       k
                                    
                                    
                                       pi
                                    
                                 
                                 
                                 
                                    
                                       k
                                    
                                    
                                       pp
                                    
                                 
                                 +
                                 
                                    
                                       k
                                    
                                    
                                       pn
                                    
                                 
                                 ]
                                 {
                                 
                                    
                                       
                                          
                                             d
                                             
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          
                                             d
                                             
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   p
                                                
                                             
                                          
                                       
                                    
                                 
                                 }
                                 +
                                 [
                                 
                                    
                                       k
                                    
                                    
                                       pi
                                    
                                 
                                 
                                 
                                    
                                       k
                                    
                                    
                                       pp
                                    
                                 
                                 
                                 
                                    
                                       k
                                    
                                    
                                       pn
                                    
                                 
                                 
                                 
                                    
                                       k
                                    
                                    
                                       pc
                                    
                                 
                                 ]
                                 d
                                 
                                    
                                       u
                                    
                                    
                                       ⁎
                                    
                                 
                              
                           
                        where using the matrix notation: 
                           
                              
                                 
                                    
                                       K
                                    
                                    
                                       P
                                       1
                                    
                                 
                                 =
                                 [
                                 
                                    
                                       K
                                    
                                    
                                       pi
                                    
                                 
                                 
                                 
                                    
                                       k
                                    
                                    
                                       pp
                                    
                                 
                                 +
                                 
                                    
                                       k
                                    
                                    
                                       pn
                                    
                                 
                                 ]
                                 ,
                                 
                                 
                                    
                                       k
                                    
                                    
                                       P
                                       2
                                    
                                 
                                 =
                                 [
                                 
                                    
                                       k
                                    
                                    
                                       pi
                                    
                                 
                                 
                                 
                                    
                                       k
                                    
                                    
                                       pp
                                    
                                 
                                 
                                 
                                    
                                       k
                                    
                                    
                                       pn
                                    
                                 
                                 
                                 
                                    
                                       k
                                    
                                    
                                       pc
                                    
                                 
                                 ]
                                 ,
                              
                           
                        the following compact expression for 
                           d
                           
                              
                                 f
                              
                              
                                 p
                              
                              
                                 ext
                              
                           
                         is obtained:
                           
                              (61)
                              
                                 d
                                 
                                    
                                       f
                                    
                                    
                                       p
                                    
                                    
                                       ext
                                    
                                 
                                 =
                                 
                                    
                                       K
                                    
                                    
                                       P
                                       1
                                    
                                 
                                 {
                                 
                                    
                                       
                                          
                                             d
                                             
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          
                                             d
                                             
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   p
                                                
                                             
                                          
                                       
                                    
                                 
                                 }
                                 +
                                 
                                    
                                       K
                                    
                                    
                                       P
                                       2
                                    
                                 
                                 
                                 d
                                 
                                    
                                       u
                                    
                                    
                                       ⁎
                                    
                                 
                              
                           
                        
                     

Once the positive nodal force vector variation was computed, the negative nodal force vector variation 
                           d
                           
                              
                                 f
                              
                              
                                 n
                              
                              
                                 ext
                              
                           
                         is also obtained straight away, since the negative and positive vectors are opposite to each other (48). Therefore
                           
                              (62)
                              
                                 d
                                 
                                    
                                       f
                                    
                                    
                                       n
                                    
                                    
                                       ext
                                    
                                 
                                 =
                                 −
                                 d
                                 
                                    
                                       f
                                    
                                    
                                       p
                                    
                                    
                                       ext
                                    
                                 
                              
                           
                        with 
                           d
                           
                              
                                 f
                              
                              
                                 p
                              
                              
                                 ext
                              
                           
                         previously obtained in (61).

In addition, the external corner node vector variation 
                           d
                           
                              
                                 f
                              
                              
                                 c
                              
                              
                                 ext
                              
                           
                         is computed as
                           
                              (63)
                              
                                 d
                                 
                                    
                                       f
                                    
                                    
                                       c
                                    
                                    
                                       ext
                                    
                                 
                                 =
                                 [
                                 
                                    
                                       k
                                    
                                    
                                       ci
                                    
                                 
                                 
                                 
                                    
                                       k
                                    
                                    
                                       cp
                                    
                                 
                                 +
                                 
                                    
                                       k
                                    
                                    
                                       cn
                                    
                                 
                                 ]
                                 {
                                 
                                    
                                       
                                          
                                             d
                                             
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          
                                             d
                                             
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   p
                                                
                                             
                                          
                                       
                                    
                                 
                                 }
                                 +
                                 [
                                 
                                    
                                       k
                                    
                                    
                                       ci
                                    
                                 
                                 
                                 
                                    
                                       k
                                    
                                    
                                       cp
                                    
                                 
                                 
                                 
                                    
                                       k
                                    
                                    
                                       cn
                                    
                                 
                                 
                                 
                                    
                                       k
                                    
                                    
                                       cc
                                    
                                 
                                 ]
                                 
                                 d
                                 
                                    
                                       u
                                    
                                    
                                       ⁎
                                    
                                 
                              
                           
                        which can be represented in a compact form as
                           
                              (64)
                              
                                 d
                                 
                                    
                                       f
                                    
                                    
                                       c
                                    
                                    
                                       ext
                                    
                                 
                                 =
                                 
                                    
                                       K
                                    
                                    
                                       C
                                       1
                                    
                                 
                                 {
                                 
                                    
                                       
                                          
                                             d
                                             
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          
                                             d
                                             
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   p
                                                
                                             
                                          
                                       
                                    
                                 
                                 }
                                 +
                                 
                                    
                                       K
                                    
                                    
                                       C
                                       2
                                    
                                 
                                 
                                 d
                                 
                                    
                                       u
                                    
                                    
                                       ⁎
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    
                                       K
                                    
                                    
                                       C
                                       1
                                    
                                 
                                 =
                                 [
                                 
                                    
                                       k
                                    
                                    
                                       ci
                                    
                                 
                                 
                                 
                                    
                                       k
                                    
                                    
                                       cp
                                    
                                 
                                 +
                                 
                                    
                                       k
                                    
                                    
                                       cn
                                    
                                 
                                 ]
                                 
                                 
                                    
                                       K
                                    
                                    
                                       C
                                       2
                                    
                                 
                                 =
                                 [
                                 
                                    
                                       k
                                    
                                    
                                       ci
                                    
                                 
                                 
                                 
                                    
                                       k
                                    
                                    
                                       cp
                                    
                                 
                                 
                                 
                                    
                                       k
                                    
                                    
                                       cn
                                    
                                 
                                 
                                 
                                    
                                       k
                                    
                                    
                                       cc
                                    
                                 
                                 
                                 ]
                              
                           
                        However, in the sum of all corner forces (49) a condition has not been taken into consideration so far. This condition implies that one of the corner forces is a dependant variable of the other corner forces. Basically, all corner forces cannot be computed at the same time using (64).

Hence, by using (49) 
                        
                           d
                           
                              
                                 f
                              
                              
                                 c
                                 1
                              
                              
                                 ext
                              
                           
                         is computed as
                           
                              (65)
                              
                                 d
                                 
                                    
                                       f
                                    
                                    
                                       c
                                       1
                                    
                                    
                                       ext
                                    
                                 
                                 =
                                 −
                                 (
                                 d
                                 
                                    
                                       f
                                    
                                    
                                       c
                                       2
                                    
                                    
                                       ext
                                    
                                 
                                 +
                                 d
                                 
                                    
                                       f
                                    
                                    
                                       c
                                       3
                                    
                                    
                                       ext
                                    
                                 
                                 +
                                 d
                                 
                                    
                                       f
                                    
                                    
                                       c
                                       4
                                    
                                    
                                       ext
                                    
                                 
                                 )
                              
                           
                        
                     

The new matrices are defined 
                           
                              
                                 
                                    
                                       K
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 C
                                 1
                              
                           
                         and 
                           
                              
                                 
                                    
                                       K
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 C
                                 2
                              
                           
                        , respectively. So that, the expression (64) is then reduced to
                           
                              (66)
                              
                                 d
                                 
                                    
                                       f
                                    
                                    
                                       c
                                    
                                    
                                       ext
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             K
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       C
                                       1
                                    
                                 
                                 {
                                 
                                    
                                       
                                          
                                             d
                                             
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          
                                             d
                                             
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   p
                                                
                                             
                                          
                                       
                                    
                                 
                                 }
                                 +
                                 
                                    
                                       
                                          
                                             K
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       C
                                       2
                                    
                                 
                                 
                                 d
                                 
                                    
                                       u
                                    
                                    
                                       ⁎
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    
                                       K
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 C
                                 1
                              
                           
                         and 
                           
                              
                                 
                                    
                                       K
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 C
                                 2
                              
                           
                         are the direct condensation of matrices. By using (59), the variation external boundary force vectors 
                           d
                           
                              
                                 f
                              
                              
                                 p
                              
                              
                                 ext
                              
                           
                        , 
                           d
                           
                              
                                 f
                              
                              
                                 n
                              
                              
                                 ext
                              
                           
                         and 
                           d
                           
                              
                                 f
                              
                              
                                 c
                              
                              
                                 ext
                              
                           
                         can be expressed only in terms of the Taylor displacement variation 
                           d
                           
                              
                                 u
                              
                              
                                 ⁎
                              
                           
                        
                        
                           
                              (67)
                              
                                 d
                                 
                                    
                                       f
                                    
                                    
                                       p
                                    
                                    
                                       ext
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       K
                                    
                                    
                                       P
                                       2
                                    
                                 
                                 −
                                 
                                    
                                       K
                                    
                                    
                                       P
                                       1
                                    
                                 
                                 
                                 
                                    
                                       K
                                    
                                    
                                       2
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                 
                                    
                                       K
                                    
                                    
                                       F
                                       2
                                    
                                 
                                 )
                                 
                                 d
                                 
                                    
                                       u
                                    
                                    
                                       ⁎
                                    
                                 
                                 =
                                 
                                    
                                       K
                                    
                                    
                                       P
                                    
                                 
                                 
                                 d
                                 
                                    
                                       u
                                    
                                    
                                       ⁎
                                    
                                 
                              
                           
                        
                        
                           
                              (68)
                              
                                 d
                                 
                                    
                                       f
                                    
                                    
                                       n
                                    
                                    
                                       ext
                                    
                                 
                                 =
                                 −
                                 (
                                 
                                    
                                       K
                                    
                                    
                                       P
                                       2
                                    
                                 
                                 −
                                 
                                    
                                       K
                                    
                                    
                                       P
                                       1
                                    
                                 
                                 
                                 
                                    
                                       K
                                    
                                    
                                       2
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                 
                                    
                                       K
                                    
                                    
                                       F
                                       2
                                    
                                 
                                 )
                                 
                                 d
                                 
                                    
                                       u
                                    
                                    
                                       ⁎
                                    
                                 
                                 =
                                 −
                                 
                                    
                                       K
                                    
                                    
                                       P
                                    
                                 
                                 
                                 d
                                 
                                    
                                       u
                                    
                                    
                                       ⁎
                                    
                                 
                              
                           
                        
                        
                           
                              (69)
                              
                                 d
                                 
                                    
                                       f
                                    
                                    
                                       c
                                    
                                    
                                       ext
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       
                                          
                                             K
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       C
                                       2
                                    
                                 
                                 −
                                 
                                    
                                       
                                          
                                             K
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       C
                                       1
                                    
                                 
                                 
                                 
                                    
                                       K
                                    
                                    
                                       2
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                 
                                    
                                       K
                                    
                                    
                                       F
                                       2
                                    
                                 
                                 )
                                 
                                 d
                                 
                                    
                                       u
                                    
                                    
                                       ⁎
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             K
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       C
                                    
                                 
                                 
                                 d
                                 
                                    
                                       u
                                    
                                    
                                       ⁎
                                    
                                 
                              
                           
                        Hence, the boundary force vector variation 
                           d
                           
                              
                                 f
                              
                              
                                 b
                              
                              
                                 ext
                              
                           
                         can now be expressed in terms of the Taylor displacement variation 
                           d
                           
                              
                                 u
                              
                              
                                 ⁎
                              
                           
                        . By adding (67), (68) and (69) it follows:
                           
                              (70)
                              
                                 d
                                 
                                    
                                       f
                                    
                                    
                                       b
                                    
                                    
                                       ext
                                    
                                 
                                 ≡
                                 {
                                 
                                    
                                       
                                          
                                             d
                                             
                                                
                                                   f
                                                
                                                
                                                   p
                                                
                                                
                                                   ext
                                                
                                             
                                          
                                       
                                       
                                          
                                             d
                                             
                                                
                                                   f
                                                
                                                
                                                   n
                                                
                                                
                                                   ext
                                                
                                             
                                          
                                       
                                       
                                          
                                             d
                                             
                                                
                                                   f
                                                
                                                
                                                   c
                                                
                                                
                                                   ext
                                                
                                             
                                          
                                       
                                    
                                 
                                 }
                                 =
                                 [
                                 
                                    
                                       
                                          
                                             
                                             
                                                
                                                   K
                                                
                                                
                                                   P
                                                
                                             
                                          
                                       
                                       
                                          
                                             −
                                             
                                                
                                                   K
                                                
                                                
                                                   P
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      
                                                         K
                                                      
                                                      
                                                         ^
                                                      
                                                   
                                                
                                                
                                                   C
                                                
                                             
                                          
                                       
                                    
                                 
                                 ]
                                 d
                                 
                                    
                                       u
                                    
                                    
                                       ⁎
                                    
                                 
                                 =
                                 
                                    
                                       K
                                    
                                    
                                       per
                                    
                                    
                                       B
                                    
                                 
                                 
                                 d
                                 
                                    
                                       u
                                    
                                    
                                       ⁎
                                    
                                 
                              
                           
                        This gives the expression:
                           
                              (71)
                              
                                 d
                                 
                                    
                                       f
                                    
                                    
                                       b
                                    
                                    
                                       ext
                                    
                                 
                                 =
                                 
                                    
                                       K
                                    
                                    
                                       per
                                    
                                    
                                       B
                                    
                                 
                                 
                                    
                                       D
                                    
                                    
                                       global
                                       ,
                                       p
                                    
                                    
                                       T
                                    
                                 
                                 
                                 d
                                 
                                    
                                       ϵ
                                    
                                    
                                       ¯
                                    
                                 
                              
                           
                        where the Taylor displacement variation (53) was inserted into Eq. (70). Therefore, the desired expression is gained as
                           
                              (72)
                              
                                 
                                    
                                       d
                                       
                                          
                                             f
                                          
                                          
                                             b
                                          
                                          
                                             ext
                                          
                                       
                                    
                                    
                                       d
                                       
                                          
                                             ϵ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       K
                                    
                                    
                                       per
                                    
                                    
                                       B
                                    
                                 
                                 
                                 
                                    
                                       D
                                    
                                    
                                       global
                                       ,
                                       p
                                    
                                    
                                       T
                                    
                                 
                              
                           
                        which gives the variation of external boundary force vector 
                           d
                           
                              
                                 f
                              
                              
                                 b
                              
                              
                                 ext
                              
                           
                         with respect to the variation of macroscopic average strain matrix 
                           d
                           
                              
                                 ϵ
                              
                              
                                 ¯
                              
                           
                        .

The overall tangent modulus 
                           
                              
                                 
                                    
                                       C
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 
                                 p
                              
                           
                         for Periodic b.c., can be computed in its discretised F.E. matrix form following the general expression given in (17), that is
                           
                              (73)
                              
                                 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       
                                       p
                                    
                                 
                                 =
                                 
                                    
                                       d
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       d
                                       
                                          
                                             ϵ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       |
                                       V
                                       |
                                    
                                 
                                 
                                 
                                    
                                       D
                                    
                                    
                                       b
                                       ,
                                       p
                                    
                                 
                                 
                                 
                                    
                                       d
                                       
                                          
                                             f
                                          
                                          
                                             b
                                          
                                          
                                             ext
                                          
                                       
                                    
                                    
                                       d
                                       
                                          
                                             ϵ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 D
                              
                              
                                 b
                                 ,
                                 p
                              
                           
                         was defined in (51).

Substituting (72) into (73), the overall tangent modulus matrix representation 
                           
                              
                                 
                                    
                                       C
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 
                                 p
                              
                           
                         is obtained as
                           
                              (74)
                              
                                 
                                    
                                       
                                          
                                             
                                                C
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          p
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          |
                                          V
                                          |
                                       
                                    
                                    
                                    
                                       
                                          D
                                       
                                       
                                          b
                                          ,
                                          p
                                       
                                    
                                    
                                    
                                       
                                          K
                                       
                                       
                                          per
                                       
                                       
                                          B
                                       
                                    
                                    
                                    
                                       
                                          D
                                       
                                       
                                          global
                                          ,
                                          p
                                       
                                       
                                          T
                                       
                                    
                                 
                              
                           
                        Clearly, the modulus 
                           
                              
                                 
                                    
                                       C
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 p
                              
                           
                         is a function of the boundary coordinate matrix 
                           
                              
                                 D
                              
                              
                                 b
                                 ,
                                 p
                              
                           
                         defined in (51), the condensed periodic stiffness matrix 
                           
                              
                                 K
                              
                              
                                 per
                              
                              
                                 B
                              
                           
                         and the global coordinate matrix 
                           
                              
                                 D
                              
                              
                                 global
                                 ,
                                 p
                              
                           
                         outlined in (50). Note that with the above (74), the tangent modulus can be computed for heterogeneous material with different microstructures RVE gaining the desired quadratic rate of convergence, for the Newton–Raphson solution procedure applied to solve the homogenised nonlinear macrostructure, under periodic deformation and antiperiodic traction on the boundary of RVE model.

The antiperiodicity is represented by means of forces at the corners as depicted in Fig. 4
                        . The superscripts indicate the following:
                           
                              B
                              Bottom (−)

Top (+)

Left (−)

Right (+)

The forces at the corners represent the discretisation of the traction coming from the surrounding continuum.
                           
                              •
                              Corner 1 (C1): 
                                    
                                       
                                          f
                                       
                                       
                                          c
                                          1
                                       
                                       
                                          B
                                       
                                    
                                    
                                    and
                                    
                                    
                                       
                                          f
                                       
                                       
                                          c
                                          1
                                       
                                       
                                          L
                                       
                                    
                                 
                              

Corner 2 (C2): 
                                    
                                       
                                          f
                                       
                                       
                                          c
                                          2
                                       
                                       
                                          B
                                       
                                    
                                    
                                    and
                                    
                                    
                                       
                                          f
                                       
                                       
                                          c
                                          2
                                       
                                       
                                          R
                                       
                                    
                                 
                              

Corner 3 (C3): 
                                    
                                       
                                          f
                                       
                                       
                                          c
                                          3
                                       
                                       
                                          R
                                       
                                    
                                    
                                    and
                                    
                                    
                                       
                                          f
                                       
                                       
                                          c
                                          3
                                       
                                       
                                          T
                                       
                                    
                                 
                              

Corner 4 (C4): 
                                    
                                       
                                          f
                                       
                                       
                                          c
                                          4
                                       
                                       
                                          T
                                       
                                    
                                    
                                    and
                                    
                                    
                                       
                                          f
                                       
                                       
                                          c
                                          4
                                       
                                       
                                          L
                                       
                                    
                                 
                              

There are two forces per corner making a total of 8 at the discretised RVE. These forces must satisfy antiperiodicity. Therefore, the following 4 equations for antiperiodicity at the corners are established as
                           
                              (75)
                              
                                 
                                    
                                       f
                                    
                                    
                                       c
                                       1
                                    
                                    
                                       B
                                    
                                 
                                 =
                                 −
                                 
                                    
                                       f
                                    
                                    
                                       c
                                       4
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       c
                                       2
                                    
                                    
                                       B
                                    
                                 
                                 =
                                 −
                                 
                                    
                                       f
                                    
                                    
                                       c
                                       3
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       c
                                       1
                                    
                                    
                                       L
                                    
                                 
                                 =
                                 −
                                 
                                    
                                       f
                                    
                                    
                                       c
                                       2
                                    
                                    
                                       R
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       c
                                       4
                                    
                                    
                                       L
                                    
                                 
                                 =
                                 −
                                 
                                    
                                       f
                                    
                                    
                                       c
                                       3
                                    
                                    
                                       R
                                    
                                 
                              
                           
                        
                     

The resultant at each corner is also described in Fig. 4. Four additional relations are obtained as follows:
                           
                              (76)
                              
                                 
                                    
                                       f
                                    
                                    
                                       c
                                       1
                                    
                                    
                                       B
                                    
                                 
                                 +
                                 
                                    
                                       f
                                    
                                    
                                       c
                                       1
                                    
                                    
                                       L
                                    
                                 
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       c
                                       1
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       c
                                       2
                                    
                                    
                                       B
                                    
                                 
                                 +
                                 
                                    
                                       f
                                    
                                    
                                       c
                                       2
                                    
                                    
                                       R
                                    
                                 
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       c
                                       2
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       c
                                       3
                                    
                                    
                                       R
                                    
                                 
                                 +
                                 
                                    
                                       f
                                    
                                    
                                       c
                                       3
                                    
                                    
                                       T
                                    
                                 
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       c
                                       3
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       c
                                       4
                                    
                                    
                                       L
                                    
                                 
                                 +
                                 
                                    
                                       f
                                    
                                    
                                       c
                                       4
                                    
                                    
                                       T
                                    
                                 
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       c
                                       4
                                    
                                 
                              
                           
                        
                     

Then, the system formed by Eqs. (75) and (76) is reduced to have only one force per corner. This leads to
                           
                              (77)
                              
                                 
                                    
                                       f
                                    
                                    
                                       c
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       f
                                    
                                    
                                       c
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       f
                                    
                                    
                                       c
                                       3
                                    
                                 
                                 +
                                 
                                    
                                       f
                                    
                                    
                                       c
                                       4
                                    
                                 
                                 =
                                 0
                              
                           
                        
                     

Eq. (77) is the additional condition to apply to the system in order to compute the tangent operator. (77) expresses the continuum antiperiodicity traction constraint and makes the system to be in equilibrium.

The equilibrium and antiperiodicity equation at the corners of the discretised RVE is given by (77) which is imposed to compute the overall tangent modulus. The first two rows of 
                           
                              
                                 K
                              
                              
                                 C
                                 1
                              
                           
                         and 
                           
                              
                                 K
                              
                              
                                 C
                                 2
                              
                           
                         (corresponding to the 2 dofs of 
                           
                              
                                 f
                              
                              
                                 c
                                 1
                              
                           
                        ) have to be removed and recomputed by adding the other 6 rows (2 by 2) and, then, multiplied by −1. This process is visually described in Fig. 5
                        .

In Section 4 a general solution scheme for microequilibrium was given. In this section, the particularisation of the microequilibrium procedure for periodic b.c. is given. The incremental Taylor displacement is given in matrix form as
                           
                              (78)
                              
                                 Δ
                                 
                                    
                                       u
                                    
                                    
                                       ⁎
                                    
                                 
                                 =
                                 
                                    
                                       D
                                    
                                    
                                       global
                                       ,
                                       p
                                    
                                    
                                       T
                                    
                                 
                                 Δ
                                 
                                    
                                       ϵ
                                    
                                    
                                       ¯
                                    
                                 
                              
                           
                        
                     

The residual force 
                           r
                         is taken as
                           
                              (79)
                              
                                 r
                                 =
                                 {
                                 
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   i
                                                
                                                
                                                   int
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   p
                                                
                                                
                                                   int
                                                
                                             
                                             +
                                             
                                                
                                                   f
                                                
                                                
                                                   n
                                                
                                                
                                                   int
                                                
                                             
                                          
                                       
                                    
                                 
                                 }
                                 −
                                 {
                                 
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   i
                                                
                                                
                                                   ext
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   p
                                                
                                                
                                                   ext
                                                
                                             
                                             +
                                             
                                                
                                                   f
                                                
                                                
                                                   n
                                                
                                                
                                                   ext
                                                
                                             
                                          
                                       
                                    
                                 
                                 }
                              
                           
                        
                     

Assuming that in equilibrium 
                           
                              
                                 f
                              
                              
                                 i
                              
                              
                                 ext
                              
                           
                           =
                           0
                         and antiperiodicity of the boundary traction in discrete form 
                           
                              
                                 f
                              
                              
                                 p
                              
                              
                                 ext
                              
                           
                           +
                           
                              
                                 f
                              
                              
                                 n
                              
                              
                                 ext
                              
                           
                           =
                           0
                        , the residual for periodic b.c. takes the form:
                           
                              (80)
                              
                                 r
                                 =
                                 {
                                 
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   i
                                                
                                                
                                                   int
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   p
                                                
                                                
                                                   int
                                                
                                             
                                             +
                                             
                                                
                                                   f
                                                
                                                
                                                   n
                                                
                                                
                                                   int
                                                
                                             
                                          
                                       
                                    
                                 
                                 }
                                 .
                              
                           
                        
                     

The differential fluctuation is given by the system (12) which takes the following form for periodic b.c.
                           
                              (81)
                              
                                 
                                    
                                       K
                                    
                                    
                                       2
                                    
                                 
                                 {
                                 
                                    
                                       
                                          
                                             δ
                                             
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          
                                             δ
                                             
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   p
                                                
                                             
                                          
                                       
                                    
                                 
                                 }
                                 =
                                 −
                                 {
                                 
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   i
                                                
                                                
                                                   int
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   p
                                                
                                                
                                                   int
                                                
                                             
                                             +
                                             
                                                
                                                   f
                                                
                                                
                                                   n
                                                
                                                
                                                   int
                                                
                                             
                                          
                                       
                                    
                                 
                                 }
                                 →
                                 {
                                 
                                    
                                       
                                          
                                             δ
                                             
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          
                                             δ
                                             
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   p
                                                
                                             
                                          
                                       
                                    
                                 
                                 }
                                 =
                                 −
                                 
                                    
                                       K
                                    
                                    
                                       2
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 {
                                 
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   i
                                                
                                                
                                                   int
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   p
                                                
                                                
                                                   int
                                                
                                             
                                             +
                                             
                                                
                                                   f
                                                
                                                
                                                   n
                                                
                                                
                                                   int
                                                
                                             
                                          
                                       
                                    
                                 
                                 }
                              
                           
                        for differential displacement fluctuation for interior and positive nodes. Also taking into consideration (46) and (44), the differential displacement fluctuation for negative and corners is computed as
                           
                              (82)
                              
                                 δ
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       n
                                    
                                 
                                 =
                                 δ
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       p
                                    
                                 
                                 
                                 and
                                 
                                 δ
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       c
                                    
                                 
                                 =
                                 0
                              
                           
                        
                     

The updating of the incremental fluctuation is then given by
                           
                              (83)
                              
                                 Δ
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 ←
                                 Δ
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 δ
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 Δ
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       p
                                    
                                 
                                 ←
                                 Δ
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       p
                                    
                                 
                                 +
                                 δ
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       p
                                    
                                 
                                 Δ
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       n
                                    
                                 
                                 ←
                                 Δ
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       p
                                    
                                 
                              
                           
                        and 
                           Δ
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 c
                              
                           
                           =
                           0
                        . Finally, the incremental displacement to compute the internal force is updated as
                           
                              (84)
                              
                                 Δ
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 ←
                                 Δ
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 δ
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 Δ
                                 
                                    
                                       u
                                    
                                    
                                       p
                                    
                                 
                                 ←
                                 Δ
                                 
                                    
                                       u
                                    
                                    
                                       p
                                    
                                 
                                 +
                                 δ
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       p
                                    
                                 
                                 Δ
                                 
                                    
                                       u
                                    
                                    
                                       n
                                    
                                 
                                 ←
                                 Δ
                                 
                                    
                                       u
                                    
                                    
                                       p
                                    
                                 
                              
                           
                        and 
                           Δ
                           
                              
                                 u
                              
                              
                                 c
                              
                           
                         remains constant.

The first numerical test consists of computation of effective elastic material properties. Square microcells, in which fibres are periodically distributed, are considered composed of epoxy matrix with Young׳s modulus E=3.13GPa and Poisson׳s ratio ν=0.34. Glass fibre is embedded in the matrix with Young׳s modulus E=73GPa and Poisson׳s ratio ν=0.2.

The test has been carried out under plane strain analysis. In Fig. 6
                      the ratio of effective shear modulus over the matrix modulus 
                        
                           
                              G
                           
                           
                              ¯
                           
                        
                        /
                        
                           
                              G
                           
                           
                              matrix
                           
                        
                      is compared with analytically obtained properties following Nemat–Nasser (Part I, chapter 8) [29].

A very similar response can be observed for less than 20% of the inclusion volume fraction. Especially, the periodic assumption seems to be very accurate. Note that the Nemat–Nasser׳s analytical model is effective in predicting equivalent material properties for a low volume fraction of the second phase inclusion. However, Nemat–Nasser׳s model [29] does not cope well with large fibre volumes.

The second numerical test considered is an analysis of nonlinear material behaviour in small strain. The test consists of a simulation of the behaviour of an internally pressurised circular metallic plate, see Fig. 7
                     . The analysis is carried out assuming plane stress conditions. Note that the equality between the macroscopic strain and the average of the microscopic strain – imposed as an average on the RVE – is satisfied by means of application of the Hill–Mandel principle or averaging theorem. The von Mises perfect elastoplastic model is used to perform the simulation.

The properties of the material are as follows:
                        
                           •
                           Young׳s modulus E=210GPa.

Poisson ratio ν=0.3.

Uniaxial yield stress 
                                 
                                    
                                       σ
                                    
                                    
                                       y
                                    
                                 
                                 =
                                 0.24
                                 
                                 GPa
                               (perfect elastoplastic).

The mesh for the macrostructure is shown in Fig. 7. Due to symmetry only a quarter of the circular plate is analysed by employing 20 standard 8-noded quadrilateral elements with reduced integration.

The pressure, P, prescribed on the inner surface, is increased gradually until collapse (limit) load is reached. For the present problem (see Fig. 8
                     ), plastic yielding starts at the inner surface (with radial coordinate r=a) and develops gradually, in the form of a circular plastic front (with radius c), towards the outer face (r=b). Collapse occurs when the plastic front reaches the outer face (c=b) and the entire cylinder can expand indefinitely without further increase in the applied pressure.

Initially, the pressure is applied during elastic regime until 
                        
                           
                              P
                           
                           
                              0
                           
                        
                      is reached at which plastic yielding begins. In this region the radial displacement of the outer surface is a linear function of P, given by
                        
                           (85)
                           
                              
                                 
                                    u
                                 
                                 
                                    b
                                 
                              
                              =
                              
                                 
                                    2
                                    Pb
                                 
                                 
                                    E
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       −
                                       1
                                    
                                    )
                                 
                              
                              
                              P
                              <
                              
                                 
                                    P
                                 
                                 
                                    0
                                 
                              
                           
                        
                     
                  

A closed-form in the plastic region, has been derived by Lubliner [30]. It relates the applied pressure to the radius c of the plastic front by means of the expression:
                        
                           (86)
                           
                              
                                 
                                    P
                                 
                                 
                                    Y
                                 
                              
                              =
                              ln
                              (
                              
                                 
                                    
                                       c
                                    
                                    
                                       a
                                    
                                 
                              
                              )
                              +
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              (
                              
                                 1
                                 −
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       
                                          
                                             b
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                              )
                              ,
                           
                        
                     where for the von Mises model 
                        Y
                        =
                        2
                        
                        
                           
                              σ
                           
                           
                              y
                           
                        
                        /
                        
                           
                              3
                           
                        
                     . Plastic yielding begins when c=a, which corresponds to the yielding pressure:
                        
                           (87)
                           
                              
                                 
                                    
                                       
                                          P
                                       
                                       
                                          0
                                       
                                    
                                 
                                 
                                    Y
                                 
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              (
                              
                                 1
                                 −
                                 
                                    
                                       
                                          
                                             a
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       
                                          
                                             b
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                              )
                              .
                           
                        
                     
                  

In the plastic regime (
                        P
                        ≥
                        
                           
                              P
                           
                           
                              0
                           
                        
                      ), the radial displacement, 
                        
                           
                              u
                           
                           
                              b
                           
                        
                     , is given by
                        
                           (88)
                           
                              
                                 
                                    u
                                 
                                 
                                    b
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          Yc
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    Eb
                                 
                              
                              
                              P
                              <
                              
                                 
                                    P
                                 
                                 
                                    0
                                 
                              
                           
                        
                     where c can be evaluated as an implicit function of P through (86).

In the following figures, diagrams showing the applied pressure P versus radial displacement at the outer face of the plate are plotted together with the closed-form solution [30] described above. The following diagrams are displayed:
                           
                              •
                              Single scale analysis: Closed form and FEM analysis.

Two multi-scale analyses. RVE: Square microstructure discretised by 8-noded quadrilateral elements with reduced integration. Every cell has a void in the middle with variable shape and volume fraction, as follows:
                                    
                                       
                                          
                                             ○
                                          
                                       
                                       Microstructure 1: Circular void in the middle of the RVE with 5% volume fraction. 
                                             
                                                
                                                   n
                                                
                                                
                                                   elements
                                                
                                             
                                             =
                                             126
                                           , 
                                             
                                                
                                                   n
                                                
                                                
                                                   nodes
                                                
                                             
                                             =
                                             438
                                          .

Microstructure 2: Square void in the middle of the RVE with 5% volume fraction. 
                                             
                                                
                                                   n
                                                
                                                
                                                   elements
                                                
                                             
                                             =
                                             128
                                           , 
                                             
                                                
                                                   n
                                                
                                                
                                                   nodes
                                                
                                             
                                             =
                                             448
                                          . 
                                             
                                                
                                                   n
                                                
                                                
                                                   elements
                                                
                                             
                                             =
                                             128
                                           , 
                                             
                                                
                                                   n
                                                
                                                
                                                   nodes
                                                
                                             
                                             =
                                             448
                                          .

Microstructure 3: Circular void in the middle of the RVE with 15% volume fraction. 
                                             
                                                
                                                   n
                                                
                                                
                                                   elements
                                                
                                             
                                             =
                                             128
                                           , 
                                             
                                                
                                                   n
                                                
                                                
                                                   nodes
                                                
                                             
                                             =
                                             448
                                          .

Microstructure 4: Square void in the middle of the RVE with 15% volume fraction. 
                                             
                                                
                                                   n
                                                
                                                
                                                   elements
                                                
                                             
                                             =
                                             160
                                           , 
                                             
                                                
                                                   n
                                                
                                                
                                                   nodes
                                                
                                             
                                             =
                                             560
                                          .

These microstructures are depicted in Fig. 9
                        .

In Figs. 10–12
                        
                        
                         results are shown for different constraints on the microcell and 5 and 15% void fraction, respectively. Curved denoted Lubliner represents the closed-form solution described above and given in [30]. FEM curve shows a single scale analysis of the problem. The agreement between the closed form and FEM solution is excellent. Furthermore, two scales analysis curves are depicted for Taylor assumption, linear b.c and periodic b.c. The comments are as follows:
                           
                              •
                              Taylor assumption gives the stiffest response. Then comes linear b.c. while the softest response is given by periodic b.c. This was expected from the nature of the constraints.

Taylor assumption and linear b.c. show insensitivity at macroscopic level for different void shape. Diagrams for circular and squared void shape are overlapped.

Periodic b.c. is the only one which shows sensitivity to the void size. It can be observed that circular void gives slightly stiffer response than the square one, which agrees with the expected response. Moreover, the difference is bigger when the void size is increased.

The diagrams (Figs. 10–12) show the results depending upon Taylor assumption, linear b.c., periodic b.c., and void volume fraction. It can be observed that the material response softens when the void volume fraction increases. The Taylor assumption gives less sensitive results than linear b.c. and periodic b.c.

In this section several figures representing effective plastic strain distribution are depicted for a quarter of the cylinder with some representative microstructures. The plastic front evolves in a circular way which agrees with the symmetry of the problem and the analytical solution given earlier [30].

In Fig. 13
                         a Microstructure 1 is considered under the Taylor assumption. Two different stages are depicted at different values of internal pressure P=140 and P=175MPa, respectively. The circular evolution of the plastic front at macroscale level can be observed. For P=175MPa a slight distortion of the plastic front is visible as the load approaches the limit value.

In Fig. 14
                        (a) and (b) the results for the linear b.c. are shown for Microstructure 1 for values of internal pressure of P=100 and P=160MPa, respectively, while Fig. 15
                        (a) and (b) gives the result for the periodic b.c. for values of internal pressure of P=95 and P=150MPa, respectively. The development of shear bands is observed in these figures.

In Fig. 16
                         the Microstructure 2 is considered under the Taylor assumption. Again two different stages are depicted for different values of internal pressure P=140 and P=175MPa, respectively. For P=175MPa a slight distortion of the plastic front is visible as the load approaches the limit value.

In Fig. 17
                         (a) and (b) the results for the linear b.c. are shown for Microstructure 2 for values of internal pressure of P=100 and P=160MPa, respectively, while Fig. 18
                        (a) and (b) gives the result for the periodic b.c. for values of internal pressure of P=95 and P=150MPa, respectively. The development of shear bands is observed in these figures.

In Fig. 19
                         the Microstructure 3 is considered under the Taylor assumption. Two different stages are depicted for different values of internal pressure P=115 and P=160MPa, respectively. The circular evolution of the plastic front at macroscale level is shown. Again, for P=160MPa a slight distortion of the plastic front is visible as the load approaches to the limit value.

In Fig. 20
                        (a) and (b) the results for the linear b.c. are shown for Microstructure 3 for values of internal pressure of P=100 and P=130MPa, respectively, while Fig. 21
                        (a) and (b) gives the result for the periodic b.c. for values of internal pressure of P=100 and P=120MPa, respectively. The development of shear bands is observed in these figures.

In Fig. 22
                         a Microstructure 4 is considered under the Taylor assumption. Two different stages are depicted for different values of internal pressure P=115 and P=160MPa, respectively. For P=160MPa a slight distortion of the plastic front is visible as the load approaches the limit value.

In Fig. 23
                        (a) and (b) the results for the linear b.c. are shown for Microstructure 1 for values of internal pressure of P=90 and P=130MPa, respectively, while Fig. 24
                        (a) and (b) gives the result for the periodic b.c. for values of internal pressure of P=75 and P=115MPa, respectively. The development of shear bands is observed in these figures.

In this section tables with the Euclidean norm 
                           
                              
                                 R
                              
                              
                                 M
                              
                           
                         of the residual are reported associated with the Newton iterations of the macro- and micro-equilibrium. The residual norm evolution is shown for the microstructure that corresponds to the macroGauss point in the bottom right corner (Tables 1 and 2
                        
                        ).

In the following tables the Euclidean norm 
                           
                              
                                 R
                              
                              
                                 M
                              
                           
                         of the residual is reported associated with the Newton iterations of the macro-equilibrium. The macro-residual is normalised and calculated as 
                           
                              
                                 R
                              
                              
                                 M
                              
                           
                           =
                           100
                           ×
                           ∥
                           
                              
                                 F
                              
                              
                                 int
                              
                           
                           −
                           
                              
                                 F
                              
                              
                                 ext
                              
                           
                           ∥
                           /
                           ∥
                           
                              
                                 F
                              
                              
                                 ext
                              
                           
                           ∥
                        . The micro-residual is computed in different ways depending on the constraint. Obviously in Taylor assumption there is no micro BVP so the residuals are not shown.

The residual for linear b.c. is evaluated as 
                           
                              
                                 R
                              
                              
                                 μ
                              
                           
                           =
                           100
                           ×
                           ∥
                           r
                           ∥
                           /
                           ∥
                           
                              
                                 f
                              
                              
                                 int
                              
                           
                           ∥
                         where 
                           r
                         is given as 
                           r
                           =
                           
                              
                                 f
                              
                              
                                 i
                              
                              
                                 int
                              
                           
                        . The residual for periodic b.c. is evaluated as 
                           
                              
                                 R
                              
                              
                                 μ
                              
                           
                           =
                           100
                           ×
                           ∥
                           r
                           ∥
                           /
                           ∥
                           
                              
                                 f
                              
                              
                                 int
                              
                           
                           ∥
                         where 
                           r
                         was given in (80).

Clearly, the quadratic rate of asymptotic convergence can be observed in the macro and microscale for both Linear and Periodic b.c.׳s. Also the Taylor assumption shows quadratic rate of convergence in macroequilibrium.

Note that the microstructure in Figs. 14–24 is rotated in order to keep axisymmetric conditions as much as possible. The RVEs are not arbitrarily rotated. They are rotated in such an angle that they have imposed the same relative macroscopic deformation of another RVEs placed at the same distance from the centre of the cylinder. The symmetry is not possible to keep it 100%. In Taylor it is more obvious since it is presented at larger pressure.

@&#CONCLUSION@&#

The proposed numerical multiscale homogenisation approach MFEH is a versatile tool to establish micro-macro property structure relations in materials where the collective behaviour of multi-phases is not possible to predict by any other method. The main novelty of MFEH lies in the way that boundary-node forces at the corners are condensed in order to achieve a macro-consistent tangent operator: anti-periodic boundary conditions in terms of traction vectors at the corners of the RVE leading to quadratic rate of convergence in the Macrostructure. The new effective macroscopic tangent modulus is consistent with the boundary conditions. The results on nonlinear materials – with voids in the microstructure – proved the robustness and effectiveness of the proposed MFEH.

@&#REFERENCES@&#

