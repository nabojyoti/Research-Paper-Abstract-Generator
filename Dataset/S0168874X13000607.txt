@&#MAIN-TITLE@&#Topology optimization of an acoustic metamaterial with negative bulk modulus using local resonance

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We propose a level set-based topology optimization to design acoustic metamaterials using the Finite Element Method.


                        
                        
                           
                           We formulate the optimization problem using effective material properties.


                        
                        
                           
                           A two-step optimization process enabled to handle the design of effective bulk modulus.


                        
                        
                           
                           In all examples we successfully obtain optimized shapes with negative bulk modulus.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Acoustic metamaterials

Negative bulk modulus

Topology optimization

Level set method

Adjoint variable method

Local resonator

@&#ABSTRACT@&#


               
               
                  During the past decade, materials that display novel properties in the acoustic realm, so-called acoustic metamaterials, have attracted much attention, since these properties can provide promising opportunities to design new acoustic devices that cannot be made with natural materials. Although acoustic metamaterials that exhibit negative mass density or negative bulk modulus, and double-negative acoustic metamaterials, have been obtained experimentally by trial and error, our aim is to develop a topology optimization method for the direct design of acoustic metamaterials, based on the concept of local resonant mechanisms, which ensures that the lattice constant is orders of magnitude functionally smaller than the corresponding sonic wavelength, and avoids unwanted effects of Bragg scattering mechanisms. This paper proposes a level set-based topology optimization method for the structural design of acoustic metamaterials that achieve an extremely negative bulk modulus at certain prescribed frequencies. Level set-based topology optimization methods can directly provide clear boundaries in optimal configurations that avoid the presence of grayscales. The optimization problem is formulated for a two-dimensional wave propagation problem, with the objective being to minimize the effective bulk modulus at chosen target frequencies. An effective medium description based on S-parameters is introduced to describe the acoustic metamaterial. Finite element method (FEM) is used to solve the Helmholtz equation for acoustic waves, sensitivities are obtained with the adjoint variable method (AVM), and a reaction-diffusion equation is used to update the level set function. Several numerical examples with prescribed target frequencies and different initial shapes are provided to demonstrate that the proposed method can provide clear, optimized structures for the design of negative bulk modulus acoustic metamaterials.
               
            

@&#INTRODUCTION@&#

Materials that can be artificially designed to exhibit special properties have recently generated intense discussion and interest, so-called metamaterials. Metamaterials are generally defined as artificially created composite materials with novel properties that emerge due to their structure, rather than the properties of the materials they are composed of. They initially gained attention in the field of electromagnetic (EM) wave propagation, with novel properties and behavior enabling the design of innovative devices not possible with naturally occurring substances. Research on metamaterials first began in 1967, when a Russian scholar, Viktor G. Veselago, proposed a daring and intriguing question concerning electromagnetic wave propagation in materials: what would happen if both the permittivity and permeability of a material were assumed to be negative [1,2]? It took roughly 30 years for researchers to treat this question seriously. After considerable theoretical and experimental efforts, Pendry et al. [3,4] and Smith et al. [5] were able to create artificial materials with negative permittivity and permeability, leading to observations of negative refractive indices. Thenceforward, research concerning the novel properties of metamaterials flourished and diverse applications have been explored and developed, including a superlens [6], waveguides [7], and electromagnetic cloaking [8].

In addition to the study of metamaterials subject to EM waves, materials that display analogous behavior in the acoustic realm have also been explored. Acoustic metamaterials are periodic structures, artificially designed to solve various acoustic problems of sound propagation. In this paper, we aim to design an acoustic metamaterial in which the effective bulk modulus is negative in the sense of an effectively homogeneous medium, by developing a new level set-based topology optimization method. Acoustic and electromagnetic waves are obviously different from the standpoint of their physical properties. Acoustic waves are full-vector waves, a combination of transverse and longitudinal waves, describable in terms of pressures and particle velocities, whereas both electric and magnetic waves are pure transverse waves. However, the two wave systems share certain physical concepts, such as wave vectors, wave impedance, and power flow, implying that approaches used to study electromagnetic metamaterials might also be effective in acoustic metamaterial research. Experience gained through initial investigations of electromagnetic metamaterials led to active research and development of acoustic metamaterials, especially from 2000, when Liu et al. fabricated sonic crystals [9]. In 2003, Sheng et al. also fabricated a microscopic composite which displayed localized sonic resonances at 350–2000Hz [10]. In 2004, split-ring resonators (SRRs) were explored in acoustic metamaterial research [11]. The first flat acoustic metamaterial lens, composed of a planar network of subwavelength Helmholtz resonators, was presented by Zhang et al. in 2009, with practical implications for high-resolution ultrasound imaging, non-destructive structural testing of buildings and bridges, and novel underwater stealth technology [12]. An acoustic cloak, a technology that renders underwater objects invisible to sonar and other ultrasound waves, was demonstrated by a team of Illinois researchers in 2011 [13]. In addition to the above research mainly dealing with experimental development of novel properties and applications, some research has focused on theoretical approaches, such as composites with inclusions having negative bulk modulus [14], modifications of Newton's second law to describe the motion of the bodies whose effective density is anisotropic [15], and the design of cloaking devices by manipulating conventional elastodynamic equations [16].

Prior to 2000, research on artificial materials used to control acoustic wave propagation started with phononic crystals, so-called sonic crystals that are artificial structures composed of a periodic array of acoustic scatterers embedded in a homogeneous matrix material. Such materials are analogs of photonic crystals. The lattice constant of such materials is comparable to the wavelength, as described in Bragg scattering theory, so the crystals are too large to function in real-world examples. As mentioned above, Liu et al. overcame this obstacle and pioneered the use of localized resonant mechanisms by fabricating a new type of composite, based on 5mm diameter lead spheres coated with silicone rubber, which behaved as a material with a negative longitudinal elastic modulus and exhibited large elastic wave band gaps in certain sonic frequency ranges. Later, Movchan et al. presented an asymptotic analysis of a periodic structure composed of split-ring resonators, to control low-frequency bandgaps [17]. Hirsekorn performed numerical local interaction simulations of a locally resonant sonic crystal composed of an array of silicone rubber-coated hollow steel cylinders embedded in an epoxy matrix, which exhibited several strong attenuation bands at frequencies between 0.3 and 6.0kHz [18]. Inspired by Liu et al., Zhou et al. further proposed two composites based on different materials, to examine the physical mechanisms of elastic metamaterials with local resonances [19]. Lazarov and Jensen studied wave propagation in a one-dimensional spring-mass system with attached local oscillators, with a bandgap located near the resonant frequency of the oscillators [20]. And Huang et al. presented a one-dimensional mass-in-mass lattice model to illustrate their method of designing an acoustic metamaterial based on local resonance [21].

After 2000, research on acoustic metamaterials entered a new stage due to an investigation of locally resonant sonic materials by Liu et al., who coated dense metal spheres with soft silicone rubber and encased these in epoxy resin [9]. The resulting metamaterial exhibited strong sound attenuation band gaps in particular sonic frequency ranges, and additionally, the new created structure had a lattice constant an order of magnitude functionally smaller than the corresponding sonic wavelength in air, in contrast to conventional composites that have much larger lattice constants that arise due to Bragg scattering [22]. Moreover, the comparatively minuscule size of the functional components in these acoustic metamaterials enabled numerical analysis using effective parameters.

Similar to electromagnetic metamaterials built from arrays of small structures, acoustic metamaterials are typically constructed as periodic arrays of acoustically scattering elements embedded in a homogeneous matrix material, with a periodicity that is considerably smaller than the wavelength of the local region (inclusion and background). For analysis, it is meaningful and valid to replace the entire composite by an effective medium. Following this practice, the acoustic metamaterial can be dealt with as a whole rather than as a collection of different components. To date, several methods have been proposed for the extraction of the effective parameters. Fang et al. calculated the effective modulus by building an ultrasonic metamaterial composed of resonators, an analog to an inductor-capacitor circuit [23]. Sheng derived formulas for effective parameters using the coherent potential approximation method [24]. Li et al. extracted the effective surface impedance by using the half-space reflection amplitude [25]. The effective mass density and effective bulk modulus can be easily obtained from the effective impedance. Additionally, reflection and transmission coefficients are also helpful and widely used to compute the effective material properties of acoustic metamaterials. Fokin et al. developed a method for extracting the effective material properties of acoustic metamaterials using reflection and transmission coefficients, and discussed the details of this method, including the sign selection of the refractive index and impedance, and the correct branch number of the real part of the refractive index [26].

Here, we develop a topology optimization numerical method, a structural optimization method that determines design features such as the number, location, and shape of holes in a structure. Among structural optimization approaches, topology optimization offers the highest degree of design freedom, in addition to high levels of performance, since the topology as well as the shape of target structures can be evolved during the optimization process. In topology optimization methods, the optimization problem is replaced by a material distribution problem within a fixed design domain. The fundamental engineered approach was initially proposed by Bendsøe and Kikuchi [27] and Bendsøe [28]. The material distribution method in topology optimization has been examined in a large number of examples, for acoustic problems [29–31], fluid problems [32], electromagnetic problems [33], and for electromagnetic metamaterials [34], in which Diaz and Sigmund presented a topology optimization method for the design of metamaterials with negative permeability. Topology optimization methods can efficiently generate optimal topologies and optimal shapes, facilitate the design of practical structures, and optimize support conditions. Moreover, topology optimization methods have proven to be flexible and reliable design tools. The methodology has, over the last two decades, become fairly widespread in industrial applications, especially among major car manufacturers [35]. But until now, no topology optimization method has been proposed for application to acoustic metamaterial design problems.

To enable topological changes in a structure during optimization, i.e., an increase or decrease in the number of holes, Bendsøe and Kikuchi [27] established a topology optimization methodology by introducing a characteristic function, first proposed by F. Murat and L. Tartar [36]. This characteristic function defined discrete values of 0 or 1 in an expanded fixed design domain that includes the original design domain, to delineate an optimal structure. However, since the function is defined according to discrete values in infinitely small domains, discontinuity is a significant problem; in other words, the design problem becomes ill-posed. To solve this problem, the discontinuous function must be replaced by a continuous one; that is, the design domain must be relaxed. To conduct this relaxation mathematically, relaxation methods based on the homogenization method [27] and the density method [28] have been proposed, but these methods encounter problems of numerical instability, such as mesh dependency, so checkerboard patterns or grayscale areas often are included in optimal configurations, a consequence of intermediate density values between 0 and 1. Much work, including various proposed filtering schemes [37–40], has been done to deal with the problem of grayscales and provide optimized configurations that have clear boundaries.

Level set-based topology optimization methods can directly provide optimal configurations that do not include grayscales. Wei et al. adopted and updated a level set-based method to obtain sharp corners and clear boundaries [41]. Additionally, level set-based topology optimization methods can avoid distortion of the mesh used in finite element analysis that can be problematic in regular shape optimization methods. In this paper, we adopt a level set-based method for acoustic metamaterial design problems, where the level set function is updated based on a reaction-diffusion equation developed by Yamada et al. [42], rather than using an updating scheme based on the Hamilton-Jacobi equation [43,44]. This level set-based topology optimization method has been successfully applied to a range of material and structural problems, including minimum mean compliance problems, the optimum design of compliant mechanisms, lowest eigenfrequency maximization problems, heat diffusion maximization, and electromagnetic wave propagation. Recently, this level set-based method was successfully applied to design electromagnetic metamaterials [45], who applied it to the design of dielectric metamaterials. Here, a level set-based topology optimization method incorporating a fictitious interface energy derived from the phase field concept is applied to the design of acoustic metamaterials for the first time.

In the following sections, we present a level set-based topology optimization method for the design of an acoustic metamaterial that achieves a negative bulk modulus, which may lead to interesting applications. First, several essential theories are introduced and the optimization problem is formulated in Section 2. The numerical implementation pertaining to the design variables for the acoustic problem and the optimization flowchart are presented in Section 3. In Section 4, to demonstrate the feasibility of the proposed method, we present several numerical examples that deal with different target frequencies and initial configurations. The final section sums up the results and provides conclusions.

Suppose that 
                           p
                         is the acoustic pressure, regarded as the state variable of the governing equation, 
                           ρ
                         is the mass density, and 
                           K
                         is the bulk modulus. The Helmholtz equation is adopted as the governing equation for acoustic wave propagation in a single unit cell, 
                           Ω
                        , under the assumption that only compressional waves are considered and that the problem is two-dimensional (2D), as follows:
                           
                              (1)
                              
                                 ∇
                                 ⋅
                                 (
                                 
                                    
                                       ρ
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 ∇
                                 p
                                 )
                                 +
                                 
                                    
                                       ω
                                    
                                    2
                                 
                                 
                                    
                                       K
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 p
                                 =
                                 0
                              
                           
                        
                     


                        
                        Fig. 1 shows the analysis model, including the design domain and boundary settings. We defined the design domain to have two parts, i.e., a fixed design domain D and a non-design domain (void areas surrounding D), to simplify the sensitivity analysis, as discussed in subsection 3.1. As shown, this design problem is limited to a row of unit cells, with a single cell in the x direction and the periodic array of the metamaterial extending in the y direction. A longitudinal acoustic incident wave propagates in the direction normal to the left cell face, 
                           
                              
                                 Γ
                              
                              
                                 1
                              
                           
                        , and the response is observed at the right boundary, indicated as 
                           
                              
                                 Γ
                              
                              
                                 4
                              
                           
                        . Both 
                           
                              
                                 Γ
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 Γ
                              
                              
                                 4
                              
                           
                         have radiation boundary conditions imposed, with unit pressure and minimal reflection, respectively. The upper and lower boundaries, 
                           
                              
                                 Γ
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 Γ
                              
                              
                                 3
                              
                           
                        , are set as periodic boundary conditions.

The boundary conditions are described by equations as follows:
                           
                              (2)
                              
                                 {
                                 
                                    
                                       
                                          
                                             
                                                n
                                                ⋅
                                                (
                                                
                                                   
                                                      ρ
                                                   
                                                   
                                                      -
                                                      1
                                                   
                                                
                                                ∇
                                                p
                                                )
                                                =
                                                2
                                                i
                                                k
                                                
                                                   
                                                      ρ
                                                   
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   
                                                      p
                                                   
                                                   i
                                                
                                                −
                                                i
                                                k
                                                
                                                   
                                                      ρ
                                                   
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                p
                                             
                                          
                                          
                                             
                                                on
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      Γ
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                n
                                                ⋅
                                                (
                                                
                                                   
                                                      ρ
                                                   
                                                   
                                                      -
                                                      1
                                                   
                                                
                                                ∇
                                                p
                                                )
                                                =
                                                −
                                                i
                                                k
                                                
                                                   
                                                      ρ
                                                   
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                p
                                             
                                          
                                          
                                             
                                                on
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      Γ
                                                   
                                                   
                                                      4
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                p
                                                
                                                   
                                                      |
                                                   
                                                   
                                                      
                                                         
                                                            Γ
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                =
                                                p
                                                
                                                   
                                                      |
                                                   
                                                   
                                                      
                                                         
                                                            Γ
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                on
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      Γ
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      Γ
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           n
                         is the normal vector, 
                           k
                         is the wave number, 
                           i
                         is an imaginary unit and 
                           
                              
                                 p
                              
                              i
                           
                         is the pressure of the incident wave. By denoting p
                        ⁎ as the adjoint variable corresponding to 
                           p
                        , the weak form of Eqs. (1) and (2) is then derived as follows:
                           
                              (3)
                              
                                 a
                                 (
                                 p
                                 ,
                                 
                                    
                                       p
                                    
                                    ⁎
                                 
                                 )
                                 =
                                 l
                                 (
                                 
                                    
                                       p
                                    
                                    ⁎
                                 
                                 )
                              
                           
                        where
                           
                              (4)
                              
                                 a
                                 (
                                 p
                                 ,
                                 
                                    
                                       p
                                    
                                    ⁎
                                 
                                 )
                                 =
                                 
                                    ∫
                                    Γ
                                 
                                 
                                    
                                       
                                          p
                                       
                                       ⁎
                                    
                                    i
                                    k
                                    
                                       
                                          ρ
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    p
                                 
                                 d
                                 Γ
                                 +
                                 
                                    ∫
                                    D
                                 
                                 
                                    (
                                    ∇
                                    
                                       
                                          p
                                       
                                       ⁎
                                    
                                    )
                                    ⋅
                                 
                                 (
                                 
                                    
                                       ρ
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 ∇
                                 p
                                 )
                                 d
                                 Ω
                                 −
                                 
                                    ∫
                                    D
                                 
                                 
                                    
                                       
                                          p
                                       
                                       ⁎
                                    
                                 
                                 
                                    
                                       ω
                                    
                                    2
                                 
                                 
                                    
                                       K
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 p
                                 d
                                 Ω
                              
                           
                        
                        
                           
                              (5)
                              
                                 l
                                 (
                                 
                                    
                                       p
                                    
                                    ⁎
                                 
                                 )
                                 =
                                 2
                                 i
                                 k
                                 
                                    ∫
                                    Γ
                                 
                                 
                                    
                                       
                                          ρ
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          p
                                       
                                       i
                                    
                                 
                                 
                                    
                                       p
                                    
                                    ⁎
                                 
                                 d
                                 Γ
                              
                           
                        
                     

As introduced in Section 1, several approaches can be applied to compute the effective properties. In this research, we use an S-parameter-based approach, first proposed [46] and later extended to inhomogeneous cases [47] by Smith et al. S-parameters, also called scattering parameters, were first used to describe the electrical behavior of linear electrical networks. Later, de Blok and van den Brink described how S-parameters can be effectively used when calculating the relationship between input and output in acoustic networks, based on an electronic network analogy [48]. The S-parameters here have the same physical meaning as the reflection and transmission coefficients in [26]. In a two-port system, 
                           
                              
                                 S
                              
                              
                                 11
                              
                           
                         and 
                           
                              
                                 S
                              
                              
                                 22
                              
                           
                         represent the input reflection coefficient and output reflection coefficient, respectively, analogous to the R coefficient. Similarly, 
                           
                              
                                 S
                              
                              
                                 21
                              
                           
                         represents the forward transmission coefficient, analogous to the T coefficient. Because we expect the optimal configuration after optimization to be symmetric about the y-axis, we use 
                           
                              
                                 S
                              
                              
                                 22
                              
                           
                         in addition to 
                           
                              
                                 S
                              
                              
                                 11
                              
                           
                        , and apply three S-parameters to guarantee that the result will be symmetrical. In Smith et al.'s approach, three S-parameters, 
                           
                              
                                 S
                              
                              
                                 11
                              
                           
                        , 
                           
                              
                                 S
                              
                              
                                 21
                              
                           
                        , and 
                           
                              
                                 S
                              
                              
                                 22
                              
                           
                        , were used. Sigmund [49] and Otomori et al. [45] successfully applied this approach to retrieve effective permeability values when designing dielectric metamaterials tailored for use at particular frequencies.

In our proposed method, 
                           
                              
                                 p
                              
                              i
                           
                         is the incident field, with 
                           
                              
                                 p
                              
                              
                                 i
                                 ⁎
                              
                           
                         as the complex conjugate transposition of 
                           
                              
                                 p
                              
                              i
                           
                        , the S-parameters are expressed as follows:
                           
                              (6)
                              
                                 
                                    
                                       S
                                    
                                    
                                       11
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∫
                                          
                                             
                                                
                                                   Γ
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          (
                                          p
                                          −
                                          
                                             
                                                p
                                             
                                             i
                                          
                                          )
                                       
                                       ⋅
                                       
                                          
                                             p
                                          
                                          
                                             i
                                             ⁎
                                          
                                       
                                       d
                                       Γ
                                    
                                    
                                       
                                          ∫
                                          
                                             
                                                
                                                   Γ
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                p
                                             
                                             i
                                          
                                          ⋅
                                          
                                             
                                                p
                                             
                                             
                                                i
                                                ⁎
                                             
                                          
                                       
                                       d
                                       Γ
                                    
                                 
                              
                           
                        
                        
                           
                              (7)
                              
                                 
                                    
                                       S
                                    
                                    
                                       21
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∫
                                          
                                             
                                                
                                                   Γ
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          p
                                          ⋅
                                          
                                             
                                                p
                                             
                                             
                                                i
                                                ⁎
                                             
                                          
                                       
                                       d
                                       Γ
                                    
                                    
                                       
                                          ∫
                                          
                                             
                                                
                                                   Γ
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                p
                                             
                                             i
                                          
                                          ⋅
                                          
                                             
                                                p
                                             
                                             
                                                i
                                                ⁎
                                             
                                          
                                       
                                       d
                                       Γ
                                    
                                 
                              
                           
                        
                        
                           
                              (8)
                              
                                 
                                    
                                       S
                                    
                                    
                                       22
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∫
                                          
                                             
                                                
                                                   Γ
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          (
                                          p
                                          −
                                          
                                             
                                                p
                                             
                                             i
                                          
                                          )
                                       
                                       ⋅
                                       
                                          
                                             p
                                          
                                          
                                             i
                                             ⁎
                                          
                                       
                                       d
                                       Γ
                                    
                                    
                                       
                                          ∫
                                          
                                             
                                                
                                                   Γ
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                p
                                             
                                             i
                                          
                                          ⋅
                                          
                                             
                                                p
                                             
                                             
                                                i
                                                ⁎
                                             
                                          
                                       
                                       d
                                       Γ
                                    
                                 
                              
                           
                        
                     

The relative impedance 
                           
                              
                                 z
                              
                              
                                 e
                              
                           
                         and refractive index 
                           n
                         are then derived as follows, using the S-parameters, based on the method of Fokin et al. [26].
                           
                              (9)
                              
                                 
                                    
                                       z
                                    
                                    
                                       e
                                    
                                 
                                 =
                                 ±
                                 
                                    
                                       
                                          
                                             (
                                             1
                                             +
                                             
                                                
                                                   S
                                                
                                                
                                                   11
                                                
                                             
                                             )
                                             (
                                             1
                                             +
                                             
                                                
                                                   S
                                                
                                                
                                                   22
                                                
                                             
                                             )
                                             −
                                             
                                                
                                                   S
                                                
                                                
                                                   21
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             (
                                             1
                                             −
                                             
                                                
                                                   S
                                                
                                                
                                                   11
                                                
                                             
                                             )
                                             (
                                             1
                                             −
                                             
                                                
                                                   S
                                                
                                                
                                                   22
                                                
                                             
                                             )
                                             −
                                             
                                                
                                                   S
                                                
                                                
                                                   21
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (10)
                              
                                 n
                                 =
                                 ±
                                 
                                    
                                       
                                          
                                             cos
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       (
                                       β
                                       /
                                       2
                                       
                                          
                                             S
                                          
                                          
                                             21
                                          
                                       
                                       )
                                    
                                    
                                       k
                                       d
                                    
                                 
                              
                           
                        
                        
                           
                              (11)
                              
                                 β
                                 =
                                 1
                                 −
                                 (
                                 
                                    
                                       S
                                    
                                    
                                       11
                                    
                                 
                                 
                                    
                                       S
                                    
                                    
                                       22
                                    
                                 
                                 −
                                 
                                    
                                       S
                                    
                                    
                                       21
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                           
                        where 
                           d
                         is the width of the unit cell.

Concerning sign selection in Eqs. (9) and (10), we impose additional requirements on the metamaterial properties. We aim to limit our designs to passive metamaterial structures that exhibit energy losses as acoustic waves are converted into other energy forms, and also exhibit strongly frequency-dependent properties, useful for narrow bandwidth applications. Thus the real part of the impedance 
                           
                              
                                 z
                              
                              
                                 e
                              
                           
                         is required to be positive. In addition, since the imaginary part of the speed of sound should be positive, the imaginary part of the refractive index n is required to be positive [50]. Thus, the requirements that determine the signs in Eqs. (9) and (10) are as follows:
                           
                              (12)
                              
                                 
                                    
                                       z
                                    
                                    
                                       e
                                    
                                    
                                       ′
                                    
                                 
                                 ≥
                                 0
                              
                           
                        
                        
                           
                              (13)
                              
                                 n
                                 ″
                                 ≥
                                 0
                              
                           
                        where 
                           (
                           ⋅
                           )
                           ′
                         and 
                           (
                           ⋅
                           )
                           ″
                         respectively denote the operators for real and imaginary parts of the parameters. Due to the differences between the physical and electromagnetic properties in a metamaterial, we need a specific expression for the effective bulk modulus K
                        
                           e
                         for the acoustic metamaterial, but the effective bulk modulus is also expressed by the effective impedance and refractive index, as is the effective permeability. A number of methods for deriving the effective material properties are discussed in the literature, two of which, have been widely used and are easily applied. In one approach, developed by Fokin et al. [26], the effective material properties of acoustic metamaterials were extracted using reflection and transmission coefficients, and details, including sign selection for the refractive index and impedance, and the correct branch number of the real part of the refractive index, were discussed, using two coefficients, R and T (corresponding to 
                           
                              
                                 S
                              
                              
                                 11
                              
                           
                         and 
                           
                              
                                 S
                              
                              
                                 21
                              
                           
                         in the current paper). We applied this method the compute the relative impedance 
                           
                              
                                 z
                              
                              
                                 e
                              
                           
                         and refractive index 
                           n
                         from S-parameters. The other approach, developed by Li et al. [25], can directly handle effective material properties and is applied here to compute the effective bulk modulus 
                           
                              
                                 K
                              
                              
                                 e
                              
                           
                         from 
                           
                              
                                 z
                              
                              
                                 e
                              
                           
                         and 
                           n
                        . We use three S-parameters to ensure that the obtained optimal configurations are symmetrical.


                        
                           
                              
                                 K
                              
                              
                                 0
                              
                           
                        , 
                           
                              
                                 ρ
                              
                              
                                 0
                              
                           
                        , and 
                           
                              
                                 c
                              
                              
                                 0
                              
                           
                         are respectively represented as the bulk modulus, mass density of the background material, and the speed of sound in the background material. Furthermore, the effective impedance in the fixed design domain and the acoustic impedance of the background material are respectively represented as 
                           
                              
                                 Z
                              
                              
                                 e
                              
                           
                           =
                           
                              
                                 z
                              
                              
                                 e
                              
                           
                           
                              
                                 Z
                              
                              
                                 0
                              
                           
                         and 
                           
                              
                                 Z
                              
                              
                                 0
                              
                           
                        . Then, the effective bulk modulus 
                           
                              
                                 K
                              
                              
                                 e
                              
                           
                         can then be computed based on three S-parameters, using the following equation:
                           
                              (14)
                              
                                 
                                    
                                       K
                                    
                                    
                                       e
                                    
                                 
                                 =
                                 
                                    
                                       Z
                                    
                                    
                                       e
                                    
                                 
                                 
                                    
                                       K
                                    
                                    
                                       0
                                    
                                 
                                 /
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       0
                                    
                                 
                                 n
                                 
                                    
                                       ρ
                                    
                                    
                                       0
                                    
                                 
                                 )
                              
                           
                        
                     

Although acoustic metamaterials are regarded as acoustic counterparts of electromagnetic metamaterials, there are nevertheless certain differences that must be taken into account in the design of these two metamaterials. While electromagnetic metamaterials can be engineered by achieving negative permeability, this property is also observed in certain natural materials. For an acoustic metamaterial, however, since no natural material exhibits negative mass density or negative bulk modulus, these properties must be achieved artificially. Physically, a negative mass density implies that force and movement vectors are expressed in opposite directions, and a negative bulk modulus implies that a medium expands in response to compressive forces at a certain frequency.

In this paper, we formulate the optimization problem so that the real part of the effective bulk modulus is extremely negative at a certain frequency, to achieve an acoustic metamaterial that has novel properties. A single negative property (negative bulk modulus or negative mass density) also can be effective in certain applications, such as achieving an acoustic bandgap (applied for sound barrier etc.) and superlens designs [23]. To obtain this condition through an optimization procedure, the objective of the optimization problem is formulated to find a material distribution within the fixed design domain that minimizes the real part of the effective bulk modulus at a desired frequency. 
                        Fig. 2 shows one example of a typical effective bulk modulus curve, where ‘Real’ and ‘Imag’ represent the real and imaginary parts of the effective bulk modulus, respectively. The figure illustrates that the real part of the effective bulk modulus has values that include a positive peak as well as a dip below zero, while the imaginary part of the effective bulk modulus is singly convex. Thus, the desired condition of negative bulk modulus is reflected in the dip of the real part of the effective bulk modulus, where its value is less than zero. Considering the different characteristics of the effective bulk modulus curve, if we attempt to directly minimize the real part of the effective bulk modulus when the positive peak lies between the initial dip and the target frequency, an optimized configuration cannot be obtained because the level set function must be updated to a smaller value of the objective function compared with that of the previous iteration. Take Fig. 2 as an example, if the initial peak lies between the target frequency and the dip, say 
                           
                              
                                 f
                              
                              
                                 2
                              
                           
                         as the target frequency in Fig. 2, when we attempt to directly minimize the real part of the effective bulk modulus, the optimization will fail or take an excessively long time to find the desired value. Consequently, the curve of the real part of the effective bulk modulus will be displaced toward the left as a whole because the level set function must be updated to a smaller value of the objective function compared with that of the previous iteration. There is another case that the initial dip in the real part of the effective bulk modulus line lies between the target frequency and the positive peak, for example, if the target frequency were 
                           
                              
                                 f
                              
                              
                                 1
                              
                           
                         in Fig. 2, the optimization process could be simplified to minimize the real part of the effective bulk modulus directly in a single step. To allow for all of these possibilities, we employ two-step optimization procedure in which the optimization is conducted in two steps, was also successfully applied for the design of dielectric metamaterials with negative permeability [45,49].

We denote 
                           F
                         as the objective functional, 
                           G
                         the volume constraint functional of the optimization problem, and 
                           
                              
                                 K
                              
                              
                                 e
                              
                              
                                 ″
                              
                           
                         the imaginary part of the effective bulk modulus. In the first step of the optimization procedure, the imaginary part of the effective bulk modulus is minimized:
                           
                              (15)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   inf
                                                
                                                ϕ
                                             
                                          
                                       
                                       
                                          
                                             F
                                             =
                                             
                                                
                                                   K
                                                
                                                
                                                   e
                                                
                                                
                                                   ″
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             subject
                                             
                                             to
                                          
                                       
                                       
                                          
                                             G
                                             =
                                             ∫
                                             
                                                d
                                                Ω
                                                −
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      max
                                                   
                                                
                                                ≤
                                                0
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             Governing
                                             
                                             equation
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             Boundary
                                             
                                             conditions
                                          
                                       
                                    
                                 
                              
                           
                        
                     

After the first step, the obtained results are used as the initial shape for the second step of the optimization procedure, whose objective is to minimize the real part of the effective bulk modulus 
                           
                              
                                 K
                              
                              
                                 e
                              
                              
                                 ″
                              
                           
                        :
                           
                              (16)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   inf
                                                
                                                ϕ
                                             
                                          
                                       
                                       
                                          
                                             F
                                             =
                                             
                                                
                                                   K
                                                
                                                
                                                   e
                                                
                                                
                                                   ″
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             subject
                                             
                                             to
                                          
                                       
                                       
                                          
                                             G
                                             =
                                             ∫
                                             
                                                d
                                                Ω
                                                −
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      max
                                                   
                                                
                                                ≤
                                                0
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             Governing
                                             
                                             equation
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             Boundary
                                             
                                             conditions
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Level set methods employ numerical techniques that are used to track moving interfaces, by intersecting the level set function 
                           ϕ
                           (
                           x
                           )
                         at zero height, with the isocontours of the level set function introduced to implicitly represent the boundary 
                           ∂
                           Ω
                         between the material and the void domains that expresses the structural shape. In this study, we employ an improved level set-based topology optimization method that uses a fictitious interface energy, based on the phase field model [42], which is a combination of topology optimization and the level set method. Suppose that 
                           D
                         is the fixed design domain and 
                           Ω
                         is a material part in the fixed design domain. A void domain in the fixed design domain is then denoted as 
                           D
                           ⧹
                           Ω
                        . The formulation of this method is as follows:
                           
                              (17)
                              
                                 {
                                 
                                    
                                       
                                          
                                             
                                                0
                                                <
                                                ϕ
                                                (
                                                x
                                                )
                                                ≤
                                                1
                                             
                                          
                                          
                                             
                                                if
                                             
                                          
                                          
                                             
                                                ∀
                                                x
                                                ∈
                                                Ω
                                                ⧹
                                                ∂
                                                Ω
                                             
                                          
                                       
                                       
                                          
                                             
                                                ϕ
                                                (
                                                x
                                                )
                                                =
                                                0
                                             
                                          
                                          
                                             
                                                if
                                             
                                          
                                          
                                             
                                                ∀
                                                x
                                                ∈
                                                ∂
                                                Ω
                                             
                                          
                                       
                                       
                                          
                                             
                                                −
                                                1
                                                ≤
                                                ϕ
                                                (
                                                x
                                                )
                                                <
                                                0
                                             
                                          
                                          
                                             
                                                if
                                             
                                          
                                          
                                             
                                                ∀
                                                x
                                                ∈
                                                D
                                                ⧹
                                                Ω
                                             
                                          
                                       
                                    
                                 
                              
                           
                        The characteristic function 
                           
                              
                                 χ
                              
                              
                                 ϕ
                              
                           
                           (
                           ϕ
                           )
                         is defined by
                           
                              (18)
                              
                                 
                                    
                                       χ
                                    
                                    
                                       ϕ
                                    
                                 
                                 (
                                 ϕ
                                 )
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                1
                                             
                                             
                                                
                                                   if
                                                
                                             
                                             
                                                
                                                   ϕ
                                                   ≥
                                                   0
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                
                                                   if
                                                
                                             
                                             
                                                
                                                   ϕ
                                                   <
                                                   0
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The above structural optimization problem is replaced by a material distribution problem, and we formulate the structural optimization problem that minimizes the objective functional F subject to a volume constraint G as follows, in which f is a density function of the objective functional and 
                           
                              
                                 V
                              
                              
                                 max
                              
                           
                         is the upper limit of the volume constraint.
                           
                              (19)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   inf
                                                
                                                ϕ
                                             
                                          
                                       
                                       
                                          
                                             F
                                             (
                                             
                                                
                                                   χ
                                                
                                                
                                                   ϕ
                                                
                                             
                                             (
                                             ϕ
                                             )
                                             )
                                             =
                                             
                                                ∫
                                                D
                                             
                                             
                                                f
                                                (
                                                x
                                                )
                                                
                                                   
                                                      χ
                                                   
                                                   
                                                      ϕ
                                                   
                                                
                                                (
                                                ϕ
                                                (
                                                x
                                                )
                                                )
                                                d
                                                Ω
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             subject
                                             
                                             to
                                          
                                       
                                       
                                          
                                             G
                                             (
                                             
                                                
                                                   χ
                                                
                                                
                                                   ϕ
                                                
                                             
                                             (
                                             ϕ
                                             )
                                             )
                                             =
                                             
                                                ∫
                                                D
                                             
                                             
                                                
                                                   
                                                      χ
                                                   
                                                   
                                                      ϕ
                                                   
                                                
                                                (
                                                ϕ
                                                (
                                                x
                                                )
                                                )
                                                d
                                                Ω
                                             
                                             −
                                             
                                                
                                                   V
                                                
                                                
                                                   max
                                                
                                             
                                             ≤
                                             0
                                          
                                       
                                    
                                 
                              
                           
                        
                     

However, the above formulation is an ill-posed problem, due to the discontinuity of the level set function in the fixed design domain, so we regularize the optimization problem using the Tikhonov regularization method [42]. The original optimization problem is therefore replaced with an energy minimization problem, namely, minimization of the sum of the original objective function and the fictitious interface energy. Let 
                           
                              
                                 F
                              
                              
                                 R
                              
                           
                         be the regularized objective functional and 
                           τ
                         be a regularization parameter that represents the extent of the regularization. The optimization problem is then regularized as follows:
                           
                              (20)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   inf
                                                
                                                ϕ
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   F
                                                
                                                
                                                   R
                                                
                                             
                                             (
                                             
                                                
                                                   χ
                                                
                                                
                                                   ϕ
                                                
                                             
                                             (
                                             ϕ
                                             )
                                             )
                                             =
                                             
                                                ∫
                                                D
                                             
                                             
                                                f
                                                (
                                                x
                                                )
                                                
                                                   
                                                      χ
                                                   
                                                   
                                                      ϕ
                                                   
                                                
                                                (
                                                ϕ
                                                (
                                                x
                                                )
                                                )
                                                d
                                                Ω
                                             
                                             +
                                             
                                                ∫
                                                D
                                             
                                             
                                                
                                                   1
                                                   2
                                                
                                                τ
                                                |
                                                ∇
                                                ϕ
                                                
                                                   
                                                      |
                                                   
                                                   2
                                                
                                                d
                                                Ω
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             subject
                                             
                                             to
                                          
                                       
                                       
                                          
                                             G
                                             (
                                             
                                                
                                                   χ
                                                
                                                
                                                   ϕ
                                                
                                             
                                             (
                                             ϕ
                                             )
                                             )
                                             =
                                             
                                                ∫
                                                D
                                             
                                             
                                                
                                                   
                                                      χ
                                                   
                                                   
                                                      ϕ
                                                   
                                                
                                                (
                                                ϕ
                                                (
                                                x
                                                )
                                                )
                                                d
                                                Ω
                                             
                                             −
                                             
                                                
                                                   V
                                                
                                                
                                                   max
                                                
                                             
                                             ≤
                                             0
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Next, the optimization problem is reformulated, using Lagrange's method of undetermined multipliers, without constraints. Suppose that 
                           
                              
                                 F
                              
                              
                                 R
                              
                           
                         is the regularized Lagrangian and that 
                           λ
                         is the Lagrange multiplier of the volume constraint.
                           
                              (21)
                              
                                 
                                    
                                       inf
                                    
                                    ϕ
                                 
                                 
                                 
                                 
                                 
                                    
                                       
                                          F
                                          ¯
                                       
                                    
                                    
                                       R
                                    
                                 
                                 (
                                 
                                    
                                       χ
                                    
                                    
                                       ϕ
                                    
                                 
                                 (
                                 ϕ
                                 )
                                 )
                                 =
                                 
                                    ∫
                                    D
                                 
                                 
                                    f
                                    (
                                    x
                                    )
                                    
                                       
                                          χ
                                       
                                       
                                          ϕ
                                       
                                    
                                    (
                                    ϕ
                                    (
                                    x
                                    )
                                    )
                                    d
                                    Ω
                                 
                                 +
                                 λ
                                 G
                                 +
                                 
                                    ∫
                                    D
                                 
                                 
                                    
                                       1
                                       2
                                    
                                    τ
                                    |
                                    ∇
                                    ϕ
                                    
                                       
                                          |
                                       
                                       2
                                    
                                    d
                                    Ω
                                 
                              
                           
                        Now, the KKT-conditions for the above problem are derived by making 
                           〈
                           d
                           
                              
                                 
                                    F
                                    ¯
                                 
                              
                              
                                 R
                              
                           
                           (
                           
                              
                                 χ
                              
                              
                                 ϕ
                              
                           
                           (
                           ϕ
                           )
                           )
                           /
                           d
                           ϕ
                           〉
                         represent the Fréchet differential of the regularized Lagrangian 
                           
                              
                                 
                                    F
                                    ¯
                                 
                              
                              
                                 R
                              
                           
                         with respect to 
                           ϕ
                         in the direction of 
                           Φ
                        , as follows:
                           
                              (22)
                              
                                 
                                    〈
                                    
                                       
                                          
                                             d
                                             
                                                
                                                   
                                                      F
                                                      ¯
                                                   
                                                
                                                
                                                   R
                                                
                                             
                                             (
                                             
                                                
                                                   χ
                                                
                                                
                                                   ϕ
                                                
                                             
                                             (
                                             ϕ
                                             )
                                             )
                                          
                                          
                                             d
                                             ϕ
                                          
                                       
                                       ,
                                       Φ
                                    
                                    〉
                                 
                                 =
                                 0
                                 ,
                                 λ
                                 G
                                 (
                                 
                                    
                                       χ
                                    
                                    
                                       ϕ
                                    
                                 
                                 (
                                 ϕ
                                 )
                                 )
                                 =
                                 0
                                 ,
                                 λ
                                 ≥
                                 0
                                 ,
                                 G
                                 ≥
                                 0
                              
                           
                        
                     

To find a solution to this level set function, which represents an optimized configuration, the KKT-conditions are derived, but solving them directly is impossible, so the optimization problem is replaced by a time evolutional problem, as follows. By introducing a fictitious time t and assuming that the variation of the level set function with respect to t is proportional to the gradient of the regularized Lagrangian 
                           
                              
                                 F
                              
                              
                                 R
                              
                           
                        , we have
                           
                              (23)
                              
                                 
                                    
                                       ∂
                                       ϕ
                                    
                                    
                                       ∂
                                       t
                                    
                                 
                                 =
                                 −
                                 K
                                 (
                                 ϕ
                                 )
                                 
                                    
                                       d
                                       
                                          
                                             
                                                F
                                                ¯
                                             
                                          
                                          
                                             R
                                          
                                       
                                    
                                    
                                       d
                                       ϕ
                                    
                                 
                              
                           
                        where 
                           K
                           (
                           ϕ
                           )
                           >
                           0
                         is a coefficient of proportionality. We note that the derivative of 
                           
                              
                                 
                                    F
                                    ¯
                                 
                              
                              
                                 R
                              
                           
                         with respect to 
                           ϕ
                         is equivalent to its topological derivative, 
                           d
                           
                              F
                              ¯
                           
                           (
                           
                              
                                 χ
                              
                              
                                 ϕ
                              
                           
                           )
                           /
                           d
                           
                              
                                 χ
                              
                              
                                 ϕ
                              
                           
                        . Finally, the variation of the level set function used to obtain the optimized configuration can be replaced by the derivative of Lagrangian 
                           d
                           
                              F
                              ¯
                           
                           (
                           
                              
                                 χ
                              
                              
                                 ϕ
                              
                           
                           )
                           /
                           d
                           
                              
                                 χ
                              
                              
                                 ϕ
                              
                           
                        , so that the time evolutionary equation, i.e., the reaction-diffusion equation with boundary conditions, is obtained as follows:
                           
                              (24)
                              
                                 {
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∂
                                                      ϕ
                                                   
                                                   
                                                      ∂
                                                      t
                                                   
                                                
                                                =
                                                −
                                                K
                                                (
                                                ϕ
                                                )
                                                
                                                   (
                                                   
                                                      −
                                                      
                                                         
                                                            d
                                                            
                                                               F
                                                               ¯
                                                            
                                                            (
                                                            
                                                               
                                                                  χ
                                                               
                                                               
                                                                  ϕ
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                            d
                                                            
                                                               
                                                                  χ
                                                               
                                                               
                                                                  ϕ
                                                               
                                                            
                                                         
                                                      
                                                      −
                                                      τ
                                                      
                                                         
                                                            ∇
                                                         
                                                         2
                                                      
                                                      ϕ
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                in
                                             
                                          
                                          
                                             
                                                ∂
                                                D
                                                ⧹
                                                ∂
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      N
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      ∂
                                                      ϕ
                                                   
                                                   
                                                      ∂
                                                      n
                                                   
                                                
                                                =
                                                0
                                             
                                          
                                          
                                             
                                                on
                                             
                                          
                                          
                                             
                                                ∂
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      N
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                ϕ
                                                =
                                                1
                                             
                                          
                                          
                                             
                                                on
                                             
                                          
                                          
                                             D
                                          
                                       
                                    
                                 
                              
                           
                        
                     

We use the adjoint variable method (AVM) for the sensitivity analysis of the effective bulk modulus minimization problem. With p⁎
                         as the adjoint variable with respect to S
                        
                           ij
                        , the Lagrangian of the optimization problem is
                           
                              (25)
                              
                                 
                                    F
                                    ¯
                                 
                                 =
                                 F
                                 −
                                 
                                    
                                       ∑
                                       
                                          i
                                          j
                                          =
                                          11
                                          ,
                                          21
                                          ,
                                          22
                                       
                                    
                                    
                                       
                                          
                                             α
                                          
                                          
                                             i
                                             j
                                          
                                       
                                    
                                 
                                 [
                                 a
                                 (
                                 p
                                 ,
                                 
                                    
                                       p
                                    
                                    ⁎
                                 
                                 )
                                 −
                                 l
                                 (
                                 
                                    
                                       p
                                    
                                    ⁎
                                 
                                 )
                                 ]
                                 +
                                 λ
                                 G
                              
                           
                        
                     

The evolution of the optimized structure boundary is conducted by updating the level set function based on the variation of the Lagrangian, using a reaction diffusion equation. The variation of the Lagrangian is obtained by the AVM as follows:
                           
                              (26)
                              
                                 
                                    〈
                                    
                                       
                                          
                                             d
                                             
                                                F
                                                ¯
                                             
                                          
                                          
                                             d
                                             
                                                
                                                   χ
                                                
                                                
                                                   ϕ
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                χ
                                             
                                             
                                                ϕ
                                             
                                          
                                          ⁎
                                       
                                    
                                    〉
                                 
                                 =
                                 
                                    
                                       ∑
                                       
                                          i
                                          j
                                          =
                                          11
                                          ,
                                          21
                                          ,
                                          22
                                       
                                    
                                    
                                       〈
                                       
                                          
                                             
                                                ∂
                                                F
                                             
                                             
                                                ∂
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      i
                                                      j
                                                   
                                                
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   S
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             ⁎
                                          
                                       
                                       〉
                                    
                                 
                                 
                                    〈
                                    
                                       
                                          
                                             ∂
                                             
                                                
                                                   S
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                          
                                          
                                             ∂
                                             p
                                          
                                       
                                       ,
                                       
                                          
                                             p
                                          
                                          ⁎
                                       
                                    
                                    〉
                                 
                                 
                                    〈
                                    
                                       
                                          
                                             ∂
                                             p
                                          
                                          
                                             ∂
                                             
                                                
                                                   χ
                                                
                                                
                                                   ϕ
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                χ
                                             
                                             
                                                ϕ
                                             
                                          
                                          ⁎
                                       
                                    
                                    〉
                                 
                                 −
                                 
                                    
                                       ∑
                                       
                                          i
                                          j
                                          =
                                          11
                                          ,
                                          21
                                          ,
                                          22
                                       
                                    
                                    
                                       
                                          
                                             α
                                          
                                          
                                             i
                                             j
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          〈
                                          
                                             
                                                
                                                   ∂
                                                   a
                                                
                                                
                                                   ∂
                                                   p
                                                
                                             
                                             ,
                                             
                                                
                                                   p
                                                
                                                ⁎
                                             
                                          
                                          〉
                                       
                                       
                                          〈
                                          
                                             
                                                
                                                   ∂
                                                   p
                                                
                                                
                                                   ∂
                                                   
                                                      
                                                         χ
                                                      
                                                      
                                                         ϕ
                                                      
                                                   
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      χ
                                                   
                                                   
                                                      ϕ
                                                   
                                                
                                                ⁎
                                             
                                          
                                          〉
                                       
                                       +
                                       
                                          〈
                                          
                                             
                                                
                                                   ∂
                                                   a
                                                
                                                
                                                   ∂
                                                   
                                                      
                                                         χ
                                                      
                                                      
                                                         ϕ
                                                      
                                                   
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      χ
                                                   
                                                   
                                                      ϕ
                                                   
                                                
                                                ⁎
                                             
                                          
                                          〉
                                       
                                    
                                    )
                                 
                                 +
                                 λ
                                 
                                    〈
                                    
                                       
                                          
                                             ∂
                                             G
                                          
                                          
                                             ∂
                                             
                                                
                                                   χ
                                                
                                                
                                                   ϕ
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                χ
                                             
                                             
                                                ϕ
                                             
                                          
                                          ⁎
                                       
                                    
                                    〉
                                 
                              
                           
                        where 
                           d
                           
                              F
                              ¯
                           
                           /
                           d
                           
                              
                                 χ
                              
                              
                                 ϕ
                              
                           
                         is the Fréchet differential of the Lagrangian with respect to the characteristic function.

In order to cancel out the 
                           〈
                           ∂
                           p
                           /
                           ∂
                           
                              
                                 χ
                              
                              
                                 ϕ
                              
                           
                           ,
                           
                              
                                 
                                    χ
                                 
                                 
                                    ϕ
                                 
                              
                              ⁎
                           
                           〉
                         term, we make 
                           
                              
                                 α
                              
                              
                                 i
                                 j
                              
                           
                           =
                           〈
                           ∂
                           F
                           /
                           ∂
                           
                              
                                 S
                              
                              
                                 i
                                 j
                              
                           
                           ,
                           
                              
                                 
                                    S
                                 
                                 
                                    i
                                    j
                                 
                              
                              ⁎
                           
                           〉
                        . Rewriting Eq. (26), we have
                           
                              (27)
                              
                                 
                                    〈
                                    
                                       
                                          
                                             d
                                             
                                                F
                                                ¯
                                             
                                          
                                          
                                             d
                                             
                                                
                                                   χ
                                                
                                                
                                                   ϕ
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                χ
                                             
                                             
                                                ϕ
                                             
                                          
                                          ⁎
                                       
                                    
                                    〉
                                 
                                 =
                                 
                                    
                                       ∑
                                       
                                          i
                                          j
                                          =
                                          11
                                          ,
                                          21
                                          ,
                                          22
                                       
                                    
                                    
                                       〈
                                       
                                          
                                             
                                                ∂
                                                F
                                             
                                             
                                                ∂
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      i
                                                      j
                                                   
                                                
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   S
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             ⁎
                                          
                                       
                                       〉
                                    
                                 
                                 
                                    (
                                    
                                       
                                          〈
                                          
                                             
                                                
                                                   ∂
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                
                                                
                                                   ∂
                                                   p
                                                
                                             
                                             ,
                                             
                                                
                                                   p
                                                
                                                ⁎
                                             
                                          
                                          〉
                                       
                                       −
                                       
                                          〈
                                          
                                             
                                                
                                                   ∂
                                                   a
                                                
                                                
                                                   ∂
                                                   p
                                                
                                             
                                             ,
                                             
                                                
                                                   p
                                                
                                                ⁎
                                             
                                          
                                          〉
                                       
                                    
                                    )
                                 
                                 
                                    〈
                                    
                                       
                                          
                                             ∂
                                             p
                                          
                                          
                                             ∂
                                             
                                                
                                                   χ
                                                
                                                
                                                   ϕ
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                χ
                                             
                                             
                                                ϕ
                                             
                                          
                                          ⁎
                                       
                                    
                                    〉
                                 
                                 −
                                 
                                    
                                       ∑
                                       
                                          i
                                          j
                                          =
                                          11
                                          ,
                                          21
                                          ,
                                          22
                                       
                                    
                                    
                                       〈
                                       
                                          
                                             
                                                ∂
                                                F
                                             
                                             
                                                ∂
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      i
                                                      j
                                                   
                                                
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   S
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             ⁎
                                          
                                       
                                       〉
                                    
                                 
                                 
                                    〈
                                    
                                       
                                          
                                             ∂
                                             a
                                          
                                          
                                             ∂
                                             
                                                
                                                   χ
                                                
                                                
                                                   ϕ
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                χ
                                             
                                             
                                                ϕ
                                             
                                          
                                          ⁎
                                       
                                    
                                    〉
                                 
                                 +
                                 λ
                                 
                                    〈
                                    
                                       
                                          
                                             ∂
                                             G
                                          
                                          
                                             ∂
                                             
                                                
                                                   χ
                                                
                                                
                                                   ϕ
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                χ
                                             
                                             
                                                ϕ
                                             
                                          
                                          ⁎
                                       
                                    
                                    〉
                                 
                              
                           
                        To obtain the solution for p⁎, we solve the following equation:
                           
                              (28)
                              
                                 a
                                 (
                                 p
                                 ,
                                 
                                    
                                       p
                                    
                                    ⁎
                                 
                                 )
                                 =
                                 
                                    
                                       S
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 (
                                 p
                                 )
                              
                           
                        Finally, the variation of the Lagrangian is calculated using the following equation:
                           
                              (29)
                              
                                 
                                    〈
                                    
                                       
                                          
                                             d
                                             
                                                F
                                                ¯
                                             
                                          
                                          
                                             d
                                             
                                                
                                                   χ
                                                
                                                
                                                   ϕ
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                χ
                                             
                                             
                                                ϕ
                                             
                                          
                                          ⁎
                                       
                                    
                                    〉
                                 
                                 =
                                 −
                                 
                                    
                                       ∑
                                       
                                          i
                                          j
                                          =
                                          11
                                          ,
                                          21
                                          ,
                                          22
                                       
                                    
                                    
                                       〈
                                       
                                          
                                             
                                                ∂
                                                F
                                             
                                             
                                                ∂
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      i
                                                      j
                                                   
                                                
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   S
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             ⁎
                                          
                                       
                                       〉
                                    
                                 
                                 
                                    〈
                                    
                                       
                                          
                                             ∂
                                             a
                                          
                                          
                                             ∂
                                             
                                                
                                                   χ
                                                
                                                
                                                   ϕ
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                χ
                                             
                                             
                                                ϕ
                                             
                                          
                                          ⁎
                                       
                                    
                                    〉
                                 
                                 +
                                 λ
                                 
                                    〈
                                    
                                       
                                          
                                             ∂
                                             G
                                          
                                          
                                             ∂
                                             
                                                
                                                   χ
                                                
                                                
                                                   ϕ
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                χ
                                             
                                             
                                                ϕ
                                             
                                          
                                          ⁎
                                       
                                    
                                    〉
                                 
                              
                           
                        Here, 
                           〈
                           d
                           
                              F
                              ¯
                           
                           /
                           d
                           
                              
                                 χ
                              
                              
                                 ϕ
                              
                           
                           ,
                           
                              
                                 
                                    χ
                                 
                                 
                                    ϕ
                                 
                              
                              ⁎
                           
                           〉
                         is a complex function with real and imaginary parts, equal to the sensitivities of the real and imaginary parts of the objective function, respectively.

In a level set-based topology optimization method, the level set function is used to describe the distribution of material and void areas inside a fixed design domain. Unlike an electromagnetic metamaterial design problem in which a single material property, electric permittivity, is used to define the fixed design domain, we apply two acoustic properties in this study, the mass density 
                           ρ
                         and the bulk modulus 
                           K
                         The speed of sound, 
                           c
                        , can then be easily obtained using the relation 
                           c
                           =
                           
                              
                                 K
                                 /
                                 ρ
                              
                           
                        . By denoting 
                           
                              
                                 ρ
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 K
                              
                              
                                 1
                              
                           
                         as the properties of material areas, and 
                           
                              
                                 ρ
                              
                              
                                 0
                              
                           
                         and 
                           
                              
                                 K
                              
                              
                                 0
                              
                           
                         as the properties of void areas (background areas), we use a reciprocal function to define the mass density and bulk modulus as the material properties to be optimized, using the characteristic function, 
                           
                              
                                 χ
                              
                              
                                 ϕ
                              
                           
                        , as follows:
                           
                              (30)
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       
                                          ρ
                                       
                                       
                                          1
                                       
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 −
                                 
                                    
                                       
                                          ρ
                                       
                                       
                                          0
                                       
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 )
                                 
                                    
                                       χ
                                    
                                    
                                       ϕ
                                    
                                 
                                 (
                                 ϕ
                                 )
                                 +
                                 
                                    
                                       
                                          ρ
                                       
                                       
                                          0
                                       
                                    
                                    
                                       −
                                       1
                                    
                                 
                              
                           
                        
                        
                           
                              (31)
                              
                                 
                                    
                                       K
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       
                                          K
                                       
                                       
                                          1
                                       
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 −
                                 
                                    
                                       
                                          K
                                       
                                       
                                          0
                                       
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 )
                                 
                                    
                                       χ
                                    
                                    
                                       ϕ
                                    
                                 
                                 (
                                 ϕ
                                 )
                                 +
                                 
                                    
                                       
                                          K
                                       
                                       
                                          0
                                       
                                    
                                    
                                       −
                                       1
                                    
                                 
                              
                           
                        
                     

In the optimization implementation, the characteristic function 
                           
                              
                                 χ
                              
                              
                                 ϕ
                              
                           
                         is approximated by the following Heaviside function, 
                           H
                           (
                           ϕ
                           )
                        .
                           
                              (32)
                              
                                 H
                                 (
                                 ϕ
                                 )
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                0
                                             
                                             
                                                
                                                   (
                                                   ϕ
                                                   <
                                                   −
                                                   w
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      1
                                                      2
                                                   
                                                   +
                                                   
                                                      ϕ
                                                      w
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               15
                                                            
                                                            
                                                               16
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               
                                                                  
                                                                     ϕ
                                                                  
                                                                  2
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     w
                                                                  
                                                                  2
                                                               
                                                            
                                                         
                                                         
                                                            (
                                                            
                                                               
                                                                  5
                                                                  8
                                                               
                                                               −
                                                               
                                                                  3
                                                                  
                                                                     16
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        
                                                                           ϕ
                                                                        
                                                                        2
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           w
                                                                        
                                                                        2
                                                                     
                                                                  
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   (
                                                   −
                                                   w
                                                   ≤
                                                   ϕ
                                                   ≤
                                                   w
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                1
                                             
                                             
                                                
                                                   (
                                                   w
                                                   ≤
                                                   ϕ
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where w is the transition width of the Heaviside function which represents the width of the interface between two materials, set to a sufficiently small and real value.

Based on the definition of the material properties in Eqs. (30) and (31), the term in the variation of the Lagrangian in Eq. (29) can be derived as follows:
                           
                              (33)
                              
                                 
                                    〈
                                    
                                       
                                          
                                             ∂
                                             a
                                          
                                          
                                             ∂
                                             
                                                
                                                   χ
                                                
                                                
                                                   ϕ
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                χ
                                             
                                             
                                                ϕ
                                             
                                          
                                          ⁎
                                       
                                    
                                    〉
                                 
                                 =
                                 
                                    ∫
                                    D
                                 
                                 
                                    (
                                    
                                       
                                          ρ
                                       
                                       
                                          1
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    −
                                    
                                       
                                          ρ
                                       
                                       
                                          0
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    )
                                    ∇
                                    p
                                    ⋅
                                    ∇
                                    
                                       
                                          p
                                       
                                       ⁎
                                    
                                    
                                       
                                          χ
                                       
                                       
                                          ϕ
                                       
                                       
                                          ⁎
                                       
                                    
                                 
                                 d
                                 Ω
                                 −
                                 
                                    ∫
                                    D
                                 
                                 
                                    (
                                    
                                       
                                          K
                                       
                                       
                                          1
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    −
                                    
                                       
                                          K
                                       
                                       
                                          0
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    )
                                    p
                                    ⋅
                                    
                                       
                                          p
                                       
                                       ⁎
                                    
                                    ⋅
                                    
                                       
                                          ω
                                       
                                       2
                                    
                                    ⋅
                                    
                                       
                                          χ
                                       
                                       
                                          ϕ
                                       
                                       
                                          ⁎
                                       
                                    
                                 
                                 d
                                 Ω
                                 +
                                 i
                                 k
                                 
                                    ∫
                                    Γ
                                 
                                 
                                    (
                                    
                                       
                                          ρ
                                       
                                       
                                          1
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    −
                                    
                                       
                                          ρ
                                       
                                       
                                          0
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    )
                                    p
                                 
                                 
                                    
                                       p
                                    
                                    ⁎
                                 
                                 
                                    
                                       χ
                                    
                                    
                                       ϕ
                                    
                                    
                                       ⁎
                                    
                                 
                                 d
                                 Γ
                              
                           
                        
                     

In the calculation of 
                           〈
                           ∂
                           a
                           /
                           ∂
                           
                              
                                 χ
                              
                              
                                 ϕ
                              
                           
                           ,
                           
                              
                                 
                                    χ
                                 
                                 
                                    ϕ
                                 
                              
                              ⁎
                           
                           〉
                        , the third term to the right of the equals sign is defined on the exterior boundaries, beyond the fixed design domain, and thus can be ignored in the global expression. We note that, due to the adoption of a reciprocal function, the expression of the derivative of a is independent of the mass density 
                           ρ
                         and the bulk modulus K, the values of which change suddenly near the structural boundaries to achieve the clear boundaries that characterize level set-based topology optimization methods. This means that the sensitivities remain stable near these boundaries, and discontinuous sensitivity distributions are avoided. In short, the reciprocal formulation guarantees a continuous material distribution and the stability of the optimization procedure.

The special characteristics of the effective bulk modulus curve of an acoustic metamaterial impel us to conduct a two-step optimization procedure to achieve the target, which is to find the minimum of the effective bulk modulus at a desired frequency. In the first step, the imaginary part of the effective bulk modulus is minimized and the obtained result is then used as the initial configuration in the second step, during which the real part of the effective bulk modulus is minimized. The flowchart of the optimization procedure for these two steps is shown in 
                        Fig. 3.

In this section, we present several numerical examples for the design of acoustic metamaterials to illustrate how our proposed method finds material distributions that function as acoustic metamaterials with extremely negative bulk modulus at a desired frequency. Furthermore, we observe the effect of different initial configurations on the optimal results. 
                     Fig. 4 shows the design model. As with the model shown in Fig. 1, the size of the analysis domain is set to 30mm×30mm and the fixed design domain is set to 20mm×20mm. The fixed design domain 
                        D
                      is discretized with a fine mapped mesh of 80×80 quadrilateral elements, which is used for the FEM analysis. Two different materials, rubber and water, are used in the optimization. The bulk modulus of the solid rubber material and the aqueous background material are set to 6.27×105
                     Pa and 2.15×109
                     Pa, respectively, and the mass densities are set to 1300kg/m3 and 1000kg/m3, respectively. The transition width of the Heaviside function w is set here to 0.001. The regularization parameter 
                        τ
                      is set to 0.0002. There is no volume constraint applied in the numerical examples.

In this subsection, we present negative effective bulk modulus minimization problems for frequencies that are above or below that of the low point in the graph of the real part of the effective bulk modulus versus the frequency, for the initial configuration. We aim to show the effectiveness of proposed method in finding an optimized distribution of rubber and water in the fixed design domain, that is, the optimal shape of an acoustic metamaterial unit cell.

First, minimization of the effective bulk modulus is conducted with the target frequency set as 1550Hz (target wavelength equal to 31.7 times of the width of unit cell 
                              d
                           ), which is lower than that at the low point of the real part of the effective bulk modulus graph for the initial configuration. In this optimization, we set the imaginary part of the bulk modulus of the soft material, water, as equal to 1% of the real part of the bulk modulus. An annular shape with a 2:1 outer/inner radius ratio and an inner radius of 4mm is used as the initial configuration.

As introduced in the previous section, the optimization is conducted in two steps: the imaginary part of the effective bulk modulus is minimized first and then the real part is minimized. 
                           Fig. 5 shows the initial configuration and the optimized configuration of the first step. In the figure, blue represents the rubber material and white represents the water background material. The effective bulk modulus curves for the initial configuration and the optimized distribution obtained after the first step are shown in 
                           Fig. 6. The imaginary part of the effective bulk modulus decreases gradually during the optimization process and reaches the low point at the desired frequency. The value of the imaginary part of the effective bulk modulus of the initial configuration at 1550Hz is −7.78Pa. After the 1st step optimization, this value at 1550Hz is −4.14×104
                           Pa. 
                           Fig. 7 shows the convergence history of changes in the imaginary part of the effective bulk modulus.

After the 1st step optimization is finished, we minimize the real part of the effective bulk modulus targeting 1550Hz in the 2nd step optimization, using the optimized configuration obtained in the 1st step as the initial configuration. 
                           Fig. 8 shows the initial configuration and the optimized configuration for the 2nd step. 
                           Fig. 9 shows the effective bulk modulus curves for the initial configuration of the 2nd step optimization, and the optimized distribution after the optimization. The real part of the effective bulk modulus decreases gradually during the optimization process and reaches a minimum at 1550Hz. The value of the real part of the effective bulk modulus of the initial configuration at 1550Hz was 181.85Pa. After the 2nd step optimization, this value at 1550Hz was −2.53×104
                           Pa. 
                           Fig. 10 shows the convergence history of the real part of the effective bulk modulus, which reaches a minimum soon after the start of the optimization and then remains essentially stable, with minor oscillation. This result implies that the optimization successfully found a minimized and negative effective bulk modulus at the desired frequency, and produced an appropriate material distribution.

Bulk modulus 
                              K
                            is defined as the ratio of an infinitesimal pressure change 
                              Δ
                              P
                            to the resulting relative change in the volume 
                              Δ
                              V
                           , and it is proportional to volume 
                              V
                            as in Eq. (34).
                              
                                 (34)
                                 
                                    K
                                    =
                                    −
                                    V
                                    
                                       
                                          Δ
                                          P
                                       
                                       
                                          Δ
                                          V
                                       
                                    
                                 
                              
                           
                        

In a natural material that has a positive bulk modulus K, an applied pressure gradient increases the force inside the material, which causes a decrease in volume. However, in an acoustic metamaterial, increase in a pressure gradient increases the volume, and decrease in a pressure gradient decreases the volume, a condition that creates a negative bulk modulus, shown in the relationship expressed in Eq. (34). The sound pressure change over the design domain and the displacements over the boundaries are integrated. The results show that the signs of the normal displacements of the right and left boundaries are both positive, which means that the volume of the design domain has increased. Concurrently, the pressure integration of the design domain is also positive, indicating that the bulk modulus has become negative at 1550Hz.

We now examine a case in which the effective bulk modulus minimization has a target frequency of 2200Hz (target wavelength equal to 22.3d), which is above the low point in the graph of the real part of the effective bulk modulus versus frequency for the initial configuration. The material settings and initial configuration are same as those described in the above subsection. The optimization in this problem is also conducted in two steps. 
                           Fig. 11 shows the initial configuration for the 1st step and the optimized configuration after the 2nd step. The effective bulk modulus curves for the initial configuration and the optimized distribution obtained after the second step are shown in 
                           Fig. 12. The minimum value of the real part of the effective bulk modulus was reached at 2200Hz. The value of the real part of the effective bulk modulus of the initial configuration at 2200Hz was −3.98×103
                           Pa. After the 2nd step optimization, this value at 2200Hz was −3.66×104
                           Pa. 
                           Fig. 13 shows the convergence history during the first and second steps of the optimization. Applying integrations to the sound pressure changes over the design domain and the displacements over the boundaries, the positive pressure change and resulting volume increase are responsible for the obtained negative bulk modulus achieved in the optimized configuration of the 2nd step.

Having solved effective bulk modulus minimization problems at desired frequencies, we now examine effective bulk modulus minimization problems based on different initial configurations, to further verify the practicality of our proposed method and to discover if optimized results are dependent upon the initial configuration. The analysis model and material properties are same as for the above examples.

First we describe a problem to minimize the effective bulk modulus based on a circular shape with a volume ratio of 0.4 as the initial configuration for the optimization. The target frequency is set to 2200Hz (target wavelength equal to 22.3d), and the optimization is conducted in two steps. 
                        Fig. 14 shows the initial configuration for the 1st step and the optimized configuration after the 2nd step. The effective bulk modulus curves for the initial configuration and the optimized distribution obtained after the second step are shown in 
                        Fig. 15. The minimum of the real part of the effective bulk modulus was reached at 2200Hz. The value of the real part of the effective bulk modulus of the initial configuration at 2200Hz was −1.37×103
                        Pa. After the 2nd step optimization, this value at 2200Hz was −4.67×104
                        Pa. This indicates that the optimization successfully found an optimized distribution at 2200Hz, given the initial configuration. 
                        Fig. 16 shows the convergence history during the first and second steps of the optimization. With the sound pressure changes integrated over the design domain and the displacements integrated over the boundaries, the positive pressure change and resulting volume increase result in a negative bulk modulus.

Next, we compare this result with the example shown in 4.1.2 where the initial configuration used in the first step is a ring shape and the target frequency is also set to 2200Hz, to show the effect of different initial configurations on the optimal configuration results. A comparison of the optimized configurations obtained based on different initial configurations, namely, a circular shape and an annular shape, shows that both initial configurations lead to optimized material distributions at the target frequency, where the effective bulk modulus is minimized. From Figs. 12 and 15 the data for the circular and annular initial configuration shapes show that the real part of the effective bulk modulus at 2200Hz had a value of −3.66×104
                        Pa and −4.67×104
                        Pa, respectively. Although the difference in the obtained optimized values implies that this design problem has many local optima, clear optimized configurations that achieve an extremely negative effective bulk modulus at a desired frequency were obtained in both cases, confirming that the proposed method yields appropriate designs of acoustic metamaterials with minimized and negative bulk modulus.

@&#CONCLUSIONS@&#

This paper presented a level set-based topology optimization method applied to the design of negative bulk modulus acoustic metamaterials based on localized resonant mechanisms, using a functional scale. We obtained the following results:
                        
                           (1)
                           The optimization problem was formulated to minimize the effective bulk modulus. A homogenization method based on S-parameters was applied to compute the effective bulk modulus of the metamaterials. A level set-based topology optimization method, using on a reaction-diffusion equation, was successfully applied to obtain clear boundary expressions of the optimal configurations.

Based on the formulation of the optimization problem, an optimization algorithm was constructed. FEM was used to solve the governing equation of acoustic wave propagations, and to update the level set function. The Adjoint Variable Method was used when computing sensitivity analyses.

Several examples were presented to confirm that the proposed method successfully finds optimized material distributions at different target frequencies, and with different initial configurations. It was also confirmed that a two-step optimization method enabled the handling of effective bulk modulus curves with unusual characteristics. The proposed method should facilitate the design of acoustic metamaterials without the need for physical experiments or trial and error approaches.

We hope to extend the current two-dimensional cases to three-dimensional or three material phase problems in the future, which may broaden and improve the prospects for developing effective applications of acoustic metamaterials.

@&#REFERENCES@&#

