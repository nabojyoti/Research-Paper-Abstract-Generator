@&#MAIN-TITLE@&#Modal analysis of active flexible multibody systems containing PID controllers with non-collocated sensors and actuators

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Coupled mechanical and control system equations are expressed in second-order form.


                        
                        
                           
                           
                              n-Space eigensolvers can be used without damping and steady-state error elimination.


                        
                        
                           
                           2n eigensolvers can be used with damping.


                        
                        
                           
                           New 3n eigensolver method allows for both damping and steady-state error elimination.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Modal analysis

Closed-loop eigenvalue problem

Flexible multibody system

Position feedback PID controller

Non-collocated sensors and actuators

@&#ABSTRACT@&#


               
               
                  A method for performing modal analysis of undamped active flexible multibody systems with collocated sensors and actuators in a finite element environment was recently developed by the authors. In this paper, the theory is further expanded to include systems with non-collocated sensors and actuators, damping and steady-state error elimination. The closed-loop eigenvalue problem for active flexible multibody systems with multiple-input multiple-output proportional-integral-derivative (PID) feedback type controllers and multiple degrees of freedom finite element models is solved.
               
            

@&#INTRODUCTION@&#

Modal analysis and dynamic simulation of active flexible multibody systems – from now on referred to as active mechanisms – are a multidisciplinary challenge. The dynamic performance of such products is strongly dependent on an optimal interaction between the controllers and the mechanical components. An important tool in the optimization of such products is modal analysis, which predicts modal parameters, i.e. natural frequencies, mode shapes and damping ratios, for the active system. Due to the complexity of the mechanical components, both in form and function, it may be practical to handle such systems through a finite element (FE) approach. Effective time domain dynamic simulations of multibody systems in an FE environment have been described by for instance Géradin and Cardona [1] and Sivertsen [2].

The authors have recently developed a method for performing modal analyses of active mechanisms in an FE environment [3]. In that work, the equations for the control system are expressed in second-order form, rather than in first-order or state-space form, which is typical practice in control system disciplines, see for instance [4–6]. One of the advantages of this approach is an increased compatibility with the mechanical equations, which are typically expressed in second-order form, e.g., [2,7–10], since equations determined in state-space form are difficult to transform into second-order structural dynamics equations [11]. For undamped systems with only collocated sensors and actuators, expressing the system equations in second-order form means that traditional symmetric FE eigensolver methods, such as the very popular Lanczos algorithm [12], may be used.

In [3], the theory for performing modal analyses of active mechanisms was only derived for the undamped case without steady-state error elimination, i.e. no damping or position feedback integral gain. Damping can occur due to both the mechanical system and controllers, e.g., [3,8,13–17], while position feedback integral gain can cause the system to become unstable [3]. As explained in for instance [8], damping and system instability are basically determined by the same factor: the constant in the exponent of the oscillation amplitude envelope; a negative constant yields a decaying oscillation, i.e. damping, whereas a positive constant yields a growing oscillation, and thus instability. The eigenfrequencies of such systems are not the same as for a stable undamped system, e.g., [7,8]. In addition to altering the eigenfrequencies, damping also causes the eigenvectors to become complex [18].

As stated in [19], the solution procedures of non-proportionally damped systems mainly follow two routes: the state-space method and approximate methods in “n-space”. Most of the n-space methods either seek an optimal decoupling of the equations of motion or simply neglect the off-diagonal terms of the modal damping matrix. Following such methodologies will still yield only real mode shapes. The accuracy of these methods, other than the light damping assumption, depends upon various factors such as frequency separation between modes, driving frequency, etc. [19]. In order to solve the damped eigenvalue problem for a system with n degrees of freedom (DOFs), the second-order differential equations can be reformulated as a first-order 2n-dimensional matrix equation system, as shown for instance in [20]. The state-space method is exact in nature but requires significant numerical effort for obtaining the eigensolutions, as the size of the problem doubles from n to 2n.

How to solve the eigenvalue problem for a closed-loop system on state-space form has been shown by e.g., Rastgaar et al. [21]. However, their theory is only valid for systems containing controller gains proportional to position and velocity, i.e. equivalent to stiffness and damping, respectively. As stated by Astrom and Hagglund [22,23], PID controllers are the most common type of controllers in use today, and as shown by the authors in [3], depending on the type of sensor inputs, PID controllers can contain gains proportional to position, velocity, acceleration or the time integral of position (absement), i.e. equivalent to stiffness, damping, mass and steady-state error elimination, respectively. Thus, modal analysis methods for active mechanisms should also take into consideration the effects caused by the various types of PID controllers.

Purely mechanical systems have symmetric system matrices. In FE software systems, this property is widely exploited in effective eigensolver methods for undamped systems. For a system containing only collocated sensors and actuators, the system matrix symmetry is retained, meaning that the ordinary symmetric eigensolver methods can still be used. However, if the system contains one or more sensors which are not collocated with their corresponding actuators, the system matrices will be unsymmetrical, meaning that the traditional symmetric eigensolver methods cannot be used.

This paper addresses the theory for solving the eigenvalue problem for active mechanisms that contain both damping and steady-state error elimination and controllers with non-collocated sensors and actuators. The proposed method is to express the system matrices in second-order form, and then transform the system matrices into a first-order 2n- or 3n-dimensional matrix equation system for modal analysis execution. Expressing the system matrices in second-order form increases the compatibility of the proposed method with FE software systems. If the effect from damping, steady-state error elimination and non-collocation between sensors and actuators on the eigenfrequencies can be neglected, the system matrices can be kept in second-order form, and traditional FE eigensolver methods can be utilized as shown in [3]. If these effects cannot be neglected, or for instance very precise predictions of the eigenfrequencies are vital, transforming the system matrices into a 2n or 3n-space provides a way of extracting the more correct eigenfrequencies, however, this comes at the cost of an increase in solving time. It should be noted that the transformation of the system matrices into a 2n or 3n-space does not necessarily mean an impractical or unsolvable equation system with respect to number of system DOFs. An example given by the authors in [3] is the satellite tracking antenna depicted in 
                     Fig. 1.

Due to model reduction techniques [2], the virtual model of the mechanism was reduced from approximately 950,000 DOFs to about 850 DOFs for effective time domain dynamic simulations.

The objective of this work is to help engineers working in an FE environment to be able to accurately predict eigenfrequencies and mode shapes of active mechanisms containing any type of PID controllers, with the exception being controllers containing acceleration feedback derivative gains. The controllers can be of type single-input single-output (SISO) or multiple-input multiple-output (MIMO), and the sensors and actuators for the controllers can be either collocated or non-collocated. The theory derived in this work is tested through numerical examples, which are deliberately made very simple because of verifiability. The derived theory is intended to be implemented in an FE software system, but for the sake of validation, all eigenvalue problems in this work are solved in MATLAB
                        1
                     
                     
                        1
                        MATLAB by The MathWorks, Inc., version R2013b.
                      using the eig() routine [24]. All time domain simulations are performed in FEDEM
                        2
                     
                     
                        2
                        FEDEM (Finite Element in Dynamics of Elastic Mechanisms) simulation software is a multibody dynamics package distributed by Fedem Technology AS. It is based on the finite element method and uses model reduction techniques to effectively perform nonlinear time domain dynamic simulations of active flexible multibody systems [2,25], version R5.0.
                     .

The equation of motion for a single degree of freedom (SDOF) mechanical system with a single-input single-output (SISO) feedback controller can be written as follows [3]:
                        
                           (1)
                           
                              m
                              
                              
                                 r
                                 ¨
                              
                              (
                              t
                              )
                              +
                              c
                              
                              
                                 r
                                 ̇
                              
                              (
                              t
                              )
                              +
                              k
                              
                              r
                              (
                              t
                              )
                              =
                              
                                 
                                    F
                                 
                                 
                                    A
                                    p
                                    p
                                 
                              
                              (
                              t
                              )
                              +
                              
                                 
                                    F
                                 
                                 
                                    C
                                    t
                                    r
                                    l
                                 
                              
                              (
                              t
                              )
                           
                        
                     where m is the mass, c is the damping and k is the stiffness. r is the displacement of the mass m with respect to time; 
                        
                           r
                           ̇
                        
                      and 
                        
                           r
                           ¨
                        
                      are the first and second time derivatives of r, respectively, i.e. velocity and acceleration of the mass m. F
                     
                        App
                      is the applied mechanical force and F
                     
                        Ctrl
                      is the force from the controller. This is in accordance with equations found in for instance [26].


                     
                     Fig. 2 shows a simple block diagram used for describing a SISO feedback control system.

In Fig. 2, y
                     0 is the reference variable, y is the measured variable, e is the difference between y
                     0 and y, u is the controller output, F
                     
                        Ctrl
                      is a force from the controller exerted by an actuator, x is the state variable from the physical process (i.e. position r, velocity 
                        
                           r
                           ̇
                        
                      or acceleration 
                        
                           r
                           ¨
                        
                     ), and v is the disturbance on the physical process. Only feedback controllers will be dealt with in this work, hence all control system terminology used here refers implicitly to feedback controllers.

For a feedback PID-type controller, the controller output u is given by
                        
                           (2)
                           
                              
                                 
                                    u
                                 
                                 
                                    P
                                    I
                                    D
                                 
                              
                              (
                              t
                              )
                              =
                              
                                 
                                    K
                                 
                                 
                                    p
                                 
                              
                              e
                              (
                              t
                              )
                              +
                              
                                 
                                    K
                                 
                                 
                                    i
                                 
                              
                              ∫
                              
                                 e
                                 (
                                 t
                                 )
                                 d
                                 t
                              
                              +
                              
                                 
                                    K
                                 
                                 
                                    d
                                 
                              
                              
                                 d
                                 
                                    d
                                    t
                                 
                              
                              e
                              (
                              t
                              )
                           
                        
                     where K
                     
                        p
                      is the proportional gain, K
                     
                        d
                      is the derivative gain and K
                     
                        i
                      is the integral gain from the controller.

Since e is the difference between y
                     0 and y, the controller output can be split into a feedforward or feedthrough part governed by y
                     0 and a feedback part governed by y, as shown in [13]. The feedforward part can be interpreted as an applied force whose parameters are not affected by the system itself, and will not affect the internal dynamics of the system. Therefore, it is not of particular interest in this context. The only part which does affect the internal dynamics of the system is the feedback part. Thus, Eq. (2) can more conveniently be written as
                        
                           (3)
                           
                              
                                 
                                    u
                                 
                                 
                                    P
                                    I
                                    
                                       
                                          D
                                       
                                       
                                          F
                                          e
                                          e
                                          d
                                          b
                                          a
                                          c
                                          k
                                       
                                    
                                 
                              
                              (
                              t
                              )
                              =
                              
                                 
                                    K
                                 
                                 
                                    p
                                 
                              
                              y
                              (
                              t
                              )
                              +
                              
                                 
                                    K
                                 
                                 
                                    i
                                 
                              
                              ∫
                              
                                 y
                                 (
                                 t
                                 )
                                 d
                                 t
                              
                              +
                              
                                 
                                    K
                                 
                                 
                                    d
                                 
                              
                              
                                 d
                                 
                                    d
                                    t
                                 
                              
                              y
                              (
                              t
                              )
                           
                        
                     
                  

One view of the control system is to isolate the control elements from the physical process. The control elements then principally contain three parts: a sensor, an actuator and a controller that contains the various controller elements, as shown in 
                     Fig. 3.

As shown in Fig. 3, the effects by the control elements on the mechanical system can be given as
                        
                           (4)
                           
                              
                                 
                                    ∂
                                    
                                       
                                          F
                                       
                                       
                                          C
                                          t
                                          r
                                          l
                                       
                                    
                                 
                                 
                                    ∂
                                    x
                                 
                              
                              =
                              
                                 
                                    ∂
                                    
                                       
                                          F
                                       
                                       
                                          C
                                          t
                                          r
                                          l
                                       
                                    
                                 
                                 
                                    ∂
                                    u
                                 
                              
                              
                                 
                                    ∂
                                    u
                                 
                                 
                                    ∂
                                    y
                                 
                              
                              
                                 
                                    ∂
                                    y
                                 
                                 
                                    ∂
                                    x
                                 
                              
                              
                              or
                              
                              d
                              
                                 
                                    F
                                 
                                 
                                    C
                                    t
                                    r
                                    l
                                 
                              
                              =
                              
                                 
                                    G
                                 
                                 
                                    A
                                    c
                                    t
                                 
                              
                              
                                 
                                    G
                                 
                                 
                                    C
                                    t
                                    r
                                    l
                                 
                              
                              
                                 
                                    G
                                 
                                 
                                    S
                                    e
                                    n
                                    s
                                 
                              
                              
                              d
                              x
                           
                        
                     where G
                     
                        Act
                      is the actuator gradient, G
                     
                        Ctrl
                      is the controller gradient and G
                     
                        Sens
                      is the sensor gradient.

Similarly, the gradients for a multiple-input multiple-output (MIMO) system can be written as
                        
                           (5)
                           
                              d
                              
                                 
                                    F
                                 
                                 
                                    C
                                    t
                                    r
                                    
                                       
                                          l
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    ∂
                                    
                                       
                                          F
                                       
                                       
                                          C
                                          t
                                          r
                                          
                                             
                                                l
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    ∂
                                    
                                       
                                          u
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                              
                                 
                                    ∂
                                    
                                       
                                          u
                                       
                                       
                                          j
                                       
                                    
                                 
                                 
                                    ∂
                                    
                                       
                                          y
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                              
                                 
                                    ∂
                                    
                                       
                                          y
                                       
                                       
                                          k
                                       
                                    
                                 
                                 
                                    ∂
                                    
                                       
                                          x
                                       
                                       
                                          l
                                       
                                    
                                 
                              
                              
                              d
                              
                                 
                                    x
                                 
                                 
                                    l
                                 
                              
                              =
                              
                                 
                                    G
                                 
                                 
                                    A
                                    c
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          j
                                       
                                    
                                 
                              
                              
                                 
                                    G
                                 
                                 
                                    C
                                    t
                                    r
                                    
                                       
                                          l
                                       
                                       
                                          j
                                          k
                                       
                                    
                                 
                              
                              
                                 
                                    G
                                 
                                 
                                    S
                                    e
                                    n
                                    
                                       
                                          s
                                       
                                       
                                          k
                                          l
                                       
                                    
                                 
                              
                              
                              d
                              
                                 
                                    x
                                 
                                 
                                    l
                                 
                              
                           
                        
                     or, in matrix form, as
                        
                           (6)
                           
                              d
                              
                                 
                                    F
                                 
                                 
                                    C
                                    t
                                    r
                                    l
                                 
                              
                              =
                              
                                 
                                    ∂
                                    
                                       
                                          F
                                       
                                       
                                          C
                                          t
                                          r
                                          l
                                       
                                    
                                 
                                 
                                    ∂
                                    u
                                 
                              
                              
                                 
                                    ∂
                                    u
                                 
                                 
                                    ∂
                                    y
                                 
                              
                              
                                 
                                    ∂
                                    y
                                 
                                 
                                    ∂
                                    x
                                 
                              
                              d
                              x
                              =
                              
                                 
                                    G
                                 
                                 
                                    A
                                    c
                                    t
                                 
                              
                              
                                 
                                    G
                                 
                                 
                                    C
                                    t
                                    r
                                    l
                                 
                              
                              
                                 
                                    G
                                 
                                 
                                    S
                                    e
                                    n
                                    s
                                 
                              
                              
                              d
                              x
                           
                        
                     
                  

Hence, as explained in [3], the equation of motion for the free vibration of a multiple degree of freedom (MDOF) mechanical system with a MIMO feedback controller can thus be written as
                        
                           (7)
                           
                              M
                              
                                 r
                                 ¨
                              
                              (
                              t
                              )
                              +
                              C
                              
                                 r
                                 ̇
                              
                              (
                              t
                              )
                              +
                              K
                              r
                              (
                              t
                              )
                              +
                              
                                 
                                    G
                                 
                                 
                                    A
                                    c
                                    t
                                 
                              
                              
                                 
                                    G
                                 
                                 
                                    C
                                    t
                                    r
                                    l
                                 
                              
                              
                                 
                                    G
                                 
                                 
                                    S
                                    e
                                    n
                                    s
                                 
                              
                              x
                              (
                              t
                              )
                              =
                              0
                           
                        
                     where 
                        M
                      is the 
                        n
                        ×
                        n
                      mass matrix, 
                        C
                      is the 
                        n
                        ×
                        n
                      damping matrix, 
                        K
                      is the 
                        n
                        ×
                        n
                      stiffness matrix and 
                        r
                        ,
                        
                        
                           r
                           ̇
                        
                        
                        and
                        
                        
                           r
                           ¨
                        
                      are the 
                        n
                        ×
                        1
                      position, velocity and acceleration vectors, respectively. 
                        x
                      is a vector of the system state variables, that is, position, velocity and acceleration. G
                     
                        Act
                     , G
                     
                        Ctrl
                      and G
                     
                        Sens
                      are the actuator gradient, controller gradient and sensor gradient matrices, respectively.

The actuator gradient G
                     
                        Act
                      describes the relationship between the controller forces F
                     
                        Ctrl
                      exerted by the actuator and the output signals u from the controller, and has dimensions 
                        
                           
                              n
                           
                           
                              
                                 
                                    F
                                 
                                 
                                    C
                                    t
                                    r
                                    l
                                 
                              
                           
                        
                        ×
                        
                           
                              n
                           
                           
                              u
                           
                        
                      where 
                        
                           
                              n
                           
                           
                              
                                 
                                    F
                                 
                                 
                                    C
                                    t
                                    r
                                    l
                                 
                              
                           
                        
                      is the number of controller forces and n
                     
                        u
                      is the number of controller outputs. The controller gradient G
                     
                        Ctrl
                      describes the relationship between the input variables y and output variables u both to and from the controller, respectively; that is, the various controller gains. Matrix G
                     
                        Ctrl
                      has dimensions 
                        
                           
                              n
                           
                           
                              u
                           
                        
                        ×
                        
                           
                              n
                           
                           
                              y
                           
                        
                      where n
                     
                        u
                      is the number of controller outputs and n
                     
                        y
                      is the number of controller inputs. The sensor gradient G
                     
                        Sens
                      describes the relationship between the controller input variables y and the system state variables 
                        r
                        ,
                        
                        
                           r
                           ̇
                        
                        
                        and
                        
                        
                           r
                           ¨
                        
                      represented by the vector x, and has dimensions 
                        
                           
                              n
                           
                           
                              y
                           
                        
                        ×
                        3
                        
                           
                              n
                           
                           
                              r
                           
                        
                      where n
                     
                        y
                      is the number of controller inputs and n
                     
                        r
                      is the number of all system DOFs. x is given as
                        
                           (8)
                           
                              x
                              =
                              
                                 [
                                 
                                    
                                       
                                          
                                             r
                                          
                                       
                                       
                                          
                                             
                                                r
                                                ̇
                                             
                                          
                                       
                                       
                                          
                                             
                                                r
                                                ¨
                                             
                                          
                                       
                                    
                                 
                                 ]
                              
                           
                        
                     
                  

Vector 
                        x
                      has the dimensions 
                        3
                        
                           
                              n
                           
                           
                              r
                           
                        
                        ×
                        1
                      where n
                     
                        r
                      is the number of all system DOFs. Each sensor is limited to measure only one state variable in only one single system DOF or between two system DOFs.

The matrix product 
                        G
                      of the gradient matrices G
                     
                        Act
                     , G
                     
                        Ctrl
                      and G
                     
                        Sens
                      has dimensions 
                        
                           
                              n
                           
                           
                              
                                 
                                    F
                                 
                                 
                                    C
                                    t
                                    r
                                    l
                                 
                              
                           
                        
                        ×
                        3
                        
                           
                              n
                           
                           
                              r
                           
                        
                     . If 
                        G
                      is pre-multiplied with the topology matrix relating each controller force 
                        
                           
                              F
                           
                           
                              C
                              t
                              r
                              
                                 
                                    l
                                 
                                 
                                    i
                                 
                              
                           
                        
                      with its respective system DOFs, and then split into 3 
                        
                           
                              n
                           
                           
                              r
                           
                        
                        ×
                        
                           
                              n
                           
                           
                              r
                           
                        
                      matrices, G
                     
                        Pos
                     , G
                     
                        Vel
                      and G
                     
                        Acc
                     , one for each state variable 
                        r
                        ,
                        
                        
                           r
                           ̇
                        
                        
                        and
                        
                        
                           r
                           ¨
                        
                     , the matrices G
                     
                        Pos
                     , G
                     
                        Vel
                      and G
                     
                        Acc
                      can be added to their respective system matrix, yielding the following equation system for the free vibration of a controlled mechanism:
                        
                           (9)
                           
                              (
                              M
                              +
                              
                                 
                                    G
                                 
                                 
                                    A
                                    c
                                    c
                                 
                              
                              )
                              
                                 r
                                 ¨
                              
                              (
                              t
                              )
                              +
                              (
                              C
                              +
                              
                                 
                                    G
                                 
                                 
                                    V
                                    e
                                    l
                                 
                              
                              )
                              
                                 r
                                 ̇
                              
                              (
                              t
                              )
                              +
                              (
                              K
                              +
                              
                                 
                                    G
                                 
                                 
                                    P
                                    o
                                    s
                                 
                              
                              )
                              r
                              (
                              t
                              )
                              =
                              0
                           
                        
                     
                  

Eq. (9) is valid for all PID controllers only containing controller elements proportional to position, velocity or acceleration. Examples of controllers not covered by Eq. (9) are: position feedback controllers containing integral gains or acceleration feedback controllers containing derivative gains, though the latter variant will not be covered in this work. Based on Eqs. (3) and (9), the equation of motion for the free vibration of an active MDOF system containing a position feedback PID controller can be written as follows:
                        
                           (10)
                           
                              (
                              M
                              +
                              
                                 
                                    G
                                 
                                 
                                    A
                                    c
                                    c
                                 
                              
                              )
                              
                                 r
                                 ¨
                              
                              (
                              t
                              )
                              +
                              (
                              C
                              +
                              
                                 
                                    G
                                 
                                 
                                    V
                                    e
                                    l
                                 
                              
                              )
                              
                                 r
                                 ̇
                              
                              (
                              t
                              )
                              +
                              (
                              K
                              +
                              
                                 
                                    G
                                 
                                 
                                    P
                                    o
                                    s
                                 
                              
                              )
                              r
                              (
                              t
                              )
                              +
                              
                                 
                                    G
                                 
                                 
                                    S
                                    S
                                    E
                                    E
                                 
                              
                              ∫
                              
                                 r
                                 (
                                 t
                                 )
                                 d
                                 t
                              
                              =
                              0
                           
                        
                     where G
                     
                        SSEE
                      is the controller gradient steady-state error elimination matrix and 
                        ∫
                        
                           r
                           
                           d
                           t
                        
                      is the position time integral (sometimes referred to as absement) vector of the system. As in Eq. (9), the dimensions of all the matrices are 
                        n
                        ×
                        n
                      and the vectors 
                        n
                        ×
                        1
                     .

As can be seen from for instance Eq. (5), if a system contains a sensor located at DOF i and have a corresponding actuator exerting a force on DOF j, the gain parameters of the controller are to be added to their respective gradient matrices 
                           G
                         only on position G
                           ij
                        . Hence, for a system with only collocated sensors and actuators, the controller gradient matrices G
                        
                           Acc
                        , G
                        
                           Vel
                        , G
                        
                           Pos
                         and G
                        
                           SSEE
                         will all be diagonal matrices. However, for a system with one or more non-collocated sensors and actuators, the G
                        
                           Acc
                        , G
                        
                           Vel
                        , G
                        
                           Pos
                         and G
                        
                           SSEE
                         matrices will be unsymmetrical. This can be illustrated through the following example:


                        
                        Fig. 4 illustrates an active MDOF system in which the sensor and actuator are non-collocated.

The mass-spring-damper system in Fig. 4 consists of three masses (m
                        1, m
                        2 and m
                        3) in series connected by springs (k
                        1, k
                        2 and k
                        3) and dampers (c
                        1, c
                        2 and c
                        3). Each mass has one DOF: translation in the horizontal plane, named r
                        1, r
                        2 and r
                        3, respectively. Expressing the position vector as: 
                           r
                           =
                           
                              
                                 [
                                 
                                    
                                       r
                                    
                                    
                                       1
                                    
                                 
                                 
                                 
                                    
                                       r
                                    
                                    
                                       2
                                    
                                 
                                 
                                 
                                    
                                       r
                                    
                                    
                                       3
                                    
                                 
                                 ]
                              
                              T
                           
                        , and the velocity and acceleration vectors in a similar manner, the mass, damping and stiffness matrix of the system in Fig. 4 can be written as:
                           
                              (11)
                              
                                 M
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 ,
                                 
                                 C
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   −
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   −
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   −
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                
                                                   −
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 ,
                                 
                                 K
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   −
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   −
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   −
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                
                                                   −
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                              
                           
                        
                     

In Fig. 4, a sensor is placed on r
                        1, while the actuator exerts a force on m
                        3, i.e. directly affecting r
                        3. If the controller of the system in Fig. 4 is a velocity feedback PID controller, all the matrices G
                        
                           Acc
                        , G
                        
                           Vel
                         and G
                        
                           Pos
                         will be non-zero, as shown in [3]. 
                        Fig. 5 illustrates a block diagram for the velocity feedback PID controller used in the system in Fig. 4.

Based on Eq. (10), this would yield the following gradient matrices G
                        
                           Acc
                        , G
                        
                           Vel
                        , G
                        
                           Pos
                         and G
                        
                           SSEE
                        :
                           
                              (12)
                              
                                 
                                    
                                       G
                                    
                                    
                                       A
                                       c
                                       c
                                    
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         K
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 ,
                                 
                                 
                                    
                                       G
                                    
                                    
                                       V
                                       e
                                       l
                                    
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         K
                                                      
                                                      
                                                         p
                                                      
                                                   
                                                
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 ,
                                 
                                 
                                    
                                       G
                                    
                                    
                                       P
                                       o
                                       s
                                    
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         K
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 ,
                                 
                                 
                                    
                                       G
                                    
                                    
                                       S
                                       S
                                       E
                                       E
                                    
                                 
                                 =
                                 0
                              
                           
                        
                     

The position of the controller gains in their respective matrices in Eq. (12) are determined by the DOFs of the sensor and actuator placements. Since the sensor is placed on r
                        1, the controller gains will be placed in column number 1, and since the actuator affects r
                        3, the controller gains will be placed in row number 3.

Combining Eqs. (11) and (12) yields the following matrix equation system for the free vibration of the active system in Fig. 4 containing a velocity feedback PID controller as follows:
                           
                              (13)
                              
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         K
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                
                                             
                                             
                                                0
                                             
                                             
                                                
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            r
                                                            ¨
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            r
                                                            ¨
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            r
                                                            ¨
                                                         
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 +
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   −
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   −
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   −
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         K
                                                      
                                                      
                                                         p
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   −
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            r
                                                            ̇
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            r
                                                            ̇
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            r
                                                            ̇
                                                         
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 +
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   −
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   −
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   −
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         K
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   −
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 =
                                 0
                              
                           
                        
                     

If the controller for the system in Fig. 4 is a position feedback PID controller, G
                        
                           Acc
                         will be zero, while all of the matrices G
                        
                           Vel
                        , G
                        
                           Pos
                         and G
                        
                           SSEE
                         will be non-zero. Based on Eq. (10), this would yield the following gradient matrices G
                        
                           Acc
                        , G
                        
                           Vel
                        , G
                        
                           Pos
                         and G
                        
                           SSEE
                        :
                           
                              (14)
                              
                                 
                                    
                                       G
                                    
                                    
                                       A
                                       c
                                       c
                                    
                                 
                                 =
                                 0
                                 ,
                                 
                                 
                                    
                                       G
                                    
                                    
                                       V
                                       e
                                       l
                                    
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         K
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 ,
                                 
                                 
                                    
                                       G
                                    
                                    
                                       P
                                       o
                                       s
                                    
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         K
                                                      
                                                      
                                                         p
                                                      
                                                   
                                                
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 ,
                                 
                                 
                                    
                                       G
                                    
                                    
                                       S
                                       S
                                       E
                                       E
                                    
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         K
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    ]
                                 
                              
                           
                        
                     

Combining Eqs. (11) and (14) yields the following matrix equation system for the free vibration of the active system in Fig. 4 containing a position feedback PID controller as follows:
                           
                              (15)
                              
                                 
                                    
                                       
                                          
                                             [
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  m
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  m
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  m
                                                               
                                                               
                                                                  3
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                          
                                             [
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     r
                                                                     ¨
                                                                  
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     r
                                                                     ¨
                                                                  
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     r
                                                                     ¨
                                                                  
                                                               
                                                               
                                                                  3
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                          +
                                          
                                             [
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  c
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  c
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            −
                                                            
                                                               
                                                                  c
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            −
                                                            
                                                               
                                                                  c
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  c
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  c
                                                               
                                                               
                                                                  3
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            −
                                                            
                                                               
                                                                  c
                                                               
                                                               
                                                                  3
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  K
                                                               
                                                               
                                                                  d
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            −
                                                            
                                                               
                                                                  c
                                                               
                                                               
                                                                  3
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  c
                                                               
                                                               
                                                                  3
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                          
                                             [
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     r
                                                                     ̇
                                                                  
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     r
                                                                     ̇
                                                                  
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     r
                                                                     ̇
                                                                  
                                                               
                                                               
                                                                  3
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                       
                                    
                                    
                                       
                                          +
                                          
                                             [
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            −
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            −
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  3
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            −
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  3
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  K
                                                               
                                                               
                                                                  p
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            −
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  3
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  3
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                          
                                             [
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  r
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  r
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  r
                                                               
                                                               
                                                                  3
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                          +
                                          
                                             [
                                             
                                                
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  K
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                          
                                             [
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∫
                                                            
                                                               
                                                                  
                                                                     r
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                               
                                                               d
                                                               t
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            ∫
                                                            
                                                               
                                                                  
                                                                     r
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                               
                                                               d
                                                               t
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            ∫
                                                            
                                                               
                                                                  
                                                                     r
                                                                  
                                                                  
                                                                     3
                                                                  
                                                               
                                                               
                                                               d
                                                               t
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                          =
                                          0
                                       
                                    
                                 
                              
                           
                        
                     

As can be seen in both Eqs. (13) and (15), the system matrices are unsymmetrical if a sensors and its corresponding actuator are non-collocated. This means that ordinary symmetric eigensolver methods, such as for instance the Lanczos algorithm [12], which is a typical eigensolver method used in FE software systems, cannot be used. If such is the case, non-symmetric eigensolver methods, such as for instance the Arnoldi algorithm [27] or the QZ algorithm [28], may be used instead.

Based on Eq. (9), the generalized eigenvalue problem for an undamped system can be given as follows:
                           
                              (16)
                              
                                 (
                                 K
                                 +
                                 
                                    
                                       G
                                    
                                    
                                       P
                                       o
                                       s
                                    
                                 
                                 )
                                 Φ
                                 =
                                 (
                                 M
                                 +
                                 
                                    
                                       G
                                    
                                    
                                       A
                                       c
                                       c
                                    
                                 
                                 )
                                 Φ
                                 Λ
                              
                           
                        where 
                           Λ
                         is diagonal matrix of the generalized eigenvalues and 
                           Φ
                         is full matrix whose columns are the corresponding eigenvectors. For systems also containing damping, the system equations can be expressed in first-order or state-space form as for instance
                           
                              (17)
                              
                                 A
                                 x
                                 −
                                 B
                                 
                                    x
                                    ̇
                                 
                                 =
                                 0
                              
                           
                        where
                           
                              (18)
                              
                                 x
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                r
                                             
                                          
                                          
                                             
                                                
                                                   r
                                                   ̇
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 ,
                                 
                                 
                                    x
                                    ̇
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   r
                                                   ̇
                                                
                                             
                                          
                                          
                                             
                                                
                                                   r
                                                   ¨
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 ,
                                 A
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   K
                                                   +
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         P
                                                         o
                                                         s
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                
                                                   −
                                                   (
                                                   M
                                                   +
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         A
                                                         c
                                                         c
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 ,
                                 
                                 B
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   −
                                                   (
                                                   C
                                                   +
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         V
                                                         e
                                                         l
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   −
                                                   (
                                                   M
                                                   +
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         A
                                                         c
                                                         c
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   −
                                                   (
                                                   M
                                                   +
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         A
                                                         c
                                                         c
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    ]
                                 
                              
                           
                        
                     

The dimensions of 
                           x
                         and 
                           
                              x
                              ̇
                           
                         are 
                           2
                           n
                           ×
                           1
                        , whereas the dimensions of A and B are both 
                           2
                           n
                           ×
                           2
                           n
                           ,
                         where n is the number of DOFs. The generalized eigenvalue problem may now be expressed as follows:
                           
                              (19)
                              
                                 A
                                 Φ
                                 =
                                 B
                                 Φ
                                 Λ
                              
                           
                        
                     

The eigenvectors 
                           
                              
                                 φ
                              
                              
                                 i
                              
                           
                         in 
                           Φ
                         will occur in accordance with the state vector 
                           x
                        , i.e.
                           
                              (20)
                              
                                 
                                    
                                       φ
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                r
                                             
                                          
                                          
                                             
                                                
                                                   r
                                                   ̇
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                              
                           
                        
                     

The equation of motion for the free vibration of an SDOF mechanical system with a position feedback PID controller can, based on Eq. (10), be written as follows:
                           
                              (21)
                              
                                 m
                                 
                                    r
                                    ¨
                                 
                                 (
                                 t
                                 )
                                 +
                                 (
                                 c
                                 +
                                 
                                    
                                       K
                                    
                                    
                                       d
                                    
                                 
                                 )
                                 
                                    r
                                    ̇
                                 
                                 (
                                 t
                                 )
                                 +
                                 (
                                 k
                                 +
                                 
                                    
                                       K
                                    
                                    
                                       p
                                    
                                 
                                 )
                                 r
                                 (
                                 t
                                 )
                                 +
                                 
                                    
                                       K
                                    
                                    
                                       i
                                    
                                 
                                 ∫
                                 
                                    r
                                    (
                                    t
                                    )
                                    
                                    d
                                    t
                                 
                                 =
                                 0
                              
                           
                        
                     

For convenience, Eq. (21) can be rewritten as follows:
                           
                              (22)
                              
                                 
                                    
                                       m
                                    
                                    
                                       e
                                       f
                                       f
                                    
                                 
                                 
                                    r
                                    ¨
                                 
                                 +
                                 
                                    
                                       c
                                    
                                    
                                       e
                                       f
                                       f
                                    
                                 
                                 
                                    r
                                    ̇
                                 
                                 +
                                 
                                    
                                       k
                                    
                                    
                                       e
                                       f
                                       f
                                    
                                 
                                 r
                                 +
                                 
                                    
                                       q
                                    
                                    
                                       e
                                       f
                                       f
                                    
                                 
                                 ∫
                                 
                                    r
                                    
                                    d
                                    t
                                 
                                 =
                                 0
                              
                           
                        where m
                        
                           eff
                         is the effective mass of the system, while c
                        
                           eff
                         is the effective damping, k
                        
                           eff
                         is the effective stiffness and q
                        
                           eff
                         is the effective steady-state error elimination of the system. It is implied that the parameters m
                        
                           eff
                        , c
                        
                           eff
                        , k
                        
                           eff
                         and q
                        
                           eff
                         are positive. Assuming a solution for Eq. (22) on the form 
                           r
                           (
                           t
                           )
                           =
                           
                              
                                 e
                              
                              
                                 s
                                 t
                              
                           
                         gives a characteristic equation
                           
                              (23)
                              
                                 
                                    
                                       m
                                    
                                    
                                       e
                                       f
                                       f
                                    
                                 
                                 
                                    
                                       s
                                    
                                    2
                                 
                                 +
                                 
                                    
                                       c
                                    
                                    
                                       e
                                       f
                                       f
                                    
                                 
                                 s
                                 +
                                 
                                    
                                       k
                                    
                                    
                                       e
                                       f
                                       f
                                    
                                 
                                 +
                                 
                                    
                                       q
                                    
                                    
                                       e
                                       f
                                       f
                                    
                                 
                                 
                                    
                                       s
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 =
                                 0
                              
                           
                        which is equal to
                           
                              (24)
                              
                                 
                                    
                                       m
                                    
                                    
                                       e
                                       f
                                       f
                                    
                                 
                                 
                                    
                                       s
                                    
                                    3
                                 
                                 +
                                 
                                    
                                       c
                                    
                                    
                                       e
                                       f
                                       f
                                    
                                 
                                 
                                    
                                       s
                                    
                                    2
                                 
                                 +
                                 
                                    
                                       k
                                    
                                    
                                       e
                                       f
                                       f
                                    
                                 
                                 s
                                 +
                                 
                                    
                                       q
                                    
                                    
                                       e
                                       f
                                       f
                                    
                                 
                                 =
                                 0
                              
                           
                        
                     

Eq. (24) is a cubic equation and has a solution for the roots s as either three real and unequal roots, three real roots in which at least two are equal, or one real root and a pair of complex conjugate roots [29]. In general, the imaginary part of the roots s is the frequency of oscillation and the real part is the constant in the exponent of the oscillation amplitude envelope. The stability of the system is hence determined by the sign of the real part of the roots s, while the oscillation is determined by the imaginary part of the roots s, meaning that if the roots s does not contain an imaginary part, the system will not oscillate. If all the parameters m
                        
                           eff
                        , c
                        
                           eff
                        , k
                        
                           eff
                         and q
                        
                           eff
                         in Eq. (24) are positive, and the solution of said equation has three real roots, the system is overcritically damped. This is because if all of the parameters in Eq. (24) are positive, all three real roots will be negative, cf. Descartes׳ rule of signs. If the solution of Eq. (24) has three real roots in which at least two are equal, the system is critically damped, and if the roots of Eq. (24) are a pair of complex conjugate roots, the system is undercritically damped. For an undercritically damped system, a negative real part of the complex conjugate roots means that the system is stable. If the real part of the complex conjugate roots is positive, the oscillation is growing, and the system is therefore unstable. The borderline case for stability is when the real part of the complex conjugate roots of s is zero, as explained in for instance [8]. When this occurs, s will be equal to 
                           
                              
                                 ω
                              
                              
                                 n
                              
                           
                           .
                         For this to occur, 
                           
                              
                                 c
                              
                              
                                 e
                                 f
                                 f
                              
                           
                           s
                         and 
                           
                              
                                 q
                              
                              
                                 e
                                 f
                                 f
                              
                           
                           
                              
                                 s
                              
                              
                                 −
                                 1
                              
                           
                         have to be zero. These yields
                           
                              (25)
                              
                                 
                                    
                                       c
                                    
                                    
                                       e
                                       f
                                       f
                                    
                                 
                                 s
                                 −
                                 
                                    
                                       q
                                    
                                    
                                       e
                                       f
                                       f
                                    
                                 
                                 
                                    
                                       s
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 =
                                 0
                                 ⇒
                                 
                                    
                                       q
                                    
                                    
                                       e
                                       f
                                       f
                                    
                                 
                                 =
                                 
                                    
                                       c
                                    
                                    
                                       e
                                       f
                                       f
                                    
                                 
                                 
                                    
                                       s
                                    
                                    2
                                 
                              
                           
                        and since for this special case, 
                           s
                           =
                           
                              
                                 ω
                              
                              
                                 n
                              
                           
                           =
                           
                              
                                 
                                    
                                       k
                                    
                                    
                                       e
                                       f
                                       f
                                    
                                 
                                 /
                                 
                                    
                                       m
                                    
                                    
                                       e
                                       f
                                       f
                                    
                                 
                              
                           
                        , the stability borderline value for q
                        
                           eff
                         can thus be derived as follows:
                           
                              (26)
                              
                                 
                                    
                                       q
                                    
                                    
                                       e
                                       f
                                       
                                          
                                             f
                                          
                                          
                                             s
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       c
                                    
                                    
                                       e
                                       f
                                       f
                                    
                                 
                                 
                                    
                                       s
                                    
                                    2
                                 
                                 =
                                 
                                    
                                       c
                                    
                                    
                                       e
                                       f
                                       f
                                    
                                 
                                 
                                    
                                       
                                          ω
                                       
                                       
                                          n
                                       
                                    
                                    2
                                 
                                 =
                                 
                                    
                                       c
                                    
                                    
                                       e
                                       f
                                       f
                                    
                                 
                                 
                                    
                                       
                                          
                                             k
                                          
                                          
                                             e
                                             f
                                             f
                                          
                                       
                                    
                                    
                                       
                                          
                                             m
                                          
                                          
                                             e
                                             f
                                             f
                                          
                                       
                                    
                                 
                              
                           
                        
                     

In order to derive the roots of Eq. (22), one possibility is to transform it into a first-order or state-space form. One possible way of writing Eq. (22) in state-space form is as given in Eq. (17), where now x, 
                           
                              x
                              ̇
                           
                        , 
                           A
                         and 
                           B
                         are given as follows:
                           
                              (27)
                              
                                 x
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   ∫
                                                   
                                                      r
                                                      
                                                      d
                                                      t
                                                   
                                                
                                             
                                          
                                          
                                             
                                                r
                                             
                                          
                                          
                                             
                                                
                                                   r
                                                   ̇
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 ,
                                 
                                 
                                    x
                                    ̇
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                r
                                             
                                          
                                          
                                             
                                                
                                                   r
                                                   ̇
                                                
                                             
                                          
                                          
                                             
                                                
                                                   r
                                                   ¨
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 ,
                                 
                                 A
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         e
                                                         f
                                                         f
                                                      
                                                   
                                                
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         e
                                                         f
                                                         f
                                                      
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         e
                                                         f
                                                         f
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 ,
                                 
                                 B
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   −
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         e
                                                         f
                                                         f
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   −
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         e
                                                         f
                                                         f
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   −
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         e
                                                         f
                                                         f
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         e
                                                         f
                                                         f
                                                      
                                                   
                                                
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         e
                                                         f
                                                         f
                                                      
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    ]
                                 
                              
                           
                        
                     

In general, the dimensions of 
                           x
                         and 
                           
                              x
                              ̇
                           
                         are 
                           3
                           n
                           ×
                           1
                        , whereas the dimensions of 
                           A
                         and 
                           B
                         are both 
                           3
                           n
                           ×
                           3
                           n
                           ,
                         where n is the number of DOFs. In order to obtain the roots of Eq. (24), the generalized eigenvalue problem can be solved with the matrices in Eq. (27) inserted into Eq. (19). The diagonal elements of the eigenvalue matrix 
                           Λ
                         correspond to the roots s of Eq. (24).

Based on Eqs. (10) and (22), the second-order differential equation of the free vibration for an MDOF system can be written as follows:
                           
                              (28)
                              
                                 
                                    
                                       M
                                    
                                    
                                       e
                                       f
                                       f
                                    
                                 
                                 
                                    r
                                    ¨
                                 
                                 +
                                 
                                    
                                       C
                                    
                                    
                                       e
                                       f
                                       f
                                    
                                 
                                 
                                    r
                                    ̇
                                 
                                 +
                                 
                                    
                                       K
                                    
                                    
                                       e
                                       f
                                       f
                                    
                                 
                                 r
                                 +
                                 
                                    
                                       Q
                                    
                                    
                                       e
                                       f
                                       f
                                    
                                 
                                 ∫
                                 
                                    r
                                    
                                    d
                                    t
                                 
                                 =
                                 0
                              
                           
                        where M
                        
                           eff
                         is the effective mass matrix of the system, while C
                        
                           eff
                         is the effective damping matrix, K
                        
                           eff
                         the effective stiffness matrix and Q
                        
                           eff
                         the effective steady-state error elimination matrix of the system. The dimensions of all the matrices are 
                           n
                           ×
                           n
                         and the vectors 
                           n
                           ×
                           1
                        . If the system in Eq. (28) is written in state-space form as in Eq. (17), its state-space matrices would be
                           
                              (29)
                              
                                 x
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   ∫
                                                   
                                                      r
                                                      
                                                      d
                                                      t
                                                   
                                                
                                             
                                          
                                          
                                             
                                                r
                                             
                                          
                                          
                                             
                                                
                                                   r
                                                   ̇
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 ,
                                 
                                 
                                    x
                                    ̇
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                r
                                             
                                          
                                          
                                             
                                                
                                                   r
                                                   ̇
                                                
                                             
                                          
                                          
                                             
                                                
                                                   r
                                                   ¨
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 ,
                                 
                                 A
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         Q
                                                      
                                                      
                                                         e
                                                         f
                                                         f
                                                      
                                                   
                                                
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                
                                                   
                                                      
                                                         K
                                                      
                                                      
                                                         e
                                                         f
                                                         f
                                                      
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         e
                                                         f
                                                         f
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 ,
                                 
                                 B
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   −
                                                   
                                                      
                                                         K
                                                      
                                                      
                                                         e
                                                         f
                                                         f
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   −
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         e
                                                         f
                                                         f
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   −
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         e
                                                         f
                                                         f
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         K
                                                      
                                                      
                                                         e
                                                         f
                                                         f
                                                      
                                                   
                                                
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         e
                                                         f
                                                         f
                                                      
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    ]
                                 
                              
                           
                        where the dimensions of 
                           x
                         and 
                           
                              x
                              ̇
                           
                         are 
                           3
                           n
                           ×
                           1
                        , and those of 
                           A
                         and 
                           B
                         are both 
                           3
                           n
                           ×
                           3
                           n
                        .

In this chapter, four examples for assessing the validity of the theory derived in Chapter 2 are presented. The first example focuses on illustrating the asymmetry which occurs in the system matrices for a system containing non-collocated sensors and actuators, as explained in Section 2.1. The second example aims at verifying the proposed properties of a system containing a term proportional to the time integral of the position, i.e. steady-state error elimination, as derived in Section 2.2. In the third example, the objective is to test the proposed method for modal analysis of active mechanisms containing both damping, steady-state error elimination and non-collocated sensors and actuators, as presented in Eq. (29).

Since all of the former examples are fairly simple, their utilitarian value may be lost. To compensate for this, a more complex and realistic example consisting of simple car front suspension is also included. The simple car front suspension example is intended as an illustrative example only; therefore, it is deliberately not an exact replication of a real physical product. Because of this, the parameter values used for the suspension are not of importance in this context.

In order to test the theory presented in Section 2.1, some numerical examples were made based on the active system in Fig. 4. For each version of the system, two separate methods for deriving the natural frequencies of the system were used: (a) modal analysis by solving the eigenvalue problem, and (b) frequency analysis of the time responses using the fast Fourier transform (FFT) algorithm. By comparing the results from the two methods (a) and (b), the degree of validity of the theory should be revealed, meaning that if both methods yield concurring results, the validity of the method is supported. The mechanical properties of the system were set to: 
                           
                              
                                 m
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 m
                              
                              
                                 2
                              
                           
                           =
                           
                              
                                 m
                              
                              
                                 3
                              
                           
                           =
                           1
                           
                           kg
                        , 
                           
                              
                                 c
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 c
                              
                              
                                 2
                              
                           
                           =
                           
                              
                                 c
                              
                              
                                 3
                              
                           
                           =
                           0
                           
                           Ns
                           /
                           m
                         and 
                           
                              
                                 k
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 k
                              
                              
                                 2
                              
                           
                           =
                           
                              
                                 k
                              
                              
                                 3
                              
                           
                           =
                           100
                           
                           N
                           /
                           m
                        , while the controller was set to be a velocity feedback PID controller with controller gains 
                           
                              
                                 K
                              
                              
                                 p
                              
                           
                           =
                           0
                        , 
                           
                              
                                 K
                              
                              
                                 i
                              
                           
                           =
                           50
                         and 
                           
                              
                                 K
                              
                              
                                 d
                              
                           
                           =
                           0.5
                        . Damping, both passive and active, were deliberately not included in this example in order to better see all frequency peaks in the FFT plots. To derive the natural frequencies using the FFT, the mass m
                        3 was given an initial deflection and the time domain response of the mechanism was recorded. This simulation was carried out in FEDEM, with a total simulation time of 10s and a simulation time increment of 0.001s, yielding a frequency sampling rate f
                        
                           s
                         of 1000Hz and a frequency resolution of approximately 0.1Hz. The result from the FFT is shown in 
                        Fig. 6.

As can be seen in Fig. 6, three frequency peaks are present, appearing at 
                           
                              
                                 ω
                              
                              
                                 1
                              
                           
                           =
                           0.9
                           
                           Hz
                        , 
                           
                              
                                 ω
                              
                              
                                 2
                              
                           
                           =
                           2.1
                           
                           Hz
                         and 
                           
                              
                                 ω
                              
                              
                                 3
                              
                           
                           =
                           2.8
                           
                           Hz
                        .

Inserting the given values for the active system into Eq. (13) gives the following equation:
                           
                              (30)
                              
                                 
                                    [
                                    
                                       
                                          
                                             
                                                1
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                1
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   0.5
                                                
                                             
                                             
                                                0
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            r
                                                            ¨
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            r
                                                            ¨
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            r
                                                            ¨
                                                         
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 +
                                 
                                    [
                                    
                                       
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            r
                                                            ̇
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            r
                                                            ̇
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            r
                                                            ̇
                                                         
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 +
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   200
                                                
                                             
                                             
                                                
                                                   −
                                                   100
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   −
                                                   100
                                                
                                             
                                             
                                                
                                                   200
                                                
                                             
                                             
                                                
                                                   −
                                                   100
                                                
                                             
                                          
                                          
                                             
                                                
                                                   50
                                                
                                             
                                             
                                                
                                                   −
                                                   100
                                                
                                             
                                             
                                                
                                                   100
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 =
                                 0
                              
                           
                        which, by solving the eigenvalue problem, yields the eigenfrequencies 
                           
                              
                                 ω
                              
                              
                                 1
                              
                           
                           =
                           0.8613
                           
                           Hz
                        , 
                           
                              
                                 ω
                              
                              
                                 2
                              
                           
                           =
                           2.0795
                           
                           Hz
                         and 
                           
                              
                                 ω
                              
                              
                                 3
                              
                           
                           =
                           2.7566
                           
                           Hz
                        . A comparison of the results from the FFT and the modal analysis is shown in 
                        Table 1.

As can be seen in Table 1, the two methods yield concurrent eigenfrequency estimates for the system. To better distinguish between the results, the eigenfrequencies derived by the modal analysis are given with four decimals, while the FFT is only given with one since the FFT only has a frequency resolution of 0.1Hz.

By comparison, if the active system in Fig. 4 has collocated sensor and actuator, both acting on DOF r
                        3, the following system equation based on Eq. (9) is given
                           
                              (31)
                              
                                 
                                    [
                                    
                                       
                                          
                                             
                                                1
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                1
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                
                                                   1.5
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            r
                                                            ¨
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            r
                                                            ¨
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            r
                                                            ¨
                                                         
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 +
                                 
                                    [
                                    
                                       
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            r
                                                            ̇
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            r
                                                            ̇
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            r
                                                            ̇
                                                         
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 +
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   200
                                                
                                             
                                             
                                                
                                                   −
                                                   100
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   −
                                                   100
                                                
                                             
                                             
                                                
                                                   200
                                                
                                             
                                             
                                                
                                                   −
                                                   100
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                
                                                   −
                                                   100
                                                
                                             
                                             
                                                
                                                   150
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 =
                                 0
                              
                           
                        which, by solving the eigenvalue problem, yields the eigenfrequencies 
                           
                              
                                 ω
                              
                              
                                 1
                              
                           
                           =
                           0.9498
                           
                           Hz
                        , 
                           
                              
                                 ω
                              
                              
                                 2
                              
                           
                           =
                           1.9350
                           
                           Hz
                         and 
                           
                              
                                 ω
                              
                              
                                 3
                              
                           
                           =
                           2.8317
                           
                           Hz
                        . The FFT plot for this system is shown in 
                        Fig. 7.

As can be seen in Fig. 7, three frequency peaks are present, appearing at 
                           
                              
                                 ω
                              
                              
                                 1
                              
                           
                           =
                           1.0
                           
                           Hz
                        , 
                           
                              
                                 ω
                              
                              
                                 2
                              
                           
                           =
                           1.9
                           
                           Hz
                         and 
                           
                              
                                 ω
                              
                              
                                 3
                              
                           
                           =
                           2.8
                           
                           Hz
                        . A comparison of the results from the FFT and the modal analysis is shown in 
                        Table 2.

As can be seen in Table 2, the two methods yield concurrent eigenfrequency estimates for the system. By comparing the results presented in Table 1 and Table 2, the difference between a system containing collocated sensor and actuator vs. a system containing non-collocated sensor and actuator is shown to be significant.

In order to further illustrate the theory, two more tests were performed on the given system, although with a slight alteration: K
                        
                           d
                         was changed to 0.3 and 0.7. The FFT plots for these tests are shown in 
                        Fig. 8 and 
                        Fig. 9, and the results from the tests are shown in 
                        Table 3 and 
                        Table 4, respectively. For the modal analysis of these tests, the relevant values for K
                        
                           d
                         were altered in Eq. (30), and the eigenvalue problem was solved. The results from the modal analyses are also shown in Table 3 and Table 4.

As seen in both Tables 3 and 4, the FFT and the eigenvalue problem yield concurrent results, which further support a validity of the presented theory. As before, the difference between the results is probably due to the number of given decimals.

In order to test the theory derived in Section 2.2, four experiments involving an active SDOF system were conducted. 
                        Fig. 10 depicts a sketch of the experiment setup.

The system in Fig. 10 consists of a mass m
                        1 connected to a wall via a spring k
                        1 and a damper c
                        1. There is one DOF in the system: translation in the horizontal direction (r
                        1). An active force F
                        
                           Ctrl
                         is acting on the mass m
                        1; the active force is governed by a position feedback PID controller whose reference is the position r
                        1 of the mass. The parameters of the system were given as follows:


                        m
                        1=1kg, c
                        1=8Ns/m, k
                        1=12N/m, K
                        
                           p
                        =4, K
                        
                           i
                        =q and K
                        
                           d
                        =2. Based on Eq. (22), the effective mass m, damping c and stiffness k of the system are: m=1kg, c=10Ns/m and k=16N/m, yielding an undamped natural frequency of
                           
                              (32)
                              
                                 
                                    
                                       ω
                                    
                                    
                                       n
                                    
                                 
                                 =
                                 
                                    
                                       
                                          k
                                          m
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             16
                                          
                                          1
                                       
                                    
                                 
                                 =
                                 4
                                 
                                 rad
                                 /
                                 s
                                 =
                                 0.6366
                                 
                                 Hz
                              
                           
                        and a value for the critical damping of
                           
                              (33)
                              
                                 
                                    
                                       c
                                    
                                    
                                       c
                                    
                                 
                                 =
                                 
                                    
                                       4
                                       m
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       4
                                       ×
                                       1
                                       ×
                                       16
                                    
                                 
                                 =
                                 8
                                 
                                 Ns
                                 /
                                 m
                              
                           
                        
                     

A comparison of the values for c and c
                        
                           c
                         reveals that, in principle at least, the system is overcritically damped, i.e. no oscillations should occur. However, increasing K
                        
                           i
                         should make the system start to oscillate. Using Eq. (26), the value for K
                        
                           i
                         that should give a constant oscillation is
                           
                              (34)
                              
                                 
                                    
                                       q
                                    
                                    
                                       s
                                    
                                 
                                 =
                                 c
                                 
                                    k
                                    m
                                 
                                 =
                                 10
                                 ×
                                 
                                    
                                       16
                                    
                                    1
                                 
                                 =
                                 160
                                 
                                 N
                                 /
                                 ms
                              
                           
                        
                     

Four different experiments were performed on this system by changing the value for the integral gain K
                        
                           i
                         from 0 to 80, 160 and 240, which should yield the following systems: overcritically damped, undercritically damped, undamped/marginally stable and unstable, respectively. The objectives of the experiments were to illustrate how K
                        
                           i
                         affects the system and to derive the eigenfrequencies and damping ratios for each case using the method outlined in Section 2.2. Additionally, in order to verify the theory, one time simulation of the free vibration of the system was performed for each case. The simulations were carried out in FEDEM; the system was set into motion by giving the mass an initial displacement. Each simulation had a total simulation time of 5s, with a time increment of 0.0005s.

The time response for the simulation with K
                           
                              i
                           =0 is shown in 
                           Fig. 11.

As seen from Fig. 11, the system is not oscillating. Solving Eq. (19) in MATLAB using the eig() routine yields a diagonal matrix 
                              D
                            of generalized eigenvalues and a full matrix 
                              V
                           , whose columns are the corresponding eigenvectors. The diagonal elements in 
                              D
                            correspond to the roots s of Eq. (24) when using the system shown in Eq. (27). Hence, solving Eq. (24) with respect to s, or Eq. (19) inserted for 
                              A
                            and 
                              B
                            in accordance with Eq. (27), yields the eigenvalues as three real, negative and unequal values, thereby indicating a system without oscillations.

The time response for the simulation with K
                           
                              i
                           =80 is shown in 
                           Fig. 12.

As seen from Fig. 12, the system is oscillating with decreasing amplitudes. Max peaks 1 and 2 occur at time t
                           1=1.6770s and t
                           2=3.8280s with amplitudes x
                           1=0.0225356m and x
                           2=0.0095886m, respectively. This yields a time period of
                              
                                 (35)
                                 
                                    τ
                                    =
                                    
                                       
                                          t
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          t
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    3
                                    .
                                    8280
                                    −
                                    1
                                    .
                                    6770
                                    =
                                    2
                                    .
                                    1510
                                    
                                    s
                                 
                              
                           and an eigenfrequency of
                              
                                 (36)
                                 
                                    ω
                                    =
                                    
                                       1
                                       τ
                                    
                                    =
                                    
                                       1
                                       
                                          2
                                          .
                                          1510
                                       
                                    
                                    =
                                    0
                                    .
                                    4649
                                    
                                    Hz
                                 
                              
                           
                        

The damping ratio 
                              ζ
                            of an oscillation can be derived from [7]
                           
                              
                                 (37)
                                 
                                    δ
                                    =
                                    
                                    ln
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       )
                                    
                                    =
                                    
                                    ln
                                    
                                    
                                       
                                          e
                                       
                                       
                                          ζ
                                          
                                             
                                                ω
                                             
                                             
                                                n
                                             
                                          
                                          τ
                                       
                                    
                                    ⇒
                                    ζ
                                    =
                                    
                                       δ
                                       
                                          
                                             
                                                ω
                                             
                                             
                                                n
                                             
                                          
                                          τ
                                       
                                    
                                    =
                                    
                                       
                                          ln
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                1
                                             
                                          
                                          /
                                          
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       
                                          
                                             
                                                ω
                                             
                                             
                                                n
                                             
                                          
                                          τ
                                       
                                    
                                 
                              
                           
                        

Inserting for x
                           1 and x
                           2 yields the following damping ratio
                              
                                 (38)
                                 
                                    ζ
                                    =
                                    
                                       
                                          ln
                                          
                                             (
                                             
                                                
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                       
                                       
                                          
                                             
                                                ω
                                             
                                             
                                                n
                                             
                                          
                                          τ
                                       
                                    
                                    =
                                    
                                       
                                          ln
                                          (
                                          0.0225356
                                          /
                                          0.0095886
                                          )
                                       
                                       
                                          4
                                          ×
                                          2
                                          .
                                          1510
                                       
                                    
                                    =
                                    0.0993
                                 
                              
                           
                        

As in Section 3.2.1, solving Eq. (24) with respect to s, or Eq. (19) inserted for 
                              A
                            and 
                              B
                            in accordance with Eq. (27), yields the eigenvalues as one real and negative value and a pair of complex conjugate values. The complex conjugate values are:
                              
                                 (39)
                                 
                                    s
                                    =
                                    −
                                    0
                                    .
                                    3970
                                    ±
                                    2
                                    .
                                    9210
                                    i
                                 
                              
                           which gives the eigenfrequency
                              
                                 (40)
                                 
                                    ω
                                    =
                                    
                                       
                                          2
                                          .
                                          9210
                                       
                                       
                                          2
                                          π
                                       
                                    
                                    =
                                    0.4649
                                    
                                    Hz
                                 
                              
                           and the damping ratio
                              
                                 (41)
                                 
                                    ζ
                                    =
                                    −
                                    
                                       
                                          −
                                          0.3970
                                       
                                       
                                          
                                             
                                                ω
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                    =
                                    −
                                    
                                       
                                          −
                                          0.3970
                                       
                                       4
                                    
                                    =
                                    0.0993
                                 
                              
                           
                        

The results from this experiment are summarized in 
                           Table 5.

As seen from the results presented in Table 5, the time simulation and solution of the eigenvalue problem yield identical results.

The time response for the simulation with K
                           
                              i
                           =160 is shown in 
                           Fig. 13.

As seen from Fig. 13, the system is oscillating with a constant amplitude. Max peaks 1 and 2 occur at time t
                           1=1.2735s and t
                           2=2.8440s with amplitudes x
                           1=0.0278458m and x
                           2=0.0278311m, respectively. This yields a time period of
                              
                                 (42)
                                 
                                    τ
                                    =
                                    
                                       
                                          t
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          t
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    2
                                    .
                                    8440
                                    −
                                    1
                                    .
                                    2735
                                    =
                                    1.5705
                                    
                                    s
                                 
                              
                           and an eigenfrequency of
                              
                                 (43)
                                 
                                    ω
                                    =
                                    
                                       1
                                       τ
                                    
                                    =
                                    
                                       1
                                       
                                          1.5705
                                       
                                    
                                    =
                                    0
                                    .
                                    6367
                                    
                                    Hz
                                 
                              
                           
                        

Inserting for x
                           1 and x
                           2 yields the following damping ratio
                              
                                 (44)
                                 
                                    ζ
                                    =
                                    
                                       
                                          ln
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                1
                                             
                                          
                                          /
                                          
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       
                                          
                                             
                                                ω
                                             
                                             
                                                n
                                             
                                          
                                          τ
                                       
                                    
                                    =
                                    
                                       
                                          ln
                                          (
                                          0.0278458
                                          /
                                          0.0278311
                                          )
                                       
                                       
                                          4
                                          ⋅
                                          1.5705
                                       
                                    
                                    =
                                    0.0001
                                 
                              
                           
                        

Solving Eq. (24) with respect to s, or Eq. (19) inserted for 
                              A
                            and 
                              B
                            in accordance with Eq. (27), yields the eigenvalues as one real and negative value and a pair of complex conjugate values. The complex conjugate values are
                              
                                 (45)
                                 
                                    s
                                    =
                                    0
                                    ±
                                    4
                                    i
                                 
                              
                           which gives the eigenfrequency
                              
                                 (46)
                                 
                                    ω
                                    =
                                    
                                       4
                                       
                                          2
                                          π
                                       
                                    
                                    =
                                    0.6366
                                    
                                    Hz
                                 
                              
                           and the damping ratio
                              
                                 (47)
                                 
                                    ζ
                                    =
                                    −
                                    
                                       0
                                       
                                          
                                             
                                                ω
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                    =
                                    −
                                    
                                       0
                                       4
                                    
                                    =
                                    0
                                 
                              
                           
                        

The results from this experiment are summarized in 
                           Table 6.

As seen from the results presented in Table 6, the time simulation and solution of the eigenvalue problem yield almost identical results. The difference in the results between the time simulation and eigenvalue problem is probably due to the inherent limited numerical accuracy of the time simulation.

The time response for the simulation with K
                           
                              i
                           =240 is shown in 
                           Fig. 14.

As seen from Fig. 14, the system is oscillating with increasing amplitudes. Max peaks 1 and 2 occur at time t
                           1=1.0935s and t
                           2=2.4180s with amplitudes x
                           1=0.0297421m and x
                           2=0.0448529m, respectively. This yields a time period of
                              
                                 (48)
                                 
                                    τ
                                    =
                                    
                                       
                                          t
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          t
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    
                                    2
                                    .
                                    4180
                                    −
                                    1.0935
                                    =
                                    1.3245
                                    
                                    s
                                 
                              
                           and an eigenfrequency of
                              
                                 (49)
                                 
                                    ω
                                    =
                                    
                                       1
                                       τ
                                    
                                    =
                                    
                                       1
                                       1.3245
                                    
                                    =
                                    0
                                    .
                                    7550
                                    
                                    Hz
                                 
                              
                           
                        

Inserted for x
                           1 and x
                           2 yields the following damping ratio
                              
                                 (50)
                                 
                                    ζ
                                    =
                                    
                                       
                                          ln
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                1
                                             
                                          
                                          /
                                          
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       
                                          
                                             
                                                ω
                                             
                                             
                                                n
                                             
                                          
                                          τ
                                       
                                    
                                    =
                                    
                                       
                                          ln
                                          (
                                          0.0297421
                                          /
                                          0.0448529
                                          )
                                       
                                       
                                          4
                                          ⋅
                                          1.3245
                                       
                                    
                                    =
                                    −
                                    0.0775
                                 
                              
                           
                        

Solving Eq. (24) with respect to s, or Eq. (19) inserted for 
                              A
                            and 
                              B
                            in accordance with Eq. (27), yields the eigenvalues as one real and negative value and a pair of complex conjugate values. The complex conjugate values are
                              
                                 (51)
                                 
                                    
                                    s
                                    =
                                    0
                                    .
                                    3105
                                    ±
                                    4
                                    .
                                    7434
                                    i
                                 
                              
                           which gives the eigenfrequency
                              
                                 (52)
                                 
                                    ω
                                    =
                                    
                                       
                                          4
                                          .
                                          7434
                                       
                                       
                                          2
                                          π
                                       
                                    
                                    =
                                    0.7549
                                    
                                    Hz
                                 
                              
                           and the damping ratio
                              
                                 (53)
                                 
                                    ζ
                                    =
                                    −
                                    
                                       
                                          0
                                          .
                                          3105
                                       
                                       
                                          
                                             
                                                ω
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                    =
                                    −
                                    
                                       
                                          0
                                          .
                                          3105
                                       
                                       4
                                    
                                    =
                                    −
                                    0.0776
                                 
                              
                           
                        

The results from this experiment are summarized in 
                           Table 7.

As can be seen from the results presented in Table 7, the time simulation and solution of the eigenvalue problem yield almost identical results. Again, the difference in the results between the time simulation and eigenvalue problem is probably due to the inherent limited numerical accuracy of the time simulation.

When solving Eq. (24) with respect to s or Eq. (19) inserted for 
                              A
                            and 
                              B
                            in accordance with Eq. (27), the effects of varying q can be seen over a greater range of values. The eigenfrequency 
                              ω
                            and damping ratio 
                              ζ
                            for 
                              0
                              ≤
                              q
                              ≤
                              2
                              
                                 
                                    q
                                 
                                 
                                    s
                                 
                              
                              =
                              0
                              …
                              320
                            are shown in 
                           Fig. 15.

As seen in Fig. 15, the eigenfrequency 
                              ω
                            goes from 0Hz to 0.8481Hz while the damping ratio 
                              ζ
                            goes from 0.2301 to −0.1427. For q<8, 
                              ω
                              =
                              0
                              
                              Hz
                           , indicating a system with a non-oscillatory motion, i.e. an overcritically damped system. For this reason, 
                              ζ
                            does not have any values for q<8. For q>160, 
                              ζ
                              <
                              0
                           , which indicates a system with “negative damping”, i.e. a growing oscillation and thus an unstable system.

To further test the theory derived in Chapter 2, the system shown in 
                        Fig. 16 was used. To illustrate the effects of the controller, two versions of the system in Fig. 16 were made: one with and one without the controller, i.e. a passive and an active system, respectively.

The system in Fig. 16 is comprised of three masses (m
                        1, m
                        2 and m
                        3) in series connected by springs (k
                        1, k
                        2 and k
                        3) and dampers (c
                        1, c
                        2 and c
                        3). Each mass has one DOF: translation in the horizontal plane, named r
                        1, r
                        2 and r
                        3, respectively. The system is controlled by a position feedback PID controller with a sensor measuring position of r
                        1, whereas an actuator is affecting mass m
                        3 as a force F
                        
                           Ctrl
                        . The mechanical properties of the system were set to: 
                           
                              
                                 m
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 m
                              
                              
                                 2
                              
                           
                           =
                           
                              
                                 m
                              
                              
                                 3
                              
                           
                           =
                           1
                           
                           kg
                        , 
                           
                              
                                 c
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 c
                              
                              
                                 2
                              
                           
                           =
                           
                              
                                 c
                              
                              
                                 3
                              
                           
                           =
                           1
                           
                           Ns
                           /
                           m
                         and 
                           
                              
                                 k
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 k
                              
                              
                                 2
                              
                           
                           =
                           
                              
                                 k
                              
                              
                                 3
                              
                           
                           =
                           100
                           
                           N
                           /
                           m
                        , and the controller gains to: 
                           
                              
                                 K
                              
                              
                                 p
                              
                           
                           =
                           80
                        , 
                           
                              
                                 K
                              
                              
                                 i
                              
                           
                           =
                           20
                         and 
                           
                              
                                 K
                              
                              
                                 d
                              
                           
                           =
                           0.5
                        . Arranging these system properties in matrix form based on Eq. (10), and expressing the position vector as: 
                           r
                           =
                           
                              
                                 [
                                 
                                    
                                       r
                                    
                                    
                                       1
                                    
                                 
                                 
                                 
                                    
                                       r
                                    
                                    
                                       2
                                    
                                 
                                 
                                 
                                    
                                       r
                                    
                                    
                                       3
                                    
                                 
                                 ]
                              
                              T
                           
                         and the velocity and acceleration vectors in a similar manner, the matrices of the mechanical system are
                           
                              (54)
                              
                                 M
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                1
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                1
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 ,
                                 
                                 C
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                2
                                             
                                             
                                                
                                                   −
                                                   1
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   −
                                                   1
                                                
                                             
                                             
                                                2
                                             
                                             
                                                
                                                   −
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                
                                                   −
                                                   1
                                                
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 ,
                                 
                                 K
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   200
                                                
                                             
                                             
                                                
                                                   −
                                                   100
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   −
                                                   100
                                                
                                             
                                             
                                                
                                                   200
                                                
                                             
                                             
                                                
                                                   −
                                                   100
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                
                                                   −
                                                   100
                                                
                                             
                                             
                                                
                                                   100
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                              
                           
                        while the matrices of the controller gradients are
                           
                              (55)
                              
                                 
                                    
                                       G
                                    
                                    
                                       A
                                       c
                                       c
                                    
                                 
                                 =
                                 0
                                 ,
                                 
                                 
                                    
                                       G
                                    
                                    
                                       V
                                       e
                                       l
                                    
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   0.5
                                                
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 ,
                                 
                                 
                                    
                                       G
                                    
                                    
                                       P
                                       o
                                       s
                                    
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   80
                                                
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 ,
                                 
                                 
                                    
                                       G
                                    
                                    
                                       S
                                       S
                                       E
                                       E
                                    
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   20
                                                
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    ]
                                 
                              
                           
                        
                     

For the passive version of the system, only the mechanical properties of the system were included in the eigenvalue problem. To derive the eigenfrequencies of the passive system in Fig. 16 with the given properties, the 2n generalized eigenvalue problem shown in Eq. (19) was solved. Based on Eq. (18), the 
                           A
                         and 
                           B
                         matrices for Eq. (19) are
                           
                              (56)
                              
                                 A
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   200
                                                
                                             
                                             
                                                
                                                   −
                                                   100
                                                
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   −
                                                   100
                                                
                                             
                                             
                                                
                                                   200
                                                
                                             
                                             
                                                
                                                   −
                                                   100
                                                
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                
                                                   −
                                                   100
                                                
                                             
                                             
                                                
                                                   100
                                                
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                
                                                   −
                                                   1
                                                
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                
                                                   −
                                                   1
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                
                                                   −
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                              
                           
                        
                        
                           
                              (57)
                              
                                 B
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   −
                                                   2
                                                
                                             
                                             
                                                1
                                             
                                             
                                                0
                                             
                                             
                                                
                                                   −
                                                   1
                                                
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                1
                                             
                                             
                                                
                                                   −
                                                   2
                                                
                                             
                                             
                                                1
                                             
                                             
                                                0
                                             
                                             
                                                
                                                   −
                                                   1
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                1
                                             
                                             
                                                
                                                   −
                                                   1
                                                
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                
                                                   −
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   −
                                                   1
                                                
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                
                                                   −
                                                   1
                                                
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                
                                                   −
                                                   1
                                                
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    ]
                                 
                              
                           
                        
                     

Solving Eq. (19) with Eq. (56) and Eq. (57) inserted yields the following eigenfrequencies: 
                           
                              
                                 ω
                              
                              
                                 1
                              
                           
                           =
                           0.7081
                           
                           Hz
                        , 
                           
                              
                                 ω
                              
                              
                                 2
                              
                           
                           =
                           1.9808
                           
                           Hz
                         and 
                           
                              
                                 ω
                              
                              
                                 3
                              
                           
                           =
                           2.8562
                           
                           Hz
                        . Alternatively, the 3n generalized eigenvalue problem with 
                           A
                         and 
                           B
                         matrices as shown in Eq. (29) can be used. The 
                           A
                         and 
                           B
                         matrices for Eq. (19) are then
                           
                              (58)
                              
                                 A
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                
                                                   200
                                                
                                             
                                             
                                                
                                                   −
                                                   100
                                                
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                
                                                   −
                                                   100
                                                
                                             
                                             
                                                
                                                   200
                                                
                                             
                                             
                                                
                                                   −
                                                   100
                                                
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                
                                                   −
                                                   100
                                                
                                             
                                             
                                                
                                                   100
                                                
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                1
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                1
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    ]
                                 
                              
                           
                        
                        
                           
                              (59)
                              
                                 B
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   −
                                                   200
                                                
                                             
                                             
                                                
                                                   100
                                                
                                             
                                             
                                                0
                                             
                                             
                                                
                                                   −
                                                   2
                                                
                                             
                                             
                                                1
                                             
                                             
                                                0
                                             
                                             
                                                
                                                   −
                                                   1
                                                
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   100
                                                
                                             
                                             
                                                
                                                   −
                                                   200
                                                
                                             
                                             
                                                
                                                   100
                                                
                                             
                                             
                                                1
                                             
                                             
                                                
                                                   −
                                                   2
                                                
                                             
                                             
                                                1
                                             
                                             
                                                0
                                             
                                             
                                                
                                                   −
                                                   1
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                
                                                   100
                                                
                                             
                                             
                                                
                                                   −
                                                   100
                                                
                                             
                                             
                                                0
                                             
                                             
                                                1
                                             
                                             
                                                
                                                   −
                                                   1
                                                
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                
                                                   −
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   200
                                                
                                             
                                             
                                                
                                                   −
                                                   100
                                                
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   −
                                                   100
                                                
                                             
                                             
                                                
                                                   200
                                                
                                             
                                             
                                                
                                                   −
                                                   100
                                                
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                
                                                   −
                                                   100
                                                
                                             
                                             
                                                
                                                   100
                                                
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                1
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                1
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                1
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    ]
                                 
                              
                           
                        
                     

Solving Eq. (19) with Eqs. (58) and (59) inserted yields identical eigenfrequencies as the solution obtained using Eqs. (56) and (57) , i.e. 
                           
                              
                                 ω
                              
                              
                                 1
                              
                           
                           =
                           0.7081
                           
                           Hz
                        , 
                           
                              
                                 ω
                              
                              
                                 2
                              
                           
                           =
                           1.9808
                           
                           Hz
                         and 
                           
                              
                                 ω
                              
                              
                                 3
                              
                           
                           =
                           2.8562
                           
                           Hz
                        .

To derive the eigenfrequencies of the active system in Fig. 16 with the given properties, the generalized eigenvalue problem shown in Eq. (19) was solved based on Eq. (29). The 
                           A
                         and 
                           B
                         matrices in Eq. (19) are
                           
                              (60)
                              
                                 A
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   20
                                                
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                
                                                   200
                                                
                                             
                                             
                                                
                                                   −
                                                   100
                                                
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                
                                                   −
                                                   100
                                                
                                             
                                             
                                                
                                                   200
                                                
                                             
                                             
                                                
                                                   −
                                                   100
                                                
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                
                                                   80
                                                
                                             
                                             
                                                
                                                   −
                                                   100
                                                
                                             
                                             
                                                
                                                   100
                                                
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                1
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                1
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    ]
                                 
                              
                           
                        
                        
                           
                              (61)
                              
                                 B
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   −
                                                   200
                                                
                                             
                                             
                                                
                                                   100
                                                
                                             
                                             
                                                0
                                             
                                             
                                                
                                                   −
                                                   2
                                                
                                             
                                             
                                                1
                                             
                                             
                                                0
                                             
                                             
                                                
                                                   −
                                                   1
                                                
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   100
                                                
                                             
                                             
                                                
                                                   −
                                                   200
                                                
                                             
                                             
                                                
                                                   100
                                                
                                             
                                             
                                                1
                                             
                                             
                                                
                                                   −
                                                   2
                                                
                                             
                                             
                                                1
                                             
                                             
                                                0
                                             
                                             
                                                
                                                   −
                                                   1
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   −
                                                   80
                                                
                                             
                                             
                                                
                                                   100
                                                
                                             
                                             
                                                
                                                   −
                                                   100
                                                
                                             
                                             
                                                
                                                   −
                                                   0.5
                                                
                                             
                                             
                                                1
                                             
                                             
                                                
                                                   −
                                                   1
                                                
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                
                                                   −
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   200
                                                
                                             
                                             
                                                
                                                   −
                                                   100
                                                
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   −
                                                   100
                                                
                                             
                                             
                                                
                                                   200
                                                
                                             
                                             
                                                
                                                   −
                                                   100
                                                
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   80
                                                
                                             
                                             
                                                
                                                   −
                                                   100
                                                
                                             
                                             
                                                
                                                   100
                                                
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                1
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                1
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                1
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    ]
                                 
                              
                           
                        
                     

Solving Eq. (19) with Eq. (60) and Eq. (61) inserted yields the following eigenfrequencies: 
                           
                              
                                 ω
                              
                              
                                 1
                              
                           
                           =
                           1.0783
                           
                           Hz
                        , 
                           
                              
                                 ω
                              
                              
                                 2
                              
                           
                           =
                           1.7088
                           
                           Hz
                         and 
                           
                              
                                 ω
                              
                              
                                 3
                              
                           
                           =
                           2.9158
                           
                           Hz
                        .

To verify the eigenfrequencies derived for both versions of the system in Fig. 16, two time simulations of the system were performed in FEDEM, one for the passive and one for the active system. To initiate the simulations, the mass m
                        3 was given an initial deflection and the time domain response of the mechanism was recorded. The time simulations ran for 10s with a time increment of 0.001s, giving a frequency sampling rate f
                        
                           s
                         of 1000Hz and a frequency resolution of approximately 0.1Hz. The time domain results from the simulations for position r
                        2 were transformed into frequency domain results by using the FFT algorithm. The FFT results for the passive and active systems are shown in 
                        
                        Figs. 17 and 18, respectively.

In both Figs. 17 and 18, three frequency peaks are present, appearing at 
                           
                              
                                 ω
                              
                              
                                 1
                              
                           
                           =
                           0.7
                           
                           Hz
                        , 
                           
                              
                                 ω
                              
                              
                                 2
                              
                           
                           =
                           2.0
                           
                           Hz
                         and 
                           
                              
                                 ω
                              
                              
                                 3
                              
                           
                           =
                           2.9
                           
                           Hz
                        , and 
                           
                              
                                 ω
                              
                              
                                 1
                              
                           
                           =
                           1.1
                           
                           Hz
                        , 
                           
                              
                                 ω
                              
                              
                                 2
                              
                           
                           =
                           1.7
                           
                           Hz
                         and 
                           
                              
                                 ω
                              
                              
                                 3
                              
                           
                           =
                           2.9
                           
                           Hz
                        , respectively. The results from the simulations and the modal analyses are shown in 
                        Table 8.

As seen from the results in Table 8, there is a close correlation between the FFT and the modal analysis for both versions of the system in Fig. 16, thus indicating a validity of the modal analyses. Also, changing the system from passive to active greatly alters the eigenfrequencies of the system.


                        
                        Fig. 19 shows a FEDEM model of a simple car front suspension.

The suspension consists of mainly three structural parts: (1) upper control arm, (2) steering knuckle and (3) lower control arm, in addition to a spring and damper connected to the lower control arm and ground. Each structural part of the suspension is modeled as an FE model. Ball joints connect the steering knuckle to the upper and lower control arms, and the upper and lower control arms to the ground. The steering knuckle׳s translational movements in global x-direction are restrained at the attachment point of the steering link, making the whole suspension only able to rotate about the global x-axis.

This particular suspension contains both a passive and an active shock absorbing system. The passive system consists of a linear spring and viscous damper, while the active system is an actuator connected to the lower control arm at the attachment point of the passive system. The active system is governed by a position feedback PID controller with collocated sensor and actuator. The weight of the whole suspension is 2.1kg, the passive spring has a stiffness of 10,000N/m, the damper a damping coefficient of 50 Ns/m while the controller gains are: K
                        
                           p
                        =5000, K
                        
                           i
                        =200,000 and K
                        
                           d
                        =20. Both the passive and active system are deliberately not fully optimized, but have parameters chosen low in order to easier distinguish between relevant and irrelevant eigenfrequencies.

To verify the accuracy of the eigenfrequency calculation of the suspension, a time simulation response of the suspension when suddenly subjected to gravity was analyzed using the FFT algorithm. The time responses of displacement in global z-direction at steering knuckle center were used. The simulation ran for 10s with time increment 0.001s, yielding a frequency sampling rate f
                        
                           s
                         of 1000Hz and a frequency resolution of approximately 0.1Hz. The FFT plot of the time series is shown in 
                        Fig. 20.

In Fig. 20, one frequency peak is present, appearing at 
                           
                              
                                 ω
                              
                              
                                 1
                              
                           
                           =
                           9.0
                           
                           Hz
                        . Solving the generalized eigenvalue problem of the coupled passive and active system using the proposed 3n state-space method (including steady-state error elimination) and the traditional 2n state-space method (excluding steady-state error elimination) yields the results presented in 
                        Table 9.

As can be seen from the results in Table 9, there is a close correlation between the FFT and the 3n state-space method while this is not so much the case for the 2n state-space method.

@&#DISCUSSION@&#

In Section 3.1, a total of three cases for an SDOF system containing non-collocated sensors and actuators were examined. As seen from the results presented in that section, there is a close correlation between the theory presented in Section 2.1 and the results from the tests performed. The comparison made between a system containing collocated vs. non-collocated sensors and actuators in Section 3.1 shows that the difference between the two systems is significant. As mentioned in Section 2.1, if a system contains one or more non-collocated sensors and actuators, the system matrices will be unsymmetrical. This means that ordinary symmetric eigensolver methods cannot be used. If such is the case, non-symmetric eigensolver methods may be used instead [17,30].

In Section 3.2, four cases of an SDOF system containing a position feedback PID controller were examined, putting an emphasis on the effects on the eigenfrequency and damping ratio caused by the steady-state error elimination. The results demonstrate that the steady-state error elimination can make a non-oscillatory system become not only oscillatory, but also highly unstable. Both eigenfrequency and damping ratio were shown to be affected by the steady-state error elimination term, indicating the importance of including these terms when performing modal analysis of systems containing such effects. Moreover, the presented method for deriving eigenvalues and eigenvectors for such systems using a 3n state-space formulation appears to be valid since all results derived using the state-space method concur well with the results derived using time simulations.

In Section 3.3, one example utilizing the theory derived in Chapter 2 was given. The system in the example contained a position feedback PID controller with a non-collocated sensor and actuator. Two tests were run on the system, one with and one without the controller being activated. The results show that the proposed eigenvalue solution method yields concurring results compared with results derived using discrete Fourier transforms of the time simulations. They also reveal the numerical difference in the derived eigenvalues for the passive and active system, once again highlighting the importance of including all properties in the system model when performing modal analysis of active systems.

Since the examples given in Sections 3.1 through 3.3 are fairly simple, their utilitarian value may be lost. In Section 3.4, the 3n state-space method was used on a more realistic example consisting of a simple car front suspension. Results obtained through this example showed that the proposed method is able to accurately handle larger systems. A small note can also be made from comparing the results of the effects of including/excluding the steady-state error elimination. The difference is not big, however, it is in the same magnitude as comparing damped versus undamped eigenfrequencies.

One major concern about the proposed 3n state-space method is the threefold increase in dimensions of the eigenvalue problem. A typical method or algorithm for solving the full eigenvalue problem in FE software systems is the QR [7,10,28,30–34] or QZ algorithm [28,33]; the QZ algorithm being a generalization the QR algorithm [28]. The QR algorithm is of order n
                     3 
                     [30]. For the proposed 3n state-space method, this would mean an (3n)3/n
                     3 increase in computation time for systems of large n, which means that solving the eigenvalue problem using the proposed 3n state-space method will be up to 27 times more expensive with respect to computational time than an n-space method.

It is worth mentioning that the proposed 3n state-space method given by Eq. (29) has not been considered as being optimized with respect to computational efficiency. There may also be other and more computational cost effective and/or well-conditioned ways of expressing that equation. The main effort in this work has been directed at deriving a functional expression, not an optimal one.

The proposed 3n state-space method is intended as a complement to the n-space method proposed by the authors in [3]. The proposed n-space method takes its basis in the same methods as the presented 3n state-space method, i.e. Eqs. (9) and (10), respectively, and is able to handle controller properties equivalent to mechanical mass and stiffness, but can be expanded to also include proportional/Rayleigh damping. The n-space method should be easier to implement in an FE software system and is more computationally effective than the presented 3n state-space method; however, it does not handle non-proportional damping or steady-state error elimination. For situations in which solving speed is more important than solution accuracy, or the effects by damping and steady-state error elimination are negligible with respect to the modal parameters, the n-space method can be used. Yet, if solution accuracy is an issue, or a stability analysis is desired, the presented 3n state-space method may be used. By offering these complementary methods for deriving the modal parameters of active flexible multibody systems, the ability to perform modal analyses of such systems for engineers working in an FE environment may be greatly improved.

@&#CONCLUSION@&#

In this work, a method for solving the eigenvalue problem for active multiple degrees of freedom systems containing position feedback PID controllers and non-collocated sensors and actuators has been derived and verified through numerical examples. The derived theory is intended to be implemented in a finite element software system, providing a powerful and accurate tool for engineers working in a finite element environment when performing modal analysis of active flexible multibody systems.

@&#ACKNOWLEDGMENTS@&#

The authors would like to acknowledge the guidance and assistance of Professor Ole Ivar Sivertsen and Professor Kristian Tønder at the Norwegian University of Science and Technology (NTNU), and the assistance from Dr. Knut Morten Okstad at Fedem Technology AS. The authors would also like to acknowledge the financial support from the Research Council of Norway and the other partners in the Lean Product Development (LPD) Project.

@&#REFERENCES@&#

