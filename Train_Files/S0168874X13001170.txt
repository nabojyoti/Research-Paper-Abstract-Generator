@&#MAIN-TITLE@&#XFEM investigation of a crack path in residual stresses resulting from quenching

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           Simulation of mechanical effects due to water quenching of a large thick plate made of 40CMD8 steel.


                        
                        
                           
                           Study of the influence of operating parameters on residual stresses with FEM.


                        
                        
                           
                           Application of XFEM to simulate a crack's path observed experimentally, which is initiated by the sawing of the plate.


                        
                        
                           
                           The results demonstrate the relevance of XFEM to study cracking problems through residual stress fields computed with FEM.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Quenching process

Residual stresses

XFEM

Crack path

@&#ABSTRACT@&#


               
               
                  The aim of this work is the numerical study of a crack path in a residual stress field resulting from a manufacturing process such as quenching. An XFEM technique is proposed to that end and the example illustrating the quenching of a large thick plate is considered so as to demonstrate the capability of the method proposed. Indeed, during the quenching of steels, metallurgical transformations can occur, leading to high residual stresses at room temperature. From the practical point of view, the thick plate must be sawn after quenching. But it is experimentally observed that, under certain quenching conditions, the crack initiated by the sawing, suddenly propagates through the thickness of the plate and then rotates through an angle of about 90°. The numerical simulation of quenching is detailed and the results obtained under two operating conditions are given. Then the XFEM technique applied to the crack propagation in a residual stress field is presented and the cracking path obtained on the quenched plate is compared to that obtained using the FEM coupled with a remeshing technique. It is shown that the computed crack path justifies experimental observations.
               
            

@&#INTRODUCTION@&#

The quenching process is often used in industry to improve the material properties of many mechanical steel components. The quenching of steels involves a fast cooling stage from an austenitic state generally obtained in a furnace. Due to the concomitant gradients of thermal strain and to the volume changes associated with the transformation of austenite into bainite or martensite during the cooling, residual stresses and distorsions occur in the component during the process. The residual stress state can be responsible for quench cracks. But the component can also be sawn after quenching and the propagation path of the crack initiated by the sawing strongly depends on the residual stress field, which can lead to surprising cutting profiles.

Measuring residual stresses through the thickness of a thick component so as to study the propagation path of a possible crack is utterly impossible. The numerical simulation of the quenching process is therefore the only way to access the residual stress field but the interactions between heat transfer, metallurgical transformations and stress–strain, as summarized in Fig. 1
                     , have to be accurately taken into account. A large number of research studies have been carried out for simulating the temperature field, the metallurgical changes and the stresses and distorsions induced by quenching. One can cite the work of Inoue and Raniecki [1], Denis et al. [2], Bergheau et al. [3] and more recently Kang et al. [4] and Li et al. [5] propose finite element programs to investigate the process parameters, Carlone et al. [6] focus on the prediction of the metallurgical structure, Da Silva et al. [7] study the distorsions of a C-ring and Lingamanaik and Chen [8] include the effects of carburizing. The finite element method is generally used [3] for the numerical simulations.

Studies concerning the propagation of a possible defect in the residual stress fields created by a quenching process are much rarer. Autesserre [9,10] proposed to use the finite element method combined with a remeshing technique and a second order fracture criterion to simulate the propagation of a crack in a quenched thick plate. But this type of approach is time consuming and is relatively complicated to implement. Moreover, when the piece is subjected to an initial (residual) stress field, this method raises the problem of the internal variables projection from one mesh to another. The past years have seen the emergence of new techniques to take account of the geometry of a crack and its evolution during propagation. The most popular enriched technique is the eXtended finite element method introduced by Moes et al. [11] for crack growth. It is based on the partition of the unity property of finite elements identified by Melenk and Babuska [12]. This approach is closely related to the GFEM technique proposed by Strouboulis et al. [13,14]. The XFEM method avoids both remeshing and the difficulty of the projection of internal variables such as phase proportions and plastic strains which are at the origin of the residual stress field in our case study. Therefore, the XFEM method is quite easy to use. Recently, Gallina [15] used the XFEM method to predict the formation of cracks during quenching but, to our knowledge, the simulation of a crack path in a component after quenching using XFEM has never been investigated.

In this paper we propose to study the mechanical effects of water quenching on a large thick plate made of 40CMD8 steel, the dimensions of which are 
                        0.4
                        ⁎
                        3
                        ⁎
                        5
                        
                        m
                     . This example comes from a real case study which has been studied by Autesserre [9]. After being completely austenitized in a furnace, the plate is quenched in water and then cooled in air up to room temperature before being sawn. Experience has shown that reducing the quenching time in water can lead to adverse effects, the sawing step becoming impossible to realize. It turns out that the saw initiates a crack which propagates almost instantly without following the desired trajectory because it rotates through an angle of about 90°. To understand the origin of this phenomenon by means of numerical modeling, this paper proposes a finite element approach to simulate the quenching step, followed by an XFEM simulation to compute the crack's propagation.


                     Section 2 presents the numerical simulation of the quenching of steel components. All the phenomena and their interactions which need to be taken into account to compute residual stresses are detailed. Section 3 presents the case study and the computed results for different quenching conditions. Section 4 focuses on the modeling of crack propagation in a residual stress field and especially the analysis of the crack initiated by the saw in the case of interrupted quenching conditions. A comparison of the crack paths obtained with FEM coupled with a remeshing technique is presented to show the interest of the numerical approach proposed.

Considering the Fourier conduction law, the heat equation writes:
                           
                              (1)
                              
                                 {
                                 
                                    
                                       
                                          
                                             ρ
                                             
                                                
                                                   H
                                                
                                                
                                                   ̇
                                                
                                             
                                             =
                                             div
                                             (
                                             λ
                                             
                                             grad
                                             
                                             T
                                             )
                                             
                                             in
                                             
                                             Ω
                                          
                                       
                                       
                                          
                                             λ
                                             
                                             grad
                                             
                                             T
                                             ·
                                             n
                                             =
                                             h
                                             (
                                             
                                                
                                                   T
                                                
                                                
                                                   (
                                                   p
                                                   )
                                                
                                             
                                             −
                                             T
                                             )
                                             
                                             on
                                             
                                             ∂
                                             Ω
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           ρ
                         is the material volumetric mass, H is the specific enthalpy, T is the temperature, 
                           λ
                         is the thermal conductivity, 
                           
                              
                                 T
                              
                              
                                 (
                                 p
                                 )
                              
                           
                         is the temperature of the quench liquid and n is the unit outward normal vector to the boundary 
                           ∂
                           Ω
                         of the domain 
                           Ω
                         representing the volume of the work piece. h is a coefficient which represents the heat exchanged between the mechanical component and the quench fluid supposed to be at the temperature 
                           
                              
                                 T
                              
                              
                                 (
                                 p
                                 )
                              
                           
                         during the cooling phase [16]. These two parameters can depend on space and time and may be determined or adjusted, for example, from measurements of the drasticity.

The weak formulation of the heat equation is classically obtained by multiplying Eq. (1)
                        1 by weighing function T
                        ⁎ and integrating over the domain 
                           Ω
                         
                        [17]. Integrating by parts and accounting for the boundary condition (1)
                        2, one thus obtains the following weak formulation:
                           
                              (2)
                              
                                 
                                    
                                       ∫
                                    
                                    
                                       Ω
                                    
                                 
                                 grad
                                 
                                 
                                    
                                       T
                                    
                                    
                                       ⁎
                                    
                                 
                                 λ
                                 
                                 grad
                                 
                                 T
                                 
                                 dv
                                 +
                                 
                                    
                                       ∫
                                    
                                    
                                       Ω
                                    
                                 
                                 
                                    
                                       T
                                    
                                    
                                       ⁎
                                    
                                 
                                 ρ
                                 
                                    
                                       H
                                    
                                    
                                       ̇
                                    
                                 
                                 
                                 dv
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       ∂
                                       Ω
                                    
                                 
                                 
                                    
                                       T
                                    
                                    
                                       ⁎
                                    
                                 
                                 h
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       (
                                       p
                                       )
                                    
                                 
                                 −
                                 T
                                 )
                                 
                                 ds
                              
                           
                        
                     

Following the usual procedure, the weak formulation (2) is applied to the finite element approximation of the function T given by
                           
                              (3)
                              
                                 T
                                 ≈
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       T
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        
                     

In this expression, N denotes the number of nodes, T
                        
                           i
                         the value of the function T at node i and N
                        
                           i
                         the shape function associated to this node. Following Galerkin's approach, the weighting function T
                        ⁎ takes the same form.

Applying for instance an implicit Euler algorithm for time discretization of the enthalpy H 
                        [18], the finite element method then leads to solve at each time step a system of N equations of the form:
                           
                              (4)
                              
                                 
                                    
                                       ∫
                                    
                                    
                                       Ω
                                    
                                 
                                 grad
                                 (
                                 
                                    
                                       N
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 λ
                                 
                                 grad
                                 (
                                 T
                                 )
                                 
                                 dv
                                 +
                                 
                                    
                                       ∫
                                    
                                    
                                       Ω
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       i
                                    
                                 
                                 ρ
                                 
                                    
                                       Δ
                                       H
                                    
                                    
                                       Δ
                                       t
                                    
                                 
                                 dv
                                 −
                                 
                                    
                                       ∫
                                    
                                    
                                       ∂
                                       Ω
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       i
                                    
                                 
                                 h
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       (
                                       p
                                       )
                                    
                                 
                                 −
                                 T
                                 )
                                 
                                 ds
                                 =
                                 0
                              
                           
                        
                     

Three types of interaction between thermal and metallurgical phenomena must be considered [19,3]:
                           
                              •
                              metallurgical transformations depend on the thermal history,

metallurgical transformations are accompanied by latent heat effects which modify temperature distributions,

thermal properties are phase dependent.

Different approaches can be used to describe the transformation kinetics in steels [20–22]. These approaches rest upon the modeling of transformations under either isothermal conditions (IT diagrams) or anisothermal conditions. In the latter case, parameters come from CCT diagrams. The model we use in this study lies in the second category. Generally, those models can be expressed, in the case of one transformation, with a differential equation of the following type:
                           
                              (5)
                              
                                 
                                    
                                       p
                                    
                                    
                                       ̇
                                    
                                 
                                 =
                                 f
                                 (
                                 p
                                 ,
                                 T
                                 ,
                                 …
                                 )
                              
                           
                        where p is the proportion of the created phase. Leblond and Devaux [21] have suggested the use of a simple first order differential equation of the form:
                           
                              (6)
                              
                                 
                                    
                                       p
                                    
                                    
                                       ̇
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ¯
                                          
                                       
                                       (
                                       T
                                       )
                                       −
                                       p
                                    
                                    
                                       τ
                                       (
                                       T
                                       )
                                    
                                 
                                 F
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       ̇
                                    
                                 
                                 )
                              
                           
                        
                        
                           
                              
                                 p
                              
                              
                                 ¯
                              
                           
                           (
                           T
                           )
                         denotes the phase proportion obtained after an infinite time at temperature T, 
                           τ
                           (
                           T
                           )
                         a time delay depending on temperature T and 
                           F
                           (
                           
                              
                                 T
                              
                              
                                 ̇
                              
                           
                           )
                         a function representing the dependency of the transformation rate with the temperature rate. These parameters are adjusted for each transformation in order to represent the CCT diagram. One can note that if the 
                           F
                           (
                           
                              
                                 T
                              
                              
                                 ̇
                              
                           
                           )
                         is chosen proportional to 
                           
                              
                                 T
                              
                              
                                 ̇
                              
                           
                        , then the resulting phase proportion only depends on temperature as is the case for martensitic transformation which follows the Koistinen–Marburger law [23]:
                           
                              (7)
                              
                                 p
                                 (
                                 T
                                 )
                                 =
                                 (
                                 1
                                 −
                                 
                                    
                                       e
                                    
                                    
                                       −
                                       b
                                       (
                                       
                                          
                                             M
                                          
                                          
                                             s
                                          
                                       
                                       −
                                       T
                                       )
                                    
                                 
                                 )
                              
                           
                        where M
                        
                           s
                         and b respectively characterize the temperature at the beginning of transformation and the evolution of transformation with temperature. In such a case, one has to choose 
                           
                              
                                 p
                              
                              
                                 ¯
                              
                           
                           (
                           T
                           )
                           =
                           1
                         for 
                           T
                           ≤
                           
                              
                                 M
                              
                              
                                 s
                              
                           
                         and 0 else and 
                           τ
                           =
                           1
                           /
                           b
                        . The effect of stresses on transformation kinetics has been widely examined [24], but, in practice, the lack of material data is a strong limitation to the application of models so that this effect is neglected in this study. Once p is known, the enthalpy H of the mixture may be obtained from the simple “linear mixture rule”:
                           
                              (8)
                              
                                 H
                                 =
                                 (
                                 1
                                 −
                                 p
                                 )
                                 
                                    
                                       H
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 T
                                 )
                                 +
                                 
                                    
                                       pH
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 T
                                 )
                              
                           
                        where 
                           
                              
                                 H
                              
                              
                                 1
                              
                           
                           (
                           T
                           )
                         denotes the enthalpy of the parent phase 1, the proportion of which is 
                           (
                           1
                           −
                           p
                           )
                         and 
                           
                              
                                 H
                              
                              
                                 2
                              
                           
                           (
                           T
                           )
                         that of the product phase 2, the proportion of which is p. Although this expression disregards possible thermodynamic interactions between the phases, it is widely considered to provide an acceptable approximation of the enthalpy of alloys during phase changes. The material volumetric mass 
                           ρ
                         and the thermal conductivity 
                           λ
                         of the mixture may be obtained in the same way. The model has been generalized in order to consider several transformations between several phases [21]. The material thermal properties are then obtained through mixture laws between the thermal properties of all the phases.

The mechanical analysis is based on the momentum equation where inertial effects are neglected:
                           
                              (9)
                              
                                 div
                                 
                                 σ
                                 =
                                 0
                                 
                                 in
                                 
                                 Ω
                              
                           
                        where 
                           σ
                         is the Cauchy stress tensor. It is performed with a plane strain assumption and the infinitesimal strain theory. Therefore, 
                           σ
                         is assumed to depend linearly on the elastic strain tensor 
                           
                              
                                 ϵ
                              
                              
                                 e
                              
                           
                         by means of the fourth rank elastic tensor 
                           C
                         as follows:
                           
                              (10)
                              
                                 σ
                                 =
                                 C
                                 :
                                 
                                    
                                       ϵ
                                    
                                    
                                       e
                                    
                                 
                              
                           
                        As the effect of plastic dissipation on heat transfer and the influence of stresses on metallurgical transformations are neglected, the mechanical analysis can be uncoupled from the thermo-metallurgical simulation. In this way, heat transfer and metallurgy are involved in the mechanical analysis through four effects [19]:
                           
                              •
                              the thermal strains,

the volume changes due to the transformations (contraction during heating and expansion during cooling),

the influence of temperature and of the phases on the behavior law (generally, the yield strength of phases is higher if they have been created with high cooling rates),

the transformation induced plasticity.

The strain rate tensor 
                           
                              
                                 ϵ
                              
                              
                                 ̇
                              
                           
                         is thus decomposed into a thermal and metallurgical part 
                           
                              
                                 
                                    
                                       ϵ
                                    
                                    
                                       ̇
                                    
                                 
                              
                              
                                 th
                              
                           
                        , an elastic part 
                           
                              
                                 
                                    
                                       ϵ
                                    
                                    
                                       ̇
                                    
                                 
                              
                              
                                 e
                              
                           
                         and a plastic part 
                           
                              
                                 
                                    
                                       ϵ
                                    
                                    
                                       ̇
                                    
                                 
                              
                              
                                 p
                              
                           
                         that includes both classical plasticity and transformation induced plasticity:
                           
                              (11)
                              
                                 
                                    
                                       ϵ
                                    
                                    
                                       ̇
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             ϵ
                                          
                                          
                                             ̇
                                          
                                       
                                    
                                    
                                       th
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             ϵ
                                          
                                          
                                             ̇
                                          
                                       
                                    
                                    
                                       e
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             ϵ
                                          
                                          
                                             ̇
                                          
                                       
                                    
                                    
                                       p
                                    
                                 
                              
                           
                        
                     

The volume changes due to transformations are a major cause of the appearance of residual stresses and strains. To include those changes, a simple solution consists in changing the standard thermal strain into the following thermal and metallurgical strain:
                           
                              (12)
                              
                                 
                                    
                                       ϵ
                                    
                                    
                                       th
                                    
                                 
                                 =
                                 (
                                 1
                                 −
                                 p
                                 )
                                 
                                    
                                       ϵ
                                    
                                    
                                       1
                                    
                                    
                                       th
                                    
                                 
                                 (
                                 T
                                 )
                                 +
                                 p
                                 
                                    
                                       ϵ
                                    
                                    
                                       2
                                    
                                    
                                       th
                                    
                                 
                                 (
                                 T
                                 )
                              
                           
                        where 
                           
                              
                                 ϵ
                              
                              
                                 1
                              
                              
                                 th
                              
                           
                           (
                           T
                           )
                         denotes the thermal strain of the parent phase 1 and 
                           
                              
                                 ϵ
                              
                              
                                 2
                              
                              
                                 th
                              
                           
                           (
                           T
                           )
                         that of the product phase 2. 
                           
                              
                                 ϵ
                              
                              
                                 th
                              
                           
                         reflects both the thermal strains of the phases and the volume change between the latter [25]. The stress–strain relation must be temperature-dependent, representative of the phase mix, and reproduce the transformation induced plasticity phenomenon. The material behavior law during transformation is usually supposed to be elastoplastic. Plastic strain rate 
                           
                              
                                 
                                    
                                       ϵ
                                    
                                    
                                       ̇
                                    
                                 
                              
                              
                                 p
                              
                           
                         is expressed as the sum of three terms, proportional to stress variation 
                           
                              
                                 σ
                              
                              
                                 ̇
                              
                           
                        , temperature variation 
                           
                              
                                 θ
                              
                              
                                 ̇
                              
                           
                         and phase proportion variations 
                           
                              
                                 p
                              
                              
                                 ̇
                              
                           
                         respectively:
                           
                              (13)
                              
                                 
                                    
                                       
                                          
                                             ϵ
                                          
                                          
                                             ̇
                                          
                                       
                                    
                                    
                                       p
                                    
                                 
                                 =
                                 a
                                 (
                                 …
                                 )
                                 
                                    
                                       σ
                                    
                                    
                                       ̇
                                    
                                 
                                 +
                                 b
                                 (
                                 …
                                 )
                                 
                                    
                                       θ
                                    
                                    
                                       ̇
                                    
                                 
                                 +
                                 c
                                 (
                                 …
                                 )
                                 
                                    
                                       p
                                    
                                    
                                       ̇
                                    
                                 
                              
                           
                        
                     

The first two terms represent the conventional plastic strain rate, while the third one represents the transformation-induced plastic strain rate. Transformation plasticity can be associated with two physical phenomena:
                           
                              •
                              Greenwood–Johnson mechanism [26]: the volume difference between the phases can generate microscopic internal stresses which are sufficient to induce plastic strain in the weaker phase (austenite).

Magee mechanism (martensitic transformation only) [27]: in the presence of an external stress martensite needles are formed in a preferential direction.

To apply the finite element method, the weak formulation for the mechanical problem is obtained by multiplying Eq. (9) with weighing function 
                           
                              
                                 U
                              
                              
                                 ⁎
                              
                           
                         and integrating over the domain 
                           Ω
                        . The boundary conditions can be prescribed displacements or stress vectors imposed. Integrating by parts and considering that the surface of the workpiece is free of stresses, one thus gets:
                           
                              (14)
                              
                                 
                                    
                                       ∫
                                    
                                    
                                       Ω
                                    
                                 
                                 ϵ
                                 (
                                 
                                    
                                       U
                                    
                                    
                                       ⁎
                                    
                                 
                                 )
                                 :
                                 σ
                                 (
                                 U
                                 )
                                 
                                 d
                                 v
                                 =
                                 0
                                 
                                 with
                                 
                                 ϵ
                                 (
                                 
                                    
                                       U
                                    
                                    
                                       ⁎
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                 
                                 (
                                 grad
                                 
                                 
                                    
                                       U
                                    
                                    
                                       ⁎
                                    
                                 
                                 +
                                 
                                    
                                       grad
                                    
                                    
                                       t
                                    
                                 
                                 
                                 
                                    
                                       U
                                    
                                    
                                       ⁎
                                    
                                 
                                 )
                              
                           
                        Following the usual procedure, the weak formulation (14) is applied to the finite element approximation of the displacement 
                           U
                         which is similar to the one used for the temperature approximation:
                           
                              (15)
                              
                                 U
                                 ≈
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       U
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        
                     

From the simulation point of view, the internal heating due to plastic dissipation is always neglected considering the small strain rates generated by a quenching operation [34]. Therefore, the simulation can be achieved through a staggered method which consists in splitting the analysis into two steps. First, the temperature and phase variations are determined as a function of time. Then, the mechanical computation uses the previous results to get displacements, stresses and distortions. Generally, for practical reasons, the mesh implemented for the thermo-metallurgical computation is also the one used for the mechanical analysis.

The example proposed consists of quenching of a large size plate described in Fig. 2
                     . A bidimensional simulation is carried out on a quarter section for symmetry reasons. The 2D mesh is plotted in Fig. 3
                     . All the simulations have been performed using the computer code 
                        
                           
                              Sysweld
                           
                           
                              ®
                           
                        
                      
                     [35].

The plate is initially at the uniform temperature of 900°C in a full austenitic state. It is then quenched in a water bath at a temperature 
                              
                                 
                                    T
                                 
                                 
                                    (
                                    p
                                    )
                                 
                              
                            equal to 20°C. Two quenching conditions are considered. A first case of continuous quenching in which the plate is maintained in the water bath until it reaches a temperature close to 20°C (room temperature). A second case of discontinuous quenching in which the plate is taken away from the water bath after 3000s, the end of cooling occurring more slowly in air at 20°C. The values of the heat transfer coefficient h have been estimated using an inverse method and comparisons between simulations and thermal kinetics were measured with thermocouples. They are given respectively in Tables A1 and A2 for cooling with water and air. The values of the metallurgical processing parameters in 
                              
                                 
                                    Sysweld
                                 
                                 
                                    ®
                                 
                              
                            
                           [35] 
                           K(T), 
                              K
                              ′
                              (
                              T
                              )
                            such that 
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ¯
                                       
                                    
                                    (
                                    T
                                    )
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          1
                                          +
                                          
                                             
                                                
                                                   K
                                                   ′
                                                   (
                                                   T
                                                   )
                                                
                                                
                                                   K
                                                   (
                                                   T
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    
                                    and
                                    
                                    τ
                                    (
                                    T
                                    )
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          K
                                          ′
                                          (
                                          T
                                          )
                                          +
                                          K
                                          (
                                          T
                                          )
                                       
                                    
                                 
                              
                           and 
                              F
                              (
                              
                                 
                                    T
                                 
                                 
                                    ̇
                                 
                              
                              )
                            are given in Tables A3–A6 for the martensitic and bainitic transformations. Two types of metallurgical transformation have been considered during cooling: a bainitic transformation and a martensitic transformation. The conductivities and the volumetric mass are given in Tables A7–A9. The enthalpies are defined by means of the temperature T (°C) as follows:
                              
                                 (16)
                                 
                                    
                                       
                                          H
                                       
                                       
                                          ferrite
                                       
                                    
                                    
                                    (
                                    J
                                    
                                    
                                       
                                          kg
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    )
                                    =
                                    0.18
                                    
                                       
                                          T
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    460
                                    T
                                 
                              
                           
                           
                              
                                 (17)
                                 
                                    
                                       
                                          H
                                       
                                       
                                          austenite
                                       
                                    
                                    
                                    (
                                    J
                                    
                                    
                                       
                                          kg
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    )
                                    =
                                    0.08
                                    
                                       
                                          T
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    495
                                    T
                                    +
                                    
                                       
                                          10
                                       
                                       
                                          5
                                       
                                    
                                 
                              
                           where H
                           
                              ferrite
                            denotes the enthalpy of both bainite and martensite.

The yield stress and the thermal strain are given in Tables A10–A14. The stresses are assumed to be zero everywhere in the austenized plate before quenching. Therefore, the thermal strain of austenite is taken equal to zero at 900°C as shown in Table A14. Young's modulus is assumed to be only temperature (and not phase) dependent and is given in Table A15. Poisson's ratio is taken equal to 0.3. For all the phases, hardening is assumed to be kinematic and is described in Tables A16 and A17. For computation, boundary conditions of symmetry are imposed on the left and lower sides of the quarter section.

@&#RESULTS@&#

For the quarter section, the computation time is about a few minutes on a standard Intel(R) Core(TM)2 duo 2.53GHz PC with 4GB memory. Fig. 4
                         shows the results in terms of phase proportions for continuous and discontinuous quenching. In both cases, rapid cooling on the surface during the first seconds leads to the formation of martensite on the skin of the plate. In the middle, cooling is slower and the austenite transforms essentially into bainite whatever the conditions of quenching, continuous or discontinuous as shown in Fig. 4. The residual stress fields are plotted in Fig. 5
                         after quenching at room temperature under the assumption of plane strains. In all cases, compressive stresses are obtained on the skin of the plate while tensile stresses are observed in the depth. Bigger tensile stresses and a compression zone at mid-thickness of the plate are obtained for discontinuous quenching while metallurgical structures are quite similar. It is thus expected that the propagation of a possible normal crack to the surface of the plate should be easier in the case of discontinuous quenching through the tensile zone. The crack encounters negative stresses in the middle of the plate. Intuitively, we can think that the propagation will stop but the crack propagation modifies the stress field and the crack does not stop. It deviates the compressive zone and rotates through an angle of about 90°. This phenomenon corresponds to what has been observed experimentally. This shows the importance of computing the redistribution of internal stresses which prevents predictions “a priori” simple, seemingly obvious but actually wrong. This is the aim of the following section.

After being completely cooled, the plate is sawn. Experience has shown that reducing the quenching time in water can lead to difficulties. It turns out that the saw initiates a crack which propagates almost instantly without following the desired trajectory because it rotates through an angle of about 90° at about mid-thickness. To understand the origin of this phenomenon, we propose an XFEM simulation to compute the crack path. In this work, the material is a high yield stress steel whose toughness is low. So, it is very sensitive to brittle fracture phenomena as observed experimentally. The XFEM analysis is therefore carried out in the framework of static linear elasticity with an initial stress field resulting from quenching. This means that the crack is assumed to propagate without inducing new plasticity phenomena. The problem to solve at each step of the crack propagation is then of the form:
                        
                           (18)
                           
                              
                                 
                                    ∫
                                 
                                 
                                    Ω
                                 
                              
                              ϵ
                              (
                              
                                 
                                    U
                                 
                                 
                                    ⁎
                                 
                              
                              )
                              :
                              C
                              :
                              (
                              ϵ
                              (
                              U
                              )
                              −
                              
                                 
                                    ϵ
                                 
                                 
                                    th
                                 
                              
                              )
                              
                              d
                              v
                              −
                              
                                 
                                    ∫
                                 
                                 
                                    Ω
                                 
                              
                              ϵ
                              (
                              
                                 
                                    U
                                 
                                 
                                    ⁎
                                 
                              
                              )
                              :
                              C
                              :
                              
                                 
                                    ϵ
                                 
                                 
                                    p
                                 
                              
                              
                              d
                              v
                              =
                              0
                           
                        
                     where 
                        
                           
                              ϵ
                           
                           
                              p
                           
                        
                      and 
                        
                           
                              ϵ
                           
                           
                              th
                           
                        
                      denote respectively the plastic and thermal strains at the end of the quenching step at ambient temperature.

The XFEM method is an alternative technique to remeshing procedures. It has the advantage of being simpler to implement. Indeed, the crack is implicitly considered in the approximation of the displacement field. Some terms are added to the classical FEM approximation of displacements without modifying the topology of the mesh. These terms depend on the geometry of the crack which is here described with the technique of level sets. The XFEM approximation of the displacements can be classically written as follows:
                           
                              (19)
                              
                                 U
                                 ≈
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ∈
                                       M
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ∈
                                       H
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       i
                                    
                                 
                                 H
                                 
                                    
                                       a
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ∈
                                       K
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          l
                                          =
                                          1
                                       
                                       
                                          4
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          l
                                       
                                    
                                    
                                       
                                          b
                                       
                                       
                                          il
                                       
                                    
                                 
                                 )
                              
                           
                        
                     

In these expressions, H is the heaviside function and the functions f
                        
                           l
                         are given by the asymptotic solution of Westergaard near the crack tip [36]. 
                           
                              
                                 u
                              
                              
                                 i
                              
                           
                        , 
                           
                              
                                 a
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 b
                              
                              
                                 il
                              
                           
                         denote the vectorial unknowns at node i. N
                        
                           i
                         is the shape function associated to this node. 
                           M
                         is the set of the mesh nodes and 
                           H
                         is the subset of nodes whose support is cut by the crack. There are several ways to build the subset 
                           K
                         corresponding to enrichment near the crack tip given in [11]. For geometrical enrichment, 
                           K
                         is composed of the subset of nodes whose distance is less than a length L characterizing the size of the area of K-dominance. The enrichment technique used in this work is topological for its simplicity although it is known to lead to suboptimal convergence rates [37]. 
                           K
                         is defined with the set of nodes whose support contains the crack tip.

At each step of the propagation, the stress and strain distributions are computed with the XFEM approximation. The crack does not close during the propagation. The plastic and thermal strains included in the simulation are only due to the quenching process and they do not change during propagation. From the numerical point of view, the plastic and thermal strains have been computed on classical 4-node bi-linear finite elements with four Gauss integration points and selective reduced integration during quenching. For the application of the XFEM method, the numerical integration is not carried out in the same way. Indeed, an enriched integration scheme of 
                           16
                           ⁎
                           16
                         Gauss integration points is used for elements cut by the crack or enriched by asymptotic functions in a similar way as the one suggested by Elguedj et al. [38]. This involves a transfer of the thermal and plastic strains from the four initial integration points to the new integration points. The technique used in this work is illustrated in Fig. 6
                        . For the computation of an XFEM integration point, the considered data are those of the nearest initial integration point.

The interest of such an approach is its simplicity even if it induces a very small mismatch in the equilibrium due to the transfer of plastic strain from the initial set to the new set of Gauss points. In fact, the use of a highest order numerical integration scheme does not change the value of the first term of Eq. (18) because the metallurgical phases obtained after quenching (bainite and martensite) have the same elastic properties and identical thermal strains. The second term is slightly affected by the projection technique because the plastic strain distribution is not exactly reproduced in a given element.

At each time step, the level sets are updated via interaction integrals that allow one to estimate the SIFs, K
                        
                           I
                         and K
                        
                           II
                        . These integrals take into account the effect of residual stress on the value of K
                        
                           I
                         and K
                        
                           II
                        , through the internal stresses of the structure in a first term and the plastic strains induced by the quenching process in a second term:
                           
                              (20)
                              
                                 
                                    
                                       I
                                    
                                    
                                       int
                                    
                                 
                                 =
                                 −
                                 
                                    
                                       ∫
                                    
                                    
                                       V
                                    
                                 
                                 
                                    
                                       q
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 (
                                 
                                    
                                       σ
                                    
                                    
                                       kl
                                    
                                 
                                 
                                    
                                       ϵ
                                    
                                    
                                       kl
                                    
                                    
                                       a
                                    
                                 
                                 
                                    
                                       δ
                                    
                                    
                                       ij
                                    
                                 
                                 −
                                 
                                    
                                       σ
                                    
                                    
                                       kj
                                    
                                 
                                 
                                    
                                       U
                                    
                                    
                                       k
                                       ,
                                       i
                                    
                                    
                                       a
                                    
                                 
                                 −
                                 
                                    
                                       σ
                                    
                                    
                                       kj
                                    
                                    
                                       a
                                    
                                 
                                 
                                    
                                       U
                                    
                                    
                                       k
                                       ,
                                       i
                                    
                                 
                                 )
                                 
                                 dv
                                 −
                                 
                                    
                                       ∫
                                    
                                    
                                       V
                                    
                                 
                                 
                                    
                                       q
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       σ
                                    
                                    
                                       kl
                                    
                                    
                                       a
                                    
                                 
                                 
                                    
                                       ϵ
                                    
                                    
                                       kl
                                       ,
                                       i
                                    
                                    
                                       p
                                    
                                 
                                 
                                 dv
                                 =
                                 
                                    
                                       2
                                       (
                                       1
                                       −
                                       
                                          
                                             ν
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    
                                       E
                                    
                                 
                                 (
                                 
                                    
                                       K
                                    
                                    
                                       I
                                    
                                 
                                 
                                    
                                       K
                                    
                                    
                                       I
                                    
                                    
                                       a
                                    
                                 
                                 +
                                 
                                    
                                       K
                                    
                                    
                                       II
                                    
                                 
                                 
                                    
                                       K
                                    
                                    
                                       II
                                    
                                    
                                       a
                                    
                                 
                                 )
                              
                           
                        where U
                        
                           i
                        , 
                           
                              
                                 σ
                              
                              
                                 ij
                              
                           
                         and 
                           
                              
                                 ϵ
                              
                              
                                 ij
                              
                              
                                 p
                              
                           
                         denote respectively the components of the displacement, the stress tensor and the plastic strain tensor computed; 
                           
                              
                                 σ
                              
                              
                                 ij
                              
                              
                                 a
                              
                           
                         and 
                           
                              
                                 ϵ
                              
                              
                                 ij
                              
                              
                                 a
                              
                           
                         are the components of the displacement and the strain tensor respectively given by the analytical asymptotic solution of Westergaard [36] under the plane strain assumption. q
                        
                           i
                         denotes the components of the virtual extension field of the crack defined with the gradient of the level sets. Choosing 
                           
                              
                                 K
                              
                              
                                 I
                              
                              
                                 a
                              
                           
                           =
                           1
                         and 
                           
                              
                                 K
                              
                              
                                 II
                              
                              
                                 a
                              
                           
                           =
                           0
                        , respectively 
                           
                              
                                 K
                              
                              
                                 I
                              
                              
                                 a
                              
                           
                           =
                           0
                         and 
                           
                              
                                 K
                              
                              
                                 II
                              
                              
                                 a
                              
                           
                           =
                           1
                        , one can compute K
                        
                           I
                        , respectively K
                        
                           II
                        , by means of I
                        
                           int
                         computed on an auxiliary square mesh shown in Fig. 7
                        , composed of 4 by 4 elements used as integration supports with 
                           16
                           ⁎
                           16
                         Gauss integration points. The norm of q
                        
                           i
                         used in this work is also plotted in Fig. 7.

Considering that the elastic properties do not depend on the metallurgical composition at ambient temperature (see Table A15), the material after quenching is homogeneous from the mechanical behavior point of view. Moreover, in our case study, the proportion of austenite is equal to zero after quenching; so there are only ferritic phases (bainite and martensite) which have the same thermal strain. Therefore, the thermal strain is homogeneous at ambient temperature and its gradient is equal to zero in the whole structure. The only inhomogeneous quantities are the plastic strains which are supposed not to change during the propagation of the crack. In the context of linear fracture mechanics, these considerations ensure the independency of the integration domain for the interaction integrals [39] but the computation of I
                        
                           int
                         requires the gradient of plastic strains. This gradient is obtained in each finite element 
                           
                              
                                 Ω
                              
                              
                                 e
                              
                           
                         of the structure by a classical finite element approximation where the nodal values are obtained from an averaging process as follows:
                           
                              (21)
                              
                                 
                                    
                                       ϵ
                                    
                                    
                                       kl
                                       ,
                                       j
                                    
                                    
                                       p
                                    
                                 
                                 ≈
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                                 
                                    
                                       ∂
                                       
                                          
                                             N
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                       ∂
                                       
                                          
                                             x
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                                 
                                    
                                       (
                                       
                                          
                                             ϵ
                                          
                                          
                                             kl
                                          
                                          
                                             p
                                          
                                       
                                       )
                                    
                                    
                                       i
                                    
                                 
                                 
                                 with
                                 
                                 
                                    
                                       (
                                       
                                          
                                             ϵ
                                          
                                          
                                             kl
                                          
                                          
                                             p
                                          
                                       
                                       )
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             ∫
                                          
                                          
                                             
                                                
                                                   Ω
                                                
                                                
                                                   e
                                                
                                             
                                          
                                       
                                       
                                          
                                             N
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             ϵ
                                          
                                          
                                             kl
                                          
                                          
                                             p
                                          
                                       
                                       
                                       d
                                       V
                                    
                                    
                                       
                                          
                                             ∫
                                          
                                          
                                             
                                                
                                                   Ω
                                                
                                                
                                                   e
                                                
                                             
                                          
                                       
                                       
                                          
                                             N
                                          
                                          
                                             i
                                          
                                       
                                       
                                       d
                                       V
                                    
                                 
                              
                           
                        
                     

The misorientation angle 
                           
                              
                                 θ
                              
                              
                                 c
                              
                           
                         of the crack is then obtained from the criterion of maximum normal stress given by:
                           
                              (22)
                              
                                 
                                    
                                       θ
                                    
                                    
                                       c
                                    
                                 
                                 =
                                 2
                                 
                                 arctan
                                 
                                 
                                    
                                       1
                                    
                                    
                                       4
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             
                                                K
                                             
                                             
                                                I
                                             
                                          
                                       
                                       
                                          
                                             
                                                K
                                             
                                             
                                                II
                                             
                                          
                                       
                                    
                                    ±
                                    
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            
                                                               K
                                                            
                                                            
                                                               I
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               K
                                                            
                                                            
                                                               II
                                                            
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          8
                                       
                                    
                                 
                                 )
                              
                           
                        
                     

The crack is modeled within a level set framework. The geometry of the crack coincides with the zero level set of a function 
                           ψ
                        . The tip of the crack is classically represented as the intersection of the zero level set of 
                           ψ
                         with an orthogonal zero level set of a function 
                           ϕ
                        . The functions 
                           ψ
                         and 
                           ϕ
                         are interpolated over the mesh by the same shape functions as those used for the temperature and the displacement. Thus,
                           
                              (23)
                              
                                 ψ
                                 ≈
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       ψ
                                    
                                    
                                       i
                                    
                                 
                                 
                                 
                                 and
                                 
                                 
                                 ϕ
                                 ≈
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       ϕ
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        
                     

The level set function representing the initial crack is constructed on the whole mesh by computing the signed distance function 
                           ψ
                         at each node, from the crack's geometry extended tangentially from its tip. At each step of the propagation, the functions 
                           ψ
                         and 
                           ϕ
                         are updated following the procedure proposed by Stolarska et al. [40]. This approach has the interest not to need to solve any partial differential equations even if it is known to produce discontinuity of the misorientation angle 
                           
                              
                                 θ
                              
                              
                                 c
                              
                           
                         as shown by Duflot [41] which has proposed more elaborate techniques. It consists of a geometrical updating which is very easy and efficient to use in 2D.

As mentioned by Stolarska et al. [40], it is not necessary to update the level sets on the entire two-dimensional domain since we are only interested in the evolution of a one-dimensional curve. Once that a new part of a crack has formed, its shape will not change anymore. Therefore, the 
                           ψ
                         and 
                           ϕ
                         functions need only to be updated for elements surrounding the crack tip and the ones located in the region where the propagation occurs. Let the current values of 
                           ψ
                         and 
                           ϕ
                         at step n be 
                           
                              
                                 ψ
                              
                              
                                 n
                              
                           
                         and 
                           
                              
                                 ϕ
                              
                              
                                 n
                              
                           
                         respectively. The algorithm for the evolution of the level set functions 
                           
                              
                                 ψ
                              
                              
                                 n
                              
                           
                         and 
                           
                              
                                 ϕ
                              
                              
                                 n
                              
                           
                         is as follows:
                           
                              •
                              
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          n
                                       
                                    
                                  is updated on the whole domain by a rotation with an angle corresponding to the misorientation angle 
                                    
                                       
                                          θ
                                       
                                       
                                          c
                                       
                                    
                                 . 
                                    
                                       
                                          ϕ
                                       
                                       
                                          n
                                       
                                    
                                  after rotation is referred to as 
                                    
                                       
                                          ϕ
                                       
                                       
                                          ⁎
                                       
                                    
                                 ,

the crack is extended by computing new values 
                                    
                                       
                                          ψ
                                       
                                       
                                          n
                                          +
                                          1
                                       
                                    
                                  in the region where 
                                    
                                       
                                          ϕ
                                       
                                       
                                          ⁎
                                       
                                    
                                    >
                                    0
                                 ,


                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          n
                                          +
                                          1
                                       
                                    
                                  is updated adding the feed pitch 
                                    δ
                                  (given by the user) at 
                                    
                                       
                                          ϕ
                                       
                                       
                                          ⁎
                                       
                                    
                                 .

@&#RESULTS@&#

For the simulation of water quenching, we have considered a quarter-section for symmetry reason. Concerning the study of cracking, the real situation is composed of only one crack in the whole section. Therefore, there are no symmetry conditions and the whole section needs to be considered. Nevertheless, Autesserre has studied this problem on a quarter section using a finite element technique coupled with a remeshing procedure and a second-order criterion giving both the angle of crack branching and the curvature of the crack path [9,10,42]. This is the reason why we have carried out two simulations: a first one on a quarter section for comparing our results with those of Autesserre and a second one on the whole section.

For the numerical simulation performed by Autesserre, the SIFs have been obtained by means of a direct comparison between the displacement field computed and the analytical solution of Westergaard, while we use the interaction integrals for the XFEM method without considering the curvature effect.

The crack path is plotted in Fig. 9
                         at different time steps for the XFEM method. For this simulation, the initial crack is vertical and located at a distance of 85mm from the vertical symmetry plane; and the crack tip is 30mm below the upper surface. The largest element of the mesh located in bottom left of the quarter section, has an edge of about 8mm long. The crack paths obtained with XFEM are shown in Fig. 10
                         for 2 different values of the feed pitch 
                           δ
                        : 8mm and 12mm. Calculations performed with 9mm, 10mm and 11mm lead to similar crack paths. A comparison is also shown between the XFEM results and the crack path obtained by Autesserre. A good agreement is obtained even if, without the fracture toughness 
                           
                              
                                 K
                              
                              
                                 I
                              
                              
                                 c
                              
                           
                        , it is impossible to find where the crack stops. In all cases, the crack shuns the compressive zone in the middle of the plate and rotates through an angle of about 90°. The result corresponds to what was observed experimentally. But, as the simulation has been performed on a quarter section with symmetry conditions, it is not the propagation of one crack that has been simulated, but of four on the whole section.

In reality, the sawing step initiates only one crack which propagates almost instantly rotating through an angle of about 90°. Therefore, it is clear that it is now necessary to perform a calculation of only one crack in the whole section without symmetry boundary conditions. The XFEM method is of particular interest because it allows one to perform this calculation in a few minutes without having to implement a remeshing procedure and a procedure for projecting the calculation results of water quenching. The crack path for the whole section is given in Fig. 11
                         with a discretization build by symmetry, from the mesh of the quarter section. The simulation is carried out with an intermediate value of the feed pitch tested on the quarter section: 10mm. One can note that the crack propagates in the same way as for the quarter section avoiding the compression zone at mid-thickness of the quenched plate.

@&#CONCLUSION@&#

A simulation strategy has been proposed in this paper to model the path of a crack in a plate quenched considering the effects of residual stresses. It is based on the finite element method for quenching simulation taking account of couplings between heat transfer, metallurgical transformations and mechanics. For the crack propagation, the XFEM method has been used to compute the internal stresses at each step of the propagation. The objective was to have the correct stress field at each position of the crack tip to compute the misorientation angle. The results show that the simulation is able to model the effects of the quenching parameters on residual stresses. Moreover, the crack path computed with XFEM is in good agreement with the results obtained by Autesserre and the experimental observations. Knowing that the XFEM simulation is very fast, this work clearly demonstrates the quality of its results and the relevance of such an approach to study cracking problems through residual stress fields.

@&#ACKNOWLEDGMENTS@&#

The authors would like to thank J.B. Leblond for the valuable discussions they had with him.

See Tables A1-A17.
                      
                      
                      
                      
                      
                      
                      
                      
                      
                      
                      
                      
                      
                      
                      
                     
                  

@&#REFERENCES@&#

