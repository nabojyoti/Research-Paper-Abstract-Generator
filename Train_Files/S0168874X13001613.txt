@&#MAIN-TITLE@&#Development of an inverse finite element method with an initial guess of linear unfolding

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           IFEM method is a fast tool to predict initial blank and strain distribution.


                        
                        
                           
                           To avoid converging problem unfolding method is used as an efficient initial guess.


                        
                        
                           
                           This initial guess decreases the number of iteration in the numerical solution.


                        
                        
                           
                           A non-uniform distribution of friction is exerted on blank‌holder zone.


                        
                        
                           
                           This method is capable of being applied to complicated geometries.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Sheet metal forming

Initial blank design

Finite element method

Linear unfolding

@&#ABSTRACT@&#


               
               
                  An inverse finite element method (IFEM) has been developed for estimation of the blank size and prediction of the strain distribution in sheet metal forming. In the inverse method the nodal coordinates in the final shape are known and their corresponding positions on the initial blank should be determined. The developed method deals with logarithmic large strains of membrane triangular elements, virtual work principle and a new approach for friction modeling. This method leads to a system of nonlinear equations which is highly sensitive to the initial guess. In order to avoid the converging problems, especially in the quasi-vertical walls, an appropriate initial guess is introduced. The introduced initial guess guarantees the convergence; furthermore the number of iterations in the nonlinear numerical solution is decreased and the solution speed is significantly increased. Three different problems are analyzed with the developed method and the results show good agreement to commercially available finite element software and experimental results.
               
            

@&#INTRODUCTION@&#

Sheet metal forming is a complicated process that depends on numerous parameters such as die geometry, blank shape, drawing ratio and blank holder force. An important factor for having a successful process without defects is the initial blank shape. The traditional method to simulate the sheet metal forming is the forward incremental finite element method [1–3]. In the forward method, computations start with the blank geometry which is unknown at the initial design stage. Therefore, trial and error is the nature of the forward method which is very time consuming. Due to this fact, a method is needed to predict the initial blank shape directly. So many attempts have been carried out in order to obtain the initial blank directly.

Karima [4] made use of the slip-line method to design the initial blank shape. Vogel and Lee [5] and Chen and Sowerby [6] used the characteristic of plane stress, while Blount and Stevens [7] used geometric mapping to design the initial blank shape. These methods provide good guidance to design the initial blank shape, but they neglect the height of the deformed parts, have geometric restrictions, and do not consider the deformation behavior of the materials. On the other hand, there have been several attempts to design the blank shape and estimate the distribution of the strain in a deformed part with deformation theory of plasticity. Majlessi and Lee [8–11] showed that using this theory is reasonable for rapid simulation in the first stages of design. They extended the theory of Levy et al. [11] and applied it to axi‌symmetric one step and multi-stage problems, obtaining good results. However, this method cannot be applied without boundary conditions implementation like friction and blank holder force. Therefore, the crash form process cannot be analyzed by this approach. Guo and Batoz [12–14] derived a formulation for field problems as an inverse method to obtain the initial blank shape and the thickness distribution in a deformed part. Due to the nonlinearities that come from considering large deformation and material properties, this method is very sensitive to initial guess and needs an efficient initial guess. Based on the work by Karima et al. [15], Assempour et al. [16–18] developed a linear inverse finite element method known as unfolding technique. Their formulation is based on the principle of potential energy minimization and linear strain–displacement relation. Thus, their formulation leads to a system of linear equations which can be solved very quickly. This method is very efficient in obtaining the initial blank; however, due to the nature of linear formulation, the strain values are less accurate compared with nonlinear formulation.

In the present study, an inverse finite element formulation has been developed which deals with the principle of virtual work, deformation theory of plasticity and logarithmic large strains of membrane triangular elements. This method leads to a system of nonlinear equations which is very sensitive to the initial guess and may diverge in numerical solution. In order to avoid the convergence problems, especially in the quasi-vertical walls, the linear unfolding method is used as an appropriate initial guess. Besides, a new approach for friction modeling is introduced which considers a non-uniform distribution of the friction force on the nodes located under the blank holder zone. Numerical simulations have been conducted and results have been compared with Abaqus Explicit and experimental results to verify its feasibility.

In the inverse approach only two states are considered:
                        
                           (1)
                           The initial flat blank obtained from the initial guess with a known thickness.

The final work piece with a known tridimensional mid-surface discretized with flat triangular membrane elements.

The geometry of final shape is discretized with linear triangular membrane elements. Positions of elements in the flat plane are obtained by an appropriate initial guess. 
                        Fig. 1 shows the schematic elements of the initial and final shapes.

By considering only the initial and final states of elements and calculating left Cauchy–Green deformation tensor [B], principal stretches are obtained as below:
                           
                              (1)
                              
                                 
                                    
                                       λ
                                    
                                    
                                       i
                                    
                                    
                                       −
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       {
                                       
                                          
                                             n
                                          
                                          
                                             i
                                          
                                       
                                       }
                                    
                                    T
                                 
                                 
                                    
                                       [
                                       B
                                       ]
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 {
                                 
                                    
                                       n
                                    
                                    
                                       i
                                    
                                 
                                 }
                                 
                                 (
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 )
                              
                           
                        where {n
                        
                           i
                        } are eigenvectors of [B]−1 
                        [19]. Principal stretches which are also eigenvalues of [B], can be calculated as follows:
                           
                              (2)
                              
                                 {
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      1
                                                   
                                                
                                                =
                                                
                                                   
                                                      (
                                                      (
                                                      1
                                                      /
                                                      2
                                                      )
                                                      (
                                                      
                                                         
                                                            B
                                                         
                                                         
                                                            11
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            B
                                                         
                                                         
                                                            22
                                                         
                                                      
                                                      )
                                                      +
                                                      (
                                                      1
                                                      /
                                                      2
                                                      )
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  (
                                                                  
                                                                     
                                                                        B
                                                                     
                                                                     
                                                                        11
                                                                     
                                                                  
                                                                  −
                                                                  
                                                                     
                                                                        B
                                                                     
                                                                     
                                                                        22
                                                                     
                                                                  
                                                                  )
                                                               
                                                               2
                                                            
                                                            +
                                                            4
                                                            
                                                               
                                                                  B
                                                               
                                                               
                                                                  12
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                            1
                                                            /
                                                            2
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      −
                                                      1
                                                      /
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      2
                                                   
                                                
                                                =
                                                
                                                   
                                                      (
                                                      (
                                                      1
                                                      /
                                                      2
                                                      )
                                                      (
                                                      
                                                         
                                                            B
                                                         
                                                         
                                                            11
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            B
                                                         
                                                         
                                                            22
                                                         
                                                      
                                                      )
                                                      −
                                                      (
                                                      1
                                                      /
                                                      2
                                                      )
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  (
                                                                  
                                                                     
                                                                        B
                                                                     
                                                                     
                                                                        11
                                                                     
                                                                  
                                                                  −
                                                                  
                                                                     
                                                                        B
                                                                     
                                                                     
                                                                        22
                                                                     
                                                                  
                                                                  )
                                                               
                                                               2
                                                            
                                                            +
                                                            4
                                                            
                                                               
                                                                  B
                                                               
                                                               
                                                                  12
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                            1
                                                            /
                                                            2
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      −
                                                      1
                                                      /
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        λ
                        3 is also obtained from λ
                        1 and λ
                        2 by assuming incompressibility.


                        B
                        
                           ij
                        ; i,j=1,2 are components of [B]−1 
                        [19]:
                           
                              (3)
                              
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         11
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         22
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         12
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    }
                                 
                                 =
                                 
                                    1
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   h
                                                
                                                
                                                   2
                                                   y
                                                
                                             
                                             
                                                
                                                   h
                                                
                                                
                                                   3
                                                   x
                                                
                                             
                                             −
                                             
                                                
                                                   h
                                                
                                                
                                                   2
                                                   x
                                                
                                             
                                             
                                                
                                                   h
                                                
                                                
                                                   3
                                                   y
                                                
                                             
                                             )
                                          
                                          2
                                       
                                    
                                 
                                 
                                    ×
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         3
                                                         y
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         2
                                                         y
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   −
                                                   (
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   )
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         2
                                                         y
                                                      
                                                   
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         3
                                                         y
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         3
                                                         x
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         2
                                                         x
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   −
                                                   (
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   )
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         2
                                                         x
                                                      
                                                   
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         3
                                                         x
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   −
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         3
                                                         x
                                                      
                                                   
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         3
                                                         y
                                                      
                                                   
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         2
                                                         x
                                                      
                                                   
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         2
                                                         y
                                                      
                                                   
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   +
                                                   (
                                                   1
                                                   /
                                                   2
                                                   )
                                                   (
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   )
                                                   (
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         2
                                                         y
                                                      
                                                   
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         3
                                                         x
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         2
                                                         x
                                                      
                                                   
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         3
                                                         y
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    }
                                 
                              
                           
                        where L
                        
                           i
                        =||H
                        
                           i
                        ||2 and h
                        
                           ix
                        , h
                        
                           iy
                         are the components of h
                        
                           i
                         (see Fig. 1) in the element local coordinates of final configuration.

Logarithmic strains in element local coordinates can be obtained from Eq. (2) as follows:
                           
                              (4)
                              
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ε
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         ε
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         ε
                                                      
                                                      
                                                         x
                                                         y
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    }
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   ln
                                                   
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         cos
                                                      
                                                      2
                                                   
                                                   
                                                   θ
                                                   +
                                                   
                                                   ln
                                                   
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         sin
                                                      
                                                      2
                                                   
                                                   
                                                   θ
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ln
                                                   
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         sin
                                                      
                                                      2
                                                   
                                                   
                                                   θ
                                                   +
                                                   
                                                   ln
                                                   
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         cos
                                                      
                                                      2
                                                   
                                                   
                                                   θ
                                                
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   ln
                                                   
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   −
                                                   
                                                   ln
                                                   
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                   sin
                                                   
                                                   θ
                                                   
                                                   cos
                                                   
                                                   θ
                                                
                                             
                                          
                                       
                                    
                                    }
                                 
                              
                           
                        where θ is the angle between the 
                           x
                         axis of the local coordinate system and the principal stretch λ
                        1 
                        [19]:
                           
                              (5)
                              
                                 θ
                                 =
                                 
                                    
                                       tan
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   λ
                                                
                                                
                                                   1
                                                
                                                
                                                   −
                                                   2
                                                
                                             
                                             −
                                             
                                                
                                                   B
                                                
                                                
                                                   11
                                                
                                             
                                          
                                          
                                             
                                                
                                                   B
                                                
                                                
                                                   12
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                              
                           
                        
                     

Under conditions of plane stress (σ
                        
                           z
                        =σ
                        
                           xz
                        =σ
                        
                           yz
                        =0) and planar isotropic material, Hill's function gives
                           
                              (6)
                              
                                 f
                                 (
                                 
                                    
                                       σ
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       σ
                                    
                                    
                                       x
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       σ
                                    
                                    
                                       y
                                       y
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 
                                    
                                       2
                                       r
                                    
                                    
                                       1
                                       +
                                       r
                                    
                                 
                                 
                                    
                                       σ
                                    
                                    
                                       x
                                       x
                                    
                                 
                                 
                                    
                                       σ
                                    
                                    
                                       y
                                       y
                                    
                                 
                                 +
                                 2
                                 
                                    
                                       1
                                       +
                                       2
                                       r
                                    
                                    
                                       1
                                       +
                                       r
                                    
                                 
                                 
                                    
                                       σ
                                    
                                    
                                       x
                                       y
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        where r is the Lankford value.

Based on deformation theory of plasticity and implementing flow rule on Hill's function, the constitutive equation is defined as
                           
                              (7)
                              
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         x
                                                         x
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         y
                                                         y
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         x
                                                         y
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    }
                                 
                                 =
                                 
                                    2
                                    3
                                 
                                 
                                    
                                       σ
                                       ¯
                                    
                                    
                                       ε
                                       ¯
                                    
                                 
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   A
                                                   B
                                                
                                             
                                             
                                                A
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                A
                                             
                                             
                                                
                                                   A
                                                   C
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                
                                                   A
                                                   D
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ε
                                                      
                                                      
                                                         x
                                                         x
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         ε
                                                      
                                                      
                                                         y
                                                         y
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         ε
                                                      
                                                      
                                                         x
                                                         y
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    }
                                 
                              
                           
                        where,
                           
                              (8)
                              
                                 A
                                 =
                                 
                                    
                                       r
                                       (
                                       2
                                       +
                                       r
                                       )
                                    
                                    
                                       (
                                       1
                                       +
                                       2
                                       r
                                       )
                                    
                                 
                                 ,
                                 
                                 B
                                 =
                                 
                                    
                                       (
                                       1
                                       +
                                       r
                                       )
                                    
                                    r
                                 
                                 ,
                                 
                                 C
                                 =
                                 
                                    
                                       (
                                       1
                                       +
                                       r
                                       )
                                    
                                    r
                                 
                                 ,
                                 
                                 D
                                 =
                                 
                                    1
                                    r
                                 
                                 ,
                              
                           
                        
                     

The effective strain corresponding to Eq. (6) can be expressed as
                           
                              (9)
                              
                                 
                                    ε
                                    ¯
                                 
                                 =
                                 
                                    
                                       (
                                       2
                                       /
                                       3
                                       )
                                       A
                                       (
                                       B
                                       
                                          
                                             ε
                                          
                                          
                                             x
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       2
                                       
                                          
                                             ε
                                          
                                          
                                             x
                                             x
                                          
                                       
                                       
                                          
                                             ε
                                          
                                          
                                             y
                                             y
                                          
                                       
                                       +
                                       C
                                       
                                          
                                             ε
                                          
                                          
                                             y
                                             y
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       2
                                       D
                                       
                                          
                                             ε
                                          
                                          
                                             x
                                             y
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        
                     

The effective stress 
                           
                              σ
                              ¯
                           
                         is also obtained from 
                           
                              ε
                              ¯
                           
                         by the Holloman power law.

The principle of virtual work is applied to the final work piece:
                           
                              (10)
                              
                                 
                                    
                                       ∑
                                       e
                                    
                                    
                                       
                                          
                                             W
                                          
                                          
                                             int
                                          
                                          
                                             e
                                          
                                       
                                       −
                                    
                                 
                                 
                                    
                                       ∑
                                       e
                                    
                                    
                                       
                                          
                                             W
                                          
                                          
                                             e
                                             x
                                             t
                                          
                                          
                                             e
                                          
                                       
                                       =
                                       0
                                    
                                 
                              
                           
                        where e is element numbers and,
                           
                              (11)
                              
                                 
                                    
                                       W
                                    
                                    
                                       int
                                    
                                    
                                       e
                                    
                                 
                                 =
                                 
                                    ∫
                                    
                                       
                                          
                                             v
                                          
                                          
                                             e
                                          
                                       
                                    
                                 
                                 
                                    〈
                                    
                                       
                                          ε
                                       
                                       ⁎
                                    
                                    〉
                                    {
                                    σ
                                    }
                                    d
                                    v
                                 
                              
                           
                        
                        
                           
                              (12)
                              
                                 
                                    
                                       W
                                    
                                    
                                       e
                                       x
                                       t
                                    
                                    
                                       e
                                    
                                 
                                 =
                                 
                                    ∫
                                    
                                       
                                          
                                             v
                                          
                                          
                                             e
                                          
                                       
                                    
                                 
                                 
                                    〈
                                    
                                       
                                          u
                                       
                                       ⁎
                                    
                                    〉
                                    {
                                    f
                                    }
                                    d
                                    v
                                 
                              
                           
                        where, 〈u
                        ⁎〉 and 〈ε
                        ⁎〉 are the virtual displacements and their corresponding virtual membrane strains, v
                        
                           e
                         is the element volume, {σ} are the Cauchy stresses, and {f} are the external forces such as tool actions in element local coordinates.

Element internal work 
                           
                              
                                 W
                              
                              
                                 int
                              
                              
                                 e
                              
                           
                         can be written as below:
                           
                              (13)
                              
                                 
                                    
                                       W
                                    
                                    
                                       int
                                    
                                    
                                       e
                                    
                                 
                                 =
                                 〈
                                 
                                    
                                       U
                                    
                                    
                                       n
                                    
                                    
                                       ⁎
                                    
                                 
                                 〉
                                 {
                                 
                                    
                                       F
                                    
                                    
                                       int
                                    
                                    
                                       e
                                    
                                 
                                 }
                              
                           
                        With 
                           〈
                           
                              
                                 U
                              
                              
                                 n
                              
                              
                                 ⁎
                              
                           
                           〉
                           =
                           〈
                           
                              
                                 U
                              
                              
                                 j
                              
                              
                                 ⁎
                              
                           
                           ,
                           
                              
                                 V
                              
                              
                                 j
                              
                              
                                 ⁎
                              
                           
                           ,
                           
                              
                                 W
                              
                              
                                 j
                              
                              
                                 ⁎
                              
                           
                           〉
                           ,
                           
                           j
                           =
                           1
                           ,
                           2
                           ,
                           3
                        . U
                        ⁎, V
                        ⁎, W
                        ⁎ are the virtual displacements in the global coordinate system XYZ. Since the vertical displacement of each node is known, 
                           
                              
                                 W
                              
                              
                                 j
                              
                              
                                 ⁎
                              
                           
                           =
                           0
                        . 
                           {
                           
                              
                                 F
                              
                              
                                 int
                              
                              
                                 e
                              
                           
                           }
                         are the element internal forces vector and are given by
                           
                              (14)
                              
                                 {
                                 
                                    
                                       F
                                    
                                    
                                       int
                                    
                                    
                                       e
                                    
                                 
                                 }
                                 =
                                 
                                    
                                       [
                                       T
                                       ]
                                    
                                    T
                                 
                                 
                                    
                                       [
                                       B
                                       ]
                                    
                                    T
                                 
                                 {
                                 σ
                                 }
                                 A
                                 h
                              
                           
                        where [B] is the strain operator in the local coordinate system of each element. [T] is the transformation matrix between global and local coordinate systems. A is the element area and h is the thickness of the element. h is obtained from thickness stretch which is modified at each iteration.

The element external work 
                           
                              
                                 W
                              
                              
                                 e
                                 x
                                 t
                              
                              
                                 e
                              
                           
                         can be written as below:
                           
                              (15)
                              
                                 
                                    
                                       W
                                    
                                    
                                       e
                                       x
                                       t
                                    
                                    
                                       e
                                    
                                 
                                 =
                                 〈
                                 
                                    
                                       U
                                    
                                    
                                       n
                                    
                                    
                                       ⁎
                                    
                                 
                                 〉
                                 {
                                 
                                    
                                       F
                                    
                                    
                                       e
                                       x
                                       t
                                    
                                    
                                       e
                                    
                                 
                                 }
                              
                           
                        where 
                           {
                           
                              
                                 F
                              
                              
                                 e
                                 x
                                 t
                              
                              
                                 e
                              
                           
                           }
                         are the element external forces vector due to the tool actions. Calculation of the element external forces will be described in the next section.

Substituting Eqs. (13) and (15) in Eq. (10), Eq. (16) is derived:
                           
                              (16)
                              
                                 
                                    
                                       ∑
                                       e
                                    
                                    
                                       
                                          
                                             F
                                          
                                          
                                             int
                                          
                                          
                                             e
                                          
                                       
                                       −
                                    
                                 
                                 
                                    
                                       ∑
                                       e
                                    
                                    
                                       
                                          
                                             F
                                          
                                          
                                             e
                                             x
                                             t
                                          
                                          
                                             e
                                          
                                       
                                       =
                                       0
                                    
                                 
                              
                           
                        
                     

Here, the external forces mainly include the blank holder and tool forces. The blank holder and tool forces consist of normal and friction forces. However, under the blank holder, the normal forces acting on the two sides of the sheet are in equilibrium; therefore, only the friction forces are considered.

Friction force is path dependent, but in the inverse method only final and initial configuration is considered; therefore it is impossible to simulate the friction forces perfectly. So a simplified method is introduced to model the friction force per unit area, under the blank holder. In this method, a non-uniform distribution of the friction force is considered on the nodes under blank-holder zone. Since the contact time for each node in this region increases from inner to outer edge, a linear weight function (ω) is defined to consider this non-uniformity. The following equation gives the blank holder friction force per unit area:
                              
                                 (17)
                                 
                                    {
                                    
                                       
                                          f
                                       
                                       
                                          t
                                       
                                    
                                    }
                                    =
                                    −
                                    2
                                    ω
                                    μ
                                    
                                       
                                          q
                                       
                                       
                                          n
                                       
                                    
                                    {
                                    t
                                    }
                                 
                              
                           where, q
                           
                              n
                            is the normal blank holder pressure, μ is the coefficient of friction, {t} is the material flow direction and ω is the linear weight function, which is 1 at nodes initially located at the outer edge of the blank and 0 at nodes initially located at the inner edge of the die (as shown in 
                           Fig. 2).

Since the material flow direction is unknown prior to the analysis, a good initial guess is used to find the nodal positions in the flat plane and therefore the material flow direction. The unit vector representing the material flow direction {t} is as follows:
                              
                                 (18)
                                 
                                    {
                                    t
                                    }
                                    =
                                    
                                       
                                          {
                                          
                                             
                                                u
                                             
                                             
                                                t
                                             
                                          
                                          }
                                       
                                       
                                          |
                                          
                                             
                                                u
                                             
                                             
                                                t
                                             
                                          
                                          |
                                       
                                    
                                 
                              
                           
                           
                              
                                 (19)
                                 
                                    {
                                    
                                       
                                          u
                                       
                                       
                                          t
                                       
                                    
                                    }
                                    =
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          j
                                       
                                    
                                    −
                                    
                                       
                                          X
                                       
                                       
                                          j
                                       
                                    
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          j
                                       
                                    
                                    −
                                    
                                       
                                          Y
                                       
                                       
                                          j
                                       
                                    
                                    ,
                                    0
                                    )
                                 
                              
                           where, X
                           
                              j
                           , Y
                           
                              j
                            are the coordinates of node j in the initial blank obtained by initial guess and x
                           
                              j
                           , y
                           
                              j
                            are the coordinates of node j in the final configuration.

The punch and die effects correspond to the normal and tangent components of the contact force, as shown in 
                           Fig. 3:
                              
                                 (20)
                                 
                                    {
                                    F
                                    }
                                    =
                                    {
                                    
                                       
                                          F
                                       
                                       
                                          n
                                       
                                    
                                    }
                                    +
                                    {
                                    
                                       
                                          F
                                       
                                       
                                          t
                                       
                                    
                                    }
                                    ⇒
                                    F
                                    {
                                    
                                       
                                          n
                                       
                                       f
                                    
                                    }
                                    =
                                    
                                       
                                          F
                                       
                                       
                                          n
                                       
                                    
                                    {
                                    n
                                    }
                                    −
                                    
                                       
                                          F
                                       
                                       
                                          t
                                       
                                    
                                    {
                                    t
                                    }
                                 
                              
                           where, {n} and {t} are the normal and tangent unit vectors. F
                           
                              n
                            is the normal force of tool and F
                           
                              t
                            is the friction force between the tool and sheet. The unit vector in the direction of the resultant force, {n
                           
                              f
                           }, can be specified as follows:
                              
                                 (21)
                                 
                                    {
                                    
                                       
                                          n
                                       
                                       
                                          f
                                       
                                    
                                    }
                                    =
                                    
                                       1
                                       
                                          
                                             
                                                1
                                                +
                                                
                                                   
                                                      μ
                                                   
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    (
                                    {
                                    n
                                    }
                                    −
                                    μ
                                    {
                                    t
                                    }
                                    )
                                 
                              
                           
                        

So the direction of the resultant force is known while its magnitude, F, is unknown.

Under the blank holder, there are two equations and two unknowns (two horizontal displacements U
                        
                           k
                        , V
                        
                           k
                        ) at each node k:
                           
                              (22)
                              
                                 {
                                 
                                    
                                       F
                                    
                                    
                                       e
                                       x
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 }
                                 −
                                 {
                                 
                                    
                                       F
                                    
                                    
                                       int
                                    
                                    
                                       k
                                    
                                 
                                 }
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         t
                                                         x
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         U
                                                      
                                                      k
                                                   
                                                   ,
                                                   
                                                      
                                                         V
                                                      
                                                      k
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         t
                                                         y
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         U
                                                      
                                                      k
                                                   
                                                   ,
                                                   
                                                      
                                                         V
                                                      
                                                      k
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    }
                                 
                                 −
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         F
                                                      
                                                      
                                                         int
                                                         
                                                         X
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         U
                                                      
                                                      k
                                                   
                                                   ,
                                                   
                                                      
                                                         V
                                                      
                                                      k
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         F
                                                      
                                                      
                                                         int
                                                         
                                                         Y
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         U
                                                      
                                                      k
                                                   
                                                   ,
                                                   
                                                      
                                                         V
                                                      
                                                      k
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    }
                                 
                                 =
                                 0
                              
                           
                        
                     

Under the punch and die regions, there are three equations and three unknowns (F
                        
                           k
                         as well as two horizontal displacements U
                        
                           k
                        , V
                        
                           k
                        ) at each node k:
                           
                              (23)
                              
                                 {
                                 
                                    
                                       F
                                    
                                    
                                       e
                                       x
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 }
                                 −
                                 {
                                 
                                    
                                       F
                                    
                                    
                                       int
                                    
                                    
                                       k
                                    
                                 
                                 }
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         F
                                                      
                                                      k
                                                   
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         f
                                                         x
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         U
                                                      
                                                      k
                                                   
                                                   ,
                                                   
                                                      
                                                         V
                                                      
                                                      k
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         F
                                                      
                                                      k
                                                   
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         f
                                                         y
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         U
                                                      
                                                      k
                                                   
                                                   ,
                                                   
                                                      
                                                         V
                                                      
                                                      k
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         F
                                                      
                                                      k
                                                   
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         f
                                                         z
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         U
                                                      
                                                      k
                                                   
                                                   ,
                                                   
                                                      
                                                         V
                                                      
                                                      k
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    }
                                 
                                 −
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         F
                                                      
                                                      
                                                         int
                                                         
                                                         X
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         F
                                                      
                                                      
                                                         int
                                                         
                                                         Y
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         F
                                                      
                                                      
                                                         int
                                                         
                                                         z
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    }
                                 
                                 =
                                 0
                              
                           
                        
                        F
                        
                           k
                         can be calculated by using the third equation, but some numerical problems may arise especially at quasi vertical walls because of small values of n
                        
                           f
                        . The following relation proposed by Naceur et al. [13] can be used in order to reduce numerical problems.
                           
                              (24)
                              
                                 
                                    
                                       F
                                    
                                    k
                                 
                                 =
                                 〈
                                 
                                    
                                       n
                                    
                                    
                                       f
                                    
                                 
                                 〉
                                 {
                                 
                                    
                                       F
                                    
                                    
                                       int
                                    
                                    
                                       k
                                    
                                 
                                 }
                              
                           
                        
                     

Therefore, the system of three equations (23) can be reduced to two equations with two unknowns U
                        
                           k
                        , V
                        
                           k
                        :
                           
                              (25)
                              
                                 {
                                 
                                    
                                       F
                                    
                                    
                                       e
                                       x
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 
                                    
                                       U
                                    
                                    k
                                 
                                 ,
                                 
                                    
                                       V
                                    
                                    k
                                 
                                 )
                                 }
                                 −
                                 {
                                 
                                    
                                       F
                                    
                                    
                                       int
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 
                                    
                                       U
                                    
                                    k
                                 
                                 ,
                                 
                                    
                                       V
                                    
                                    k
                                 
                                 )
                                 }
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         F
                                                      
                                                      k
                                                   
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         x
                                                      
                                                      
                                                         f
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         F
                                                      
                                                      k
                                                   
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         y
                                                      
                                                      
                                                         f
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    }
                                 
                                 −
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         F
                                                      
                                                      
                                                         int
                                                         
                                                         X
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         F
                                                      
                                                      
                                                         int
                                                         
                                                         Y
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    }
                                 
                                 =
                                 0
                              
                           
                        
                     

The Newton Raphson method has been implemented for solving the set of nonlinear Eqs. (22) and (25) as follows:
                           
                              (26)
                              
                                 {
                                 
                                    
                                       U
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 }
                                 =
                                 {
                                 
                                    
                                       U
                                    
                                    
                                       i
                                    
                                 
                                 }
                                 +
                                 α
                                 {
                                 Δ
                                 U
                                 }
                              
                           
                        
                        
                           
                              (27)
                              
                                 {
                                 Δ
                                 U
                                 }
                                 =
                                 
                                    
                                       [
                                       
                                          
                                             J
                                          
                                          
                                             i
                                          
                                       
                                       ]
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 {
                                 R
                                 (
                                 
                                    
                                       U
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 }
                              
                           
                        where, [J
                        
                           i
                        ] is the Jacobian matrix:
                           
                              (28)
                              
                                 [
                                 
                                    
                                       J
                                    
                                    
                                       i
                                    
                                 
                                 ]
                                 =
                                 −
                                 
                                    
                                       [
                                       
                                          
                                             
                                                ∂
                                                {
                                                R
                                                (
                                                U
                                                )
                                                }
                                             
                                             
                                                ∂
                                                {
                                                U
                                                }
                                             
                                          
                                       
                                       ]
                                    
                                    
                                       U
                                       =
                                       
                                          
                                             U
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                           
                        
                        α is a coefficient between 0 and 1. According to the examples solved in this work, suitable value for α is between 0.3 and 0.5. Values less than 0.3 decrease the convergence speed and values between 0.5 and 1 usually lead to divergence.

The Newton–Raphson method expressed by Eq. (26) is highly sensitive to the initial guess {U
                        0}. So initial guess is an important issue to speed up and guarantee the convergence of Newton–Raphson iteration. In this study the unfolding technique is used as initial guess.

The unfolding technique, as discussed in Section 1, is a linear type of IFEM that is very quick and efficient to obtain the initial blank. This method avoids the convergence problems in the nonlinear method. Detailed description about this method is given in the following section.

The idea of the initial guess used in the present analysis is a linear mapping of the deformed surface of the final state to a flat surface of the initial state. In the mapping procedure, the surface is discretized into triangular elements and it is assumed that the material in each element deforms linearly.

The scheme for the initial guess is as follows:
                        
                           Step 1. Unfold each element in the final configuration to the flat plane, as shown in 
                              Fig. 4.

Step 2. Project each element in the final configuration on the flat plane, as shown in 
                              Fig. 5.

Step 3. Calculate displacement vector between the unfolded and projected elements, Δu
                              
                                 e
                               and consequently the force vector, F
                              
                                 e
                               with respect to Eq. (29).
                                 
                                    (29)
                                    
                                       
                                          
                                             F
                                          
                                          e
                                       
                                       =
                                       
                                          
                                             K
                                          
                                          e
                                       
                                       Δ
                                       
                                          
                                             u
                                          
                                          e
                                       
                                    
                                 
                              where K
                              
                                 e
                               is the linear stiffness matrix of triangular membrane element.

Step 4. Assemble the force vectors and stiffness matrices to obtain global displacement vector:
                                 
                                    (30)
                                    
                                       Δ
                                       U
                                       =
                                       
                                          
                                             K
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       F
                                    
                                 
                              
                           

Add this vector to the coordinates of projected nodes to obtain the initial estimation of nodal coordinates.

Step 5. Calculate element effective strain and stress in accordance with Section 2.1 by using the final nodal coordinates and the initial nodal coordinates obtained from Step 4.

Step 6. Correct the material properties with respect to 
                              Fig. 6 and repeat Steps 3–5 until convergence. The convergence criterion has been selected according to Ref. [16]. It usually takes about 4–6 iterations to obtain convergence.

For more details about unfolding technique, refer to Ref. [16].

@&#RESULTS@&#

The inverse algorithm has been implemented in a finite element code and applied to three sheet metal forming examples: circular cup, square cup and Srail. The direct unfolding method has been used as the initial guess. The blank shape and strain distributions of these parts have been obtained. In order to check the validity of the present algorithm, ABAQUS explicit has been used with blank dimensions extracted from the IFEM results. Moreover, in circular cup example, IFEM results have been compared with experimental results [20].

A circular cup is considered to determine the initial blank and strain distribution. Dimensions of the part and material properties were adopted from Ref. [20] and are shown in 
                        
                        Tables 1 and 2, respectively. This part is meshed with 3836 elements and 2003 nodes.

The initial blank obtained from the developed inverse algorithm has a radius of 90mm. The obtained blank from IFEM is used in ABAQUS Explicit for forward simulation. Radial and hoop strain along radial direction predicted by IFEM with non-uniform and without non-uniform friction is shown in 
                        
                        Figs. 7 and 8 and compared with those of ABAQUS Explicit and experimental results [20].

As shown above, results of the developed method are in good agreement with experimental and ABAQUS results. Furthermore, the new approach for friction modeling has improved the solution in the wall region; however errors between experimental and IFEM results increase in the blank holder region.

A square cup of 36.1mm depth shown in 
                        Fig. 9 is considered to determine the initial blank and strain distribution. The material properties and other process variables are as follows:
                           
                              initial thickness: h
                                 0=1 (mm)

uni‌axial tension curve: σ=538ε
                                 0.18 (Mpa)

Lankford value: r=1

friction coefficient: μ=0.1

blank‌holder pressure: q
                                 
                                    n
                                 =1000 (Mpa)

A quarter of the box is meshed with 992 nodes and 1868 CST triangular elements.

The initial blank obtained from the developed inverse algorithm is shown in 
                        Fig. 10.

Thickness strain along transverse direction predicted by nonlinear and linear IFEM are compared with those of ABAQUS Explicit in 
                        Fig. 11.

The thickness strain distribution predicted by the present method is in good agreement with the incremental forward results. The maximum amount of error is observed at the blank-holder region because this method does not consider the deformation path. It is also obvious that the nonlinear IFEM strains are more accurate in comparison to linear IFEM strains.

In order to check the validity of the developed algorithm for complicated geometries, the inverse algorithm has been applied to S‌rail with the geometry dimensions shown in 
                        Fig. 12. It is meshed with 923 nodes and 1721 CST triangular elements. Material and mechanical properties are like those of the square cup.

The initial blank obtained by IFEM is shown in 
                        Fig. 13.

It is shown that it can also analyze complicated problems such as Srail drawing, by providing reasonable blank shape.

Results of thickness strain in two paths are compared with those of ABAQUS Explicit in 
                        Fig. 14.

As shown in Fig. 14, regardless of how complicated the geometry is, the present algorithm predicts strain distribution with good agreement with incremental finite element.

In order to evaluate the effect of unfolding technique on solution time and convergence condition, this example is solved using other common initial guesses such as projection or a factor of it. The computation time and convergence condition is compared in 
                        Table 3. The computations have been done on a Pentium®4 CPU 3.2GHz, 1GB RAM computer.

As shown in Table 3, applying the linear unfolding method as initial guess reduces significantly the solution time. For instance the convergence occurred after just two iterations for Srail. Using other initial guesses such as projection or a factor of it led to divergence or time consuming solution. Therefore, the proposed initial guess ensures convergence even for complicated shapes. Moreover, it took about 15min to complete the simulation in ABAQUS explicit with blank dimensions extracted from the IFEM results.

@&#CONCLUSIONS@&#

In the present study, an inverse finite element formulation has been developed which deals with principle of virtual work, deformation theory of plasticity, logarithmic large strains of membrane triangular elements and a new approach for friction modeling. In order to avoid the convergence problems, especially in the quasi-vertical walls, the linear unfolding method has been used as an appropriate initial guess. Furthermore, using the unfolding method as initial guess decreases the number of iterations in the nonlinear numerical solution and the solution speed is significantly increased.

The numerical results demonstrate that the present algorithm calculates initial blank shape and strain distributions reasonably good even for complicated shapes. The observed errors are intrinsic to the inverse method because of applying deformation theory of plasticity and ignoring path dependent nature of deep drawing. However, this method helps engineers to quickly estimate the initial blank shape and strain distribution for a new shape. Therefore, it has a significant application in automobile, airplane and home appliance industry by letting engineers to easily modify the design in blue print stage.

@&#REFERENCES@&#

