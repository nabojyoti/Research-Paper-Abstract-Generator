@&#MAIN-TITLE@&#Explicit symplectic momentum-conserving time-stepping scheme for the dynamics of geometrically exact rods

@&#HIGHLIGHTS@&#


               
                  Author-Highlights
                  
                     
                        
                           
                           An explicit variational integrator for the dynamics of rods is developed.


                        
                        
                           
                           The method is explicit, symplectic and momentum conserving.


                        
                        
                           
                           The method is second-order accurate with the time step and the mesh size.


                        
                        
                           
                           The energy drift remains bounded over exponentially long times.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Geometrically exact rods

Finite rotations

Momentum-conserving algorithms

Variational integrators

@&#ABSTRACT@&#


               
               
                  A new structure-preserving algorithm for simulating the nonlinear dynamics of geometrically exact rods is developed. The method is based on the simultaneous discretization in space and time of Hamilton׳s variational principle. The resulting variational integrator is explicit, second-order accurate and can be identified with a Lie-group symplectic partitioned Runge–Kutta method for finite element discretizations of rods involving large rotations and displacements. Numerical examples allow to verify that the algorithm presents an excellent long term energy behavior along with the exact conservation of the momenta associated to the symmetries of the system.
               
            

@&#INTRODUCTION@&#

The formulation of continuum based theories for rods has captured the interest of researchers during decades [60]. The motivation for developing such theories is rooted in attempting to model complex physical problems arising in the dynamics of slender solids by means of a dimensionally reduced approach. This point of view has boosted the construction of models depending on one spatial variable and the time [1,73].

One of the most successful models
                        1
                     
                     
                        1
                        An alternative to geometrically exact models is given by the co-rotational approach for rods, see for example [15].
                      for describing the dynamics of elastic rods undergoing finite deformation has been proposed by Simo in [65]. This geometrically exact formulation follows a director-type approach to describe the kinematics of the rods and corresponds to a three-dimensional generalization of Reissner׳s original model [60,61]. In a posterior work, Simo and Vu-Quoc [69,70] proposed a numerical scheme based on combining the finite element method (FEM) with a modified version of Newmark׳s scheme for time integration. Other authors have also made highlighting contributions. For example, an initially curved reference configuration for the rod has been considered in [31,32,37]. A total Lagrangian formulation has been proposed in [11] and revisited in [47]. Some important numerical issues such as the construction of non-locking elements or frame-indifferent formulations can be consulted in [8,35,62,63]. An alternative formulation based on some concepts of geometric (Clifford) algebra is presented in [58]. The list of works largely exceeds the mentioned ones, which only constitute some relevant examples; a more complete survey can be consulted in [53].

From the point of view of the applications, this formulation has also received considerable attention. In [72] Simo and Vu-Quoc applied the model to study the dynamics of earth-orbiting flexible satellites with multibody components. It has also been used for studying the dynamics of flexible mechanisms [7,10], robotic technology [78], the coupled geometric and constitutive nonlinear response of structures and buildings in the static [56] and dynamic cases [57], including applications to passive control in earthquake engineering [73,53]. The application of the model to the study of slender structures made of composite materials has been carried out in [75–77].

The formulation of time integrators for the Reissner–Simo theory of elastic rods results to be a particularly challenging task since the model describes a dynamical system evolving on a nonlinear manifold rather than on a linear space. Several approaches have been proposed in order to design time integrators respecting the geometry of the configuration space. The design of structure-preserving algorithms for dynamics of rigid bodies is closely linked to the design of new methods for elastic rods. In this sense, Simo and Wong [71] developed a midpoint algorithm on 
                        SO
                        (
                        3
                        )
                     
                     
                        2
                     
                     
                        2
                        The symbol 
                              SO
                              (
                              3
                              )
                            denotes the non-commutative group of proper rotations [47].
                      which conserves the total energy and the norm of the total momentum. They also formulated an implicit energy and momentum conserving algorithm. In [70] Newmark׳s method was extended to include 
                        SO
                        (
                        3
                        )
                      yielding to a scheme able to handle arbitrarily large rotations and displacements. Even though this scheme has demonstrated to be useful in several applications [11], Mäkinen states [46] that it only constitutes an approximated version of the correct formulas, which are given in [2].

In spite of the above results, it is widely recognized that Newmark׳s family of implicit schemes fails to preserve the invariants of nonlinear Hamiltonian systems with symmetry [68]. Moreover, the stability and accuracy properties are not guaranteed in the nonlinear range [3,4]. A further step towards the development of robust schemes is given by formulation of the so-called the energy and momentum conserving (E–M) methods. They have been extended to elastic rods by Simo et al. in [67]. An alternative to E–M methods is given by the symplectic-momentum methods which are characterized by the preservation of certain skew-symmetric bilinear form on the phase space
                        3
                     
                     
                        3
                        The simultaneous conservation of the total energy and the symplectic structure is not possible for methods with constant time step [36,41,22].
                      along with the exact conservation of the momenta associated to symmetries of the Lagrangian. A comparison between symplectic and E–M schemes is presented in [24]. First-order accurate algorithms that exhibit controllable energy dissipation and momentum conservation are formulated in [3] and second-order methods can be found in [4].

More recently, the attention have been turned towards the so-called variational integrators (VI) which are methods obtained from a discrete version of Hamilton׳s principle for conservative systems [51,52,59,79]. These methods present remarkable properties among which are: (i) they are symplectic, (ii) they exactly conserve the momenta associated to the symmetries of a discrete Lagrangian and (iii) they show an excellent long time energy behavior. Moreover, higher order methods can be constructed following a systematic procedure. An overview of the method can be found in [44] and the case of continuum systems in considered in [49,81]. The construction of asynchronous VI׳s is carried out in [43] and development of generalized Galerkin VI׳s, including dynamical systems evolving on Lie groups, can be consulted in [41,39,40]. In summary, variational methods constitute an extraordinarily versatile framework for the systematic construction of structure-preserving time integrators [29] that can be applied to a wide variety of problems arising in different fields of science and engineering [41,55]. However, the variational techniques have not been applied to formulate structure-preserving methods for geometrically exact rods.

Innovative numerical models of elastic rods are currently used in a wide range of subjects areas such as computational biophysics, the dynamics of interacting biomolecules and filaments, synthetic polymers and new materials based on nano-technologies. For example, in [38] a numerical model for the dynamics of viscous Kirchhoff rods is used for studying problems of biological significance, including the super-coiling and instability in closed rods and the self-assembly behavior of fibril structures such as certain types of bacteria. Goriely and Tabor [25–27] study certain theoretical aspects of Kirchhoff׳s rods with applications in the numerical simulation of thin filaments. The application of rod models to the study the growth of certain plants can be consulted in [28]. In [23] a theory of elastic filaments is extended to consider biological systems that display competition between two helical structures of opposite chirality. Balaeff et al. [6] extend the classical Kirchhoff׳s model applied to deoxyribonucleic acid (DNA) to account for sequence-dependent intrinsic twist and curvature, anisotropic rotational stiffness and electrostatic interactions. Yang et al. [80] construct a finite element (FE) model for inextensible elastic rods including self-contact and use it for modelling a DNA polymer composed of thousands of base pairs. A survey about the numerical modelling of super-helical DNA can be consulted in [64]. Therefore, it is necessary to formulate robust time integrators for simulating the dynamics of rods undergoing complex morphological changes.

In this work, a new explicit variational integrator for simulating the dynamics of geometrically exact rods is formulated. Its construction is built on the simultaneous discretization in space and time of the action functional. To this end, the finite element method is applied the continuum problem to obtain a finite-dimensional semi-discrete problem. Then, standard procedures in variational integration are applied on the nodal variables of the mesh to formulate a structure-preserving Lie-group partitioned Runge–Kutta method. The new time integrator enjoys a number of remarkable features: (i) it is explicit if an appropriate quadrature rule is used to compute the discrete kinetic energy, (ii) it is symplectic, (iii) it exactly conserves the momenta associated to the symmetries of the discrete Lagrangian, (iv) it is second-order accurate, (v) it shows an energy drift that remains bounded over exponentially long periods of times and, (vi) since it is explicit, it avoids using iterative schemes to solve large systems of nonlinear equations.

In this section the Lagrangian point of view of the mechanics is considered to deduce the balance equations for geometrically exact rods in finite deformation. Special emphasis is given to the non-linear nature of the configuration manifold. Additionally, the Hamiltonian structure of the problem is also addressed along with the invariants of the dynamics.


                        Kinematics: Let 
                           {
                           
                              
                                 E
                              
                              
                                 i
                              
                           
                           }
                         and 
                           {
                           
                              
                                 e
                              
                              
                                 i
                              
                           
                           }
                         be the material and spatial inertial frames, which are orthogonal and coincident.
                           4
                        
                        
                           4
                           Notation: Latin and Greek indexes range over {1,2,3} and {2,3}, respectively. The symbols 
                                 (
                                 •
                                 )
                                 
                                    
                                       ,
                                    
                                    
                                       x
                                    
                                 
                              , 
                                 
                                    
                                       (
                                       •
                                       )
                                    
                                    
                                       ̇
                                    
                                 
                               and 
                                 SO
                                 (
                                 3
                                 )
                               denote differentiation with respect to x, time differentiation and the linear space of skew-symmetric tensors, respectively.
                         The reference configuration is given by a straight rod of length L with constant cross section 
                           A
                           ⊂
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                        . Then, the position vector of a material point in this configuration is 
                           
                              
                                 X
                                 (
                                 s
                                 ,
                                 
                                    
                                       ξ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       ξ
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 =
                                 s
                                 
                                    
                                       E
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       ξ
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       E
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       ξ
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       E
                                    
                                    
                                       2
                                    
                                 
                                 ,
                              
                           
                        where 
                           s
                           ∈
                           [
                           0
                           ,
                           L
                           ]
                         is an arch-length coordinate and 
                           (
                           
                              
                                 ξ
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 ξ
                              
                              
                                 2
                              
                           
                           )
                           ∈
                           A
                         are coordinates on the cross section. The reference curve 
                           
                              
                                 φ
                              
                              
                                 0
                              
                           
                         is defined as the geometric place of all the points of the form 
                           X
                           (
                           s
                           ,
                           0
                           ,
                           0
                           )
                        . The position vector of a material point in the current configuration is given by
                           
                              (1)
                              
                                 x
                                 (
                                 s
                                 ,
                                 
                                    
                                       ξ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       ξ
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 =
                                 φ
                                 (
                                 s
                                 )
                                 +
                                 
                                    
                                       ξ
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       t
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 s
                                 )
                                 +
                                 
                                    
                                       ξ
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       t
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 s
                                 )
                                 ,
                              
                           
                        where the spatial curve 
                           φ
                           :
                           [
                           0
                           ,
                           L
                           ]
                           →
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                         is obtained by adding a displacement onto 
                           
                              
                                 φ
                              
                              
                                 0
                              
                           
                         and the vectors 
                           
                              
                                 t
                              
                              
                                 i
                              
                           
                           =
                           Λ
                           
                              
                                 E
                              
                              
                                 i
                              
                           
                         with 
                           Λ
                           :
                           [
                           0
                           ,
                           L
                           ]
                           →
                           SO
                           (
                           3
                           )
                         define an orthonormal coordinate system characterizing the current orientation of the cross-section [65,37], see Fig. 1
                        .

The configuration space, 
                           Q
                        , is the set of all the smooth-enough fields
                           
                              (2)
                              
                                 Φ
                                 ≡
                                 (
                                 φ
                                 ,
                                 Λ
                                 )
                                 :
                                 [
                                 0
                                 ,
                                 L
                                 ]
                                 →
                                 
                                    
                                       R
                                    
                                    
                                       3
                                    
                                 
                                 ×
                                 SO
                                 (
                                 3
                                 )
                                 ,
                              
                           
                        subjected to the prescribed boundary conditions 
                           Φ
                           (
                           0
                           )
                           =
                           
                              
                                 Φ
                              
                              
                                 0
                              
                           
                         and 
                           Φ
                           (
                           L
                           )
                           =
                           
                              
                                 Φ
                              
                              
                                 L
                              
                           
                         and to the restriction 
                           φ
                           
                              
                                 ,
                              
                              
                                 s
                              
                           
                           ·
                           
                              
                                 t
                              
                              
                                 1
                              
                           
                           >
                           0
                         
                        [67]. Due to the non-commutative nature of 
                           SO
                           (
                           3
                           )
                        , 
                           Q
                         results to be a nonlinear differentiable manifold [50,68]. Thereby, using the spatial rule to update rotations, we obtain that admissible variations on 
                           Φ
                           ∈
                           Q
                         are given by elements of the form 
                           (
                           u
                           ,
                           
                              
                                 θ
                              
                              
                                 ˜
                              
                           
                           Λ
                           )
                           ∈
                           
                              
                                 T
                              
                              
                                 Φ
                              
                           
                           Q
                         where
                           
                              (3)
                              
                                 (
                                 u
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       ˜
                                    
                                 
                                 )
                                 :
                                 [
                                 0
                                 ,
                                 L
                                 ]
                                 →
                                 
                                    
                                       R
                                    
                                    
                                       3
                                    
                                 
                                 ×
                                 so
                                 (
                                 3
                                 )
                                 .
                              
                           
                        If we consider a time interval of interest 
                           [
                           0
                           ,
                           T
                           ]
                        , a motion of the rod is given by a curve 
                           Φ
                           (
                           ·
                           )
                           :
                           [
                           0
                           ,
                           T
                           ]
                           →
                           Q
                        . The corresponding velocity is 
                           
                              
                                 Φ
                              
                              
                                 ̇
                              
                           
                           =
                           (
                           
                              
                                 φ
                              
                              
                                 ̇
                              
                           
                           ,
                           
                              
                                 Λ
                              
                              
                                 ̇
                              
                           
                           )
                         which yields to the following expression for the velocity of a material point:
                           
                              (4)
                              
                                 
                                    
                                       x
                                    
                                    
                                       ̇
                                    
                                 
                                 =
                                 
                                    
                                       φ
                                    
                                    
                                       ̇
                                    
                                 
                                 +
                                 Λ
                                 
                                    
                                       V
                                    
                                    
                                       ˜
                                    
                                 
                                 Z
                                 =
                                 
                                    
                                       φ
                                    
                                    
                                       ̇
                                    
                                 
                                 +
                                 
                                    
                                       v
                                    
                                    
                                       ˜
                                    
                                 
                                 z
                                 ,
                              
                           
                        where 
                           Z
                           =
                           
                              
                                 β
                              
                              
                                 2
                              
                           
                           
                              
                                 E
                              
                              
                                 2
                              
                           
                           +
                           
                              
                                 β
                              
                              
                                 3
                              
                           
                           
                              
                                 E
                              
                              
                                 3
                              
                           
                         and
                           
                              (5)
                              
                                 
                                    
                                       V
                                    
                                    
                                       ˜
                                    
                                 
                                 =
                                 
                                    
                                       Λ
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       Λ
                                    
                                    
                                       ̇
                                    
                                 
                                 ,
                              
                           
                        is the material form of the angular velocity tensor. The corresponding spatial forms are 
                           z
                           =
                           Λ
                           Z
                         and 
                           
                              
                                 v
                              
                              
                                 ˜
                              
                           
                           =
                           Λ
                           
                              
                                 V
                              
                              
                                 ˜
                              
                           
                           
                              
                                 Λ
                              
                              
                                 t
                              
                           
                        .


                        Strains: The material form of the cross sectional strain measures [37,66] are the strain vector, 
                           Γ
                           =
                           
                              
                                 Λ
                              
                              
                                 t
                              
                           
                           φ
                           
                              
                                 ,
                              
                              
                                 s
                              
                           
                           −
                           
                              
                                 E
                              
                              
                                 1
                              
                           
                        ,, and the curvature tensor 
                           
                              
                                 Ω
                              
                              
                                 ˜
                              
                           
                           =
                           
                              
                                 Λ
                              
                              
                                 t
                              
                           
                           Λ
                           
                              
                                 ,
                              
                              
                                 s
                              
                           
                        . The corresponding spatial forms are given by 
                           γ
                           =
                           Λ
                           Γ
                         and 
                           
                              
                                 ω
                              
                              
                                 ˜
                              
                           
                           =
                           Λ
                           
                              
                                 Ω
                              
                              
                                 ˜
                              
                           
                           
                              
                                 Λ
                              
                              
                                 t
                              
                           
                        , respectively.


                        Stresses: It will be assumed that the rod is made of an isotropic, homogeneous, hyper-elastic material and that 
                           {
                           
                              
                                 t
                              
                              
                                 β
                              
                           
                           }
                         are oriented along principal axes of the cross section. Following previous works [32,33,65,67], we consider a stored energy function per unit of reference length 
                           ψ
                           (
                           Γ
                           ,
                           Ω
                           )
                         such that the material form of the stress resultants and stress couples are given by
                           
                              (6)
                              
                                 
                                    
                                       n
                                    
                                    
                                       m
                                    
                                 
                                 =
                                 
                                    
                                       ∂
                                       ψ
                                       (
                                       Γ
                                       ,
                                       Ω
                                       )
                                    
                                    
                                       ∂
                                       Γ
                                    
                                 
                                 =
                                 
                                    
                                       C
                                    
                                    
                                       Γ
                                    
                                 
                                 Γ
                                 
                                 and
                                 
                                 
                                    
                                       m
                                    
                                    
                                       m
                                    
                                 
                                 =
                                 
                                    
                                       ∂
                                       ψ
                                       (
                                       Γ
                                       ,
                                       Ω
                                       )
                                    
                                    
                                       ∂
                                       Ω
                                    
                                 
                                 =
                                 
                                    
                                       C
                                    
                                    
                                       Ω
                                    
                                 
                                 Ω
                                 ,
                              
                           
                        where 
                           Ω
                         is the axial vector of 
                           
                              
                                 Ω
                              
                              
                                 ˜
                              
                           
                         and, 
                           
                              
                                 C
                              
                              
                                 Γ
                              
                           
                         and 
                           
                              
                                 C
                              
                              
                                 Ω
                              
                           
                         are the following cross sectional constitutive tensors: 
                           
                              
                                 
                                    
                                       C
                                    
                                    
                                       Γ
                                    
                                 
                                 =
                                 diag
                                 [
                                 EA
                                 ,
                                 
                                 GA
                                 ,
                                 
                                 GA
                                 ]
                                 
                                 and
                                 
                                 
                                    
                                       C
                                    
                                    
                                       Ω
                                    
                                 
                                 =
                                 diag
                                 [
                                 GJ
                                 ,
                                 
                                 
                                    
                                       EI
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       EI
                                    
                                    
                                       3
                                    
                                 
                                 ]
                                 ,
                              
                           
                        where A is the cross sectional area and E, G, J, I
                        2 and I
                        3 are an elastic modulus, a shear modulus, a torsional stiffness and two flexural stiffnesses, respectively. The corresponding spatial forms are 
                           n
                           =
                           Λ
                           
                              
                                 n
                              
                              
                                 m
                              
                           
                        , 
                           m
                           =
                           Λ
                           
                              
                                 m
                              
                              
                                 m
                              
                           
                        
                     

The Lagrangian point of view of the mechanics is based on variational principles [51]. Often, it is preferred over other approaches due to its potential in the development of computational applications [20,36,39–41,43,44]. Basically, this approach consists in constructing the Lagrangian function of the system and then using Hamilton׳s variational principle to deduce the equations of motion. Hamilton׳s principle states that the trajectory of the system is a critical point of the action computed on the space of trajectories joining two fixed points on the configuration space. See [81] for a recent survey in the context of elasticity. In this section, this procedure is carried out for geometrically exact elastic rods.


                        Kinetic energy: The kinetic energy, 
                           K
                           :
                           T
                           Q
                           →
                           R
                        , is given by
                           
                              (7)
                              
                                 K
                                 (
                                 Φ
                                 ,
                                 
                                    
                                       Φ
                                    
                                    
                                       ̇
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       ∫
                                    
                                    
                                       0
                                    
                                    
                                       L
                                    
                                 
                                 (
                                 
                                    
                                       
                                          A
                                       
                                       
                                          ρ
                                       
                                    
                                    
                                       
                                          φ
                                       
                                       
                                          ̇
                                       
                                    
                                    ·
                                    
                                       
                                          φ
                                       
                                       
                                          ̇
                                       
                                    
                                    −
                                    Tr
                                    [
                                    
                                       
                                          V
                                       
                                       
                                          ˜
                                       
                                    
                                    
                                       
                                          E
                                       
                                       
                                          ρ
                                       
                                    
                                    
                                       
                                          V
                                       
                                       
                                          ˜
                                       
                                    
                                    ]
                                 
                                 )
                                 
                                 ds
                                 ,
                              
                           
                        where the cross sectional mass density 
                           
                              
                                 A
                              
                              
                                 ρ
                              
                           
                         and the cross sectional material tensor 
                           
                              
                                 E
                              
                              
                                 ρ
                              
                           
                         are given by
                           
                              (8)
                              
                                 
                                    
                                       A
                                    
                                    
                                       ρ
                                    
                                 
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       A
                                    
                                 
                                 
                                    
                                       ρ
                                    
                                    
                                       0
                                    
                                 
                                 
                                 dA
                                 
                                 and
                                 
                                 
                                    
                                       E
                                    
                                    
                                       ρ
                                    
                                 
                                 =
                                 
                                    
                                       Λ
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 
                                    
                                       
                                          ∫
                                       
                                       
                                          A
                                       
                                    
                                    
                                       
                                          ρ
                                       
                                       
                                          0
                                       
                                    
                                    z
                                    ⊗
                                    z
                                    
                                    dA
                                 
                                 )
                                 Λ
                                 ,
                              
                           
                        respectively.


                        Potential energy: We assume that the potential energy, 
                           U
                           :
                           Q
                           →
                           R
                        , is given by the sum of two components according to 
                           
                              
                                 U
                                 (
                                 Φ
                                 )
                                 =
                                 
                                    
                                       U
                                    
                                    
                                       int
                                    
                                 
                                 (
                                 Φ
                                 )
                                 +
                                 
                                    
                                       U
                                    
                                    
                                       ext
                                    
                                 
                                 (
                                 Φ
                                 )
                                 ,
                              
                           
                        where 
                           
                              
                                 U
                              
                              
                                 int
                              
                           
                           ,
                           
                              
                                 U
                              
                              
                                 ext
                              
                           
                           :
                           Q
                           →
                           R
                         are given by
                           
                              (9a)
                              
                                 
                                    
                                       U
                                    
                                    
                                       int
                                    
                                 
                                 (
                                 Φ
                                 )
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       0
                                    
                                    
                                       L
                                    
                                 
                                 ψ
                                 (
                                 Γ
                                 ,
                                 Ω
                                 )
                                 
                                 ds
                                 ,
                              
                           
                        
                        
                           
                              (9b)
                              
                                 
                                    
                                       U
                                    
                                    
                                       ext
                                    
                                 
                                 (
                                 Φ
                                 )
                                 =
                                 −
                                 
                                    
                                       ∫
                                    
                                    
                                       0
                                    
                                    
                                       L
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       ext
                                    
                                 
                                 (
                                 φ
                                 ,
                                 Λ
                                 )
                                 
                                 ds
                                 ,
                              
                           
                        where 
                           
                              
                                 w
                              
                              
                                 ext
                              
                           
                           (
                           Φ
                           )
                         is a potential function for the loads applied on the system. Simo et al. [67] demonstrated that if 
                           
                              
                                 w
                              
                              
                                 ext
                              
                           
                         is left invariant under the action of rotations, then necessarily 
                           
                              
                                 U
                              
                              
                                 ext
                              
                           
                           (
                           Φ
                           )
                           =
                           
                              
                                 U
                              
                              
                                 ext
                              
                           
                           (
                           
                              
                                 Λ
                              
                              
                                 t
                              
                           
                           φ
                           )
                        .


                        Hamilton׳s principle: The Lagrangian function 
                           L
                           :
                           T
                           Q
                           →
                           R
                         is constructed as the kinetic minus the potential energy of the system [50], i.e.,
                           
                              (10)
                              
                                 L
                                 (
                                 Φ
                                 ,
                                 
                                    
                                       Φ
                                    
                                    
                                       ̇
                                    
                                 
                                 )
                                 =
                                 K
                                 (
                                 
                                    
                                       Φ
                                    
                                    
                                       ̇
                                    
                                 
                                 )
                                 −
                                 U
                                 (
                                 Φ
                                 )
                                 .
                              
                           
                        
                     

Moreover, we consider the set 
                           C
                         composed by all the smooth enough motions 
                           Φ
                           :
                           [
                           0
                           ,
                           T
                           ]
                           →
                           Q
                         and we construct the action functional 
                           S
                           :
                           C
                           →
                           R
                         as
                           
                              (11)
                              
                                 S
                                 [
                                 Φ
                                 (
                                 ·
                                 )
                                 ]
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       0
                                    
                                    
                                       T
                                    
                                 
                                 L
                                 (
                                 Φ
                                 ,
                                 
                                    
                                       Φ
                                    
                                    
                                       ̇
                                    
                                 
                                 )
                                 
                                 dt
                                 .
                              
                           
                        Hamilton׳s principle states that the trajectory followed by the system is a stationary point of the action under all variations in 
                           C
                         that leaves fixed the end points 
                           Φ
                           (
                           0
                           )
                           =
                           Φ
                           (
                           T
                           )
                           =
                           0
                        . Due to the non-linear nature of 
                           C
                         computing 
                           δ
                           S
                           =
                           0
                         results to be a non-trivial task [69] which yields to the following Euler–Lagrange equations:
                           
                              (12a)
                              
                                 
                                    
                                       A
                                    
                                    
                                       ρ
                                    
                                 
                                 
                                    
                                       
                                          
                                             d
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       
                                          
                                             dt
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 φ
                                 ==
                                 n
                                 
                                    
                                       ,
                                    
                                    
                                       s
                                    
                                 
                                 +
                                 N
                                 ,
                              
                           
                        
                        
                           
                              (12b)
                              
                                 
                                    
                                       d
                                    
                                    
                                       dt
                                    
                                 
                                 (
                                 
                                    skew
                                    [
                                    
                                       
                                          i
                                       
                                       
                                          ρ
                                       
                                    
                                    v
                                    ]
                                 
                                 )
                                 =
                                 
                                    
                                       m
                                    
                                    
                                       ˜
                                    
                                 
                                 
                                    
                                       ,
                                    
                                    
                                       s
                                    
                                 
                                 +
                                 
                                    
                                       φ
                                    
                                    
                                       ˜
                                    
                                 
                                 
                                    
                                       ,
                                    
                                    
                                       s
                                    
                                 
                                 
                                    
                                       n
                                    
                                    
                                       ˜
                                    
                                 
                                 −
                                 
                                    
                                       n
                                    
                                    
                                       ˜
                                    
                                 
                                 
                                    
                                       φ
                                    
                                    
                                       ˜
                                    
                                 
                                 
                                    
                                       ,
                                    
                                    
                                       s
                                    
                                 
                                 +
                                 
                                    
                                       M
                                    
                                    
                                       ˜
                                    
                                 
                                 ,
                              
                           
                        which have to be supplemented with adequate initial conditions. In the above equations 
                           
                              
                                 i
                              
                              
                                 ρ
                              
                           
                         is the spatial form of the inertial tensor, 
                           N
                         a vector of the external forces and 
                           
                              
                                 M
                              
                              
                                 ˜
                              
                           
                         a skew-symmetric tensor of external moments. The details to obtain (12a) and (12b) are omitted here but given in the accompanying Appendix. Alternatively, (12b) can be given in terms of axial vectors as
                           
                              (13)
                              
                                 
                                    
                                       d
                                    
                                    
                                       dt
                                    
                                 
                                 (
                                 
                                    
                                       i
                                    
                                    
                                       ρ
                                    
                                 
                                 v
                                 )
                                 =
                                 m
                                 
                                    
                                       ,
                                    
                                    
                                       s
                                    
                                 
                                 +
                                 φ
                                 
                                    
                                       ,
                                    
                                    
                                       s
                                    
                                 
                                 ×
                                 n
                                 +
                                 M
                                 .
                              
                           
                        
                     

Hamiltonian mechanics [50] provides an alternative framework to study the dynamics of geometrically exact rods [17]. However, it has been less considered in the literature. Notable exceptions are [9,45] where energy-momentum algorithms are developed. In this section we present some basic concepts in Hamiltonian mechanics in order to deduce Hamilton׳s equations for elastic rods along with the invariants of the dynamics.


                        Legendre transforms: Momentum densities 
                           (
                           p
                           ,
                           
                              
                                 π
                              
                              
                                 ˜
                              
                           
                           )
                           :
                           [
                           0
                           ,
                           L
                           ]
                           →
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                           ×
                           SO
                           (
                           3
                           )
                         are introduced by mean of the following Legendre transforms:
                           
                              (14a)
                              
                                 
                                    
                                       ∫
                                    
                                    
                                       0
                                    
                                    
                                       L
                                    
                                 
                                 p
                                 ·
                                 δ
                                 
                                    
                                       φ
                                    
                                    
                                       ̇
                                    
                                 
                                 
                                 ds
                                 =
                                 
                                    
                                       
                                          
                                             
                                                d
                                             
                                             
                                                d
                                                ϵ
                                             
                                          
                                          L
                                          (
                                          
                                             …
                                             ,
                                             
                                                
                                                   
                                                      
                                                         φ
                                                      
                                                      
                                                         ̇
                                                      
                                                   
                                                
                                                
                                                   ϵ
                                                
                                             
                                             ,
                                             …
                                          
                                          )
                                       
                                       |
                                    
                                    
                                       ϵ
                                       =
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       0
                                    
                                    
                                       L
                                    
                                 
                                 
                                    
                                       A
                                    
                                    
                                       ρ
                                    
                                 
                                 
                                    
                                       φ
                                    
                                    
                                       ̇
                                    
                                 
                                 ·
                                 δ
                                 
                                    
                                       φ
                                    
                                    
                                       ̇
                                    
                                 
                                 
                                 ds
                                 ,
                              
                           
                        
                        
                           
                              (14b)
                              
                                 
                                    
                                       ∫
                                    
                                    
                                       0
                                    
                                    
                                       L
                                    
                                 
                                 Tr
                                 [
                                 δ
                                 
                                    
                                       
                                          
                                             θ
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       ̇
                                    
                                 
                                 
                                    
                                       π
                                    
                                    
                                       ˜
                                    
                                 
                                 ]
                                 
                                 ds
                                 =
                                 
                                    
                                       
                                          
                                             
                                                d
                                             
                                             
                                                d
                                                ϵ
                                             
                                          
                                          L
                                          (
                                          
                                             …
                                             ,
                                             
                                                
                                                   
                                                      
                                                         Λ
                                                      
                                                      
                                                         ̇
                                                      
                                                   
                                                
                                                
                                                   ϵ
                                                
                                             
                                             ,
                                             …
                                          
                                          )
                                       
                                       |
                                    
                                    
                                       ϵ
                                       =
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       0
                                    
                                    
                                       L
                                    
                                 
                                 Tr
                                 [
                                 
                                    δ
                                    
                                       
                                          
                                             
                                                θ
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          ̇
                                       
                                    
                                    
                                    skew
                                    [
                                    
                                       
                                          i
                                       
                                       
                                          ρ
                                       
                                    
                                    v
                                    ]
                                 
                                 ]
                                 
                                 ds
                                 ,
                              
                           
                        from which it is clear that 
                           p
                           =
                           
                              
                                 A
                              
                              
                                 ρ
                              
                           
                           
                              
                                 φ
                              
                              
                                 ̇
                              
                           
                         and 
                           
                              
                                 π
                              
                              
                                 ˜
                              
                           
                           =
                           skew
                           [
                           
                              
                                 i
                              
                              
                                 ρ
                              
                           
                           v
                           ]
                        . Note that 
                           (
                           φ
                           ,
                           Λ
                           ,
                           p
                           ,
                           
                              
                                 Λ
                              
                              
                                 t
                              
                           
                           
                              
                                 π
                              
                              
                                 ˜
                              
                           
                           )
                         belongs to the co-tangent bundle 
                           
                              
                                 T
                              
                              
                                 ⁎
                              
                           
                           Q
                        . Alternatively, it is possible to consider the axial vector 
                           π
                           =
                           
                              
                                 i
                              
                              
                                 ρ
                              
                           
                           v
                         
                        [68,67].


                        Hamilton׳s equations: Rewriting the kinetic energy in terms of 
                           (
                           p
                           ,
                           π
                           )
                         it is possible to define the Hamiltonian function 
                           H
                           :
                           
                              
                                 T
                              
                              
                                 ⁎
                              
                           
                           Q
                           →
                           R
                         as 
                           
                              
                                 H
                                 (
                                 p
                                 ,
                                 π
                                 ,
                                 Φ
                                 )
                                 =
                                 K
                                 (
                                 p
                                 ,
                                 π
                                 )
                                 +
                                 U
                                 (
                                 Φ
                                 )
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       ∫
                                    
                                    
                                       0
                                    
                                    
                                       L
                                    
                                 
                                 (
                                 
                                    
                                       
                                          A
                                       
                                       
                                          ρ
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    p
                                    ·
                                    p
                                    +
                                    
                                       
                                          i
                                       
                                       
                                          ρ
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    π
                                    ·
                                    π
                                 
                                 )
                                 
                                 ds
                                 +
                                 U
                                 (
                                 Φ
                                 )
                                 .
                              
                           
                        Moreover, following standard procedures in classical mechanics (see e.g. [48,66]) Hamilton׳s equations are obtained as
                           
                              (15a)
                              
                                 
                                    
                                       φ
                                    
                                    
                                       ̇
                                    
                                 
                                 =
                                 
                                    
                                       A
                                    
                                    
                                       ρ
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 p
                                 ,
                              
                           
                        
                        
                           
                              (15b)
                              
                                 
                                    
                                       Λ
                                    
                                    
                                       ̇
                                    
                                 
                                 =
                                 skew
                                 [
                                 
                                    
                                       i
                                    
                                    
                                       ρ
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 π
                                 ]
                                 Λ
                                 ,
                              
                           
                        
                        
                           
                              (15c)
                              
                                 
                                    
                                       p
                                    
                                    
                                       ̇
                                    
                                 
                                 =
                                 n
                                 
                                    
                                       ,
                                    
                                    
                                       s
                                    
                                 
                                 +
                                 N
                                 ,
                              
                           
                        
                        
                           
                              (15d)
                              
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       ̇
                                    
                                 
                                 =
                                 
                                    
                                       m
                                    
                                    
                                       ˜
                                    
                                 
                                 
                                    
                                       ,
                                    
                                    
                                       s
                                    
                                 
                                 +
                                 
                                    
                                       φ
                                    
                                    
                                       ˜
                                    
                                 
                                 
                                    
                                       ,
                                    
                                    
                                       s
                                    
                                 
                                 
                                    
                                       n
                                    
                                    
                                       ˜
                                    
                                 
                                 −
                                 
                                    
                                       n
                                    
                                    
                                       ˜
                                    
                                 
                                 
                                    
                                       φ
                                    
                                    
                                       ˜
                                    
                                 
                                 
                                    
                                       ,
                                    
                                    
                                       s
                                    
                                 
                                 +
                                 
                                    
                                       M
                                    
                                    
                                       ˜
                                    
                                 
                                 .
                              
                           
                        Note that (15d) can be replaced by 
                           
                              
                                 π
                              
                              
                                 ̇
                              
                           
                           =
                           m
                           
                              
                                 ,
                              
                              
                                 s
                              
                           
                           +
                           φ
                           
                              
                                 ,
                              
                              
                                 s
                              
                           
                           ×
                           n
                           +
                           M
                        .


                        Conserved quantities: In virtue of Noether׳s theorem [50] there exist as many conserved quantities as symmetries of the Lagrangian. In the present case, the following conserved quantities are identified:
                           
                              (i)
                              The Lagrangian of system is autonomous and therefore, invariant under translations in time. This property yields to the conservation of energy which may easily verified by computing
                                    
                                       
                                          
                                             
                                                H
                                             
                                             
                                                ̇
                                             
                                          
                                          =
                                          0
                                          ,
                                       
                                    
                                 after considering (15a) to (15d).

The Lagrangian is invariant under rigid body translations and rotations in space. The conserved quantities associated to these symmetries are the total linear momentum, 
                                    
                                       
                                          L
                                       
                                       
                                          t
                                       
                                    
                                 , and total angular momentum, 
                                    
                                       
                                          J
                                       
                                       
                                          t
                                       
                                    
                                 , which are given by
                                    
                                       (16)
                                       
                                          
                                             
                                                L
                                             
                                             
                                                t
                                             
                                          
                                          =
                                          
                                             
                                                ∫
                                             
                                             
                                                0
                                             
                                             
                                                L
                                             
                                          
                                          p
                                          
                                          ds
                                          
                                          and
                                          
                                          
                                             
                                                J
                                             
                                             
                                                t
                                             
                                          
                                          =
                                          
                                             
                                                ∫
                                             
                                             
                                                0
                                             
                                             
                                                L
                                             
                                          
                                          (
                                          
                                             φ
                                             ×
                                             p
                                             +
                                             π
                                          
                                          )
                                          
                                          ds
                                          .
                                       
                                    
                                 The above quantities are conserved by the dynamics if the external loading is self-equilibrated and the prescribed boundary conditions are of the Neumann type [51,49,67,66].

In this section a second-order accurate time integrator for finite element discretizations of geometrically exact rods is formulated. We follow a standard methodology in variational integration to construct algorithms that automatically enjoy a number of remarkable properties: (i) they are symplectic, (ii) they exactly preserve the momenta associated to symmetries of the discrete Lagrangian, (iii) they show an excellent long term energy stability, and (iv) they preserve the geometric structure of the configuration manifold of the problem [43,44,51,52].

The discretization in space of the continuum problem is carried out with the help of the finite element method. We consider a partition 
                           
                              
                                 T
                              
                              
                                 h
                              
                           
                         of the domain 
                           [
                           0
                           ,
                           L
                           ]
                         in 
                           
                              
                                 N
                              
                              
                                 e
                              
                           
                         non-overlapping elements. The resulting mesh is characterized by the length h of the largest finite element. On each element, 
                           
                              
                                 I
                              
                              
                                 e
                              
                           
                        , a local one-dimensional finite element space 
                           
                              
                                 P
                              
                              
                                 m
                              
                           
                           (
                           
                              
                                 I
                              
                              
                                 e
                              
                           
                           )
                         of polynomial functions of degree 
                           m
                           ≥
                           0
                         is defined.

The basic idea consist in approximating 
                           Q
                         by means of a finite-dimensional subspace 
                           
                              
                                 Q
                              
                              
                                 h
                              
                           
                         composed by elements of the form 
                           (
                           
                              
                                 φ
                              
                              
                                 h
                              
                           
                           ,
                           
                              
                                 Λ
                              
                              
                                 h
                              
                           
                           )
                         which are finite-dimensional approximations to 
                           (
                           φ
                           ,
                           Λ
                           )
                        . In following, calculations are performed on the basis of a generic finite element 
                           
                              
                                 I
                              
                              
                                 e
                              
                           
                        .
                           
                              (i)
                              We consider first the translational part of the motion. Then, 
                                    
                                       
                                          φ
                                       
                                       
                                          h
                                       
                                    
                                    :
                                    
                                       
                                          I
                                       
                                       
                                          e
                                       
                                    
                                    →
                                    
                                       
                                          R
                                       
                                       
                                          3
                                       
                                    
                                  is given by
                                    
                                       (17)
                                       
                                          
                                             
                                                φ
                                             
                                             
                                                h
                                             
                                          
                                          (
                                          s
                                          )
                                          =
                                          
                                             
                                                ∑
                                             
                                             
                                                a
                                                =
                                                1
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      d
                                                   
                                                
                                             
                                          
                                          
                                             
                                                N
                                             
                                             
                                                a
                                             
                                          
                                          (
                                          s
                                          )
                                          
                                             
                                                φ
                                             
                                             
                                                a
                                             
                                          
                                          ,
                                          
                                          s
                                          ∈
                                          
                                             
                                                I
                                             
                                             
                                                e
                                             
                                          
                                          ,
                                       
                                    
                                 where 
                                    
                                       
                                          φ
                                       
                                       
                                          a
                                       
                                    
                                    =
                                    (
                                    
                                       
                                          φ
                                       
                                       
                                          a
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          φ
                                       
                                       
                                          a
                                       
                                       
                                          3
                                       
                                    
                                    )
                                  is the position vector of the node a and 
                                    
                                       
                                          {
                                          
                                             
                                                N
                                             
                                             
                                                a
                                             
                                          
                                          }
                                       
                                       
                                          a
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                d
                                             
                                          
                                       
                                    
                                  is a set of Lagrangian basis functions for 
                                    
                                       
                                          P
                                       
                                       
                                          m
                                       
                                    
                                    (
                                    
                                       
                                          I
                                       
                                       
                                          e
                                       
                                    
                                    )
                                  
                                 [30].

It is worth noting that 
                                    
                                       
                                          φ
                                       
                                       
                                          h
                                       
                                    
                                    (
                                    s
                                    )
                                  belongs to 
                                    
                                       
                                          R
                                       
                                       
                                          3
                                       
                                    
                                  for any value of 
                                    s
                                    ∈
                                    
                                       
                                          I
                                       
                                       
                                          e
                                       
                                    
                                  since the nodal values 
                                    
                                       
                                          φ
                                       
                                       
                                          a
                                       
                                    
                                  also belongs 
                                    
                                       
                                          R
                                       
                                       
                                          3
                                       
                                    
                                 . This is always the case when we are interpolating nodal variables that belong to a linear space. For example, if we know the nodal values of any skew-symmetric tensor, 
                                    
                                       
                                          
                                             
                                                w
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          a
                                       
                                    
                                    ∈
                                    SO
                                    (
                                    3
                                    )
                                 , such as the angular velocity or the curvature, we can construct 
                                    
                                       
                                          
                                             
                                                w
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          h
                                       
                                    
                                    :
                                    
                                       
                                          I
                                       
                                       
                                          e
                                       
                                    
                                    →
                                    SO
                                    (
                                    3
                                    )
                                  as
                                    
                                       (18)
                                       
                                          
                                             
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                h
                                             
                                          
                                          (
                                          s
                                          )
                                          =
                                          
                                             
                                                ∑
                                             
                                             
                                                a
                                                =
                                                1
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      d
                                                   
                                                
                                             
                                          
                                          
                                             
                                                N
                                             
                                             
                                                a
                                             
                                          
                                          (
                                          s
                                          )
                                          
                                             
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                a
                                             
                                          
                                          ,
                                          
                                          s
                                          ∈
                                          
                                             
                                                I
                                             
                                             
                                                e
                                             
                                          
                                          .
                                       
                                    
                                 In the general case, if the nodal variables do not belongs to a linear space, the above interpolation yields to approximations which do not belong to the same space as the nodal variables. This is the case with the rotational part of the motion as we explain below.

Since the rotation group is a non-linear manifold rather than a linear space, (17) cannot be applied. Therefore, in general, we have that
                                    
                                       (19)
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                a
                                                =
                                                1
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      d
                                                   
                                                
                                             
                                          
                                          
                                             
                                                N
                                             
                                             
                                                a
                                             
                                          
                                          (
                                          s
                                          )
                                          
                                             
                                                Λ
                                             
                                             
                                                a
                                             
                                          
                                          ∉
                                          SO
                                          (
                                          3
                                          )
                                          ,
                                          
                                          s
                                          ∈
                                          
                                             
                                                I
                                             
                                             
                                                e
                                             
                                          
                                          .
                                       
                                    
                                 To construct a geometrically consistent approximation for 
                                    
                                       
                                          Λ
                                       
                                       
                                          h
                                       
                                    
                                    :
                                    
                                       
                                          I
                                       
                                       
                                          e
                                       
                                    
                                    →
                                    SO
                                    (
                                    3
                                    )
                                  we do not apply the classical Rodrigues׳s formula for the exponential map [15] since this operation does not provide a representation free of singularities for arbitrary rotations. Instead, we adopt the following procedure proposed in [63]:
                                    
                                       •
                                       We consider a representation of the nodal values of the rotation tensors in terms of unit quaternions.
                                             5
                                          
                                          
                                             5
                                             Theoretical aspect about unit quaternions can be consulted e.g. in [58,15].
                                           This representation is unique for arbitrary rotations. The nodal values of the unit quaternions 
                                             
                                                
                                                   {
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         a
                                                      
                                                   
                                                   }
                                                
                                                
                                                   a
                                                   =
                                                   1
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                
                                             
                                           are obtained from 
                                             
                                                
                                                   {
                                                   
                                                      
                                                         Λ
                                                      
                                                      
                                                         a
                                                      
                                                   
                                                   }
                                                
                                                
                                                   a
                                                   =
                                                   1
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                
                                             
                                           by means of applying the well known Spurrier׳s algorithm 
                                          [74].

The nodal values of the rotation vectors 
                                             
                                                
                                                   {
                                                   
                                                      
                                                         Φ
                                                      
                                                      
                                                         a
                                                      
                                                   
                                                   }
                                                
                                                
                                                   a
                                                   =
                                                   1
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                
                                             
                                           are extracted from 
                                             
                                                
                                                   {
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         a
                                                      
                                                   
                                                   }
                                                
                                                
                                                   a
                                                   =
                                                   1
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                
                                             
                                           with the help of the procedure given in [69].

Since rotation vectors belong to a linear space, 
                                             
                                                
                                                   Φ
                                                
                                                
                                                   h
                                                
                                             
                                             (
                                             s
                                             )
                                           can be obtained by applying (17). Then, 
                                             
                                                
                                                   q
                                                
                                                
                                                   h
                                                
                                             
                                             (
                                             s
                                             )
                                           is computed following standard procedures (see e.g. [15, Chapter XVI]).

Finally, 
                                             
                                                
                                                   Λ
                                                
                                                
                                                   h
                                                
                                             
                                             (
                                             s
                                             )
                                           is obtained from 
                                             
                                                
                                                   q
                                                
                                                
                                                   h
                                                
                                             
                                             (
                                             s
                                             )
                                           by applying the classical relation between rotation tensors and quaternions.

The construction of a semi-discrete counterpart of the Lagrangian functional (10) is build on the introduction of the FE interpolation of the (time-dependent) configuration variables 
                           (
                           
                              
                                 φ
                              
                              
                                 h
                              
                           
                           (
                           t
                           )
                           ,
                           
                              
                                 Λ
                              
                              
                                 h
                              
                           
                           (
                           t
                           )
                           )
                         in (7), (9a) and (9b) along with specifying appropriate quadrature rules to compute the corresponding volume integrals. Then, the semi-discrete kinetic energy 
                           
                              
                                 K
                              
                              
                                 h
                              
                           
                           :
                           T
                           
                              
                                 Q
                              
                              
                                 h
                              
                           
                           ×
                           R
                           →
                           R
                         and the internal and external components of the potential energy 
                           
                              
                                 U
                              
                              
                                 int
                              
                           
                           ,
                           
                              
                                 U
                              
                              
                                 ext
                              
                           
                           :
                           
                              
                                 Q
                              
                              
                                 h
                              
                           
                           ×
                           R
                           →
                           R
                         are given by
                           
                              (21a)
                              
                                 
                                    
                                       K
                                    
                                    
                                       h
                                    
                                 
                                 (
                                 
                                    
                                       Φ
                                    
                                    
                                       h
                                    
                                 
                                 (
                                 t
                                 )
                                 ,
                                 
                                    
                                       
                                          
                                             Φ
                                          
                                          
                                             ̇
                                          
                                       
                                    
                                    
                                       h
                                    
                                 
                                 (
                                 t
                                 )
                                 )
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             l
                                          
                                       
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 
                                    
                                       
                                          A
                                       
                                       
                                          ρ
                                       
                                    
                                    
                                       
                                          ∥
                                          
                                             
                                                
                                                   
                                                      
                                                         φ
                                                      
                                                      
                                                         ̇
                                                      
                                                   
                                                
                                                
                                                   h
                                                
                                             
                                             (
                                             
                                                
                                                   ξ
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             t
                                             )
                                          
                                          ∥
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    Tr
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   V
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             h
                                          
                                       
                                       (
                                       
                                          
                                             ξ
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       t
                                       )
                                       
                                          
                                             E
                                          
                                          
                                             ρ
                                          
                                       
                                       
                                          
                                             
                                                
                                                   V
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             h
                                          
                                       
                                       (
                                       
                                          
                                             ξ
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       t
                                       )
                                    
                                    ]
                                 
                                 )
                                 ,
                              
                           
                        
                        
                           
                              (21b)
                              
                                 
                                    
                                       U
                                    
                                    
                                       h
                                    
                                    
                                       int
                                    
                                 
                                 (
                                 
                                    
                                       Φ
                                    
                                    
                                       h
                                    
                                 
                                 ,
                                 t
                                 )
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             g
                                          
                                       
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                 
                                 ψ
                                 (
                                 
                                    
                                       
                                          Γ
                                       
                                       
                                          h
                                       
                                    
                                    (
                                    
                                       
                                          ξ
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    t
                                    )
                                    ,
                                    
                                       
                                          Ω
                                       
                                       
                                          h
                                       
                                    
                                    (
                                    
                                       
                                          ξ
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    t
                                    )
                                 
                                 )
                                 ,
                              
                           
                        
                        
                           
                              (21c)
                              
                                 
                                    
                                       U
                                    
                                    
                                       h
                                    
                                    
                                       ext
                                    
                                 
                                 (
                                 
                                    
                                       Φ
                                    
                                    
                                       h
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             g
                                          
                                       
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       ext
                                    
                                 
                                 (
                                 
                                    
                                       
                                          φ
                                       
                                       
                                          h
                                       
                                    
                                    (
                                    
                                       
                                          ξ
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    ,
                                    
                                       
                                          Λ
                                       
                                       
                                          h
                                       
                                    
                                    (
                                    
                                       
                                          ξ
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 )
                                 ,
                              
                           
                        where 
                           
                              
                                 {
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       ξ
                                    
                                    
                                       i
                                    
                                 
                                 }
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 
                                    
                                       N
                                    
                                    
                                       l
                                    
                                 
                              
                           
                        , 
                           
                              
                                 {
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       ξ
                                    
                                    
                                       i
                                    
                                 
                                 }
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 
                                    
                                       N
                                    
                                    
                                       g
                                    
                                 
                              
                           
                         are quadrature points and weights over 
                           [
                           0
                           ,
                           L
                           ]
                        , 
                           
                              
                                 Γ
                              
                              
                                 h
                              
                           
                           (
                           
                              
                                 ξ
                              
                              
                                 i
                              
                           
                           )
                           =
                           
                              
                                 Λ
                              
                              
                                 h
                              
                              
                                 t
                              
                           
                           (
                           
                              
                                 ξ
                              
                              
                                 i
                              
                           
                           )
                           
                              
                                 φ
                              
                              
                                 h
                              
                           
                           ,
                           
                              
                                 (
                                 
                                    
                                       ξ
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              
                              
                              
                              
                                 s
                              
                              
                           
                           −
                           
                              
                                 E
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 
                                    
                                       Ω
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 h
                              
                           
                           (
                           
                              
                                 ξ
                              
                              
                                 i
                              
                           
                           )
                           =
                           
                              
                                 Λ
                              
                              
                                 h
                              
                              
                                 t
                              
                           
                           (
                           
                              
                                 ξ
                              
                              
                                 i
                              
                           
                           )
                           
                              
                                 Λ
                              
                              
                                 h
                              
                           
                           ,
                           
                              
                                 (
                                 
                                    
                                       ξ
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              
                              
                              
                              
                                 s
                              
                              
                           
                        . The semi-discrete Lagrangian is then constructed as 
                           
                              
                                 L
                              
                              
                                 h
                              
                           
                           =
                           
                              
                                 K
                              
                              
                                 h
                              
                           
                           −
                           
                              
                                 U
                              
                              
                                 h
                              
                           
                         and the application of Hamilton׳s principle allows to obtain the corresponding EL equations on the nodes of the mesh.

The values of the (semi-discrete) nodal momenta are computed with the help of the Legendre transform as
                           
                              (22a)
                              
                                 
                                    
                                       p
                                    
                                    
                                       a
                                    
                                 
                                 (
                                 t
                                 )
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       b
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             d
                                          
                                       
                                    
                                 
                                 
                                    
                                       m
                                    
                                    
                                       ab
                                    
                                 
                                 
                                    
                                       
                                          
                                             φ
                                          
                                          
                                             ̇
                                          
                                       
                                    
                                    
                                       b
                                    
                                 
                                 (
                                 t
                                 )
                                 ,
                              
                           
                        
                        
                           
                              (22b)
                              
                                 
                                    
                                       
                                          
                                             Π
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       a
                                    
                                 
                                 (
                                 t
                                 )
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             l
                                          
                                       
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       a
                                    
                                 
                                 (
                                 
                                    
                                       ξ
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 
                                 skew
                                 [
                                 
                                    
                                       
                                          I
                                       
                                       
                                          ρ
                                       
                                    
                                    (
                                    
                                       
                                          ξ
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    
                                       
                                          V
                                       
                                       
                                          h
                                       
                                    
                                    (
                                    
                                       
                                          ξ
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    t
                                    )
                                 
                                 ]
                                 ,
                                 
                                 a
                                 ∈
                                 {
                                 1
                                 ,
                                 …
                                 ,
                                 
                                    
                                       n
                                    
                                    
                                       d
                                    
                                 
                                 }
                                 ,
                              
                           
                        where 
                           m
                         is given in 51b, 
                           
                              
                                 I
                              
                              
                                 ρ
                              
                           
                         is the material form of 
                           
                              
                                 i
                              
                              
                                 ρ
                              
                           
                         and 
                           
                              
                                 V
                              
                              
                                 h
                              
                           
                         the FE interpolation of the material form of the angular velocity vector. Semi-discrete counterpart of Hamilton׳s Eqs. (15a)–(15d) can also be deduced.

The time interval 
                           [
                           0
                           ,
                           T
                           ]
                         is partitioned into 
                           N
                           >
                           1
                         subintervals with constant time step 
                           Δ
                           t
                           =
                           T
                           /
                           N
                        , and we set 
                           
                              
                                 t
                              
                              
                                 k
                              
                           
                           =
                           kT
                           /
                           N
                        , 
                           k
                           =
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           N
                        . We denote by
                           
                              (23)
                              
                                 (
                                 
                                    
                                       φ
                                    
                                    
                                       a
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                    
                                       Λ
                                    
                                    
                                       a
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 ,
                                 
                                 a
                                 ∈
                                 {
                                 1
                                 ,
                                 …
                                 ,
                                 
                                    
                                       n
                                    
                                    
                                       t
                                    
                                 
                                 }
                                 ,
                              
                           
                        the approximation of the nodal values of the configuration variables, 
                           (
                           
                              
                                 φ
                              
                              
                                 a
                              
                           
                           (
                           
                              
                                 t
                              
                              
                                 k
                              
                           
                           )
                           ,
                           
                              
                                 Λ
                              
                              
                                 a
                              
                              
                                 k
                              
                           
                           (
                           
                              
                                 t
                              
                              
                                 k
                              
                           
                           )
                           )
                        , and the procedures described in Section 3.1 are used to compute 
                           (
                           
                              
                                 φ
                              
                              
                                 h
                              
                              
                                 k
                              
                           
                           (
                           s
                           )
                           ,
                           
                              
                                 Λ
                              
                              
                                 h
                              
                              
                                 k
                              
                           
                           (
                           s
                           )
                           )
                         as the approximation to 
                           (
                           
                              
                                 φ
                              
                              
                                 h
                              
                           
                           (
                           s
                           ,
                           
                              
                                 t
                              
                              
                                 k
                              
                           
                           )
                           ,
                           
                              
                                 Λ
                              
                              
                                 h
                              
                           
                           (
                           s
                           ,
                           
                              
                                 t
                              
                              
                                 k
                              
                           
                           )
                           )
                         for all 
                           s
                           ∈
                           
                              
                                 I
                              
                              
                                 e
                              
                           
                        , 
                           ∀
                           
                              
                                 I
                              
                              
                                 e
                              
                           
                           ⊂
                           
                              
                                 T
                              
                              
                                 h
                              
                           
                        .

The translational velocity is approximated by
                           
                              (24)
                              
                                 
                                    
                                       
                                          
                                             φ
                                          
                                          
                                             ̇
                                          
                                       
                                    
                                    
                                       h
                                    
                                 
                                 (
                                 s
                                 ,
                                 τ
                                 )
                                 ≈
                                 
                                    
                                       
                                          
                                             φ
                                          
                                          
                                             h
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                       
                                       (
                                       s
                                       )
                                       −
                                       
                                          
                                             φ
                                          
                                          
                                             h
                                          
                                          
                                             k
                                          
                                       
                                       (
                                       s
                                       )
                                    
                                    
                                       Δ
                                       t
                                    
                                 
                                 ,
                                 
                                 (
                                 s
                                 ,
                                 τ
                                 )
                                 ∈
                                 
                                    
                                       I
                                    
                                    
                                       e
                                    
                                 
                                 ×
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       k
                                       +
                                       a
                                    
                                 
                                 )
                                 ,
                              
                           
                        and time derivative of the rotational tensor by
                           
                              (25)
                              
                                 
                                    
                                       Λ
                                    
                                    
                                       h
                                    
                                 
                                 (
                                 s
                                 ,
                                 τ
                                 )
                                 ≈
                                 
                                    
                                       
                                          
                                             Λ
                                          
                                          
                                             h
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                       
                                       (
                                       s
                                       )
                                       −
                                       
                                          
                                             Λ
                                          
                                          
                                             h
                                          
                                          
                                             k
                                          
                                       
                                       (
                                       s
                                       )
                                    
                                    
                                       Δ
                                       t
                                    
                                 
                                 ,
                                 
                                 (
                                 s
                                 ,
                                 τ
                                 )
                                 ∈
                                 
                                    
                                       I
                                    
                                    
                                       e
                                    
                                 
                                 ×
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       k
                                       +
                                       a
                                    
                                 
                                 )
                                 .
                              
                           
                        Approximations (24) and (25), which are discontinuous across time interval boundaries, can be obtained following the standard methodology to construct Galerkin variational integrators (see e.g. [36,41,51,52]). Moreover, higher order methods can be systematically formulated by means of combining higher degree polynomials with higher order quadrature rules to compute the discrete Lagrangian. A complete analysis of Galerkin VI׳s and their relation with Runge–Kutta time integrators can be found in [43,79]. In [54] a fourth-order method for thermo-elastic problems is presented and the formulation of methods for dynamical problems evolving on Lie-group manifolds can be consulted in [41].


                        Discrete Lagrangian and discrete action sum: The fully discrete (in space and time) counterpart of the kinetics energy, 
                           
                              
                                 K
                              
                              
                                 d
                              
                           
                           :
                           
                              
                                 Q
                              
                              
                                 h
                              
                           
                           ×
                           
                              
                                 Q
                              
                              
                                 h
                              
                           
                           →
                           R
                        , is obtained by replacing 
                           
                              
                                 
                                    
                                       φ
                                    
                                    
                                       ̇
                                    
                                 
                              
                              
                                 h
                              
                           
                         by (24) and 
                           
                              
                                 
                                    
                                       Λ
                                    
                                    
                                       ̇
                                    
                                 
                              
                              
                                 h
                              
                           
                         by (25) in (21a) to obtain
                           
                              (26)
                              
                                 
                                    
                                       K
                                    
                                    
                                       d
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                       
                                          
                                             (
                                             Δ
                                             t
                                             )
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             l
                                          
                                       
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 
                                    
                                       
                                          A
                                       
                                       
                                          ρ
                                       
                                    
                                    ∥
                                    
                                       
                                          φ
                                       
                                       
                                          h
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          ξ
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    −
                                    
                                       
                                          φ
                                       
                                       
                                          h
                                       
                                       
                                          k
                                       
                                    
                                    (
                                    
                                       
                                          ξ
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    
                                       
                                          ∥
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    2
                                    
                                    Tr
                                    [
                                    
                                       (
                                       
                                          I
                                          −
                                          
                                             
                                                Λ
                                             
                                             
                                                h
                                             
                                             
                                                (
                                                k
                                                )
                                                t
                                             
                                          
                                          (
                                          
                                             
                                                ξ
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          
                                             
                                                Λ
                                             
                                             
                                                h
                                             
                                             
                                                n
                                                +
                                                1
                                             
                                          
                                          (
                                          
                                             
                                                ξ
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                       )
                                       
                                          
                                             E
                                          
                                          
                                             ρ
                                          
                                       
                                    
                                    ]
                                 
                                 )
                                 .
                              
                           
                        Correspondingly, the discrete potential energy, 
                           
                              
                                 U
                              
                              
                                 d
                              
                           
                           :
                           
                              
                                 Q
                              
                              
                                 h
                              
                           
                           →
                           R
                        , is given by
                           
                              (27)
                              
                                 
                                    
                                       U
                                    
                                    
                                       d
                                    
                                 
                                 =
                                 
                                    
                                       U
                                    
                                    
                                       d
                                    
                                    
                                       int
                                    
                                 
                                 +
                                 
                                    
                                       U
                                    
                                    
                                       d
                                    
                                    
                                       ext
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             g
                                          
                                       
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 
                                    ψ
                                    (
                                    
                                       
                                          
                                             Γ
                                          
                                          
                                             h
                                          
                                          
                                             k
                                          
                                       
                                       (
                                       
                                          
                                             ξ
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       ,
                                       
                                          
                                             
                                                
                                                   Ω
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             h
                                          
                                          
                                             k
                                          
                                       
                                       (
                                       
                                          
                                             ξ
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    )
                                    −
                                    
                                       
                                          w
                                       
                                       
                                          ext
                                       
                                    
                                    (
                                    
                                       
                                          
                                             φ
                                          
                                          
                                             h
                                          
                                          
                                             k
                                          
                                       
                                       (
                                       
                                          
                                             ξ
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       ,
                                       
                                          
                                             Λ
                                          
                                          
                                             h
                                          
                                          
                                             k
                                          
                                       
                                       (
                                       
                                          
                                             ξ
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    )
                                 
                                 )
                                 .
                              
                           
                        
                     

Moreover, we consider the scalar 
                           α
                           ∈
                           [
                           0
                           ,
                           1
                           ]
                         and apply the so-called generalized trapezoidal rule 
                        [52] to construct a discrete Lagrangian,
                           
                              (28)
                              
                                 
                                    
                                       L
                                    
                                    
                                       d
                                    
                                    
                                       α
                                    
                                 
                                 (
                                 
                                    
                                       Φ
                                    
                                    
                                       h
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       Φ
                                    
                                    
                                       h
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 =
                                 Δ
                                 t
                                 (
                                 
                                    
                                       
                                          K
                                       
                                       
                                          d
                                       
                                    
                                    (
                                    
                                       
                                          Φ
                                       
                                       
                                          h
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          Φ
                                       
                                       
                                          h
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    −
                                    α
                                    
                                       
                                          U
                                       
                                       
                                          d
                                       
                                    
                                    (
                                    
                                       
                                          Φ
                                       
                                       
                                          h
                                       
                                       
                                          0
                                       
                                    
                                    )
                                    −
                                    (
                                    1
                                    −
                                    α
                                    )
                                    
                                       
                                          U
                                       
                                       
                                          d
                                       
                                    
                                    (
                                    
                                       
                                          Φ
                                       
                                       
                                          h
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                                 )
                                 ,
                              
                           
                        which is an approximation to the action functional on the time interval 
                           [
                           
                              
                                 t
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 1
                              
                           
                           ]
                        .
                           Remark
                           It is worth noting that 
                                 
                                    
                                       L
                                    
                                    
                                       d
                                    
                                    
                                       1
                                       /
                                       2
                                    
                                 
                               is equivalent to the discrete Lagrangian obtained by means of using a two-point Gauss–Lobbato quadrature rule in time to approximate 
                                 
                                    
                                       
                                          
                                             ∫
                                          
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   0
                                                
                                             
                                          
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             h
                                          
                                       
                                       (
                                       
                                          
                                             Φ
                                          
                                          
                                             h
                                          
                                       
                                       (
                                       t
                                       )
                                       ,
                                       
                                          
                                             
                                                
                                                   Φ
                                                
                                                
                                                   ̇
                                                
                                             
                                          
                                          
                                             h
                                          
                                       
                                       (
                                       t
                                       )
                                       )
                                       
                                       dt
                                       .
                                    
                                 
                              The corresponding VI results to be a member of the standard Lobatto IIIA–IIIB symplectic-partitioned Runge–Kutta methods [52]. Moreover, it is possible to show that 
                                 
                                    
                                       L
                                    
                                    
                                       d
                                    
                                    
                                       1
                                       /
                                       2
                                    
                                 
                               is equivalent to the symmetric discrete Lagrangian 
                                 
                                    
                                       
                                          
                                             L
                                          
                                          
                                             d
                                          
                                          
                                             sym
                                          
                                       
                                       =
                                       
                                          
                                             Δ
                                             t
                                          
                                          
                                             2
                                          
                                       
                                       L
                                       (
                                       
                                          
                                             
                                                Φ
                                             
                                             
                                                h
                                             
                                             
                                                0
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   
                                                      Φ
                                                   
                                                   
                                                      h
                                                   
                                                   
                                                      1
                                                   
                                                
                                                −
                                                
                                                   
                                                      Φ
                                                   
                                                   
                                                      h
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                             
                                                Δ
                                                t
                                             
                                          
                                       
                                       )
                                       +
                                       
                                          
                                             Δ
                                             t
                                          
                                          
                                             2
                                          
                                       
                                       L
                                       (
                                       
                                          
                                             
                                                Φ
                                             
                                             
                                                h
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   
                                                      Φ
                                                   
                                                   
                                                      h
                                                   
                                                   
                                                      1
                                                   
                                                
                                                −
                                                
                                                   
                                                      Φ
                                                   
                                                   
                                                      h
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                             
                                                Δ
                                                t
                                             
                                          
                                       
                                       )
                                       ,
                                    
                                 
                              and therefore, according to [36, Theorem 3.1] the corresponding variational algorithm results to be a Lie group specialization of the classical Newmark׳s method with 
                                 β
                                 =
                                 0
                               and 
                                 γ
                                 =
                                 1
                                 /
                                 2
                               (also known as central differences). However, the resulting method is explicit only if appropriate quadrature rules are used to compute (26) and (27). Details are given below

The discrete action sum is given by
                           
                              (29)
                              
                                 
                                    
                                       S
                                    
                                    
                                       d
                                    
                                    
                                       α
                                    
                                 
                                 (
                                 
                                    
                                       Φ
                                    
                                    
                                       h
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       Φ
                                    
                                    
                                       h
                                    
                                    
                                       N
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       0
                                    
                                    
                                       N
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       L
                                    
                                    
                                       d
                                    
                                    
                                       α
                                    
                                 
                                 (
                                 
                                    
                                       Φ
                                    
                                    
                                       h
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                    
                                       Φ
                                    
                                    
                                       h
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 )
                                 ,
                              
                           
                        which is an approximation to (11).


                        Discrete Hamilton׳s principle and DEL equations: The discrete counterpart of Hamilton׳s principle states that the evolution equations extremize (29) given fixed end points, 
                           
                              
                                 {
                                 
                                    
                                       Φ
                                    
                                    
                                       a
                                    
                                    
                                       0
                                    
                                 
                                 }
                              
                              
                                 a
                                 =
                                 1
                              
                              
                                 
                                    
                                       N
                                    
                                    
                                       t
                                    
                                 
                              
                           
                         and 
                           
                              
                                 {
                                 
                                    
                                       Φ
                                    
                                    
                                       a
                                    
                                    
                                       N
                                    
                                 
                                 }
                              
                              
                                 a
                                 =
                                 1
                              
                              
                                 
                                    
                                       N
                                    
                                    
                                       t
                                    
                                 
                              
                           
                        . Extremizing the action sum is equivalent to enforcing
                           
                              (30)
                              
                                 δ
                                 
                                    
                                       S
                                    
                                    
                                       d
                                    
                                    
                                       α
                                    
                                 
                                 (
                                 
                                    
                                       Φ
                                    
                                    
                                       h
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       Φ
                                    
                                    
                                       h
                                    
                                    
                                       N
                                    
                                 
                                 )
                                 =
                                 0
                                 ,
                              
                           
                        for arbitrary variations on the nodal values of the configuration variables 
                           
                              
                                 {
                                 
                                    
                                       Φ
                                    
                                    
                                       a
                                    
                                    
                                       k
                                    
                                 
                                 }
                              
                              
                                 a
                                 =
                                 1
                              
                              
                                 
                                    
                                       N
                                    
                                    
                                       t
                                    
                                 
                              
                           
                         and 
                           k
                           ∈
                           {
                           0
                           ,
                           ‥
                           ,
                           N
                           }
                        . Details are given in the accompanying appendix (Section A.2).

Hamilton׳s principle yields the discrete Euler–Lagrange equations (DEL):
                           
                              (31a)
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       b
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             d
                                          
                                       
                                    
                                 
                                 
                                    
                                       m
                                    
                                    
                                       ab
                                    
                                 
                                 
                                    
                                       (
                                       
                                          
                                             φ
                                          
                                          
                                             b
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                       
                                       −
                                       2
                                       
                                          
                                             φ
                                          
                                          
                                             b
                                          
                                          
                                             k
                                          
                                       
                                       −
                                       
                                          
                                             φ
                                          
                                          
                                             b
                                          
                                          
                                             k
                                             −
                                             1
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             (
                                             Δ
                                             t
                                             )
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       s
                                    
                                    
                                       a
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 
                                    
                                       S
                                    
                                    
                                       a
                                    
                                    
                                       k
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (31b)
                              
                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             a
                                          
                                          
                                             (
                                             k
                                             )
                                             t
                                          
                                       
                                       −
                                       
                                          
                                             R
                                          
                                          
                                             a
                                          
                                          
                                             (
                                             k
                                             −
                                             1
                                             )
                                             t
                                          
                                       
                                       −
                                       
                                          
                                             R
                                          
                                          
                                             a
                                          
                                          
                                             k
                                          
                                       
                                       +
                                       
                                          
                                             R
                                          
                                          
                                             a
                                          
                                          
                                             (
                                             k
                                             −
                                             1
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             (
                                             Δ
                                             t
                                             )
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             h
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       a
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             H
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       a
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                 a
                                 ∈
                                 {
                                 1
                                 ,
                                 …
                                 ,
                                 
                                    
                                       n
                                    
                                    
                                       d
                                    
                                 
                                 }
                                 ,
                              
                           
                        where 
                           m
                        , 
                           
                              
                                 s
                              
                              
                                 a
                              
                              
                                 k
                              
                           
                         and 
                           
                              
                                 S
                              
                              
                                 a
                              
                              
                                 k
                              
                           
                         are the mass matrix, the nodal value of the internal force vector and the nodal value of the externally applied force vector. Moreover, 
                           
                              
                                 R
                              
                              
                                 a
                              
                              
                                 k
                              
                           
                        , 
                           
                              
                                 
                                    
                                       h
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 a
                              
                              
                                 k
                              
                           
                         and 
                           
                              
                                 
                                    
                                       H
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 a
                              
                              
                                 k
                              
                           
                         are the nodal values of the rotational inertia, the internal moment tensor and the externally applied moment tensor, respectively. Explicit expressions 
                           m
                        , 
                           
                              
                                 s
                              
                              
                                 a
                              
                              
                                 k
                              
                           
                        , 
                           
                              
                                 S
                              
                              
                                 a
                              
                              
                                 k
                              
                           
                        , 
                           
                              
                                 R
                              
                              
                                 a
                              
                              
                                 k
                              
                           
                        , 
                           
                              
                                 
                                    
                                       h
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 a
                              
                              
                                 k
                              
                           
                         and 
                           
                              
                                 
                                    
                                       H
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 a
                              
                              
                                 k
                              
                           
                         are given in Appendix A.

Eqs. (31a) and (31b) (which do not depend on α) may be interpreted as the balance of translational forces and moments on each node of the mesh, respectively. They in fact provide a method to compute 
                           
                              
                                 Φ
                              
                              
                                 a
                              
                              
                                 k
                                 +
                                 1
                              
                           
                         (
                           ∀
                           a
                        ) if we know 
                           
                              
                                 Φ
                              
                              
                                 a
                              
                              
                                 k
                              
                           
                         and 
                           
                              
                                 Φ
                              
                              
                                 a
                              
                              
                                 k
                                 −
                                 1
                              
                           
                        . If the body is subjected to non-conservative forces and moments, Lagrange–D׳Alembert principle can be used in deriving the modified DEL equations (see e.g. [36]).


                        Discrete Legendre transformations: Initial conditions are often given in terms of positions and momenta rather than in terms of two positions as required in (31a) and (31b). However, it is possible to rewrite the integrator in position-momentum form taking advantage of the discrete Legendre transform [43,44,52].

On one hand, we compute the translational momenta as follows:
                           
                              (32a)
                              
                                 
                                    
                                       p
                                    
                                    
                                       a
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 −
                                 
                                    
                                       ∇
                                    
                                    
                                       
                                          
                                             φ
                                          
                                          
                                             a
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 
                                    
                                       L
                                    
                                    
                                       d
                                    
                                    
                                       α
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       b
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             d
                                          
                                       
                                    
                                 
                                 
                                    
                                       m
                                    
                                    
                                       ab
                                    
                                 
                                 
                                    
                                       
                                          
                                             φ
                                          
                                          
                                             b
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             φ
                                          
                                          
                                             b
                                          
                                          
                                             k
                                          
                                       
                                    
                                    
                                       Δ
                                       t
                                    
                                 
                                 +
                                 α
                                 Δ
                                 t
                                 (
                                 
                                    
                                       
                                          s
                                       
                                       
                                          a
                                       
                                       
                                          k
                                       
                                    
                                    +
                                    
                                       
                                          S
                                       
                                       
                                          a
                                       
                                       
                                          k
                                       
                                    
                                 
                                 )
                                 ,
                              
                           
                        
                        
                           
                              (32b)
                              
                                 
                                    
                                       p
                                    
                                    
                                       a
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       ∇
                                    
                                    
                                       
                                          
                                             φ
                                          
                                          
                                             a
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                       
                                    
                                 
                                 
                                    
                                       L
                                    
                                    
                                       d
                                    
                                    
                                       α
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       b
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             d
                                          
                                       
                                    
                                 
                                 
                                    
                                       m
                                    
                                    
                                       ab
                                    
                                 
                                 
                                    
                                       
                                          
                                             φ
                                          
                                          
                                             a
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             φ
                                          
                                          
                                             a
                                          
                                          
                                             k
                                          
                                       
                                    
                                    
                                       Δ
                                       t
                                    
                                 
                                 −
                                 (
                                 1
                                 −
                                 α
                                 )
                                 Δ
                                 t
                                 (
                                 
                                    
                                       
                                          s
                                       
                                       
                                          a
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          S
                                       
                                       
                                          a
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                 
                                 )
                                 ,
                              
                           
                        for all 
                           a
                           ∈
                           {
                           1
                           ,
                           …
                           ,
                           
                              
                                 n
                              
                              
                                 d
                              
                           
                           }
                        .

For the rotational part the following relation holds: 
                           
                              
                                 Tr
                                 [
                                 
                                    δ
                                    
                                       
                                          
                                             
                                                θ
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          a
                                       
                                       
                                          k
                                       
                                    
                                    (
                                    −
                                    
                                       
                                          D
                                       
                                       
                                          
                                             
                                                V
                                             
                                             
                                                a
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                    
                                       
                                          L
                                       
                                       
                                          d
                                       
                                       
                                          α
                                       
                                    
                                    )
                                 
                                 ]
                                 =
                                 Tr
                                 [
                                 
                                    δ
                                    
                                       
                                          
                                             
                                                θ
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          a
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          π
                                       
                                       
                                          a
                                       
                                       
                                          k
                                       
                                    
                                 
                                 ]
                                 ,
                              
                           
                        with 
                           
                              
                                 
                                    
                                       π
                                    
                                    
                                       a
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 −
                                 
                                    
                                       D
                                    
                                    
                                       
                                          
                                             V
                                          
                                          
                                             a
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 
                                    
                                       L
                                    
                                    
                                       d
                                    
                                    
                                       α
                                    
                                 
                                 =
                                 −
                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             a
                                          
                                          
                                             k
                                          
                                       
                                    
                                    
                                       Δ
                                       t
                                    
                                 
                                 −
                                 
                                    
                                       α
                                       Δ
                                       t
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             
                                                h
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          a
                                       
                                       
                                          k
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                H
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          a
                                       
                                       
                                          k
                                       
                                    
                                 
                                 )
                                 .
                              
                           
                        It is clear that (
                           
                              
                                 D
                              
                              
                                 
                                    
                                       V
                                    
                                    
                                       a
                                    
                                    
                                       k
                                    
                                 
                              
                           
                           
                              
                                 L
                              
                              
                                 d
                              
                              
                                 α
                              
                           
                           +
                           
                              
                                 π
                              
                              
                                 a
                              
                              
                                 k
                              
                           
                        ) has to be symmetric since 
                           δ
                           
                              
                                 
                                    
                                       θ
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 a
                              
                              
                                 k
                              
                           
                         is skew-symmetric and therefore, the nodal value of the rotational momentum 
                           
                              
                                 
                                    
                                       Π
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 a
                              
                              
                                 k
                              
                           
                         is given by
                           
                              (33a)
                              
                                 
                                    
                                       
                                          
                                             Π
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       a
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       π
                                    
                                    
                                       a
                                    
                                    
                                       k
                                    
                                 
                                 −
                                 
                                    
                                       π
                                    
                                    
                                       a
                                    
                                    
                                       (
                                       k
                                       )
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             a
                                          
                                          
                                             (
                                             k
                                             )
                                             t
                                          
                                       
                                       −
                                       
                                          
                                             R
                                          
                                          
                                             a
                                          
                                          
                                             k
                                          
                                       
                                    
                                    
                                       Δ
                                       t
                                    
                                 
                                 −
                                 α
                                 Δ
                                 t
                                 (
                                 
                                    
                                       
                                          
                                             
                                                h
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          a
                                       
                                       
                                          k
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                H
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          a
                                       
                                       
                                          k
                                       
                                    
                                 
                                 )
                                 ,
                              
                           
                        and 
                           
                              
                                 
                                    
                                       Π
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 a
                              
                              
                                 k
                                 +
                                 1
                              
                           
                         by
                           
                              (33b)
                              
                                 
                                    
                                       
                                          
                                             Π
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       a
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             a
                                          
                                          
                                             (
                                             k
                                             )
                                             t
                                          
                                       
                                       −
                                       
                                          
                                             R
                                          
                                          
                                             a
                                          
                                          
                                             k
                                          
                                       
                                    
                                    
                                       Δ
                                       t
                                    
                                 
                                 +
                                 (
                                 1
                                 −
                                 α
                                 )
                                 Δ
                                 t
                                 (
                                 
                                    
                                       
                                          
                                             
                                                h
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          a
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                H
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          a
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                 
                                 )
                                 .
                              
                           
                        Rearranging (32a) and (33a) allows to obtain the following updating scheme:
                           
                              (34a)
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       b
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             d
                                          
                                       
                                    
                                 
                                 
                                    
                                       m
                                    
                                    
                                       ab
                                    
                                 
                                 
                                    
                                       φ
                                    
                                    
                                       b
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       b
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             d
                                          
                                       
                                    
                                 
                                 
                                    
                                       m
                                    
                                    
                                       ab
                                    
                                 
                                 
                                    
                                       φ
                                    
                                    
                                       b
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 Δ
                                 t
                                 (
                                 
                                    
                                       
                                          p
                                       
                                       
                                          a
                                       
                                       
                                          k
                                       
                                    
                                    −
                                    α
                                    Δ
                                    t
                                    (
                                    
                                       
                                          
                                             s
                                          
                                          
                                             a
                                          
                                          
                                             k
                                          
                                       
                                       +
                                       
                                          
                                             S
                                          
                                          
                                             a
                                          
                                          
                                             k
                                          
                                       
                                    
                                    )
                                 
                                 )
                                 ,
                              
                           
                        
                        
                           
                              (34b)
                              
                                 
                                    
                                       R
                                    
                                    
                                       a
                                    
                                    
                                       (
                                       k
                                       )
                                       t
                                    
                                 
                                 −
                                 
                                    
                                       R
                                    
                                    
                                       a
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 Δ
                                 t
                                 (
                                 
                                    
                                       
                                          
                                             
                                                Π
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          a
                                       
                                       
                                          k
                                       
                                    
                                    +
                                    α
                                    Δ
                                    t
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             a
                                          
                                          
                                             k
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   H
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             a
                                          
                                          
                                             k
                                          
                                       
                                    
                                    )
                                 
                                 )
                              
                           
                        and subtracting (32a) from (32b) and (33a) from (33b), yields to the following relations:
                           
                              (35a)
                              
                                 
                                    
                                       p
                                    
                                    
                                       a
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       p
                                    
                                    
                                       a
                                    
                                    
                                       k
                                    
                                 
                                 −
                                 Δ
                                 t
                                 (
                                 
                                    
                                       
                                          s
                                       
                                       
                                          a
                                       
                                       
                                          k
                                          +
                                          α
                                       
                                    
                                    +
                                    
                                       
                                          S
                                       
                                       
                                          a
                                       
                                       
                                          k
                                          +
                                          α
                                       
                                    
                                 
                                 )
                                 ,
                              
                           
                        
                        
                           
                              (35b)
                              
                                 
                                    
                                       
                                          
                                             Π
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       a
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             Π
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       a
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 Δ
                                 t
                                 (
                                 
                                    
                                       
                                          
                                             
                                                h
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          a
                                       
                                       
                                          k
                                          +
                                          α
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                H
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          a
                                       
                                       
                                          k
                                          +
                                          α
                                       
                                    
                                 
                                 )
                                 ,
                              
                           
                        where 
                           
                              
                                 (
                                 •
                                 )
                              
                              
                                 a
                              
                              
                                 k
                                 +
                                 α
                              
                           
                           =
                           (
                           1
                           −
                           α
                           )
                           
                              
                                 (
                                 •
                                 )
                              
                              
                                 a
                              
                              
                                 k
                                 +
                                 1
                              
                           
                           +
                           α
                           
                              
                                 (
                                 •
                                 )
                              
                              
                                 a
                              
                              
                                 k
                              
                           
                        .

@&#IMPLEMENTATION@&#

The selection of specific quadrature rules to evaluate (21a)–(21c) has important implications on the accuracy and on the computational cost of the resulting implementation (see e.g. [12, Chapter 4] or [18,14]). For example, using a Gauss–Legendre quadrature rule to evaluate the kinetic energy yields to a non-diagonal mass matrix preventing the formulation of explicit methods. In this work, we use one-dimensional Gauss–Lobatto rules, with integration points located on the nodes of the element, to evaluate (21a). This choice allows the formulation of explicit methods and avoids computationally expensive tasks related to the iterative solution of large systems of nonlinear equations [9,33,62,70].

We select a Gauss–Lobatto quadrature rule to evaluate (26) and a Gauss–Legendre rule of the same order to evaluate (27). This selection yields to the following updating procedure for the nodal values of the configuration variables,
                           
                              •
                              The mass matrix (51b) becomes diagonal with entries 
                                    
                                       
                                          m
                                       
                                       
                                          aa
                                       
                                    
                                    =
                                    
                                       
                                          m
                                       
                                       
                                          a
                                       
                                    
                                    =
                                    
                                       
                                          w
                                       
                                       
                                          a
                                       
                                    
                                    
                                       
                                          A
                                       
                                       
                                          ρ
                                       
                                    
                                 . therefore, it is possible to update the nodal positions explicitly according to 
                                    
                                       (36)
                                       
                                          
                                             
                                                φ
                                             
                                             
                                                a
                                             
                                             
                                                k
                                                +
                                                1
                                             
                                          
                                          =
                                          
                                             
                                                φ
                                             
                                             
                                                a
                                             
                                             
                                                k
                                             
                                          
                                          +
                                          
                                             
                                                Δ
                                                t
                                             
                                             
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      a
                                                   
                                                
                                             
                                          
                                          (
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   a
                                                
                                                
                                                   k
                                                
                                             
                                             −
                                             α
                                             Δ
                                             t
                                             (
                                             
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      a
                                                   
                                                   
                                                      k
                                                   
                                                
                                                +
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      a
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                             )
                                          
                                          )
                                          ,
                                       
                                    
                                 where 
                                    
                                       
                                          m
                                       
                                       
                                          a
                                       
                                    
                                 , 
                                    
                                       
                                          s
                                       
                                       
                                          a
                                       
                                       
                                          k
                                       
                                    
                                  and 
                                    
                                       
                                          S
                                       
                                       
                                          a
                                       
                                       
                                          k
                                       
                                    
                                  consider the contributions of all the elements sharing the node a 
                                 [30].

Eq. (34b) simplifies to 
                                    
                                       (37)
                                       
                                          
                                             
                                                Λ
                                             
                                             
                                                in
                                                (
                                                a
                                                )
                                             
                                             
                                                k
                                             
                                          
                                          
                                             
                                                J
                                             
                                             
                                                ρ
                                                (
                                                a
                                                )
                                             
                                             
                                                k
                                             
                                          
                                          −
                                          
                                             
                                                J
                                             
                                             
                                                ρ
                                                (
                                                a
                                                )
                                             
                                             
                                                k
                                             
                                          
                                          
                                             
                                                Λ
                                             
                                             
                                                in
                                                (
                                                a
                                                )
                                             
                                             
                                                k
                                                (
                                                t
                                                )
                                             
                                          
                                          =
                                          
                                             
                                                Δ
                                                t
                                             
                                             
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      a
                                                   
                                                
                                             
                                          
                                          (
                                          
                                             
                                                
                                                   
                                                      
                                                         Π
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   a
                                                
                                                
                                                   k
                                                
                                             
                                             +
                                             α
                                             Δ
                                             t
                                             (
                                             
                                                
                                                   
                                                      
                                                         
                                                            h
                                                         
                                                         
                                                            ˜
                                                         
                                                      
                                                   
                                                   
                                                      a
                                                   
                                                   
                                                      k
                                                   
                                                
                                                +
                                                
                                                   
                                                      
                                                         
                                                            H
                                                         
                                                         
                                                            ˜
                                                         
                                                      
                                                   
                                                   
                                                      a
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                             )
                                          
                                          )
                                          ,
                                       
                                    
                                 where 
                                    
                                       
                                          Λ
                                       
                                       
                                          in
                                          (
                                          a
                                          )
                                       
                                       
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          Λ
                                       
                                       
                                          a
                                       
                                       
                                          (
                                          k
                                          )
                                          t
                                       
                                    
                                    
                                       
                                          Λ
                                       
                                       
                                          a
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                  is the nodal value of the incremental rotation tensor and 
                                    
                                       
                                          J
                                       
                                       
                                          ρ
                                          (
                                          a
                                          )
                                       
                                       
                                          k
                                       
                                    
                                  is the nodal value of the characteristic tensor given in (43). Both of them as well as 
                                    
                                       
                                          
                                             
                                                Π
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          a
                                       
                                       
                                          k
                                       
                                    
                                  consider the contribution of all the elements sharing the node a.

To determine 
                                    
                                       
                                          Λ
                                       
                                       
                                          in
                                          (
                                          a
                                          )
                                       
                                       
                                          k
                                       
                                    
                                  we follow the method proposed by Lee et al. in [39]. It is based on using Rodrigues׳s formula to parametrize the incremental rotation tensor in terms of an incremental rotation vector as
                                    
                                       
                                          
                                             
                                                Λ
                                             
                                             
                                                in
                                                (
                                                a
                                                )
                                             
                                             
                                                k
                                             
                                          
                                          =
                                          exp
                                          [
                                          
                                             skew
                                             (
                                             
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      a
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                             )
                                          
                                          ]
                                          ,
                                       
                                    
                                 Then, replacing the above expression in (37) the following nonlinear system of equations is obtained for each node of the mesh 
                                    
                                       (38)
                                       
                                          
                                             
                                                sin
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      a
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      a
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                          
                                          (
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   ρ
                                                   (
                                                   a
                                                   )
                                                
                                                
                                                   k
                                                
                                             
                                             
                                                
                                                   θ
                                                
                                                
                                                   a
                                                
                                                
                                                   k
                                                
                                             
                                          
                                          )
                                          +
                                          
                                             
                                                1
                                                −
                                                cos
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      a
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            θ
                                                         
                                                         
                                                            a
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          (
                                          
                                             
                                                
                                                   θ
                                                
                                                
                                                   a
                                                
                                                
                                                   k
                                                
                                             
                                             ×
                                             
                                                
                                                   i
                                                
                                                
                                                   ρ
                                                   (
                                                   a
                                                   )
                                                
                                                
                                                   k
                                                
                                             
                                             
                                                
                                                   θ
                                                
                                                
                                                   a
                                                
                                                
                                                   k
                                                
                                             
                                          
                                          )
                                          =
                                          
                                             
                                                Y
                                             
                                             
                                                a
                                             
                                             
                                                k
                                             
                                          
                                          ,
                                       
                                    
                                 where 
                                    θ
                                    =
                                    ∥
                                    θ
                                    ∥
                                  and 
                                    
                                       
                                          Y
                                       
                                       
                                          a
                                       
                                       
                                          k
                                       
                                    
                                  is the axial vector of the right hand side of (37). The system (38) is solved with the help of the Newton–Raphson scheme. Details about an efficient computational implementation can be consulted in [39].

Having obtained the current value of the incremental rotation vectors 
                                    
                                       
                                          {
                                          
                                             
                                                θ
                                             
                                             
                                                a
                                             
                                             
                                                k
                                             
                                          
                                          }
                                       
                                       
                                          a
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                d
                                             
                                          
                                       
                                    
                                  we compute 
                                    
                                       
                                          {
                                          
                                             
                                                Λ
                                             
                                             
                                                in
                                                (
                                                a
                                                )
                                             
                                             
                                                k
                                             
                                          
                                          }
                                       
                                       
                                          a
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                d
                                             
                                          
                                       
                                    
                                 . Then, the update procedure for the nodal rotation tensors is given by
                                    
                                       (39)
                                       
                                          
                                             
                                                Λ
                                             
                                             
                                                a
                                             
                                             
                                                k
                                                +
                                                1
                                             
                                          
                                          =
                                          
                                             
                                                Λ
                                             
                                             
                                                in
                                                (
                                                a
                                                )
                                             
                                             
                                                k
                                             
                                          
                                          
                                             
                                                Λ
                                             
                                             
                                                a
                                             
                                             
                                                k
                                             
                                          
                                          ,
                                          
                                          a
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          
                                             
                                                n
                                             
                                             
                                                d
                                             
                                          
                                          .
                                       
                                    
                                 Moreover, following the procedure described in Section 3.1 it is possible to compute 
                                    
                                       
                                          Λ
                                       
                                       
                                          h
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                    (
                                    s
                                    )
                                 , 
                                    s
                                    ∈
                                    
                                       
                                          I
                                       
                                       
                                          e
                                       
                                    
                                 . The updated value of the translational strain vector and the curvature vector are computed according to [63].

The nodal momenta are updated with the help of (35a) and (35b). If initial data is given in terms of translational and angular velocity vectors, then Eqs. (22a) and (22b) are used to de compute 
                                    
                                       
                                          p
                                       
                                       
                                          a
                                       
                                       
                                          0
                                       
                                    
                                    =
                                    p
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          0
                                       
                                    
                                    )
                                  and 
                                    
                                       
                                          
                                             
                                                Π
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          a
                                       
                                       
                                          0
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                Π
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          a
                                       
                                    
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          0
                                       
                                    
                                    )
                                 , respectively.

Using a Gauss–Lobbato quadrature rule to compute (26) yields to an explicit method to update translational part of the configuration variables, (see (36)). However, to update the rotational part a non-linear system of equations has to be solved iteratively in every node of the mesh, (see (37) and (38)). It is irrespective of the quadrature rule used to compute (27).

A fundamental property of the Reissner–Simo rod model is the frame invariance of the balance equations. However, as noted first in [16], most of the numerical approximations do not inherit this property, yielding to path-dependent solutions. This pathology is related to the method used to interpolate rotations from the nodes to the quadrature points. Different solutions have been proposed to correct this problem (see e.g. [8,9,35,62] among others). In the this work this aspect is not covered in great detail. However, we note that the interpolation procedure explained in Section 3.1 yields to path-independent solutions as it is shown in [63].

The resulting integration scheme is summarized in Algorithm 1. In the following its main properties are described. 
                           Algorithm 1
                           Explicit algorithm for geometrically exact rods.
                                 
                                    
                                       
                                       
                                          
                                             
                                                Data: Mesh: 
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                , initial configuration: 
                                                   
                                                      
                                                         {
                                                         
                                                            (
                                                            
                                                               
                                                                  φ
                                                               
                                                               
                                                                  a
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  Λ
                                                               
                                                               
                                                                  a
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                            )
                                                         
                                                         }
                                                      
                                                      
                                                         a
                                                         =
                                                         1
                                                      
                                                      
                                                         
                                                            
                                                               n
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                      
                                                   
                                                 and initial boundary conditions: 
                                                   
                                                      
                                                         {
                                                         
                                                            (
                                                            
                                                               
                                                                  p
                                                               
                                                               
                                                                  a
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  Π
                                                               
                                                               
                                                                  a
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                            )
                                                         
                                                         }
                                                      
                                                      
                                                         a
                                                         =
                                                         1
                                                      
                                                      
                                                         
                                                            
                                                               n
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                      
                                                   
                                                .
                                          
                                          
                                             
                                                forall
                                                the time instants t
                                                
                                                   k
                                                 with 
                                                   k
                                                   ∈
                                                   {
                                                   1
                                                   ,
                                                   …
                                                   ,
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   }
                                                 
                                                do
                                             
                                          
                                          
                                             
                                                
                                                   |
                                                   
                                                      
                                                         
                                                            
                                                               forall
                                                               
                                                               the
                                                               
                                                               nodes
                                                               
                                                               a
                                                               ∈
                                                               {
                                                               1
                                                               ,
                                                               …
                                                               ,
                                                               
                                                                  
                                                                     n
                                                                  
                                                                  
                                                                     t
                                                                  
                                                               
                                                               }
                                                               
                                                               do
                                                            
                                                         
                                                         
                                                            
                                                               |
                                                               
                                                                  
                                                                     
                                                                        
                                                                           Update
                                                                           
                                                                           
                                                                              
                                                                                 φ
                                                                              
                                                                              
                                                                                 a
                                                                              
                                                                              
                                                                                 k
                                                                                 +
                                                                                 1
                                                                              
                                                                           
                                                                           
                                                                           with
                                                                           
                                                                           the
                                                                           
                                                                           help
                                                                           
                                                                           of
                                                                           
                                                                           (
                                                                           36
                                                                           )
                                                                           .
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           Update
                                                                           
                                                                           
                                                                              
                                                                                 Λ
                                                                              
                                                                              
                                                                                 a
                                                                              
                                                                              
                                                                                 k
                                                                                 +
                                                                                 1
                                                                              
                                                                           
                                                                           
                                                                           according
                                                                           
                                                                           to
                                                                           
                                                                           (
                                                                           39
                                                                           )
                                                                           
                                                                           after
                                                                           
                                                                           solving
                                                                           
                                                                           (
                                                                           38
                                                                           )
                                                                           .
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           Update
                                                                           
                                                                           (
                                                                           
                                                                              
                                                                                 
                                                                                    p
                                                                                 
                                                                                 
                                                                                    a
                                                                                 
                                                                                 
                                                                                    k
                                                                                    +
                                                                                    1
                                                                                 
                                                                              
                                                                              ,
                                                                              
                                                                                 
                                                                                    Π
                                                                                 
                                                                                 
                                                                                    a
                                                                                 
                                                                                 
                                                                                    k
                                                                                    +
                                                                                    1
                                                                                 
                                                                              
                                                                           
                                                                           )
                                                                           
                                                                           using
                                                                           
                                                                           (
                                                                           35
                                                                           a
                                                                           )
                                                                           
                                                                           and
                                                                           
                                                                           (
                                                                           35
                                                                           b
                                                                           )
                                                                           .
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               end
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                end
                                             
                                          
                                       
                                    
                                 
                              
                           


                        Order of accuracy with h: As it has been already explained, a Gauss–Lobatto quadrature rule is selected to evaluate the volume integral appearing in the kinetic energy function. This option allows to formulate an explicit time integrator. Moreover, the entries of the lumped mass matrix are always positive. It is worth to mention that in this case the order of accuracy with the mesh size does not result affected by using a suboptimal quadrature rule. The reasons that explain this advantageous characteristic are the following:
                           
                              •
                              On one side, one-dimensional Gauss–Lobbato quadrature rules of arbitrarily high order with positive weights are available [13].

On the other side, the following basic principle ensuring optimal convergence rate with h is automatically satisfied [21]:—In each element, the quadrature rule must be exact for 
                                 
                                    
                                       
                                          P
                                       
                                       
                                          2
                                          (
                                          k
                                          −
                                          m
                                          )
                                       
                                    
                                 — where m is the highest differentiation order appearing in the energy expression (m=1).

Taking into account the above arguments, the highest order of accuracy with the mesh size is achieved when using a Gauss–Lobatto quadrature rule. Error bounds for finite element interpolations of functions and an analysis of convergence of the finite element method can be reviewed e.g. in [5,12].


                        Order of accuracy with 
                        
                           Δ
                           t
                        : Marsden and West in [52, pp. 402] have proven that the order of accuracy of an algorithm in position-momentum form coincides with the order of accuracy of the discrete Lagrangian whenever it satisfies some standard smoothness conditions. In the cases of the discrete Lagrangian (28), if 
                           α
                           =
                           
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                           
                         second-order of accuracy is obtained. The algorithm can be identified with a Lie-group version of the Störmer–Verlet scheme for finite element discretizations of geometrically exact rods. The same conclusion can be achieved after constructing the adjoint discrete Lagrangian defined as 
                           
                              
                                 
                                    
                                       L
                                    
                                    
                                       d
                                    
                                    
                                       ⁎
                                       α
                                    
                                 
                                 (
                                 
                                    
                                       Φ
                                    
                                    
                                       h
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                    
                                       Φ
                                    
                                    
                                       h
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 ,
                                 Δ
                                 t
                                 )
                                 =
                                 −
                                 
                                    
                                       L
                                    
                                    
                                       d
                                    
                                    
                                       α
                                    
                                 
                                 (
                                 
                                    
                                       Φ
                                    
                                    
                                       h
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       Φ
                                    
                                    
                                       h
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 −
                                 Δ
                                 t
                                 )
                                 .
                              
                           
                        Simple calculations indicate that the discrete Lagrangian (28) is self-adjoint i.e. 
                           
                              
                                 L
                              
                              
                                 d
                              
                              
                                 ⁎
                                 α
                              
                           
                           =
                           
                              
                                 L
                              
                              
                                 d
                              
                              
                                 α
                              
                           
                         only if 
                           α
                           =
                           
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                           
                        . Self-adjoint discrete Lagrangians derives in VI׳s which are symmetric and have even order of accuracy (see [79, pp. 66 and 69]). Other values of 
                           α
                           ≠
                           
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                           
                         render only first-order accurate schemes.


                        Symplecticity and long term energy behavior: The Hamiltonian structure of the dynamics of geometrically exact rods ensures that the trajectories followed by the system conserve two important quantities: the total energy and the (skew-symmetric) symplectic two-form [50,66]. In the discrete case, variational methods automatically conserve a discrete analogue of the symplectic form (see e.g [44,49] for a proof). In what regards to the discrete total energy,
                           
                              (40)
                              
                                 
                                    
                                       H
                                    
                                    
                                       d
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       a
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             d
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       
                                          m
                                       
                                       
                                          a
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          p
                                       
                                       
                                          a
                                       
                                       
                                          k
                                       
                                    
                                    ·
                                    
                                       
                                          p
                                       
                                       
                                          a
                                       
                                       
                                          k
                                       
                                    
                                    +
                                    
                                       
                                          I
                                       
                                       
                                          ρ
                                          (
                                          a
                                          )
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          Π
                                       
                                       
                                          a
                                       
                                       
                                          k
                                       
                                    
                                    ·
                                    
                                       
                                          Π
                                       
                                       
                                          a
                                       
                                       
                                          k
                                       
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       U
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 
                                    
                                       
                                          φ
                                       
                                       
                                          1
                                       
                                       
                                          k
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          φ
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                d
                                             
                                          
                                       
                                       
                                          k
                                       
                                    
                                    ,
                                    
                                       
                                          Λ
                                       
                                       
                                          1
                                       
                                       
                                          k
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          Λ
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                d
                                             
                                          
                                       
                                       
                                          k
                                       
                                    
                                 
                                 )
                                 ,
                              
                           
                        its exact conservation is not possible for symplectic methods with constant time steps [36], however, a theorem in [29, pp. 312] allows us to ensure that the error in the total energy remains 
                           O
                           (
                           
                              
                                 h
                              
                              
                                 p
                              
                           
                           )
                         (p being the order of accuracy the method) close to the original value for exponentially long periods of time if the provided time step is in the range of stability of the method. An equivalent result in the context of general Lie-group methods has been recently given in [19].


                        Invariants associated to symmetries of 
                        
                           
                              
                                 L
                              
                              
                                 d
                              
                              
                                 α
                              
                           
                        : A discrete Lagrangian posses a symmetry when it remains invariant under the action of a Lie group on the configuration manifold. Moreover, according to a discrete version of Noether׳s theorem (see e.g. [51,52]) each symmetry of the discrete Lagrangian leads to a quantity conserved by the dynamics. In our case, 
                           
                              
                                 L
                              
                              
                                 d
                              
                              
                                 α
                              
                           
                         results to be invariant under the action of rigid body translations and rotations. To verify this is enough to impose a rigid body rotation 
                           
                              
                                 Q
                              
                              
                                 +
                              
                           
                           ∈
                           SO
                           (
                           3
                           )
                         and a rigid body translation 
                           
                              
                                 c
                              
                              
                                 +
                              
                           
                           ∈
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                         onto 
                           (
                           
                              
                                 Φ
                              
                              
                                 h
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 Φ
                              
                              
                                 h
                              
                              
                                 1
                              
                           
                           )
                           ∈
                           
                              
                                 Q
                              
                              
                                 h
                              
                           
                           ×
                           
                              
                                 Q
                              
                              
                                 h
                              
                           
                         to yield 
                           
                              
                                 Φ
                              
                              
                                 h
                              
                              
                                 i
                                 +
                              
                           
                           =
                           (
                           
                              
                                 
                                    Q
                                 
                                 
                                    +
                                 
                              
                              
                                 
                                    φ
                                 
                                 
                                    h
                                 
                                 
                                    i
                                 
                              
                              +
                              
                                 
                                    c
                                 
                                 
                                    +
                                 
                              
                              ,
                              
                                 
                                    Q
                                 
                                 
                                    +
                                 
                              
                              
                                 
                                    Λ
                                 
                                 
                                    h
                                 
                                 
                                    i
                                 
                              
                           
                           )
                         (i=0,1) and to check that
                           
                              (41)
                              
                                 
                                    
                                       L
                                    
                                    
                                       d
                                    
                                    
                                       α
                                    
                                 
                                 (
                                 
                                    
                                       
                                          Φ
                                       
                                       
                                          h
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          Φ
                                       
                                       
                                          h
                                       
                                       
                                          1
                                       
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       L
                                    
                                    
                                       d
                                    
                                    
                                       α
                                    
                                 
                                 (
                                 
                                    
                                       
                                          Φ
                                       
                                       
                                          h
                                       
                                       
                                          0
                                          +
                                       
                                    
                                    ,
                                    
                                       
                                          Φ
                                       
                                       
                                          h
                                       
                                       
                                          1
                                          +
                                       
                                    
                                 
                                 )
                                 ,
                              
                           
                        which may be easily confirmed after replacing 
                           (
                           
                              
                                 Φ
                              
                              
                                 h
                              
                              
                                 0
                                 +
                              
                           
                           ,
                           
                              
                                 Φ
                              
                              
                                 h
                              
                              
                                 1
                                 +
                              
                           
                           )
                         in (26), noting that 
                           Γ
                           (
                           
                              
                                 Φ
                              
                              
                                 h
                              
                              
                                 i
                                 +
                              
                           
                           )
                           =
                           Γ
                           (
                           
                              
                                 Φ
                              
                              
                                 h
                              
                              
                                 i
                              
                           
                           )
                        , 
                           
                              
                                 Ω
                              
                              
                                 ˜
                              
                           
                           (
                           
                              
                                 Φ
                              
                              
                                 h
                              
                              
                                 i
                                 +
                              
                           
                           )
                           =
                           
                              
                                 Ω
                              
                              
                                 ˜
                              
                           
                           (
                           
                              
                                 Φ
                              
                              
                                 h
                              
                              
                                 i
                              
                           
                           )
                         and then 
                           
                              
                                 U
                              
                              
                                 d
                              
                              
                                 int
                              
                           
                           (
                           
                              
                                 Φ
                              
                              
                                 h
                              
                              
                                 i
                                 +
                              
                           
                           )
                           =
                           
                              
                                 U
                              
                              
                                 d
                              
                              
                                 int
                              
                           
                           (
                           
                              
                                 Φ
                              
                              
                                 h
                              
                              
                                 i
                              
                           
                           )
                        , and that 
                           
                              
                                 U
                              
                              
                                 d
                              
                              
                                 ext
                              
                           
                           (
                           
                              
                                 Λ
                              
                              
                                 h
                              
                              
                                 (
                                 i
                                 +
                                 )
                                 t
                              
                           
                           
                              
                                 φ
                              
                              
                                 h
                              
                              
                                 i
                                 +
                              
                           
                           )
                           =
                           
                              
                                 U
                              
                              
                                 d
                              
                              
                                 ext
                              
                           
                           (
                           
                              
                                 Λ
                              
                              
                                 h
                              
                              
                                 (
                                 i
                                 )
                                 t
                              
                           
                           
                              
                                 φ
                              
                              
                                 h
                              
                              
                                 i
                              
                           
                           )
                        . Therefore, the discrete versions of the total linear momentum and total angular velocity
                           
                              (42)
                              
                                 
                                    
                                       L
                                    
                                    
                                       t
                                       ,
                                       d
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       a
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       a
                                    
                                    
                                       k
                                    
                                 
                                 
                                 and
                                 
                                 
                                    
                                       J
                                    
                                    
                                       t
                                       ,
                                       d
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       a
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             Π
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       a
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 
                                    
                                       φ
                                    
                                    
                                       a
                                    
                                    
                                       k
                                    
                                 
                                 ×
                                 
                                    
                                       p
                                    
                                    
                                       a
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 ,
                              
                           
                        are invariants of the discrete trajectories. We note that the discrete momenta need not be equal to their continuous counterparts (16) since a finite element discretization along with the corresponding quadrature rule have been introduced in order to compute their values at t
                        0 (see (22a) and (22b)).


                        Stability: In spite of the fact that nowadays there exist a deep understanding of the stability properties of numerical methods for ODE׳s [29], it is widely accepted that it is not the case for methods designed to solve differential equations on Lie-groups. See e.g. [34, pp. 103] and references therein for a recent discussion about the topic. A new perspective of the stability problem is obtained by means of the so-called backward error analysis [29,19, Chapter 9]. Following that approach it is possible to show that, for a small enough time steps, the energy of the numerically computed trajectories remains exponentially close to that of a modified shadow Hamiltonian for exponentially long periods of time. Moreover, the balance equations of the modified Hamitonian are 
                           O
                           (
                           
                              
                                 h
                              
                              
                                 p
                              
                           
                           )
                         perturbations of that obtained for the exact Hamiltonian. In this work, we follow Lew et al. [44] and we determine the time step length from the Courant condition, which provides an estimate of the stability limit for explicit integration. It is worth noting that this condition is only a necessary condition for stability i.e. it is not always sufficient to guarantee stability of the solution (an example is given in [[42, Section 4.5]). Therefore, the value of the time step is set to a fraction of the Courant limit.

This example in taken from [67] where simulations are carried out using an energy-momentum conserving scheme. The straight rod of Fig. 2
                         is subjected to a spatially fixed system of loads given by the force 
                           F
                           =
                           (
                           1
                           /
                           10
                           )
                           p
                           (
                           t
                           )
                           
                              
                                 
                                    
                                       e
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 1
                              
                           
                         and moments 
                           
                              
                                 M
                              
                              
                                 1
                              
                           
                           =
                           p
                           (
                           t
                           )
                           
                              
                                 
                                    
                                       e
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 3
                              
                           
                         and 
                           
                              
                                 M
                              
                              
                                 2
                              
                           
                           =
                           0.5
                           p
                           (
                           t
                           )
                           
                              
                                 
                                    
                                       e
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 2
                              
                           
                        . The time varying factor p(t) is given by 
                           
                              
                                 p
                                 (
                                 t
                                 )
                                 =
                                 {
                                 
                                    
                                       
                                          
                                             80
                                             t
                                             ,
                                          
                                          
                                             t
                                             ∈
                                             [
                                             0
                                             ,
                                             2.5
                                             )
                                          
                                       
                                       
                                          
                                             200
                                             −
                                             80
                                             t
                                             ,
                                          
                                          
                                             t
                                             ∈
                                             [
                                             2.5
                                             ,
                                             5.0
                                             ]
                                          
                                       
                                       
                                          
                                             0
                                             ,
                                          
                                          
                                             t
                                             >
                                             5.0
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        The material properties are 
                           E
                           A
                           =
                           G
                           A
                           =
                           10
                           ,
                           000
                        , 
                           EI
                           =
                           500
                        , 
                           
                              
                                 A
                              
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       0
                                    
                                 
                              
                           
                           =
                           1
                         and 
                           
                              
                                 I
                              
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       0
                                    
                                 
                              
                           
                           =
                           10
                        . Zero initial conditions are assumed. The finite element mesh consists of 10 linear elements. Internal forces and moments are computed using a Gauss–Legendre quadrature rule with one point. The time step was set to 0.015s.

The resulting motion shows translational and tumbling components involving large rotations and large displacements. Out-of plane motion has place due to the torque about 
                           
                              
                                 
                                    
                                       e
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 2
                              
                           
                        . Fig. 3
                        a shows that the discrete version of the total energy, 
                           
                              
                                 H
                              
                              
                                 d
                              
                           
                        , given in (40) is nearly exactly conserved, presenting bounded oscillations around its value at t=6s. This behavior contrasts with that presented in [67] for the midpoint rule as well as for the Newmark trapezoidal rule applied to the same problem. In spite of the fact that in the present case the discrete energy is not exactly conserved, its error remains bounded for exponentially long periods of time. The exact conservation of the spatial form of the discrete version of the total angular momentum, 
                           
                              
                                 J
                              
                              
                                 t
                                 ,
                                 d
                              
                           
                        , given in (42) can be verified in Fig. 3b.

Regarding to computational aspects, for 
                           Δ
                           t
                           >
                           0.015
                        
                        s the proposed algorithm loses stability. When compared with the implicit energy-momentum method due to Simo et al. in [67], it is possible to see that to get stable solutions, the present method requires 
                           Δ
                           t
                        
                        s that are 13 times smaller. However, we think that the need for smaller time steps (compared with implicit methods) is compensated by the fact that we avoid the iterative solving of large systems of nonlinear equations.

This example corresponds to the numerical simulation of the 3D dynamics of an elastic ring of radius r=5 as shown in Fig. 4
                        . This case has been selected due to the fact that it represents a typical structure appearing in problems of current interest n biophysics and coarse grain models in molecular dynamics (see e.g. [6,25,26,38] among others). This simulation highlights the ability of the model to reproduce the dynamics of filament-like structures involving important changes in the configuration while retaining the geometric properties of the flow.

The ring is subjected to applied moments 
                           
                              
                                 m
                              
                              
                                 1
                              
                           
                           =
                           m
                           
                              
                                 e
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 m
                              
                              
                                 2
                              
                           
                           =
                           −
                           
                              
                                 m
                              
                              
                                 1
                              
                           
                        , where m is a scalar which increases linearly from 0 to 80 in 1.5s. After that the loads are suddenly removed and the system continues vibrating freely. Since the applied moments represents a system of self-equilibrated loads, both the total linear momentum and the total angular momentum are equal to zero. Thus, they are exactly conserved during the free-fly phase of the motion.

The cross-sectional mechanical properties are 
                           E
                           A
                           =
                           G
                           A
                           =
                           3
                           ×
                           
                              
                                 10
                              
                              
                                 4
                              
                           
                        , 
                           EI
                           =
                           7
                           ×
                           
                              
                                 10
                              
                              
                                 3
                              
                           
                        , 
                           
                              
                                 A
                              
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       0
                                    
                                 
                              
                           
                           =
                           1
                         and 
                           
                              
                                 I
                              
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       0
                                    
                                 
                              
                           
                           =
                           10
                        . The mesh consists of 80 linear elements and a Gauss–Legendre quadrature rule with one point is used to compute internal forces and internal moments. The simulation is carried out for 4.5s with 
                           Δ
                           t
                           =
                           0.0015
                           
                           s
                        .

The system exhibits a complex dynamics, undergoing nonlinear vibrations which involve large rotations coupled with large displacements in space. Therefore, drastic changes in the configuration have place during the motion. Fig. 5
                         shows a sequence of snapshots of the motion in the 
                           
                              
                                 e
                              
                              
                                 1
                              
                           
                        –
                           
                              
                                 e
                              
                              
                                 2
                              
                           
                         plane. The same sequence but in the 
                           
                              
                                 e
                              
                              
                                 1
                              
                           
                        –
                           
                              
                                 e
                              
                              
                                 3
                              
                           
                         plane is shown in Fig. 6
                        . Finally, the time evolution of the discrete kinetic, potential and total energies are shown in Fig. 7
                         from which it is possible to see the excellent long term energy behavior of the algorithm. It is worth to mention that since the method is symplectic, 
                           
                              
                                 H
                              
                              
                                 d
                              
                           
                         cannot be exactly conserved [22]. However, by means of using backward error analysis it is possible to show that the error in the energy remains bounded for exponentially long periods of time [29, Chapter IX].

@&#CONCLUSIONS@&#

In this work, a new second-order accurate variational integrator for simulating the dynamics of geometrically exact rods is presented. To this end, the Reissner–Simo׳s theory of elastic rods in finite deformation is revisited giving special emphasis to the Lagrangian and Hamiltonian point of views of the problem. Technical issues regarding to the nonlinear nature of the configuration manifold are discussed. The discretization in space of the continuum problem is based on the finite element method. Special attention is given to the way in which rotations are interpolated to avoid singularities. Regarding to the discretization of the problem in time, a standard methodology for formulating Lie group variational integrators is used. The method is based on constructing a discrete counterpart of Hamilton׳s principle to deduce discrete analogues of the Euler–Lagrange equations. Additionally, the discrete Legendre transform allows to obtain a position-momentum form of the method. The discrete flow results to be symplectic and exactly conserves the invariants associated to the symmetries of the discrete Lagrangian. An explicit method is obtained if the kinetic term of the Lagrangian is computed using a Gauss–Lobatto quadrature rule. Numerical examples allow to verify the excellent performance of the developed method. In particular, the exact conservation of momenta associated to symmetries of the discrete Lagrangian and a remarkably good long term energy behavior are evidenced. Future work should consider including self-contact between different parts of the rod along with parallel asynchronous integration.

@&#ACKNOWLEDGEMENTS@&#

This research has been partially funded by “Gobierno regional de Aysén. FIC: Transferencia modelización computacional para recursos hídricos. BIP-code 30137300-0”. This support is gratefully acknowledged.

First, we note that the spatial form of the inertia tensor is given by
                           
                              (43)
                              
                                 
                                    
                                       i
                                    
                                    
                                       ρ
                                    
                                 
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       A
                                    
                                 
                                 
                                    
                                       ρ
                                    
                                    
                                       0
                                    
                                 
                                 
                                 Tr
                                 [
                                 z
                                 ⊗
                                 z
                                 ]
                                 
                                 dA
                                 
                                 I
                                 −
                                 
                                    
                                       ∫
                                    
                                    
                                       A
                                    
                                 
                                 
                                    
                                       ρ
                                    
                                    
                                       0
                                    
                                 
                                 z
                                 ⊗
                                 z
                                 
                                 dA
                                 =
                                 
                                    
                                       z
                                    
                                    
                                       ρ
                                    
                                 
                                 I
                                 −
                                 
                                    
                                       J
                                    
                                    
                                       ρ
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 J
                              
                              
                                 ρ
                              
                           
                         is a characteristic cross sectional tensor. The corresponding material form is 
                           
                              
                                 I
                              
                              
                                 ρ
                              
                           
                           =
                           
                              
                                 Λ
                              
                              
                                 t
                              
                           
                           
                              
                                 i
                              
                              
                                 ρ
                              
                           
                           Λ
                           =
                           
                              
                                 e
                              
                              
                                 ρ
                              
                           
                           I
                           −
                           
                              
                                 E
                              
                              
                                 ρ
                              
                           
                        . Moreover, for all 
                           v
                           ∈
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                        , it is possible to show that
                           
                              (44)
                              
                                 skew
                                 [
                                 
                                    
                                       i
                                    
                                    
                                       ρ
                                    
                                 
                                 v
                                 ]
                                 =
                                 
                                    
                                       J
                                    
                                    
                                       ρ
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       ˜
                                    
                                 
                                 −
                                 
                                    
                                       
                                          
                                             v
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       J
                                    
                                    
                                       ρ
                                    
                                 
                                 .
                              
                           
                        where 
                           
                              
                                 v
                              
                              
                                 ˜
                              
                           
                           =
                           skew
                           [
                           v
                           ]
                         with 
                           skew
                           [
                           •
                           ]
                           :
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                           →
                           SO
                           (
                           3
                           )
                        .
                           
                              •
                              
                                 Linearization of 
                                 
                                    K
                                 : The linear part of the kinetic energy is computed according to 
                                    
                                       (45)
                                       
                                          δ
                                          K
                                          =
                                          
                                             
                                                ∫
                                             
                                             
                                                0
                                             
                                             
                                                L
                                             
                                          
                                          
                                             
                                                A
                                             
                                             
                                                ρ
                                             
                                          
                                          
                                             
                                                φ
                                             
                                             
                                                ̇
                                             
                                          
                                          ·
                                          δ
                                          
                                             
                                                φ
                                             
                                             
                                                ̇
                                             
                                          
                                          
                                          ds
                                          −
                                          
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                ∫
                                             
                                             
                                                0
                                             
                                             
                                                L
                                             
                                          
                                          Tr
                                          [
                                          
                                             δ
                                             
                                                
                                                   V
                                                
                                                
                                                   ˜
                                                
                                             
                                             
                                                
                                                   E
                                                
                                                
                                                   ρ
                                                
                                             
                                             
                                                
                                                   V
                                                
                                                
                                                   ˜
                                                
                                             
                                             +
                                             
                                                
                                                   V
                                                
                                                
                                                   ˜
                                                
                                             
                                             
                                                
                                                   E
                                                
                                                
                                                   ρ
                                                
                                             
                                             δ
                                             
                                                
                                                   V
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          ]
                                          
                                          ds
                                          .
                                       
                                    
                                 Taking into account that 
                                    δ
                                    
                                       
                                          V
                                       
                                       
                                          ˜
                                       
                                    
                                    =
                                    
                                       
                                          Λ
                                       
                                       
                                          t
                                       
                                    
                                    δ
                                    
                                       
                                          
                                             
                                                θ
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          ̇
                                       
                                    
                                    Λ
                                 , Eq. (44) and the fact that for all A, 
                                    B
                                    ∈
                                    
                                       
                                          R
                                       
                                       
                                          n
                                          ×
                                          n
                                       
                                    
                                 , 
                                    Tr
                                    [
                                    AB
                                    ]
                                    =
                                    Tr
                                    [
                                    BA
                                    ]
                                    =
                                    Tr
                                    [
                                    
                                       
                                          (
                                          AB
                                          )
                                       
                                       
                                          T
                                       
                                    
                                    ]
                                    =
                                    Tr
                                    [
                                    
                                       
                                          (
                                          BA
                                          )
                                       
                                       
                                          T
                                       
                                    
                                    ]
                                 , it is possible to rewrite the second term of the right hand side of (45) as 
                                    
                                       (46)
                                       
                                          
                                             
                                                ∫
                                             
                                             
                                                0
                                             
                                             
                                                L
                                             
                                          
                                          Tr
                                          [
                                          
                                             
                                                
                                                   Λ
                                                
                                                
                                                   t
                                                
                                             
                                             δ
                                             
                                                
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   ̇
                                                
                                             
                                             Λ
                                             
                                                
                                                   E
                                                
                                                
                                                   ρ
                                                
                                             
                                             
                                                
                                                   V
                                                
                                                
                                                   ˜
                                                
                                             
                                             +
                                             
                                                
                                                   V
                                                
                                                
                                                   ˜
                                                
                                             
                                             
                                                
                                                   E
                                                
                                                
                                                   ρ
                                                
                                             
                                             
                                                
                                                   Λ
                                                
                                                
                                                   t
                                                
                                             
                                             δ
                                             
                                                
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   ̇
                                                
                                             
                                             Λ
                                          
                                          ]
                                          
                                          ds
                                          =
                                          
                                             
                                                ∫
                                             
                                             
                                                0
                                             
                                             
                                                L
                                             
                                          
                                          Tr
                                          [
                                          
                                             δ
                                             
                                                
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   ̇
                                                
                                             
                                             (
                                             
                                                
                                                   J
                                                
                                                
                                                   ρ
                                                
                                             
                                             
                                                
                                                   v
                                                
                                                
                                                   ˜
                                                
                                             
                                             +
                                             
                                                
                                                   v
                                                
                                                
                                                   ˜
                                                
                                             
                                             
                                                
                                                   J
                                                
                                                
                                                   ρ
                                                
                                             
                                             )
                                          
                                          ]
                                          
                                          ds
                                          =
                                          
                                             
                                                ∫
                                             
                                             
                                                0
                                             
                                             
                                                L
                                             
                                          
                                          Tr
                                          [
                                          
                                             δ
                                             
                                                
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   ̇
                                                
                                             
                                             
                                             skew
                                             [
                                             
                                                
                                                   i
                                                
                                                
                                                   ρ
                                                
                                             
                                             v
                                             ]
                                          
                                          ]
                                          
                                          ds
                                          .
                                       
                                    
                                 
                              


                                 Linearization of 
                                 
                                    
                                       
                                          U
                                       
                                       
                                          int
                                       
                                    
                                 : The linear part of (9a) can be expressed as 
                                    
                                       (47)
                                       
                                          δ
                                          
                                             
                                                U
                                             
                                             
                                                int
                                             
                                          
                                          =
                                          δ
                                          
                                             
                                                ∫
                                             
                                             
                                                0
                                             
                                             
                                                L
                                             
                                          
                                          ψ
                                          (
                                          Γ
                                          ,
                                          Ω
                                          )
                                          
                                          ds
                                          =
                                          
                                             
                                                ∫
                                             
                                             
                                                0
                                             
                                             
                                                L
                                             
                                          
                                          
                                             
                                                n
                                             
                                             
                                                m
                                             
                                          
                                          ·
                                          δ
                                          Γ
                                          
                                          ds
                                          +
                                          
                                             
                                                ∫
                                             
                                             
                                                0
                                             
                                             
                                                L
                                             
                                          
                                          
                                             
                                                m
                                             
                                             
                                                m
                                             
                                          
                                          ·
                                          δ
                                          Ω
                                          
                                          ds
                                          ,
                                       
                                    
                                 which, considering that 
                                    δ
                                    Γ
                                    =
                                    
                                       
                                          Λ
                                       
                                       
                                          t
                                       
                                    
                                    (
                                    δ
                                    φ
                                    
                                       
                                          ,
                                       
                                       
                                          s
                                       
                                    
                                    −
                                    δ
                                    
                                       
                                          θ
                                       
                                       
                                          ˜
                                       
                                    
                                    φ
                                    
                                       
                                          ,
                                       
                                       
                                          s
                                       
                                    
                                    )
                                  and 
                                    δ
                                    Ω
                                    =
                                    
                                       
                                          Λ
                                       
                                       
                                          t
                                       
                                    
                                    δ
                                    θ
                                    
                                       
                                          ,
                                       
                                       
                                          s
                                       
                                    
                                  (see [69,67]) allows to obtain 
                                    
                                       (48)
                                       
                                          δ
                                          
                                             
                                                U
                                             
                                             
                                                int
                                             
                                          
                                          =
                                          
                                             
                                                ∫
                                             
                                             
                                                0
                                             
                                             
                                                L
                                             
                                          
                                          n
                                          ·
                                          δ
                                          φ
                                          
                                             
                                                ,
                                             
                                             
                                                s
                                             
                                          
                                          
                                          ds
                                          +
                                          
                                             
                                                ∫
                                             
                                             
                                                0
                                             
                                             
                                                L
                                             
                                          
                                          δ
                                          
                                             
                                                θ
                                             
                                             
                                                ˜
                                             
                                          
                                          n
                                          ·
                                          φ
                                          
                                             
                                                ,
                                             
                                             
                                                s
                                             
                                          
                                          
                                          ds
                                          +
                                          
                                             
                                                ∫
                                             
                                             
                                                0
                                             
                                             
                                                L
                                             
                                          
                                          m
                                          ·
                                          δ
                                          θ
                                          
                                             
                                                ,
                                             
                                             
                                                s
                                             
                                          
                                          
                                          ds
                                          =
                                          
                                             
                                                ∫
                                             
                                             
                                                0
                                             
                                             
                                                L
                                             
                                          
                                          (
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                             Tr
                                             [
                                             
                                                δ
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                                (
                                                
                                                   
                                                      
                                                         φ
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                   
                                                      
                                                         ,
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                   
                                                      
                                                         φ
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                   
                                                      
                                                         ,
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                   
                                                      
                                                         ,
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                
                                                )
                                             
                                             ]
                                             −
                                             n
                                             
                                                
                                                   ,
                                                
                                                
                                                   s
                                                
                                             
                                             ·
                                             δ
                                             φ
                                          
                                          )
                                          
                                          ds
                                          .
                                       
                                    
                                 
                              


                                 Linearization of 
                                 
                                    
                                       
                                          U
                                       
                                       
                                          ext
                                       
                                    
                                 : Denoting by 
                                    
                                       
                                          φ
                                       
                                       
                                          m
                                       
                                    
                                    ≡
                                    
                                       
                                          Λ
                                       
                                       
                                          t
                                       
                                    
                                    φ
                                  and by 
                                    
                                       
                                          f
                                       
                                       
                                          m
                                       
                                    
                                    =
                                    
                                       
                                          ∇
                                       
                                       
                                          
                                             
                                                φ
                                             
                                             
                                                m
                                             
                                          
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          ext
                                       
                                    
                                  it is possible to obtain that the linear part of (9b) as 
                                    
                                       (49)
                                       
                                          δ
                                          
                                             
                                                U
                                             
                                             
                                                ext
                                             
                                          
                                          =
                                          
                                             
                                                ∫
                                             
                                             
                                                0
                                             
                                             
                                                L
                                             
                                          
                                          
                                             
                                                f
                                             
                                             
                                                m
                                             
                                          
                                          ·
                                          δ
                                          
                                             
                                                φ
                                             
                                             
                                                m
                                             
                                          
                                          
                                          ds
                                          =
                                          −
                                          
                                             
                                                ∫
                                             
                                             
                                                0
                                             
                                             
                                                L
                                             
                                          
                                          (
                                          
                                             N
                                             ·
                                             δ
                                             φ
                                             −
                                             
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                             Tr
                                             [
                                             
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                                δ
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             ]
                                          
                                          )
                                          
                                          ds
                                          .
                                       
                                    
                                 where 
                                    N
                                    =
                                    Λ
                                    
                                       
                                          f
                                       
                                       
                                          m
                                       
                                    
                                  and 
                                    
                                       
                                          M
                                       
                                       
                                          ˜
                                       
                                    
                                    =
                                    skew
                                    [
                                    φ
                                    ×
                                    N
                                    ]
                                 . Taking into account (45), (46), (48) and (49), integrating by parts and considering the fact that the endpoints of the trajectory of the system remain fixed, it is possible to obtain 
                                    
                                       (50)
                                       
                                          δ
                                          S
                                          =
                                          
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                ∫
                                             
                                             
                                                0
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                ∫
                                             
                                             
                                                0
                                             
                                             
                                                L
                                             
                                          
                                          Tr
                                          [
                                          
                                             δ
                                             
                                                
                                                   θ
                                                
                                                
                                                   ˜
                                                
                                             
                                             (
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      dt
                                                   
                                                
                                                (
                                                
                                                   skew
                                                   [
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         ρ
                                                      
                                                   
                                                   v
                                                   ]
                                                
                                                )
                                                +
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                                
                                                   
                                                      φ
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                                
                                                   
                                                      ,
                                                   
                                                   
                                                      S
                                                   
                                                
                                                −
                                                
                                                   
                                                      φ
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                                
                                                   
                                                      ,
                                                   
                                                   
                                                      S
                                                   
                                                
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                                −
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                                
                                                   
                                                      ,
                                                   
                                                   
                                                      S
                                                   
                                                
                                                −
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             )
                                          
                                          ]
                                          
                                          ds
                                          −
                                          
                                             
                                                ∫
                                             
                                             
                                                0
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                ∫
                                             
                                             
                                                0
                                             
                                             
                                                L
                                             
                                          
                                          δ
                                          φ
                                          ·
                                          (
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   ρ
                                                
                                             
                                             
                                                
                                                   φ
                                                
                                                
                                                   ¨
                                                
                                             
                                             −
                                             n
                                             
                                                
                                                   ,
                                                
                                                
                                                   S
                                                
                                             
                                             −
                                             N
                                          
                                          )
                                          
                                          ds
                                          .
                                       
                                    
                                 
                              

In this section we obtain the linear part of the discrete action sum.
                           
                              •
                              
                                 Linearization of 
                                 
                                    
                                       
                                          K
                                       
                                       
                                          d
                                       
                                    
                                 : First, we note that 
                                    
                                       
                                          
                                          δ
                                          (
                                          
                                             
                                                
                                                   Λ
                                                
                                                
                                                   h
                                                
                                                
                                                   (
                                                   k
                                                   )
                                                   t
                                                
                                             
                                             (
                                             
                                                
                                                   
                                                      Λ
                                                   
                                                   
                                                      h
                                                   
                                                   
                                                      k
                                                      +
                                                      1
                                                   
                                                
                                                −
                                                
                                                   
                                                      Λ
                                                   
                                                   
                                                      h
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                             )
                                          
                                          )
                                          =
                                          
                                             
                                                Λ
                                             
                                             
                                                h
                                             
                                             
                                                (
                                                k
                                                )
                                                t
                                             
                                          
                                          (
                                          
                                             δ
                                             
                                                
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   h
                                                
                                                
                                                   k
                                                   +
                                                   1
                                                
                                             
                                             −
                                             δ
                                             
                                                
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   h
                                                
                                                
                                                   k
                                                
                                             
                                          
                                          )
                                          
                                             
                                                Λ
                                             
                                             
                                                h
                                             
                                             
                                                k
                                                +
                                                1
                                             
                                          
                                          ,
                                       
                                    
                                 then, we get that the linear part of the discrete kinetic energy as 
                                    
                                       (51a)
                                       
                                          δ
                                          
                                             
                                                K
                                             
                                             
                                                d
                                             
                                          
                                          =
                                          
                                             
                                                1
                                             
                                             
                                                
                                                   
                                                      (
                                                      Δ
                                                      t
                                                      )
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ∑
                                             
                                             
                                                a
                                                =
                                                1
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      d
                                                   
                                                
                                             
                                          
                                          (
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   b
                                                   =
                                                   1
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   m
                                                
                                                
                                                   ab
                                                
                                             
                                             (
                                             
                                                
                                                   φ
                                                
                                                
                                                   b
                                                
                                                
                                                   k
                                                   +
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   φ
                                                
                                                
                                                   b
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                             ·
                                             (
                                             δ
                                             
                                                
                                                   φ
                                                
                                                
                                                   a
                                                
                                                
                                                   k
                                                   +
                                                   1
                                                
                                             
                                             −
                                             δ
                                             
                                                
                                                   φ
                                                
                                                
                                                   a
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                             +
                                             Tr
                                             [
                                             
                                                (
                                                δ
                                                
                                                   
                                                      
                                                         
                                                            θ
                                                         
                                                         
                                                            ˜
                                                         
                                                      
                                                   
                                                   
                                                      a
                                                   
                                                   
                                                      k
                                                      +
                                                      1
                                                   
                                                
                                                −
                                                δ
                                                
                                                   
                                                      
                                                         
                                                            θ
                                                         
                                                         
                                                            ˜
                                                         
                                                      
                                                   
                                                   
                                                      a
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      a
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                             ]
                                          
                                          )
                                          ,
                                       
                                    
                                 where the components of the translational mass matrix and the nodal value of the rotational inertia tensor are given by 
                                    
                                       (51b)
                                       
                                          
                                             
                                                m
                                             
                                             
                                                ab
                                             
                                          
                                          =
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      l
                                                   
                                                
                                             
                                          
                                          
                                             
                                                w
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                N
                                             
                                             
                                                a
                                             
                                          
                                          (
                                          
                                             
                                                ξ
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          
                                             
                                                A
                                             
                                             
                                                ρ
                                             
                                          
                                          
                                             
                                                N
                                             
                                             
                                                b
                                             
                                          
                                          (
                                          
                                             
                                                ξ
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          ,
                                       
                                    
                                 
                                 
                                    
                                       (51c)
                                       
                                          
                                             
                                                R
                                             
                                             
                                                a
                                             
                                             
                                                k
                                             
                                          
                                          =
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      l
                                                   
                                                
                                             
                                          
                                          
                                             
                                                w
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                N
                                             
                                             
                                                a
                                             
                                          
                                          (
                                          
                                             
                                                ξ
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          
                                             
                                                J
                                             
                                             
                                                ρ
                                                (
                                                h
                                                )
                                             
                                             
                                                k
                                             
                                          
                                          (
                                          
                                             
                                                ξ
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          
                                             
                                                Λ
                                             
                                             
                                                in
                                                (
                                                h
                                                )
                                             
                                             
                                                (
                                                k
                                                )
                                                t
                                             
                                          
                                          (
                                          
                                             
                                                ξ
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          ,
                                       
                                    
                                 with 
                                    
                                       
                                          J
                                       
                                       
                                          ρ
                                          (
                                          h
                                          )
                                       
                                       
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          Λ
                                       
                                       
                                          h
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          E
                                       
                                       
                                          ρ
                                       
                                    
                                    
                                       
                                          Λ
                                       
                                       
                                          h
                                       
                                       
                                          (
                                          k
                                          )
                                          t
                                       
                                    
                                  and 
                                    
                                       
                                          Λ
                                       
                                       
                                          in
                                          (
                                          h
                                          )
                                       
                                       
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          Λ
                                       
                                       
                                          h
                                       
                                       
                                          (
                                          k
                                          )
                                          t
                                       
                                    
                                    
                                       
                                          Λ
                                       
                                       
                                          h
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                 .


                                 Linearization of 
                                 
                                    
                                       
                                          U
                                       
                                       
                                          d
                                       
                                       
                                          int
                                       
                                    
                                 : The linear part of 
                                    
                                       
                                          U
                                       
                                       
                                          d
                                       
                                       
                                          int
                                       
                                    
                                  is given by 
                                    
                                       (52a)
                                       
                                          δ
                                          
                                             
                                                U
                                             
                                             
                                                d
                                             
                                             
                                                int
                                             
                                          
                                          =
                                          
                                             
                                                ∑
                                             
                                             
                                                a
                                                =
                                                1
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      d
                                                   
                                                
                                             
                                          
                                          (
                                          
                                             δ
                                             
                                                
                                                   φ
                                                
                                                
                                                   a
                                                
                                                
                                                   k
                                                
                                             
                                             ·
                                             
                                                
                                                   s
                                                
                                                
                                                   a
                                                
                                                
                                                   k
                                                
                                             
                                             −
                                             
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                             Tr
                                             [
                                             
                                                δ
                                                
                                                   
                                                      
                                                         
                                                            θ
                                                         
                                                         
                                                            ˜
                                                         
                                                      
                                                   
                                                   
                                                      a
                                                   
                                                   
                                                      k
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            h
                                                         
                                                         
                                                            ˜
                                                         
                                                      
                                                   
                                                   
                                                      a
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                             ]
                                          
                                          )
                                          .
                                       
                                    
                                 where the nodal vector of internal forces, 
                                    
                                       
                                          s
                                       
                                       
                                          a
                                       
                                       
                                          k
                                       
                                    
                                 , and the nodal tensor of internal moments, 
                                    
                                       
                                          
                                             
                                                h
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          a
                                       
                                       
                                          k
                                       
                                    
                                 , are given by 
                                    
                                       (52b)
                                       
                                          
                                             
                                                s
                                             
                                             
                                                a
                                             
                                             
                                                k
                                             
                                          
                                          =
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      g
                                                   
                                                
                                             
                                          
                                          
                                             
                                                w
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                N
                                             
                                             
                                                a
                                             
                                          
                                          (
                                          
                                             
                                                ξ
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          
                                             
                                                ,
                                             
                                             
                                                S
                                             
                                          
                                          
                                             
                                                n
                                             
                                             
                                                k
                                             
                                          
                                          (
                                          
                                             
                                                ξ
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          ,
                                       
                                    
                                 
                                 
                                    
                                       (52c)
                                       
                                          
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                a
                                             
                                             
                                                k
                                             
                                          
                                          =
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      g
                                                   
                                                
                                             
                                          
                                          
                                             
                                                w
                                             
                                             
                                                i
                                             
                                          
                                          [
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   a
                                                
                                             
                                             (
                                             
                                                
                                                   ξ
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                             (
                                             
                                                
                                                   
                                                      
                                                         
                                                            φ
                                                         
                                                         
                                                            ˜
                                                         
                                                      
                                                   
                                                   
                                                      h
                                                   
                                                   
                                                      k
                                                   
                                                
                                                (
                                                
                                                   
                                                      ξ
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                                
                                                   
                                                      ,
                                                   
                                                   
                                                      S
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            ˜
                                                         
                                                      
                                                   
                                                   
                                                      h
                                                   
                                                   
                                                      k
                                                   
                                                
                                                (
                                                
                                                   
                                                      ξ
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                                −
                                                
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            ˜
                                                         
                                                      
                                                   
                                                   
                                                      h
                                                   
                                                   
                                                      k
                                                   
                                                
                                                (
                                                
                                                   
                                                      ξ
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                                
                                                   
                                                      
                                                         
                                                            φ
                                                         
                                                         
                                                            ˜
                                                         
                                                      
                                                   
                                                   
                                                      h
                                                   
                                                   
                                                      k
                                                   
                                                
                                                (
                                                
                                                   
                                                      ξ
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                                
                                                   
                                                      ,
                                                   
                                                   
                                                      S
                                                   
                                                
                                             
                                             )
                                             −
                                             
                                                
                                                   N
                                                
                                                
                                                   a
                                                
                                             
                                             (
                                             
                                                
                                                   ξ
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                             
                                                
                                                   ,
                                                
                                                
                                                   S
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   h
                                                
                                                
                                                   k
                                                
                                             
                                             (
                                             
                                                
                                                   ξ
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                          
                                          ]
                                          .
                                       
                                    
                                 
                                 Remark: If a full quadrature is used to compute (52b) and (52c), a numerical pathology known as shear locking may affect the simulations (see [30, pp. 323]). Several remedies have been proposed [32] to overcome that problem. The simplest treatment consists in using reduced integration. In this work, a reduced integration with a Gauss–Legendre quadrature rule is used for these terms. It does not affects the order of accuracy of the FE method as is explained in [12].


                                 Linearization of 
                                 
                                    
                                       
                                          U
                                       
                                       
                                          d
                                       
                                       
                                          ext
                                       
                                    
                                 : Analogously, considering (49), the linearization of the external component of the discrete potential energy is given by 
                                    
                                       (54)
                                       
                                          δ
                                          
                                             
                                                U
                                             
                                             
                                                d
                                             
                                             
                                                ext
                                             
                                          
                                          =
                                          −
                                          
                                             
                                                ∑
                                             
                                             
                                                a
                                                =
                                                1
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      d
                                                   
                                                
                                             
                                          
                                          (
                                          
                                             δ
                                             
                                                
                                                   φ
                                                
                                                
                                                   a
                                                
                                                
                                                   k
                                                
                                             
                                             ·
                                             
                                                
                                                   S
                                                
                                                
                                                   a
                                                
                                                
                                                   k
                                                
                                             
                                             +
                                             
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                             Tr
                                             [
                                             
                                                δ
                                                
                                                   
                                                      
                                                         
                                                            θ
                                                         
                                                         
                                                            ˜
                                                         
                                                      
                                                   
                                                   
                                                      a
                                                   
                                                   
                                                      k
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            H
                                                         
                                                         
                                                            ˜
                                                         
                                                      
                                                   
                                                   
                                                      a
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                             ]
                                          
                                          )
                                          .
                                       
                                    
                                 where 
                                    
                                       (55)
                                       
                                          
                                             
                                                S
                                             
                                             
                                                a
                                             
                                             
                                                k
                                             
                                          
                                          =
                                          −
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      g
                                                   
                                                
                                             
                                          
                                          
                                             
                                                w
                                             
                                             
                                                i
                                             
                                          
                                          N
                                          (
                                          
                                             
                                                ξ
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          N
                                          
                                             
                                                (
                                                
                                                   
                                                      ξ
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                             
                                                k
                                             
                                          
                                          
                                          and
                                          
                                          
                                             
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                a
                                             
                                             
                                                k
                                             
                                          
                                          =
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      g
                                                   
                                                
                                             
                                          
                                          
                                             
                                                w
                                             
                                             
                                                i
                                             
                                          
                                          N
                                          (
                                          
                                             
                                                ξ
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          
                                             
                                                M
                                             
                                             
                                                ˜
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      ξ
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                             
                                                k
                                             
                                          
                                          .
                                       
                                    
                                 Then, the linear part of discrete action is obtained as 
                                    
                                       (56)
                                       
                                          δ
                                          
                                             
                                                S
                                             
                                             
                                                d
                                             
                                          
                                          =
                                          
                                             
                                                ∑
                                             
                                             
                                                k
                                                =
                                                0
                                             
                                             
                                                N
                                                −
                                                1
                                             
                                          
                                          δ
                                          
                                             
                                                L
                                             
                                             
                                                d
                                             
                                          
                                          (
                                          
                                             
                                                Φ
                                             
                                             
                                                h
                                             
                                             
                                                k
                                                +
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                Φ
                                             
                                             
                                                h
                                             
                                             
                                                k
                                             
                                          
                                          )
                                          ,
                                          =
                                          
                                             
                                                ∑
                                             
                                             
                                                a
                                                =
                                                1
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      d
                                                   
                                                
                                             
                                          
                                          (
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   k
                                                   =
                                                   0
                                                
                                                
                                                   N
                                                   −
                                                   1
                                                
                                             
                                             −
                                             δ
                                             
                                                
                                                   φ
                                                
                                                
                                                   a
                                                
                                                
                                                   k
                                                
                                             
                                             ·
                                             [
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      b
                                                      =
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            d
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      ab
                                                   
                                                
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            φ
                                                         
                                                         
                                                            b
                                                         
                                                         
                                                            k
                                                            +
                                                            1
                                                         
                                                      
                                                      −
                                                      2
                                                      
                                                         
                                                            φ
                                                         
                                                         
                                                            b
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            φ
                                                         
                                                         
                                                            b
                                                         
                                                         
                                                            k
                                                            −
                                                            1
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      Δ
                                                      t
                                                   
                                                
                                                +
                                                Δ
                                                t
                                                (
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         a
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         a
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                                )
                                             
                                             ]
                                          
                                          
                                             +
                                             Tr
                                             [
                                             
                                                δ
                                                
                                                   
                                                      
                                                         
                                                            θ
                                                         
                                                         
                                                            ˜
                                                         
                                                      
                                                   
                                                   
                                                      a
                                                   
                                                   
                                                      k
                                                   
                                                
                                                (
                                                
                                                   
                                                      
                                                         
                                                            
                                                               [
                                                               
                                                                  
                                                                     
                                                                        R
                                                                     
                                                                     
                                                                        a
                                                                     
                                                                     
                                                                        k
                                                                     
                                                                  
                                                                  −
                                                                  
                                                                     
                                                                        R
                                                                     
                                                                     
                                                                        a
                                                                     
                                                                     
                                                                        k
                                                                        −
                                                                        1
                                                                     
                                                                  
                                                               
                                                               ]
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                      
                                                      
                                                         Δ
                                                         t
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         Δ
                                                         t
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         
                                                            h
                                                         
                                                         
                                                            a
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            H
                                                         
                                                         
                                                            a
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                   )
                                                
                                                )
                                             
                                             ]
                                          
                                          )
                                          =
                                          0
                                          .
                                       
                                    
                                 
                              

@&#REFERENCES@&#

