@&#MAIN-TITLE@&#An adaptive mesh refinement method for a medium with discrete fracture network: The enriched Persson’s method

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           An adaptive mesh refinement method is developed to triangulate fractured media.


                        
                        
                           
                           Persson’s mesh generation method is enriched.


                        
                        
                           
                           Varying size and density of meshes around fractures can be produced.


                        
                        
                           
                           An assessment method of mesh size quality is proposed.


                        
                        
                           
                           The enriched meshing method is advantageous in generating a high resolving mesh.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Discrete fracture network

Adaptive mesh refinement

Analogous force equilibrium

Optimized mesh size function

Enriched Persson’s method

@&#ABSTRACT@&#


               
               
                  Discrete fracture network has significant effects on the thermal–hydraulic–mechanical–chemical coupling analysis in a highly fractured medium. Due to the complex configuration of interior fracture network, generation of a high resolving mesh is crucial in achieving accurate numerical results. An adaptive mesh refinement method is developed for generating adaptive meshes in a domain with discrete fracture networks. An optimized size function is embedded into Persson’s mesh generator. The constrained Delaunay triangulation algorithm is integrated into the analogous force equilibrium method. An assessment method of mesh size quality is proposed. Fractures are pre-meshed with a user-specified length in advance. The whole domain is then adaptively meshed using a constrained Delaunay method in a locally relaxation manner. Varying meshes can be generated with fine meshes around fractures and coarse meshes in the domain. Two case studies are carried out and compared with those obtained from conventional methods. Results show that the present method is advantageous in generating a high resolving mesh. Finer meshes are adaptively generated around fractures and gradually changed to sparser meshes away from fractures. Smoothly and gradually varying meshes are generated with little sacrifice of the size and angle quality. The adaptive mesh refinement method can be used for a wide range of thermal, hydraulic, mechanical, chemical simulations and their numerical coupling system in a fractured medium.
               
            

@&#INTRODUCTION@&#

Numerical modeling plays an important role in understanding the combined effect of thermal–hydraulic–mechanical–chemical (THMC) coupling which has been attracting more and more researchers’ interests in the past years. However, most of the available studies were focused on THMC analyses of continuous media. For highly fractured media, the discrete fracture network affects significantly the THMC properties and the continuum based numerical methods become not appropriate [1,2]. On the other hand, configurations of a fractured porous medium (a dual medium) are highly complex due to the existence of a large number of internal fractures [3]. The dual geological material is considered multi-scale heterogeneous, which requires an efficient and accurate discretization of the fractures as well as the matrix [4]. Generating a high resolving mesh is equally important and as critical as the numerical simulations of THMC analysis. Various meshing algorithms have been proposed in open literature to simplify the highly complex simulation of fractured porous media. For example, simplification procedures using 2D/3D structured grid [5], 2D/3D unstructured grid [6,7], 2D/3D local transformation of the fractures [7,8], more details can be referred to the G23FM, a mesh generation tool for discretizing two- and three-dimensional complex fractured geological medium in [4]. Most of these methods were based on a non-optimal and global transformation of the fractures, which cannot generate fine grids around fractures. The Graf method can generate fine triangles close to fractures and identify certain tetrahedron faces as fracture faces. However, this method becomes computationally costly and difficult to handle situations with complex and numerous fractures [6,8]. The Hussein method locally transforms the complex and critical geometric configuration which ensures the structure of globally connected fractures mostly unchanged [7,8]. However, the mesh quality still needs to be improved [8]. Though there also exist various smoothing and improving methods of triangulation, the Laplacian smoothing [9–11], some optimization-based smoothing schemes [12–14], the priori-based approach [15], the geometric element transformation method [16] and so on, most of them cannot handle problems with complex interior fractures. Detailed discussion can be referred in articles [16–18]. Another alternative but different way to construct complex geometries of discrete fracture networks is the meshfree or meshless method. Rabczuk and Belytschko present complex geometries based on constrained Delaunay triangulations and level sets in the context of meshfree methods [19]. Other efficient enriched methods for complex fracture geometries are also investigated in 2-D [20–23] and 3-D [24,25].

Here, in order to adaptively control mesh quality, an adaptive mesh refinement method is developed in the present study based on Persson and Strang’s mesh generator, which is demonstrated with very high quality [26,27]. Node locations are found by solving for equilibrium in a truss structure using piecewise linear force–displacement relations. Mesh topology is reset by the Delaunay algorithm in the previous mesh generator [26], but updated by a constrained Delaunay algorithm to fulfill complex internal fractures in our enriched method. Holm et al. also presented a meshing method for domains with internal boundaries based on the griding algorithm of Persson and Strang [27]. In addition, Holm et al. compared the mesh generator with the well regarded Triangle program [28], where both element quality and simulation performance are checked. They stated that the mesh generator almost always produced higher quality meshes by all conventional measures [27]. However, Holm’s meshes were almost uniform and equilateral triangles, and they did not consider the requirement of a finer mesh near fractures where pressure gradients vary greatly in water flow simulations.

The present method is able to adaptively mesh a highly fractured porous medium with mesh density constraints at and around fractures. The mesh density is changed around fractures. In addition, the present study is compared with Holm’s meshing results for a few examples, which shows that finer and gradually changing meshes are obtained around fractures with little sacrifice of mesh quality [29].


                     Section 2.1 briefly discusses the distance function which governs the geometry of the dual medium. Section 2.2 presents the analogy force equilibrium algorithm based on analogy between a triangular mesh and a 2-D truss structure. Section 2.3 investigates how a mesh size function controls mesh density and the gradient. Section 2.4 briefly introduces the constrained Delaunay method. Section 2.5 defines two mesh quality evaluation methods. Section 3 carries out two case studies. Section 4 analyzes the results and carries out some discussion. Finally, some conclusions of the present adaptive mesh refinement method are drawn in Section 5.

Persson’s mesh generation method is enriched to generate high resolving meshes for fractured dual media. An optimized size function is embedded into Persson’s mesh generator. The Delaunay triangulation algorithm is updated by a two-step meshing algorithm of pre-meshing of discrete fracture networks and constrained Delaunay triangulation of dual media. An assessment method of mesh size quality is proposed.

Firstly, fractures are pre-meshed with a user-assigned length. Secondly, the whole domain is meshed using a constrained Delaunay method in a local relaxation manner. Points around fractures are connected to the pre-meshed points on fractures. Mesh edges in domains are prevented from intersecting with fractures. In addition, owing to the analogous force equilibrium and the optimized mesh size function, points will move away from each other and distributed adaptively based on the mesh size function. There will be no points too close to or too far away from fractures. In addition, the proposed size quality indirectly represents the gradients of the actual mesh and verifies the size function.

Distance function, d(x, y) determines whether a node is inside or outside a domain. It can be represented in terms of a curved function, a circular or elliptical equation, or some Boolean operations of several geometries, or even some discretized values at nodes. More details can be gained by referring to Chapter 2 in Persson’s doctoral thesis [30]. The distance function will be embedded into the mesh size function in Section 2.3 where a special distance function, d
                        
                           i
                        (p), is integrated into the Persson’s mesh generator.

The mesh generation algorithm is based on a mechanical analogy between a triangular mesh and a 2-D truss structure, or an equivalent structure of springs. Positions of nodes are found by solving for static force equilibrium of the truss structure [26]. The force vector at mesh points is an array,
                           
                              (1)
                              
                                 F
                                 (
                                 p
                                 )
                                 =
                                 [
                                 
                                    
                                       F
                                    
                                    
                                       int
                                       
                                       ,
                                       x
                                    
                                 
                                 (
                                 p
                                 )
                                 +
                                 
                                    
                                       
                                          
                                             
                                                
                                                   F
                                                
                                                
                                                   e
                                                   x
                                                   t
                                                   ,
                                                   x
                                                
                                             
                                             (
                                             p
                                             )
                                          
                                       
                                    
                                 
                                 
                                 
                                    
                                       F
                                    
                                    
                                       int
                                       
                                       ,
                                       y
                                    
                                 
                                 (
                                 p
                                 )
                                 +
                                 
                                    
                                       F
                                    
                                    
                                       ext
                                       ,
                                       y
                                    
                                 
                                 (
                                 p
                                 )
                                 ]
                              
                           
                        where F
                        int are the internal forces from edges (connections of mesh points), F
                        ext are the external forces from boundary reactions, and p is an MN-by-2 coordinate matrix of mesh points (MN is the number of mesh points).

The external forces come from reaction forces acting normal to the boundary. The magnitude of this force is determined by the distance function and it is just large enough to prevent nodes from moving outside the domain. The internal force function has been investigated before [31,32], as argued by Persson and Strang [26], a linear function correspond to a linear elastic truss structure is modeled,
                           
                              (2)
                              
                                 f
                                 (
                                 l
                                 ,
                                 
                                    
                                       l
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                k
                                                (
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      0
                                                   
                                                
                                                −
                                                l
                                                )
                                             
                                          
                                          
                                             
                                                0
                                                ,
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ,
                                       
                                       
                                          
                                             l
                                             <
                                             
                                                
                                                   l
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             l
                                             ≥
                                             
                                                
                                                   l
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where f(l,l
                        0) is the internal force in each truss bar, l, and l
                        0 are the actual and desired length of edge.

Eq. (2) only allows positive repulsive forces but no attractive forces. Thus, mesh points will move away from each other and spread out across the mesh domain. In addition, the desired edge length is not an actual size but a relative distribution over the whole geometry, the mesh size function h(x,y). This function avoids an implicit desired length at each node (which is unknown before meshing), and therefore makes it possible to adaptively control the mesh density according to geometrical adaptively as well as other user-defined expressions.

Mesh points p is then solved from the equilibrium system F(p)=0. However, it is not easy to solve the equilibrium system directly because the system is a discontinuous of mesh points p. An alternative way is a pseudo time stepping method,
                           
                              (3)
                              
                                 
                                    
                                       d
                                       p
                                    
                                    
                                       d
                                       t
                                    
                                 
                                 =
                                 F
                                 (
                                 p
                                 )
                                 ,
                                 
                                 t
                                 ≥
                                 0
                              
                           
                        
                     

Eq. (3) is then discretized explicitly using the forward Euler method, whereby,
                           
                              (4)
                              
                                 p
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                 
                                 )
                                 =
                                 p
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       n
                                    
                                 
                                 )
                                 +
                                 Δ
                                 t
                                 ⋅
                                 F
                                 (
                                 p
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       n
                                    
                                 
                                 )
                                 )
                              
                           
                        
                     

After each time step, new mesh points, p(t
                        
                           n+1) are deduced from the pre-step known positions p(t
                        
                           n
                        ), and new triangulation is generated by a constrained Delauney algorithm using p(t
                        
                           n+1). This is different from Persson’s mesh generator in which the delauney algorithm is applied. Finally, the iteration terminates once norm of F(p
                        t(
                           n+i
                        )) approximately equals to zero.

Fine mesh on and around fractures is required in a wide range of numerical simulations. Though some mesh generation algorithms do not assign an explicit size function [33,34], it is advantageous if a mesh size function is known prior to triangulation [35], such as the advancing front method [36], the paving method for quadrilateral meshes [37] and the Persson’s mesh generator [30]. Introduction of a mesh size function will greatly enhance the capabilities of size functions as well as improve the quality of poor background mesh vertices and pre-meshed source entities [38–42]. An implicit mesh size function is introduced and optimized from Persson’s algorithm to control mesh density around fractures,
                           
                              (5)
                              
                                 h
                                 (
                                 p
                                 )
                                 =
                                 
                                    
                                       min
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       F
                                       N
                                    
                                 
                                 {
                                 
                                    
                                       h
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 p
                                 )
                                 +
                                 
                                    
                                       g
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 p
                                 )
                                 ⋅
                                 
                                    
                                       d
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 p
                                 )
                                 ,
                                 
                                    
                                       h
                                    
                                    
                                       0
                                       
                                       max
                                    
                                 
                                 (
                                 p
                                 )
                                 }
                              
                           
                        where h(p) is the mesh size function for all mesh grids, FN is the number of fractures, h
                        
                           i
                        (p), h
                        0max(p), g
                        
                           i
                        (p) and d
                        
                           i
                        (p) are the assigned mesh size, maximum size, gradient limitation and distance function originated from the ith fracture.


                        h
                        
                           i
                        (p), h
                        0max(p), g
                        
                           i
                        (p) and d
                        
                           i
                        (p) can be input as a constant value or a distribution function of space. Thus, unstructured meshes can be adaptively generated to resolve fine features of the geometry and the curvature of boundaries. Though it would be interesting to carry out some examples for curved fractures, the present study will only focus on the algorithms of the enriched Persson’s meshing method for a medium with interior straight fractures. In addition, due to the complexity of fracture configuration, most of the fractures in 2-D domain are interpreted as straight segments in the literature. Curved fractures can be represented by several straight line segments. Detailed discussion and case studies of the adaptive functions for curved fractures and boundaries can be referred in Chapter 4 in Persson’s doctoral dissertation [30].


                        h
                        
                           i
                        (p), h
                        0max(p) and g
                        
                           i
                        (p) in the present study are set to be constant values, l
                        cst, l
                        max and g. As discussed in Section 3, l
                        cst is the mesh size on fractures (the constrained edge length), l
                        max is the maximum mesh size in the whole domain and g is the gradient limitation. The selection criterion of these parameters is also discussed in detail in Section 3.


                        d
                        
                           i
                        (p) is the distance function,
                           
                              (6)
                              
                                 
                                    
                                       d
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 p
                                 )
                                 =
                                 f
                                 (
                                 
                                    p
                                    1
                                 
                                 ,
                                 
                                    p
                                    2
                                 
                                 )
                              
                           
                        where p is a random point in the domain, p
                        1 and p
                        2 are the end points of a fracture.


                        d
                        
                           i
                        (p) varies between zero and the positive infinity which means that the point p is on the fracture segment p
                        1
                        p
                        2 or far away from p
                        1
                        p
                        2. Thus, the mesh size function 
                           
                              
                                 h
                              
                              
                                 i
                              
                           
                           (
                           p
                           )
                           +
                           
                              
                                 g
                              
                              
                                 i
                              
                           
                           (
                           p
                           )
                           ⋅
                           
                              
                                 d
                              
                              
                                 i
                              
                           
                           (
                           p
                           )
                         also varies between zero and the positive infinity. Detailed discussion of the distance function can be referred in [30]. However, a big gap between the smallest and the largest mesh size of elements will reduce the accuracy of numerical simulations. When fractures are sparsely distributed in the domain, it is quite important to define a proper maximum mesh size, so that no triangles will exceed the maximum size length. This is why the parameter of the maximum mesh size is introduced. The mesh size function is actually a Boolean operation of union for all size functions generated from each fracture. It is locally symmetrical to fractures and varies without any direction. Thus, high quality of meshes without any sharp change can be adaptively controlled, which is also a highlight of the present approach.

Delaunay triangulation has been widely used in scientific computing and numerical simulations. The fundamental property of a Delaunay scheme is the empty circumcircle criterion. This criterion ensures the circumcircle associate with each triangle contains no other points in its interior. This criterion is very important because it makes the Delaunay triangulation to be well shaped, i.e., triangles with large internal angles are selected over ones with small internal angles [13]. Thus, the minimum angle would be maximized which generates as equilateral triangles as possible. The largest value of the minimum angle is obtained in each triangle. In addition, the circumcircle criterion also ensures the Delaunay triangulation connects points to the nearest neighbor points [27,43–45].

Though well shaped mesh can be gained from the Delaunay method, a set of points should be generated in advance of triangulation. This is the reason why the analogous force equilibrium and the distance-based mesh size function are proposed and integrated.

Moreover, for a fractured dual medium, there should be a large number of internal constrained fractures which allows no crossing edges. Thus, fractures are pre-meshed with a user-assigned length.

Meshing of fracture networks is quite simple. A fracture line, no. k, is meshed into Nk
                            parts based on the constraint mesh size l
                           cst on fractures as in Eq. (7),
                              
                                 (7)
                                 
                                    
                                       N
                                       k
                                    
                                    =
                                    
                                    int
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                            )
                                                         
                                                         2
                                                      
                                                      +
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  y
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  y
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                            )
                                                         
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      cst
                                                   
                                                
                                             
                                          
                                       
                                       }
                                    
                                 
                              
                           where int represents the round function, (x
                           
                              i
                           ,y
                           
                              i
                           ) and (x
                           
                              j
                           ,y
                           
                              j
                           ) are the end points’ coordinates of a line segment.

One thing to note is that all lines should be broken into separate line segments at the intersection point so that intersection lines connect to the same overlapping point. As shown in 
                           Fig. 1(a), intersection fractures V
                           1
                           V
                           2 and V
                           3
                           V
                           4 are broken into separate segments of V
                           1
                           V
                           5, V
                           5
                           V
                           2, V
                           3
                           V
                           5 and V
                           5
                           V
                           4 so that they are connected by the intersection node V
                           5. On the contrary, intersection lines V
                           1
                           V
                           2 and V
                           3
                           V
                           4 in Fig. 1(b) are wrongly meshed and cause a non-connection of meshes on different lines.

The whole domain is meshed using a constrained Delaunay method in a locally relaxation manner [43]. Points around fractures are connected to the pre-meshed points on fractures. Mesh edges in the domain are prevented from intersecting with fractures. So triangulation around fractures is relaxed and maybe invalidates the nearest-neighbor relation as well as the empty circumcircle criterion. However, due to the analogous force equilibrium and the distance-based mesh size function, points will move away from each other based on the mesh size function, and therefore there will be no points too close to or too far away from fractures.

In a word, mesh points are updated by solving for the analogous force equilibrium via a pseudo time stepping method (Sections 2.2 and 2.3), and triangulated by a constrained Delaunay method (Section 2.4).

Mesh quality is critical for the accuracy and efficiency of a simulation based on the solution of partial differential equations [46,47]. Knupp stated there were no formal definitions of mesh quality appearing in literatures, however he defined that mesh quality concerned the characteristics of a mesh that permitted a particular numerical PDE simulation to be efficiently performed, with fidelity to the underlying physics, and with the accuracy required for the problem [47,48]. A lot of literature discuss mesh quality in detail [49–51].

As argued by Persson and Strang [26], one commonly used angle quality measurement is introduced,
                              
                                 (8)
                                 
                                    
                                       
                                          q
                                       
                                       
                                          angle
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    
                                       
                                          (
                                          
                                             
                                                l
                                             
                                             
                                                1
                                             
                                             
                                                i
                                             
                                          
                                          +
                                          
                                             
                                                l
                                             
                                             
                                                2
                                             
                                             
                                                i
                                             
                                          
                                          −
                                          
                                             
                                                l
                                             
                                             
                                                3
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          ⋅
                                          (
                                          
                                             
                                                l
                                             
                                             
                                                1
                                             
                                             
                                                i
                                             
                                          
                                          +
                                          
                                             
                                                l
                                             
                                             
                                                3
                                             
                                             
                                                i
                                             
                                          
                                          −
                                          
                                             
                                                l
                                             
                                             
                                                2
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          ⋅
                                          (
                                          
                                             
                                                l
                                             
                                             
                                                2
                                             
                                             
                                                i
                                             
                                          
                                          +
                                          
                                             
                                                l
                                             
                                             
                                                3
                                             
                                             
                                                i
                                             
                                          
                                          −
                                          
                                             
                                                l
                                             
                                             
                                                1
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                       
                                          
                                             
                                                l
                                             
                                             
                                                1
                                             
                                             
                                                i
                                             
                                          
                                          ⋅
                                          
                                             
                                                l
                                             
                                             
                                                2
                                             
                                             
                                                i
                                             
                                          
                                          ⋅
                                          
                                             
                                                l
                                             
                                             
                                                3
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 
                                    l
                                 
                                 
                                    1
                                 
                                 
                                    i
                                 
                              
                           , 
                              
                                 
                                    l
                                 
                                 
                                    2
                                 
                                 
                                    i
                                 
                              
                           , 
                              
                                 
                                    l
                                 
                                 
                                    3
                                 
                                 
                                    i
                                 
                              
                            are the edge length of the ith triangle and i is from 1 to TN (TN is the number of triangles).

Eq. (8) is twice the ratio between the radius of the circumcircle (the smallest circle that circumscribes the triangle) and the radius of the incircle (the largest circle inscribes the triangle). If the interior angle of the triangle equals to π/3, the angle quality is optical and equal to one. If the triangle is degenerated, the angle quality is unacceptable and equal to zero. Mesh quality is usually deemed acceptable or good while the angle quality 
                              
                                 
                                    q
                                 
                                 
                                    angle
                                 
                                 
                                    i
                                 
                              
                            is more than 0.5 or 0.6 [27,30].

Another important mesh quality parameter is the size quality. Holm et al. compared the deviation of the edge size from the mean size of all edges, and stated the ratio ended up between zero and one [27]. However, their ratio was actually between the negative infinity and the positive infinity, and only ended up between zero and one for some special cases (discuss in detail in Section 4). Furthermore, size differences between adjacent triangles can have a large influence upon numerical simulations. Thus, a new assessment method of size quality is proposed,
                              
                                 (9)
                                 
                                    
                                       
                                          q
                                       
                                       
                                          size
                                       
                                       
                                          i
                                          −
                                          j
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            2
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                      /
                                                      (
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            2
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            2
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      <
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            2
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            2
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      )
                                                      /
                                                      (
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            2
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            2
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ≥
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            2
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 
                                    l
                                 
                                 
                                    1
                                 
                                 
                                    i
                                 
                              
                           , 
                              
                                 
                                    l
                                 
                                 
                                    2
                                 
                                 
                                    i
                                 
                              
                           , 
                              
                                 
                                    l
                                 
                                 
                                    1
                                 
                                 
                                    j
                                 
                              
                            and 
                              
                                 
                                    l
                                 
                                 
                                    2
                                 
                                 
                                    j
                                 
                              
                            are the edge length of the two adjacent triangles except the common edge 
                              
                                 
                                    l
                                 
                                 
                                    3
                                 
                                 
                                    i
                                 
                              
                            and 
                              
                                 
                                    l
                                 
                                 
                                    3
                                 
                                 
                                    j
                                 
                              
                           .

The size quality 
                              
                                 
                                    q
                                 
                                 
                                    size
                                 
                                 
                                    i
                                    -
                                    j
                                 
                              
                            ends up between zero and one which means that sizes of two adjacent triangles are completely different and nearly the same, respectively. Eq. (9) indirectly represents the gradients of the actual mesh, and therefore it is also a test function of the mesh size function.

Recommended threshold of the size quality can be deduced from the recommended angle quality of 0.5 or 0.6. As shown in 
                           Fig. 2, supposing that there is a fracture at O(0,0) and two triangular meshes AOB and ABC (
                              
                                 
                                    l
                                 
                                 
                                    1
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    l
                                 
                                 
                                    2
                                 
                                 
                                    1
                                 
                              
                              =
                              l
                              ,
                              
                                 
                                    l
                                 
                                 
                                    3
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    l
                                 
                                 
                                    0
                                 
                              
                           ), it can be deduced from Eq. (8) that,
                              
                                 (10)
                                 
                                    
                                       
                                          q
                                       
                                       
                                          angle
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          (
                                          2
                                          l
                                          −
                                          
                                             
                                                l
                                             
                                             
                                                0
                                             
                                          
                                          )
                                          ⋅
                                          
                                             
                                                l
                                             
                                             
                                                0
                                             
                                          
                                       
                                       
                                          
                                             
                                                l
                                             
                                             2
                                          
                                       
                                    
                                 
                              
                           when 
                              
                                 
                                    q
                                 
                                 
                                    angle
                                 
                                 
                                    1
                                 
                              
                            equals to 0.5,
                              
                                 (11)
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      
                                                         l
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                
                                                l
                                             
                                          
                                          )
                                       
                                       
                                          1
                                          ,
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                1.7071
                                                ,
                                             
                                          
                                          
                                             
                                                0.2929
                                             
                                          
                                       
                                    
                                 
                              
                           where (l
                           0/l)1,2 belongs to the triangular meshes AOB and ABC, respectively.

Thus, the size quality is
                              
                                 (12)
                                 
                                    
                                       
                                          q
                                       
                                       
                                          size
                                       
                                       
                                          1
                                          -
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          0.2929
                                       
                                       
                                          1.7071
                                       
                                    
                                    =
                                    0.1716
                                 
                              
                           
                        

The interior angles of the triangular mesh AOB are
                              
                                 (13)
                                 
                                    ∠
                                    OAB
                                    =
                                    ∠
                                    OBA
                                    =
                                    31
                                    °
                                    ,
                                    ∠
                                    AOB
                                    =
                                    116
                                    °
                                 
                              
                           or
                              
                                 (14)
                                 
                                    ∠
                                    OAB
                                    =
                                    ∠
                                    OBA
                                    =
                                    82
                                    °
                                    ,
                                    ∠
                                    AOB
                                    =
                                    16
                                    °
                                 
                              
                           
                        

when 
                              
                                 
                                    q
                                 
                                 
                                    angle
                                 
                                 
                                    1
                                 
                              
                            equals to 0.6,
                              
                                 (15)
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      
                                                         l
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                
                                                l
                                             
                                          
                                          )
                                       
                                       
                                          1
                                          ,
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                1.6325
                                                ,
                                             
                                          
                                          
                                             
                                                0.3675
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (16)
                                 
                                    
                                       
                                          q
                                       
                                       
                                          size
                                       
                                       
                                          1
                                          -
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          0.3675
                                       
                                       
                                          1.6325
                                       
                                    
                                    =
                                    0.2251
                                 
                              
                           
                           
                              
                                 (17)
                                 
                                    ∠
                                    OAB
                                    =
                                    ∠
                                    OBA
                                    =
                                    35
                                    °
                                    ,
                                    ∠
                                    AOB
                                    =
                                    110
                                    °
                                 
                              
                           or
                              
                                 (18)
                                 
                                    ∠
                                    OAB
                                    =
                                    ∠
                                    OBA
                                    =
                                    79
                                    °
                                    ,
                                    ∠
                                    AOB
                                    =
                                    22
                                    °
                                 
                              
                           
                        

Thus, the recommended threshold of size quality should be 0.2 or 0.3. Mesh quality is acceptable or good while the size quality is greater than or equal to 0.2 or 0.3.

Mesh properties are investigated by adopting our enriched Persson’s method in the following section. Case studies are compared with some conventional method based on the angle and size quality in conjunction with visual inspections. In order to compare with available methods, geometries of the fracture networks for the first case study are graphically captured from the works of Holm [27]. The fracture network of the second case study is randomly generated with fewer fractures. This case study is carried out to further illustrate the high quality of our newly proposed approach, the enriched Persson’s method. The difference between the two case studies is that fracture density of the second is sparser which demonstrates a clearer and more distinct understanding of the unstructured varying meshes, from fine meshes on and around fractures to coarse meshes away from fractures.

Approximately same numbers of triangles (3136 in this example) are generated using the enriched Persson’s method so as to compare with Holm’s results, 3164 elements for the Triangle method, 3108 for the Patched method and 3134 for the Persson’s method (see 
                        Fig. 3). In Holm’s study, the Triangle method was introduced from [28]. However, this method may produce some cobwebs around fractures that intersect at a steep angle (see Fig. 3(a) near the top right corner). So they create a patch subroutine embedded in the Triangle program to inhibit refinement cascade for triangles below a certain specified size. The refinement treats the centroid as an estimator of the child element size, which may cause very bad quality triangles. Finally, they revised the analogous force-equilibrium method of Persson and conclude that this approach always provides higher quality meshes [27].

However, as shown in Fig. 3(a)–(c), it is easy to see that these methods do not produce gradually changing meshes around fractures, where finer meshes are required to resolve details around fractures and larger meshes are needed to reduce the computational burdon. The enriched Persson’ method meets the requirement well and produces ideal meshes as shown in Fig. 3(d) and 
                        Fig. 4.

Moreover, Fig. 4 illustrates the high flexibility of the present method that different mesh densities can be produced based on a constrained mesh size of fractures (l
                        cst) and a gradient limitation (g). Since fractures are intensively distributed in the whole domain, the maximum mesh size function h
                        0max(p) is set to be larger enough (e.g., 20) than all the adaptively generated size.

This section focuses on the qualitative investigation of mesh quality, i.e., only by visual inspections. Quantitative probes of the angle and size quality will be discussed in Section 4 on the percentile curve, mean, standard deviation and first percentile of quality.

Though case study no. 1 already illustrates the high performance of the present approach, fracture densities are too high to reveal the advantages of the size function. Another two examples of stochastically generated fracture networks and the corresponding triangulations are carried out. As shown in 
                        Fig. 5, meshes change smoothly over the whole domain, and there is no sharp change. However, for conventional software (e.g., ANSYS), auxiliary lines should be added to generate blocks before meshing. Sharp changes will be produced at auxiliary lines and boundaries of blocks. Meshes of different blocks are generated separately without smooth connections. Moreover, no regular patterns can be gained to add auxiliary lines and to generate blocks. This work has to be done manually (one at a time), which is tedious labor for the users and is impossible to handle problems with numerous fractures.

Angle and size quality of case study no. 1 are probed in this section. Corresponding to Fig. 3(d), angle and size quality of all elements are investigated and plotted in 
                     Fig. 6 based on the percentile concept. A percentile means the value of the angle or size quality below which a certain percent of observations fall. For instance, the first percentile is the angle or size quality below which one percent of meshes can be found.

As shown in Fig. 6, both angle and size quality increase sharply from a lower percentile to a higher percentile. Angle and size quality also increase with numbers of elements.
                        
                           1.
                           Angle quality

Only a few triangles are badly shaped, less than one percent, e.g., only 0.56%, 0.28%, 0.28%, 0.12% and 0.08% of the triangles’ angle quality is under 20% for TN equals to 1606 (l
                              cst=3.5), 2302(l
                              cst=3), 2939(l
                              cst=2.5), 4019(l
                              cst=2) and 6015 (l
                              cst=1.5). Most of the elements are well shaped with high quality, e.g., more than 74.19%, 81.76%, 83.43%, 87.22% and 89.17% of the triangles’ angle quality is above 80% for TN equals to 1606, 2302, 2939, 4019 and 6015.

Size quality

Size quality is excellent and no size quality is under 20% for all case studies. This exciting result demonstrates the high performance of the distance-based mesh size function. Only 2.03%, 0.87%, 0.58%, 0.18% and 0.14% of the size quality is under 50% for TN equals to 1606 (l
                              cst=3.5), 2302 (l
                              cst=3), 2939 (l
                              cst=2.5), 4019 (l
                              cst=2) and 6015 (l
                              cst=1.5). Most of the elements are well shaped with high quality, e.g., more than 65.05%, 70.23%, 70.62%, 71.10% and 70.86% of the size quality is above 80% for TN equals to 1606, 2302, 2939, 4019 and 6015.

A detailed discussion on the mean, standard deviation and first percentile of angle quality is carried out. Our enriched method is compared with the Triangle, Patched and Persson method after [27] (
                        Fig. 7(a)). Mean angle quality increases with number of elements for all methods. The revised Persson method performs best, while our method produces better meshes than the Triangle and Patched method. However, angle quality of the revised Persson method is only a little better than the enriched method. This is reasonable and acceptable because that our enriched method adopts varying meshes. A little sacrifice of angle quality is worth for better numerical performance. Moreover, standard deviation of angle quality decreases as the number of elements increase (Fig. 7(b)). Angle quality is very good with a small standard deviation decreasing from 14.25% to 8.66% (TN from 1606 to 6015). The first percentile and minimum value of angle quality reflects the worst situation of the mesh caused by steep and high density of intersections (
                        Fig. 8). Only a few elements are badly shaped. A compensation solution can be easily implemented with higher density and more elements.

As mentioned in Section 2.5, Holm proposed an assessment method of size quality and compared size quality of different meshes produced by the Triangle, Patched and Persson method [27],
                           
                              (19)
                              
                                 
                                    
                                       q
                                    
                                    
                                       size
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                l
                                                
                                                   ¯
                                                
                                             
                                          
                                          2
                                       
                                    
                                    
                                       
                                          
                                             
                                                l
                                                
                                                   ¯
                                                
                                             
                                          
                                          2
                                       
                                       −
                                       
                                          
                                             (
                                             
                                                l
                                                
                                                   ¯
                                                
                                             
                                             −
                                             
                                                
                                                   
                                                      
                                                         l
                                                      
                                                      i
                                                   
                                                
                                                
                                                   ¯
                                                
                                             
                                             )
                                          
                                          2
                                       
                                    
                                 
                              
                           
                        where 
                           
                              l
                              
                                 ¯
                              
                           
                           =
                           (
                           
                              1
                              /
                              n
                           
                           )
                           ∑
                           
                              
                                 
                                    l
                                 
                                 
                                    i
                                 
                              
                           
                         and 
                           
                              
                                 
                                    
                                       l
                                    
                                    i
                                 
                              
                              
                                 ¯
                              
                           
                           =
                           
                              
                                 (
                                 
                                    
                                       l
                                    
                                    
                                       1
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 
                                    
                                       l
                                    
                                    
                                       2
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 
                                    
                                       l
                                    
                                    
                                       3
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              /
                              3
                           
                         are the mean size of all edges and mean size of the ith triangle, 
                           
                              
                                 
                                    l
                                    
                                       ¯
                                    
                                 
                              
                              2
                           
                           −
                           
                              
                                 (
                                 
                                    l
                                    
                                       ¯
                                    
                                 
                                 −
                                 
                                    
                                       
                                          
                                             l
                                          
                                          i
                                       
                                    
                                    
                                       ¯
                                    
                                 
                                 )
                              
                              2
                           
                         is the deviation of ith element’s size.

However, Eq. (19) is not accurate for two reasons, one is that the value does not end up between zero and one but locates between the negative and the positive infinity, the other is that the size quality does not reflect the size ratio of two adjacent triangles. This equation means that size quality is proportional to the mean size which does not make any sense, but inversely proportional to the deviation which is actually true.

Thus, the size quality of the present study is not compared with previous research. As shown in 
                        Fig. 9, size quality of the enriched method tends to vary in a similar way, i.e., the size quality increases with the numbers of elements from 84.22% to 85.72% (TN from 1606 to 6015), while the standard deviation decreases from 12.09% to 9.43% when mesh density grows higher. As shown in 
                        Fig. 10, the first percentile of size quality is much larger than the angle quality. Especially, when the minimum size quality is between 25.86% and 38.08% (see Fig. 6 (b)). This is an exciting result which demonstrates the outstanding performance of the distance-based mesh size function.

In addition, our size quality is also a verification of the mesh size function. As shown in Fig. 2, supposing that there is a fracture at O(0,0) and two adjacent triangles centered at O1(x
                        1,0) and O2(x
                        2,0), by choosing a mean size quality of 85%, we can conclude from Eq. (9) that,
                           
                              (20)
                              
                                 
                                    
                                       q
                                    
                                    
                                       size
                                    
                                    
                                       1
                                       -
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             l
                                          
                                          
                                             1
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             l
                                          
                                          
                                             2
                                          
                                          
                                             1
                                          
                                       
                                    
                                    
                                       
                                          
                                             l
                                          
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             l
                                          
                                          
                                             2
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 ≈
                                 
                                    
                                       
                                          
                                             
                                                
                                                   l
                                                
                                                1
                                             
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   l
                                                
                                                2
                                             
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                 
                                 =
                                 85
                                 %
                              
                           
                        
                     

Since the constrained edge length l
                        cst (assigned mesh size of the fracture) is one in case study no. 1, the sizes of the two elements can be gained by referring to Eqs. (5) and (6),
                           
                              (21)
                              
                                 
                                    
                                       
                                          
                                             l
                                          
                                          1
                                       
                                    
                                    
                                       ¯
                                    
                                 
                                 ≈
                                 
                                    
                                       l
                                    
                                    
                                       c
                                       s
                                       t
                                    
                                 
                                 +
                                 
                                    
                                       
                                          3
                                       
                                    
                                    6
                                 
                                 
                                    
                                       
                                          
                                             l
                                          
                                          1
                                       
                                    
                                    
                                       ¯
                                    
                                 
                                 ⋅
                                 g
                              
                           
                        
                        
                           
                              (22)
                              
                                 
                                    
                                       
                                          
                                             l
                                          
                                          2
                                       
                                    
                                    
                                       ¯
                                    
                                 
                                 ≈
                                 
                                    
                                       l
                                    
                                    
                                       c
                                       s
                                       t
                                    
                                 
                                 +
                                 
                                    (
                                    
                                       
                                          
                                             
                                                3
                                             
                                          
                                          2
                                       
                                       
                                          
                                             
                                                
                                                   l
                                                
                                                1
                                             
                                          
                                          
                                             ¯
                                          
                                       
                                       +
                                       
                                          
                                             
                                                3
                                             
                                          
                                          6
                                       
                                       
                                          
                                             
                                                
                                                   l
                                                
                                                2
                                             
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    )
                                 
                                 ⋅
                                 g
                              
                           
                        
                     

Subtracting Eqs. (21) and (22) on both sides produces,
                           
                              (23)
                              
                                 
                                    
                                       
                                          
                                             l
                                          
                                          2
                                       
                                    
                                    
                                       ¯
                                    
                                 
                                 −
                                 
                                    
                                       
                                          
                                             l
                                          
                                          1
                                       
                                    
                                    
                                       ¯
                                    
                                 
                                 ≈
                                 
                                    (
                                    
                                       
                                          
                                             
                                                3
                                             
                                          
                                          3
                                       
                                       
                                          
                                             
                                                
                                                   l
                                                
                                                1
                                             
                                          
                                          
                                             ¯
                                          
                                       
                                       +
                                       
                                          
                                             
                                                3
                                             
                                          
                                          6
                                       
                                       
                                          
                                             
                                                
                                                   l
                                                
                                                2
                                             
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    )
                                 
                                 ⋅
                                 g
                              
                           
                        
                     

Then substituting Eq. (20) into Eq. (23) yields the actual gradient g=0.19 while 
                           
                              
                                 q
                              
                              
                                 size
                                 ,
                              
                              
                                 1
                                 -
                                 2
                              
                           
                         equals to 85%. Similarly, g=0.43 while 
                           
                              
                                 q
                              
                              
                                 size
                                 ,
                              
                              
                                 1
                                 -
                                 2
                              
                           
                           =
                           70
                           %
                        , g=0.12 while 
                           
                              
                                 q
                              
                              
                                 size
                                 ,
                              
                              
                                 1
                                 -
                                 2
                              
                           
                           =
                           90
                           %
                        , g=0 while 
                           
                              
                                 q
                              
                              
                                 size
                                 ,
                              
                              
                                 1
                                 -
                                 2
                              
                           
                           =
                           100
                           %
                        .

Since we use the trigonometric functions of equilateral triangles, this is an approximate way of evaluating the relationship between the actual gradient and the mean size quality. It is not accurate when the actual gradient of meshes is large (badly shaped mesh). Real trigonometric functions of the interior angle of the two adjacent elements should be used for assessment of non-approximately equilateral triangles. From this point of view, it can still be concluded that a lower gradient limitation produces a better quality of meshes. However, a little sacrifice of the size quality is worth for the high performance of numerical simulations with gradually and smoothly changed meshes.

One thing to note is that the enriched Persson’s meshing method can be extended into 3-D adaptive mesh refinement for discrete fracture networks and fractured dual media. For 3-D fracture networks, fractures can be meshed one by one where intersection lines of fractures will be treated as interior constraint boundaries as the fracture lines in the present study. For 3-D dual media, fractures are pre-meshed and set as constraints for the meshing of the 3-D domain. Then the 3-D domain is meshed by a 3-D constrained Delaunay method where every triangular element on fractures is a constraint element that allows no crossing. As in 2-D meshing of fractures, the analogous force equilibrium algorithm and the distance-based mesh size function can also be introduced to control mesh size and density. More details can be referred in Xu’s doctoral dissertation [29].

@&#CONCLUSIONS@&#

An adaptive mesh refinement method is proposed based on Persson’s mesh generation method. An optimized size function is embedded into Persson’s mesh generator. The constrained Delaunay triangulation algorithm is integrated into the analogous force equilibrium method. An assessment method of mesh size quality is proposed.

Case studies are carried out and compared with previous research which shows that the present method is advantageous in generating a high resolving mesh. Finer meshes are adaptively generated around fractures and gradually changed to sparser meshes away from fractures. Smoothly and gradually changed meshes can be generated with little sacrifice of the size and angle quality. The adaptive mesh refinement method can be used for a wide range of thermal, hydraulic, mechanical, chemical simulations and their numerical coupling system in a fractured medium. Moreover, this method can also be extended into 3-D adaptive mesh refinement for a fractured medium.

@&#ACKNOWLEDGMENTS@&#

We would like to acknowledge the financial support from the National Basic Research Program of China (973 Program, Grant no.: 2013CB036000), the Fundamental Research Funds of Shandong University (Grant no.: 2014GN028) and the State Key Laboratory for GeoMechanics and Deep Underground Engineering, China University of Mining & Technology (Grant no.: SKLGDUEK1309).

Last but not least, we would like to extend our gratitude to Prof. Per-Olof Persson in the University of California, Berkeley. We benefit a lot from his open source code of the mesh generator.

@&#REFERENCES@&#

