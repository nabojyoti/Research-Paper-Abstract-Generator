@&#MAIN-TITLE@&#Modeling metal deposition in heat transfer analyses of additive manufacturing processes

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           FEA techniques for modeling metal deposition in additive manufacturing are investigated.


                        
                        
                           
                           A new hybrid inactive/quiet element method is proposed for modeling additive manufacturing.


                        
                        
                           
                           Metal deposition element is initially inactive, then, they are switched to quiet layer by layer.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Additive manufacturing

Metal deposition

Element activation

Heat transfer

@&#ABSTRACT@&#


               
               
                  Additive Manufacturing (AM) processes for metallic parts using both laser and electron beam heat sources are becoming increasingly popular due to their potential of producing near net shape structural components. The thermal history generated by additive manufacturing is essential in determining the resulting microstructure, material properties, residual stress, and distortion.
                  In this work finite element techniques for modeling metal deposition heat transfer analyses of additive manufacturing are investigated in detail. In particular, both quiet and inactive element activation are reviewed in detail and techniques for minimizing errors associated with element activation errors are proposed. 1D and 3D numerical examples are used to demonstrate that both methods can give equivalent results if implemented properly. It is also shown that neglecting surface convection and radiation on the continuously evolving interface between active and inactive elements can lead to errors. A new hybrid quiet inactive metal deposition method is also proposed to accelerate computer run times.
               
            

@&#INTRODUCTION@&#

Additive Manufacturing (AM) processes for metallic parts using both laser and electron beam heat sources have the potential of producing near net shape structural components over a range of sizes (mm3 through m3). Applications range from customized medical implants to aerospace components. Both laser and electron beam based deposition systems have been utilized to deposit a range of materials. All Additive Manufacturing processes are similar in that a three dimensional part represented by a CAD file is sliced into layers (build plan) which in turn define scan trajectories of the heat source. A high power energy source (laser or electron beam) is used to heat and melt metal powder or wire, which solidifies to form a fully dense layer. The powder may be fed to the heat source through nozzles or may be raked into flat layers in powder bed systems. The addition of multiple layers can produce a three dimensional fully dense part.

Significant research has been devoted over the past ten years into investigating the effects of processing parameters on the resulting microstructure during additive manufacturing [1–7]. Another concern in additive manufacturing is distortion and residual stress [8–13]. The thermal history generated by additive manufacturing is essential in determining the resulting microstructure, material properties, residual stress, and distortion.

Modeling the thermal history of the additive manufacturing process is similar to modeling multi-pass welding [4,14–16]. Thermo-mechanical modeling of welding has been an active research area since the late 1970s [17–19]. A detailed review of finite element modeling for welding is available in references [20–27]. Typically, transient heat conduction analyses are performed in Lagrangian reference frames as opposed to Eulerian transport analyses which most often used to predict the temperature field and physical shape of the melt pool [28–32], buoyancy, surface tension, and magneto-hydro-dynamic effects [33], or powder melt pool interaction [34].

Building a complex part with additive manufacturing may require depositing hundreds or thousands of layers of material which compared to multi-pass welding introduces significant computational cost. Therefore, computational efficiency becomes paramount. Notable work in the thermal and microstructural modeling in additive manufacturing is available in Refs. [1–5,7]. Residual stress and deformation modeling is investigated in Refs. [14–16,35,36].

The material deposition in additive manufacturing is modeled by using inactive or quiet elements which are activated as the added material (powder or wire) solidifies. Two metal deposition methods are reported for modeling material deposition: (1) the use of quiet or (2) inactive elements [23,37,38]. In the quiet approach, the elements are present in the analysis but are assigned properties so they do not affect the analysis. In the inactive element approach, elements are not included in the analysis until the corresponding material has been added. A variety of general purpose commercial codes have been reportedly used to model metal deposition: Zhu et al. [39] use Ansys et al. [40,41] use Adina et al. [42] and Ye et al. [43] use Abaqus et al. [44] use Comsol, and Lundback and Lindgren [14] use Marc. However, the numerical approach implemented during element activation and potential sources of errors or numerical efficiency are not investigated in these references. In welding, the size filler metal is usually small compared to the base metal, and errors introduced by element activation may be negligible. However, in additive manufacturing, the size of the deposited material is significantly larger and thus element activation errors could be significant.

The objective of this work is to investigate finite element techniques for modeling metal deposition in heat transfer analyses of additive manufacturing and demonstrate potential sources of error. In particular, both quiet and inactive element activation are reviewed in detail and techniques for minimizing errors associated with element activation errors are proposed. 1D and 3D numerical examples are used to demonstrate that both methods can give equivalent results if implemented properly. Is also shown that neglecting surface convection and radiation on the continuously evolving interface between active and inactive elements can lead to errors. A new hybrid quiet inactive metal deposition method is also proposed to accelerate computer run times.

This section provides a brief summary of the finite element formulation for transient conductive heat transfer. For more details see Ref. [45]. Heat transfer through mass transport in the melt pool is not directly simulated in this study. Its effects are introduced into the simulation by a distributed heat input model [46]. Enforcing energy balance in a Lagrangian reference frame x for a domain of volume V (see Fig. 1
                     ) results into the following partial differential equation:
                        
                           (1)
                           
                              Q
                              (
                              x
                              ,
                              t
                              )
                              −
                              
                                 
                                    dH
                                 
                                 
                                    dt
                                 
                              
                              (
                              x
                              ,
                              t
                              )
                              −
                              ∇
                              ·
                              q
                              (
                              x
                              ,
                              t
                              )
                              =
                              0
                              
                              in
                              
                              the
                              
                              entire
                              
                              volume
                              
                              V
                              
                              of
                              
                              the
                              
                              material
                           
                        
                     where x is spatial coordinate and t is time. T is the temperature, q is the heat flux vector, Q is the body heat source, and H is the enthalpy.

The initial temperature field is given by
                        
                           (2)
                           
                              T
                              (
                              x
                              ,
                              
                                 
                                    t
                                 
                                 
                                 
                                 
                                 
                                 
                                    0
                                 
                              
                              )
                              =
                              
                                 
                                    T
                                 
                                 
                                 
                                 
                                 
                                 
                                    0
                                 
                              
                              (
                              x
                              )
                              
                              in
                              
                              the
                              
                              entire
                              
                              volume
                              
                              V
                           
                        
                     where 
                        
                           
                              T
                           
                           
                           
                           
                           
                           
                              0
                           
                        
                        (
                        x
                        )
                      is the prescribed initial temperature. The following boundary conditions are applied on the surface,
                        
                           (3)
                           
                              T
                              (
                              x
                              ,
                              t
                              )
                              =
                              
                                 
                                    T
                                 
                                 
                                    p
                                 
                              
                              (
                              x
                              ,
                              t
                              )
                              
                              on
                              
                              the
                              
                              surface
                              
                              
                                 
                                    A
                                 
                                 
                                    T
                                 
                              
                           
                        
                     
                     
                        
                           (4)
                           
                              
                                 
                                    q
                                 
                                 
                                    s
                                 
                              
                              (
                              x
                              ,
                              t
                              )
                              =
                              
                                 
                                    q
                                 
                                 
                                    p
                                 
                              
                              (
                              x
                              ,
                              t
                              )
                              
                              on
                              
                              the
                              
                              surface
                              
                              
                                 
                                    A
                                 
                                 
                                    q
                                 
                              
                           
                        
                     where 
                        
                           
                              T
                           
                           
                              p
                           
                        
                        (
                        x
                        ,
                        t
                        )
                      and 
                        
                           
                              q
                           
                           
                              p
                           
                        
                        (
                        x
                        ,
                        t
                        )
                      represent the prescribed temperature and temperature-dependent surface flux, respectively. For surface convection and radiation, 
                        
                           
                              q
                           
                           
                              p
                           
                        
                        (
                        x
                        ,
                        t
                        )
                      is defined as follows:
                        
                           (5)
                           
                              
                                 
                                    q
                                 
                                 
                                    p
                                 
                              
                              (
                              x
                              ,
                              t
                              )
                              =
                              h
                              
                              (
                              T
                              −
                              
                                 
                                    T
                                 
                                 
                                    ∞
                                 
                              
                              )
                              +
                              ϵ
                              σ
                              (
                              
                                 
                                    T
                                 
                                 
                                    4
                                 
                              
                              −
                              
                                 
                                    T
                                 
                                 
                                    ∞
                                 
                                 
                                    4
                                 
                              
                              )
                           
                        
                     where, h is the convection coefficient, and 
                        
                           
                              T
                           
                           
                              ∞
                           
                        
                      is the room temperature. ϵ is the emissivity and σ is the Stefan–Boltzmann constant.

The energy flux q is expressed as a function of temperature T using the nonlinear isotropic Fourier heat flux constitutive relation:
                        
                           (6)
                           
                              q
                              =
                              −
                              k
                              (
                              T
                              )
                              ∇
                              T
                           
                        
                     where, k is the thermal conductivity. The rate of the enthalpy can also be rewritten as
                        
                           (7)
                           
                              
                                 
                                    dH
                                 
                                 
                                    dt
                                 
                              
                              =
                              
                                 
                                    dH
                                 
                                 
                                    dT
                                 
                              
                              
                                 
                                    dT
                                 
                                 
                                    dt
                                 
                              
                              =
                              ρ
                              
                                 
                                    C
                                 
                                 
                                    p
                                 
                              
                              
                                 
                                    dT
                                 
                                 
                                    dt
                                 
                              
                           
                        
                     where ρ is the density of the flowing body, C
                     
                        p
                      is the specific heat.

Substitution of Eqs. (6) and (7) into Eq. (1) results into the following:
                        
                           (8)
                           
                              Q
                              (
                              x
                              ,
                              t
                              )
                              −
                              ρ
                              
                                 
                                    C
                                 
                                 
                                    p
                                 
                              
                              
                                 
                                    dT
                                 
                                 
                                    dt
                                 
                              
                              +
                              ∇
                              ·
                              [
                              k
                              (
                              T
                              )
                              ∇
                              T
                              ]
                              =
                              0
                              
                              in
                              
                              the
                              
                              entire
                              
                              volume
                              
                              V
                              
                              of
                              
                              the
                              
                              material
                           
                        
                     
                  

Using an implicit formulation the temporal derivatives at time 
                        
                           
                              t
                           
                           
                           
                           
                           
                           
                              n
                           
                        
                      are approximated by the backward finite difference:
                        
                           (9)
                           
                              
                                 
                                    d
                                    
                                       
                                          T
                                       
                                       
                                       
                                       
                                       
                                       
                                          n
                                       
                                    
                                 
                                 
                                    d
                                    
                                       
                                          t
                                       
                                       
                                       
                                       
                                       
                                       
                                          n
                                       
                                    
                                 
                              
                              ≃
                              
                                 
                                    
                                       
                                          T
                                       
                                       
                                       
                                       
                                       
                                       
                                          n
                                       
                                    
                                    −
                                    
                                       
                                          T
                                       
                                       
                                       
                                       
                                       
                                       
                                          n
                                          −
                                          1
                                       
                                    
                                 
                                 
                                    
                                       
                                          t
                                       
                                       
                                       
                                       
                                       
                                       
                                          n
                                       
                                    
                                    −
                                    
                                       
                                          t
                                       
                                       
                                       
                                       
                                       
                                       
                                          n
                                          −
                                          1
                                       
                                    
                                 
                              
                           
                        
                     where, 
                        
                           
                              T
                           
                           
                           
                           
                           
                           
                              n
                           
                        
                      and 
                        
                           
                              T
                           
                           
                           
                           
                           
                           
                              n
                              −
                              1
                           
                        
                      are the temperatures at times 
                        
                           
                              t
                           
                           
                           
                           
                           
                           
                              n
                           
                        
                      and 
                        
                           
                              t
                           
                           
                           
                           
                           
                           
                              n
                              −
                              1
                           
                        
                     , respectively.

Using the Galerkin finite element discretization and the Newton–Raphson solution scheme, Eqs. (8) and (4) result into the following element residual R and Jacobian 
                        d
                        R
                        /
                        d
                        
                           
                              T
                           
                           
                           
                           
                           
                           
                              n
                           
                        
                     :
                        
                           (10)
                           
                              R
                              =
                              
                                 
                                    ∫
                                 
                                 
                                    
                                       
                                          V
                                       
                                       
                                          element
                                       
                                    
                                 
                              
                              {
                              
                                 
                                    
                                       B
                                    
                                    
                                       T
                                    
                                 
                                 kB
                                 
                                    
                                       T
                                    
                                    
                                    
                                    
                                    
                                    
                                       n
                                    
                                 
                                 −
                                 
                                    
                                       N
                                    
                                    
                                       T
                                    
                                 
                                 Q
                                 +
                                 
                                    
                                       N
                                    
                                    
                                       T
                                    
                                 
                                 N
                                 ρ
                                 
                                    
                                       C
                                    
                                    
                                       p
                                    
                                 
                                 
                                    
                                       
                                          
                                             T
                                          
                                          
                                          
                                          
                                          
                                          
                                             n
                                          
                                       
                                       −
                                       
                                          
                                             T
                                          
                                          
                                          
                                          
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                          
                                          
                                          
                                          
                                             n
                                          
                                       
                                       −
                                       
                                          
                                             t
                                          
                                          
                                          
                                          
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                    
                                 
                              
                              }
                              dV
                              +
                              
                                 
                                    ∫
                                 
                                 
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                q
                                             
                                          
                                       
                                       
                                          element
                                       
                                    
                                 
                              
                              
                              
                                 
                                    N
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    q
                                 
                                 
                                    p
                                 
                              
                              
                              dA
                           
                        
                     
                     
                        
                           (11)
                           
                              
                                 
                                    d
                                    R
                                 
                                 
                                    d
                                    
                                       
                                          T
                                       
                                       
                                       
                                       
                                       
                                       
                                          n
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    ∫
                                 
                                 
                                    
                                       
                                          V
                                       
                                       
                                          element
                                       
                                    
                                 
                              
                              [
                              
                                 
                                    
                                       B
                                    
                                    
                                       T
                                    
                                 
                                 kB
                                 +
                                 
                                    
                                       B
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       ∂
                                       k
                                    
                                    
                                       ∂
                                       T
                                    
                                 
                                 B
                                 
                                    
                                       T
                                    
                                    
                                    
                                    
                                    
                                    
                                       n
                                    
                                 
                                 N
                                 −
                                 
                                    
                                       N
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       ∂
                                       Q
                                    
                                    
                                       ∂
                                       T
                                    
                                 
                                 N
                                 +
                                 
                                    
                                       N
                                    
                                    
                                       T
                                    
                                 
                                 N
                                 ρ
                                 
                                    
                                       C
                                    
                                    
                                       p
                                    
                                 
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                          
                                          
                                          
                                          
                                             n
                                          
                                       
                                       −
                                       
                                          
                                             t
                                          
                                          
                                          
                                          
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                    
                                 
                              
                              ]
                              dV
                              +
                              
                                 
                                    ∫
                                 
                                 
                                    
                                       
                                          V
                                       
                                       
                                          element
                                       
                                    
                                 
                              
                              [
                              
                                 
                                    
                                       N
                                    
                                    
                                       T
                                    
                                 
                                 N
                                 ρ
                                 
                                    
                                       ∂
                                       
                                          
                                             C
                                          
                                          
                                             p
                                          
                                       
                                    
                                    
                                       ∂
                                       T
                                    
                                 
                                 N
                                 
                                    
                                       
                                          
                                             T
                                          
                                          
                                          
                                          
                                          
                                          
                                             n
                                          
                                       
                                       −
                                       
                                          
                                             T
                                          
                                          
                                          
                                          
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                          
                                          
                                          
                                          
                                             n
                                          
                                       
                                       −
                                       
                                          
                                             t
                                          
                                          
                                          
                                          
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                    
                                 
                              
                              ]
                              dV
                              +
                              
                                 
                                    ∫
                                 
                                 
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                q
                                             
                                          
                                       
                                       
                                          element
                                       
                                    
                                 
                              
                              
                                 
                                    N
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    ∂
                                    q
                                 
                                 
                                    ∂
                                    T
                                 
                              
                              N
                              
                              dA
                           
                        
                     where, T is the element temperature nodal vector, and N and B are the operators that compute the temperature and temperature gradient as follows:
                        
                           (12)
                           
                              T
                              =
                              NT
                           
                        
                     
                     
                        
                           (13)
                           
                              ∇
                              T
                              =
                              BT
                           
                        
                     
                  

Two metal deposition methods are reported in the literature for modeling material deposition: (1) the quiet and (2) the inactive element method [14,23,37,38]. In this section the methods are described in further detail.

In the quiet element method, the elements representing metal deposition regions are present from the start of the analysis. However, they are assigned properties so they do not affect the analysis. For heat transfer analyses, the thermal conductivity k is set to a lower value to minimize conduction into the quiet elements, and the specific heat C
                        
                           p
                         is set to a lower value to adjust energy transfer to the quiet elements:
                           
                              (14)
                              
                                 
                                    
                                       k
                                    
                                    
                                       quiet
                                    
                                 
                                 =
                                 
                                    
                                       s
                                    
                                    
                                       k
                                    
                                 
                                 
                                 k
                              
                           
                        
                        
                           
                              (15)
                              
                                 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             p
                                          
                                       
                                    
                                    
                                       quiet
                                    
                                 
                                 =
                                 
                                    
                                       s
                                    
                                    
                                       
                                          
                                             C
                                          
                                          
                                             p
                                          
                                       
                                    
                                 
                                 
                                 
                                    
                                       C
                                    
                                    
                                       p
                                    
                                 
                              
                           
                        where, k
                        
                           quiet
                         and 
                           
                              
                                 
                                    
                                       C
                                    
                                    
                                       p
                                    
                                 
                              
                              
                                 quiet
                              
                           
                         are the thermal conductivity and specific heat used for quiet elements, and s
                        
                           k
                         and 
                           
                              
                                 s
                              
                              
                                 
                                    
                                       C
                                    
                                    
                                       p
                                    
                                 
                              
                           
                         are the scaling factors used for the thermal conductivity and specific heat, respectively.

The quiet element method has the following advantages:
                           
                              •
                              It is easy to implement and can be applied to commercial finite element codes via user subroutines.

Since the number of elements does not change, the number of equations is constant through the analysis and no additional equation renumbering and solver initialization is needed.

The quiet element method has the following disadvantages:
                           
                              •
                              If the scaling factors s
                                 
                                    k
                                  and 
                                    
                                       
                                          s
                                       
                                       
                                          
                                             
                                                C
                                             
                                             
                                                p
                                             
                                          
                                       
                                    
                                  are not small enough, thermal energy conducts into the inactive elements resulting to errors.

If the scaling factors s
                                 
                                    k
                                  and 
                                    
                                       
                                          s
                                       
                                       
                                          
                                             
                                                C
                                             
                                             
                                                p
                                             
                                          
                                       
                                    
                                  are too small, the Jacobian resulting from Eq. (11) may be ill-conditioned.

Implementation of the quiet element method in modeling additive manufacturing, where most of the analysis domain is composed of quiet elements, may result into long computer runs.

In the inactive element method, the elements representing metal deposition regions are removed from the analysis and only nodal degrees of freedom corresponding to active elements are considered. Numerical implementation involves computing the element residual (Eq. (10)) and Jacobian (Eq. (11)) for the active elements only and solving for the active nodal degrees of freedom only.

The inactive element method has the following advantages:
                           
                              •
                              There are no errors or ill-conditioning introduced by scaling factors as is the case of the quiet element method.

Element residual and Jacobian calculations are performed for active elements only.

Only the active nodal degrees of freedom are considered at a time resulting into smaller algebraic systems by the Newton–Raphson linearization.

The inactive element method has the following disadvantages:
                           
                              •
                              The method cannot be easily incorporated into general purpose commercial codes using user subroutines.

The equation numbering and solver initialization have to be repeated every time elements are activated. This may negate the computational advantage of solving for a reduced active number of degrees of freedom.

When elements are activated, nodes shared by active elements may not be at the initial temperature which may result into artificial energy being introduced into the model. The effect is illustrated in Fig. 2
                                 . Node 2 is shared by active element 1 and inactive element 2. If the temperature at node 2 is not equal to initial temperature 
                                    
                                       
                                          T
                                       
                                       
                                       
                                       
                                       
                                       
                                          0
                                       
                                    
                                 , when element 2 is activated, the initial temperature across the element as interpolated by Eq. (12) is not equal to the initial temperature 
                                    
                                       
                                          T
                                       
                                       
                                       
                                       
                                       
                                       
                                          0
                                       
                                    
                                  which results into artificial numerical thermal energy introduced during element activation. A remedy to this problem is to set 
                                    
                                       
                                          T
                                       
                                       
                                       
                                       
                                       
                                       
                                          n
                                          −
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          T
                                       
                                       
                                       
                                       
                                       
                                       
                                          0
                                       
                                    
                                  in Eqs. (10) and (11) for the inactive elements before their activation. 
                                    
                                       
                                          T
                                       
                                       
                                       
                                       
                                       
                                       
                                          n
                                          −
                                          1
                                       
                                    
                                  is not reset for the active elements, otherwise, energy would be lost.


                     Fig. 3
                      illustrates a finite element mesh for the simulation of building a thin wall by powder fed metal deposition additive manufacturing. The active element region is shown as contour shaded with temperature results and the inactive (or quiet) region as translucent. The interface between active and inactive (or quiet) elements is also illustrated in the figure. Surface convection and radiation conditions (Eq. (5)) need to be applied to this interface since it is an external free surface. The interface continuously changes as the metal is deposited during processing. Therefore, algorithms need to be developed to calculate the location of the evolving interface and apply surface convection and radiation as needed.

As seen in Fig. 3, the interface is an internal surface in the mesh. When using general purpose FEA codes, it is difficult to compute the interface between active and inactive (or quiet) elements using user subroutines. Thus, it is common practice to neglect the surface convection and radiation on this interface. This simplification may be appropriate in weld modeling since the filler metal and therefore the size of the interface is negligible compared to the base metal. However, in additive manufacturing, the size of the deposited material could be significant compared to the substrate and thus neglecting surface convection and radiation on the interface between active and inactive elements can be a source of error as demonstrated in the examples section.

The 1D bar problem of Fig. 4
                         is used to illustrate and quantify potential errors of the implementation of the quiet and inactive element methods. The length of the bar is set to 10mm and the cross section to 1mm2. The thermal conductivity k is set to .05W/mm/°C, the specific heat C
                        
                           p
                         to 1000kJ/kg/°C, and the density ρ to 10−6
                        kg/mm3. The half left of the bar is set to be active at all time, while the right half is set to be inactive or quiet for times 0–.1s, and then switched to active. A heat source Q of 1W/mm3 is applied to the left half of the bar for times 0–.1s.


                           Table 1
                            lists the analyses cases performed using the quiet element method. The analyses are performed by implementing (Eqs. (10)–15) into a Matlab code for 100 time increments of 0.1s. Results for the first and last time increments are illustrated in Figs. 5 and 6
                           
                           , respectively. Temperature results of the center node are also listed in Table 1. Results at the first time increment evaluate the effectiveness of the method to compute the discontinuous temperature transition from active to quiet elements, while, results at the last time increment indicate any artificial (numerical) heat loss/generation by the method.

In cases q1–q4, the thermal conductivity scaling factor s
                           
                              k
                            is varied from 1 to .000001. As seen in Table 1 and Fig. 5, the error at time t=0.1s decreases from −50% to −11.5739% as s
                           
                              k
                            is set to lower values. However, the improvement from s
                           
                              k
                           =.0001 (case q3) to s
                           
                              k
                           =.000001 (case q4) is minimal, and further reduction of s
                           
                              k
                            risks introducing ill-conditioning in the system Jacobian. The error at time t=10s for cases q1–q4 is less than 10−10%.

In cases q5 and q8, the thermal conductivity scaling factor s
                           
                              k
                            is set to s
                           
                              k
                           =.0001 and the specific heat scaling factor 
                              
                                 
                                    s
                                 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                            is varied from .1 to .01 respectively. As seen in Table 1 and Fig. 5, the error at time 0.1 s decreases to −1.3296% and −0.1653% as 
                              
                                 
                                    s
                                 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                            is set to lower values. However, the error at the last time increment increases to 5.2786% and 7.2180%, indicating that there is artificial (numerical) heat generation.

In case q7, the number of elements is increased tenfold and s
                           
                              k
                           =.0001 and 
                              
                                 
                                    s
                                 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                              =
                              .01
                           . As the element length is decreased, the error at t=.1s decreases to −0.0984%, but at t=10s is still at 6.4596%.

In case q8, s
                           
                              k
                           =.0001 and 
                              
                                 
                                    s
                                 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                              =
                              .01
                            but the previous increment temperature 
                              
                                 
                                    T
                                 
                                 
                                 
                                 
                                 
                                 
                                    n
                                    −
                                    1
                                 
                              
                            during the activation of the quiet elements is reset to the initial temperature 
                              
                                 
                                    T
                                 
                                 
                                 
                                 
                                 
                                 
                                    0
                                 
                              
                           , enforcing the discontinuity of the solution at the previous time increment. The error now at t=.1s is reduced to −0.0729%. Indicating the artificial energy loss/generation is diminished.


                           Table 2
                            lists the analyses cases performed using the inactive element method. Results for the first (t=.1s) and last (t=10s) time increments are illustrated in Figs. 7 and 8
                           
                           , respectively. Temperature results of the center node are also listed in Table 2. In the first time increment, the inactive element method is 100% accurate over the active element region. However, on the last time increment, there is artificial energy generation resulting to 10% error for 10 elements (case i1) and 1% for 100 elements (case i2). When the previous increment temperature 
                              
                                 
                                    T
                                 
                                 
                                 
                                 
                                 
                                 
                                    n
                                    −
                                    1
                                 
                              
                            during the activation of the inactive elements is reset to the initial temperature 
                              
                                 
                                    T
                                 
                                 
                                 
                                 
                                 
                                 
                                    0
                                 
                              
                           , the error at the last time increment is diminished (cases i3 and i4).

In this section, the quiet and inactive element methods are evaluated in 3D models of building a thin wall using the directed powder process by the Optomec LENS system. The process conditions and material properties are set to correspond to typical experimental settings. However, the intention of this study is model verification rather model validation which involves a systematic and detailed experimental effort as well. (Eqs. (10)–15) are programmed into the CUBIC code by Pan Computing LLC. The code is parallelized using the Open Multi Processing (OMP) interface. Results are presented for 8 node hex (hex8) elements with full numerical integration and consistent heat capacity matrix. The maximum number of threads is set to the number of physical processors (cores).


                        Process description: A 3mm thick wall is built using the Optomec LENS system. The process uses a laser beam as heat source and metal powder is fed into the beam path. The powder particles under the laser beam melt and fall onto the partially build part and solidify upon cooling. A substrate is used to start the metal deposition. The wall length is 38.1mm and it is build by 62 layers of 0.2032mm height each. Each layer is generated by a single straight laser scan. The travel speed is 8.466mm/s, and the laser power is 425W. The substrate is 6.35mm thick, 38.1mm wide, and 76.2mm long.


                        Heat input model: The double ellipsoid [46] volumetric source heat input model is used to simulate the heat input onto the part. The heat source distribution Q is given by
                           
                              (16)
                              
                                 Q
                                 =
                                 
                                    
                                       6
                                       
                                          
                                             3
                                          
                                       
                                       P
                                       η
                                       f
                                    
                                    
                                       abc
                                       π
                                       
                                          
                                             π
                                          
                                       
                                    
                                 
                                 
                                 
                                    
                                       e
                                    
                                    
                                       −
                                       [
                                       3
                                       
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       /
                                       
                                          
                                             a
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       3
                                       
                                          
                                             y
                                          
                                          
                                             2
                                          
                                       
                                       /
                                       
                                          
                                             b
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       3
                                       
                                          
                                             (
                                             z
                                             +
                                             
                                                
                                                   v
                                                
                                                
                                                   w
                                                
                                             
                                             t
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       /
                                       
                                          
                                             c
                                          
                                          
                                             2
                                          
                                       
                                       ]
                                    
                                 
                              
                           
                        where P is the power; η is the process efficiency; x, y, and z are the local coordinates of the double ellipsoid model; a, b, and c are the transverse, through the depth, and longitudinal ellipsoid axes. Usually, a is set to the deposition half width, and b to the melt pool depth. Typically, different values are used in front and behind the melt pool for the longitudinal ellipsoid axis c. However, here the same value is used here since the melt pool is nearly spherical in the LENS process. f is a scaling factor; v
                        
                           w
                         is the heating spot travel speed; and t is time. The values used here are: P=425W, η=.45, a=1.5mm, b=.9mm, c=1.5mm, and f=1. Eq. (16) is applied on the entire model and beyond the edges of the ellipsoid (defined at the 5% value [46]) and thus no correction for cut-off is needed.


                        FEA mesh: Fig. 9
                         shows a symmetric model of the substrate only and Fig. 10
                         shows a symmetric model of the substrate and wall. The substrate model (Fig. 9) is composed of 8480 hex8 elements and 10,086 nodes. The substrate and wall model contains 14,432 hex8 elements and 19,200 nodes. The mesh density is targeted towards obtaining temperature results for follow on mechanical analyses for computing residual stress and distortion. Finer meshes would be required for solidification studies.


                        Time incrementation: During heating, the time increment is set to 0.0885827s, which results into a 0.75mm (quarter of deposition width) travel distance per time increment. When there is no heating, the time increments are increased.


                        Element activation criterion: In the double ellipsoid model, the heat source at the edges of the ellipsoid reduces to 5% of the peak value at the center. Since the edges of the ellipsoid correspond to the edge of the molten region, quiet or inactive elements are activated when the following is valid at any Gauss point of an element:
                           
                              (17)
                              
                                 
                                    
                                       6
                                       
                                          
                                             3
                                          
                                       
                                       f
                                    
                                    
                                       abc
                                       π
                                       
                                          
                                             π
                                          
                                       
                                    
                                 
                                 
                                 
                                    
                                       e
                                    
                                    
                                       −
                                       [
                                       3
                                       
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       /
                                       
                                          
                                             a
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       3
                                       
                                          
                                             y
                                          
                                          
                                             2
                                          
                                       
                                       /
                                       
                                          
                                             b
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       3
                                       
                                          
                                             (
                                             z
                                             +
                                             
                                                
                                                   v
                                                
                                                
                                                   w
                                                
                                             
                                             t
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       /
                                       
                                          
                                             c
                                          
                                          
                                             2
                                          
                                       
                                       ]
                                    
                                 
                                 ≥
                                 .05
                              
                           
                        
                     


                        Other boundary conditions: The free surface convection set to h=.00001W/mm2/°C. The gas and powder flow near the heating zone is simulated as a forced convection region moving along with the heat source with a spherical shape with 5mm radius and a forced convection of H=.000210W/mm2/°C. The emissivity for radiation is set to ϵ=.5. The initial temperature 
                           
                              
                                 T
                              
                              
                              
                              
                              
                              
                                 0
                              
                           
                         and ambient temperature 
                           
                              
                                 T
                              
                              
                                 ∞
                              
                           
                         are set to 30.5°C.


                        Material properties. Material properties for TI64 are used. The thermal conductivity k and specific heat C
                        
                           p
                         are listed in Table 3
                         
                        [47]. Material properties are linearly interpolated between the values listed on the table, and kept constant beyond the minimum and maximum listed values. The density is 4.43×10−6
                        kg/mm3. The latent heat of fusion 365kj/kg and is spread over a temperature range from 1600°C to 1670°C.

In this test, heating of the substrate only with no metal deposition is modeled. A model of the substrate only (Fig. 9, case s1) is used as reference to evaluate the accuracy of models with active elements on the substrate and quiet or inactive elements on the wall (cases sq1 and si1). For the quiet element model (shown in Fig. 10), the conductivity and specific heat scaling factors at the quiet elements are set as s
                           
                              k
                           =.000001 and 
                              
                                 
                                    s
                                 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                              =
                              .01
                           . Temperature results along line AA as illustrated in Figs. 9 and 10 are extracted and plotted in Fig. 11
                           . Convection and radiation are also applied on the interface between active and inactive (or quiet) elements. The maximum error for the quiet element and inactive methods is .0390% and 6.375e−5%, respectively (Table 4
                           ). It is noted that no elements are switched from quiet to active in this test.


                           Fig. 10 shows the symmetric model of the substrate and wall used for this test. A time period of 1000s is simulated. The metal deposition lasts 286.95s and requires 3223 time increments. Further cool down for the remaining of the simulation requires 9 additional time increments. An average of 6 iterations per time increment is required to achieve convergence, which is defined as minimization of the norm of the global residual by 7 orders of magnitude.


                           Tables 5 and 6
                           
                            list the analysis cases performed for the wall build test and the respective wall CPU run times on a 16 3.1GHz core computer using either all or a single core. Cases wq1 and wq2 use the quiet element method with thermal conductivity and specific heat scaling factors at the quiet elements set as s
                           
                              k
                           =.000001 and 
                              
                                 
                                    s
                                 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                              =
                              .01
                           . Initially, all elements on the wall are set to quiet, then, when Eq. (17) is true at any Gauss point of an element, it is switched to active. The scheme results into a continuous element activation emulating the metal deposition of the process. The quiet element cases use the same number of equations throughout the analysis and require no additional equation renumbering and solver initialization. Run times are about 1009s wall CPU using 16 cores (7587s using 1 core).

Cases wi1 and wi2 use the inactive element method. Initially, the all elements on the wall are set to inactive, and then switched to active based on the heat input similarly to the quiet element method. Since elements are activated continuously, equation numbering and solver initialization is repeated at nearly all time increments resulting into slower computer run times of about 1875s wall (8179s using 1 core).

Cases wiq1–wiq3 use a hybrid inactive/quiet element method in which wall elements are initially set as inactive. Then, layer by layer elements are switched to quiet, and then switched individually to active based on the heat input similarly to the quiet element method implemented in cases wq1 and wq2. In this approach, equation numbering and solver initialization is repeated only when each layer is activated resulting into slightly faster computer run times of about 976s wall (6284s using 1 core) per case.

In cases wq2, wi2, wiq2, and wiq3, the temperature of quiet or inactive elements before activation 
                              
                                 
                                    T
                                 
                                 
                                 
                                 
                                 
                                 
                                    n
                                    −
                                    1
                                 
                              
                            is set to the initial temperature 
                              
                                 
                                    T
                                 
                                 
                                 
                                 
                                 
                                 
                                    0
                                 
                              
                           , while in cases wq1, wi1, wiq1, it is not. The temperature result during the deposition of the 61st layer for case wq2 is illustrated in Fig. 12
                           . 
                           Fig. 13 illustrates the temperature result for case wq2 at the same time instance with all quiet element removed. The temperature result during the deposition of the 61st layer for case wi2 is illustrated in Fig. 14
                           . Temperature results along line AA are extracted and plotted in Fig. 15
                           . Results from cases wq2 and wi3 are also plotted in the same figure. Using case wiq2 as reference, the maximum % error along the line is listed in Table 5. As seen in Table 5, neglecting to reset 
                              
                                 
                                    T
                                 
                                 
                                 
                                 
                                 
                                 
                                    n
                                    −
                                    1
                                 
                              
                            upon element activation leads to errors (3.5323–5.3056%). The error is higher in the inactive element method. When 
                              
                                 
                                    T
                                 
                                 
                                 
                                 
                                 
                                 
                                    n
                                    −
                                    1
                                 
                              
                            is reset, all methods result into nearly equivalent results (maximum error .5%).

In all cases, except case wi3, surface and convection and radiation are applied on the interface between active and inactive (or quiet) elements. Neglecting the application of convection and radiation on the interface between active and inactive (or quiet) elements results into higher computed temperatures. In this example, the maximum error is about 7.5832% since the size of the interface is small compared to the total surface of the part. However, the error may be higher when the size of the interface is larger such as in multi-layer cladding and manufacturing of complex 3D parts.

@&#CONCLUSIONS@&#

Finite element techniques for modeling metal deposition in heat transfer analyses of additive manufacturing are investigated in detail. A popular method used in general purpose commercial codes through user subroutines is the quiet element method, where elements are present in the analysis but quiet elements are assigned properties rendering them irrelevant until their activation. Another approach is the inactive element method, where elements are removed from the analysis until their activation.

1D and 3D numerical examples are used to demonstrate that when the thermal conductivity and specific heat are scaled by .000001 and .01 respectively, both active and inactive element method results are practically identical (less than .5% difference). However, both methods result in artificial heating generation (more than 5% error) unless, the temperature of the active (or quiet) elements is reset to the initial temperature during activation to enforce the discontinuity of the temperature field in the transition from active to inactive (or quiet) elements.

Although the inactive element method results into a reduced number of degrees of freedom at the initial stages of the analysis, it requires longer computer run times than the quiet element method due to the continuous equation renumbering and solver initialization.

A new hybrid inactive/quiet element method is proposed for modeling additive manufacturing. In this approach, elements corresponding to metal deposition are initially inactive, then, they are switched to quiet on a layer-by-layer basis. The approach results into equivalent results within faster run times.

Numerical examples also demonstrate that neglecting the surface convection and radiation on the continuously evolving interface between active and inactive (or quiet) elements can lead into over predicting the resulting temperature.

@&#REFERENCES@&#

