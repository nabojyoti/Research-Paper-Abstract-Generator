@&#MAIN-TITLE@&#Multiscale nonlinear thermoelastic analysis of heterogeneous multiphase materials with temperature-dependent properties

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           The microscopic perturbed pre-correction is constructed.


                        
                        
                           
                           Microscopic loads and inaccuracy of the NBFs are better considered.


                        
                        
                           
                           The accuracies of micro- and macro-responses are all improved.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Nonlinear thermoelastic analysis

Heterogeneous multiphase material

Pre-correction multiscale strategy

Numerical base functions

@&#ABSTRACT@&#


               
               
                  A pre-correction multiscale strategy is developed for the nonlinear thermoelastic analysis of heterogeneous multiphase materials with temperature-dependent properties. In this strategy, based on the multiscale finite element formulation, the numerical base functions (NBFs) are constructed in order to bring the microscopic heterogeneous properties to the macroscopic response. By constructing the microscopic perturbed pre-correction the inaccuracy of the NBFs due to the temperature-dependent properties is better considered, as well as the influence of the microscopic loads. Then the pre-correction multiscale strategy is implemented for the nonlinear heat conduction and thermoelastic analysis. Finally several representative numerical examples are presented and the results indicate that the proposed strategy is efficient and accurate for modeling heterogeneous multiphase materials.
               
            

@&#INTRODUCTION@&#

Compared with the homogeneous materials, heterogeneous multiphase materials exhibit attractive properties and functional adaptations for their optimized microstructures. The design parameters of these materials can be tailored to optimize the performance of these materials. In engineering applications these materials are usually exposed to complex thermal environments, which will cause thermomechanical problems such as the thermal fatigue of refractory materials, thermal protection at extremely low or high temperature, thermal deformation of the aerospace structure, heating and cooling during the manufacturing, etc. Numerical methods like the finite element method (FEM) [1–4], boundary element method [5] and meshless method [6] are adopted to the analysis of nonlinear problems in heat conduction and thermomechanics. However, there exist enormous differences in various length scales in these heterogeneous materials where the traditional numerical methods are generally ineffective due to the resultant large number of degrees of freedom (DOFs).

Many methods have been developed to obtain the effective properties of the multiscale materials [7–10]. Among them, the effective property methods and the combined macroscopic–microscopic computation methods are most widely used. The effective property methods [11–15] focus on the determination of effective properties in the heterogeneous materials and can be traced back to Eshelby [11]. Recently, Al-Sulaiman et al. [12], Al-Nassar [13] and Jiang and Sousa [14] have extended this method to the prediction of thermal conductivity of fibers, composite and heterogeneous multicomponent materials. Cho et al. [15] numerically estimated the thermoelastic properties of heterogeneous materials with dual-phase microstructures. These methods can predict the macroscopic material behaviors by obtaining the effective physical properties. To study the multiscale behaviors of the materials, the combined macroscopic–microscopic computation methods are designed by researchers to take advantage of the efficiency of macroscopic models and the accuracy of the microscopic models. These methods include the asymptotic method [16–21] and the computational homogenization method [22–32]. The asymptotic method is a mathematical theory which was developed by Bensoussan et al. [16] and has been extended to the heat conduction and thermomechanical problems such as the works of Chung et al. [17], Alzina et al. [18], Zhang et al. [19], Vel and Goupee [20] and Goupee and Vel [21]. The computational homogenization method is essentially based on the solution of nested boundary value problems (BVP). This approach took its origin from Suquet [22] and Terada and Kikuchi [23] and was further developed by Smit et al. [24], Kouznetsova et al. [25] and Kouznetsova [26]. It has been extended also to thermal problems such as the works of Özdenir et al. [27], Muliana and Kim [28], Temizer and Wriggers [29], Özdemir et al. [30] and Terada et al. [31]. However, the range of applications for these homogenization methods is usually restricted by the assumptions on the media, such as scale separation and periodicity.

In addition to these effective property methods and homogeneous methods, there are other works dedicated to relaxing the constraints of the conventional FEM such as the generalized finite element method (GFEM). The concept of GFEM was proposed by Babuška and Osborn [32] and Babuška et al. [33] for one-dimensional and two-dimensional problems with rough coefficients. This method is essentially the finite element method with modified displacement base functions. Systematic investigation of this method was started by Duarte et al. [34] and Strouboulis et al. [35]. Recently, Babuška and Banerjee [36] presented a modification to the GFEM to deal with the loss of accuracy problems when the resultant stiffness matrix is ill-conditioned. O׳Hara et al. [37,38] extended the GFEM to the heat transfer problems involving sharp thermal gradients. Macri and Littlefield [39] extended this method to the thermo-stress analysis of heterogeneous materials. Motivated by the idea of using special base functions, Hou and Wu [40] developed a multiscale finite element method for the ecliptic problems in composite materials and porous media where the numerical base functions (NBFs) were used. Compared with the homogeneous methods, in the multiscale finite element method, the downscale computation can be easily performed using the NBFs. For the mechanical analysis of heterogeneous materials Zhang et al. [41,42] developed the extended multiscale finite element method, where additional coupled terms are introduced to the NBFs to account for the coupling effect among different axial directions. To solve the thermomechanical problems, Zhang et al. [47] developed the coupling extended multiscale finite element method (CEMsFEM) for the thermoelastic analysis of heterogeneous multiphase materials. The accuracy and validity of the method to regular and random multiphase materials were demonstrated by numerical examples.

For the nonlinear problems, Efendiev et al. [43] and Efendive and Hou [44] developed a general framework in which the multiscale map between the coarse grid space and fine grid space is defined to formulate the finite element analysis on the global scale. Zhang et al. [45,46] developed the extended multiscale finite element method for the elastic–plastic analysis of 2D periodic lattice truss and heterogeneous materials where the multiscale base functions are constructed numerically and employed to establish the relationship between the macroscopic and microscopic variables. For many materials, especially when large changes in temperature occur, the properties of the materials usually depend on the temperature, which leads to nonlinearities in the governing heat conduction equation. However, one can find few papers in which the temperature-dependent thermomechanical properties are taken into account in the multiscale analysis of heterogeneous materials.

The objective of this paper is to present a multiscale strategy for the nonlinear thermoelastic analysis of heterogeneous multiphase materials involving temperature-dependent material properties. The present work is based on the previous work of CEMsFEM developed by Zhang et al. [47] in which the NBFs are constructed for the temperature field and displacement field separately to bring the microscopic heterogeneous properties to the macroscale. However, considering the temperature-dependence of the material properties, the NBFs have to be updated when the material properties vary with temperature, which could be a large amount of computation effort. Furthermore, as shown by Zhang et al. [41] and Zhang et al. [47], the influences of the microscopic load are considered as the combination of the influence of macroscopic equivalent load and the microscopic perturbed results. This treatment can provide good modification to the local microscopic results. However, the influences of the microscopic modification on the global equivalent equations are omitted. In the present paper, a pre-correction multiscale strategy is developed in which the microscopic perturbed pre-corrections are constructed within every coarse element to consider the inaccuracy of the NBFs or/and the influence of microscopic nodal forces. Furthermore, the oversampling technique is also adopted for the pre-correction to improve the accuracy on the boundary regions of the coarse elements. The framework is implemented on the SiPESC [48] and can be used for solving engineering problems.

This paper is organized as follows. In the next section, the basic equations for nonlinear thermoelastic problem are presented. Subsequently, we briefly summarize the formulation of the construction of NBFs discussed in detail in [47]. Then the pre-correction multiscale strategy is implemented for the nonlinear thermoelastic analysis. In Section 5, the memory storage and computing time are compared between the proposed method and the traditional FEM to show the efficiency of the proposed method. In Section 6, numerical examples are presented to demonstrate the accuracy of the proposed method. Then the multiscale thermoelastic analyses of FGM and the cooling structure are performed to show the validity of the proposed method. Finally some conclusions are presented.

In the numerical analysis of heterogeneous materials, the macroscale L of the structure is usually larger than the scale l of the material heterogeneities. In the homogenization methods the hypothesis of scale separation means that l/L→0, which is not always applicable in reality. In contrast, small-scale differences require full resolution of the heterogeneous structure in which special strategies are needed to bridge different scales directly. This kind of problem is mainly considered in the present research. In this section the basic equations for nonlinear thermoelastic problem of heterogeneous materials are described in detail.

The nonlinearity considered here is mainly caused by the temperature-dependent material properties. The heat conduction governing equation is expressed as
                        
                           (1)
                           
                              ρ
                              (
                              x
                              ,
                              T
                              )
                              c
                              (
                              x
                              ,
                              T
                              )
                              
                                 T
                                 ̇
                              
                              −
                              div
                              (
                              k
                              (
                              x
                              ,
                              T
                              )
                              ⋅
                              grad
                              T
                              )
                              =
                              Q
                           
                        
                     where T is the temperature field, 
                        
                           T
                           ̇
                        
                      denotes the derivation of T with respected to time; and Q is heat source; ρ, c and k are the mass density, specific heat and thermal conductivity tensor, respectively, which are functions of spatial coordinate x and temperature T. The mechanical equilibrium and constitutive relation (see [2]) are
                        
                           (2)
                           
                              
                                 
                                    L
                                 
                                 T
                              
                              σ
                              +
                              f
                              =
                              0
                           
                        
                     
                     
                        
                           (3)
                           
                              σ
                              =
                              D
                              (
                              x
                              ,
                              T
                              )
                              (
                              ε
                              −
                              
                                 
                                    ε
                                 
                                 
                                    0
                                 
                              
                              −
                              
                                 
                                    ε
                                 
                                 
                                    e
                                    ,
                                    T
                                 
                              
                              )
                           
                        
                     where L is a differential operator and defined as
                        
                           (4)
                           
                              L
                              =
                              
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∂
                                                      
                                                         ∂
                                                         x
                                                      
                                                   
                                                
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                
                                                   
                                                      ∂
                                                      
                                                         ∂
                                                         y
                                                      
                                                   
                                                
                                             
                                             
                                                0
                                             
                                             
                                                
                                                   
                                                      ∂
                                                      
                                                         ∂
                                                         z
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                
                                                   
                                                      ∂
                                                      
                                                         ∂
                                                         y
                                                      
                                                   
                                                
                                             
                                             
                                                0
                                             
                                             
                                                
                                                   
                                                      ∂
                                                      
                                                         ∂
                                                         x
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∂
                                                      
                                                         ∂
                                                         z
                                                      
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                
                                                   
                                                      ∂
                                                      
                                                         ∂
                                                         z
                                                      
                                                   
                                                
                                             
                                             
                                                0
                                             
                                             
                                                
                                                   
                                                      ∂
                                                      
                                                         ∂
                                                         y
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∂
                                                      
                                                         ∂
                                                         x
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 T
                              
                           
                        
                     
                  


                     σ and ε are the vector forms of stress and strain tensors, respectively; f is the body load per unit volume; D is the elastic constitutive matrix which is a function of x and T; ε
                     0 is the thermal strain vector induced by the temperature rise; ε
                     
                        e,T
                      is the strain vector due to temperature-dependent material properties [2], which is omitted in the present nonlinear thermoelastic analysis ([5,6]). The strain and thermal strain are given by
                        
                           (5)
                           
                              ε
                              =
                              Lu
                              ,
                              
                              
                                 
                                    ε
                                 
                                 
                                    0
                                 
                              
                              =
                              α
                              (
                              x
                              ,
                              T
                              )
                              (
                              T
                              −
                              
                                 
                                    T
                                 
                                 
                                    0
                                 
                              
                              )
                           
                        
                     where u is the displacement vector; α is the strain–temperature constitutive matrix and T
                     0 is the initial temperature distribution.

The initial condition and the three kinds of boundary conditions for the temperature field are given as
                        
                           (6)
                           
                              T
                              (
                              x
                              ,
                              0
                              )
                              =
                              
                                 
                                    T
                                 
                                 
                                    0
                                 
                              
                              
                              in
                              
                              
                              Ω
                              
                              
                              and
                              
                              on
                              
                              
                              Γ
                           
                        
                     
                     
                        
                           (7)
                           
                              T
                              (
                              x
                              ,
                              t
                              )
                              =
                              
                                 T
                                 ^
                              
                              
                              
                              on
                              
                              
                              
                                 
                                    Γ
                                 
                                 
                                    t
                                 
                              
                           
                        
                     
                     
                        
                           (8)
                           
                              −
                              q
                              
                                 
                                    (
                                    x
                                    ,
                                    t
                                    )
                                 
                                 T
                              
                              ⋅
                              n
                              =
                              
                                 q
                                 ^
                              
                              
                              
                              on
                              
                              
                              
                                 
                                    Γ
                                 
                                 
                                    q
                                 
                              
                           
                        
                     
                     
                        
                           (9)
                           
                              −
                              q
                              
                                 
                                    (
                                    x
                                    ,
                                    t
                                    )
                                 
                                 T
                              
                              ⋅
                              n
                              +
                              h
                              (
                              T
                              (
                              x
                              ,
                              t
                              )
                              −
                              
                                 
                                    T
                                 
                                 
                                    ∞
                                 
                              
                              )
                              =
                              0
                              
                              
                              on
                              
                              
                              
                                 
                                    Γ
                                 
                                 
                                    h
                                 
                              
                           
                        
                     where Ω is the problem domain and Γ its boundary; 
                        
                           T
                           ^
                        
                      is the imposed temperature on the boundary Γ
                        t
                     ; 
                        
                           q
                           ^
                        
                      is the imposed heat flux normal to the boundary Γ
                        q
                     ; n={n
                     
                        x
                     
                     
                     n
                     
                        y
                     
                     
                     n
                     
                        z
                     }T is the outward normal vector; h is the convection coefficient on the convective boundary Γ
                        h
                     ; and 
                        
                           
                              T
                           
                           
                              ∞
                           
                        
                      is the temperature of the ambient. The mechanical boundary conditions are specified as
                        
                           (10)
                           
                              u
                              =
                              
                                 u
                                 ^
                              
                              
                              
                              on
                              
                              
                                 
                                    Γ
                                 
                                 
                                    u
                                 
                              
                           
                        
                     
                     
                        
                           (11)
                           
                              I
                              σ
                              =
                              
                                 σ
                                 ^
                              
                              
                              
                              on
                              
                              
                              
                                 
                                    Γ
                                 
                                 
                                    σ
                                 
                              
                           
                        
                     where 
                        
                           u
                           ^
                        
                      is the imposed displacement on the boundary Γ
                        u
                      and 
                        
                           σ
                           ^
                        
                      is the imposed traction on the boundary Γ
                        σ
                     . The matrix I is related to the unit normal vector n by
                        
                           (12)
                           
                              I
                              =
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      x
                                                   
                                                
                                             
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      y
                                                   
                                                
                                             
                                          
                                          
                                             0
                                          
                                          
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      z
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      y
                                                   
                                                
                                             
                                          
                                          
                                             0
                                          
                                          
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      x
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      z
                                                   
                                                
                                             
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      z
                                                   
                                                
                                             
                                          
                                          
                                             0
                                          
                                          
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      y
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      x
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ]
                              
                           
                        
                     
                  

In the above description, the material properties are functions of spatial coordinate x. It means that a large number of DOFs are required to resolve the microscopic heterogeneity. In the following, the CEMsFEM is proposed to effectively solve the above problem on the macroscale.

The main idea of the CEMsFEM is to construct the NBFs which capture the small scale information within each coarse grid element. In this section, we briefly summarize the construction of NBFs for thermoelastic problem with reference to [47].

For simplicity, we consider a structure of heterogeneous material as illustrated in 
                     Fig. 1(a), which is discretized into coarse grid and fine grid. For an initial temperature distribution within the coarse element, the NBFs for temperature field are solved through the following governing equation and boundary conditions:
                        
                           (13)
                           
                              −
                              div
                              (
                              k
                              (
                              x
                              ,
                              T
                              )
                              ⋅
                              grad
                              
                              
                                 
                                    N
                                 
                                 
                                    I
                                 
                              
                              )
                              =
                              0
                              
                              
                              in
                              
                              
                              
                                 
                                    Ω
                                 
                                 
                                    E
                                 
                              
                              ,
                              
                              
                              
                              
                              
                                 
                                    N
                                 
                                 
                                    I
                                 
                              
                              =
                              
                                 
                                    ξ
                                 
                                 
                                    I
                                 
                              
                              
                              on
                              
                              
                                 
                                    Γ
                                 
                                 
                                    E
                                 
                              
                           
                        
                     where Ω
                        E
                      is the region of sub-grid and Γ
                        E
                      its boundary as shown in Fig. 1(b), ξ
                     
                        I
                      are the given values for all the nodes on the boundary, and I indicates the node of the coarse element E. For the linear boundary conditions, the values of the bilinear shape function are used as the given values on the boundary of the sub-grid, i.e.
                        
                           (14)
                           
                              
                                 
                                    ξ
                                 
                                 
                                    I
                                 
                              
                              =
                              
                                 
                                    N
                                 
                                 
                                    I
                                 
                                 
                                    0
                                 
                              
                              
                              on
                              
                              
                                 
                                    Γ
                                 
                                 
                                    E
                                 
                              
                           
                        
                     where N
                     
                        I
                     
                     0 is the bilinear shape function used in standard FEM for node I.

For the displacement field, the NBFs are constructed separately along different axial directions and the Poisson׳s effect is considered through the additional coupled terms [42]. The construction of the base functions requires the solution of equilibrium equation on the sub-grid with special boundary conditions, i.e.
                        
                           (15)
                           
                              
                                 
                                    L
                                 
                                 T
                              
                              σ
                              =
                              0
                              
                              in
                              
                              
                                 
                                    Ω
                                 
                                 
                                    E
                                 
                              
                              ,
                              u
                              
                              affined
                              
                              on
                              
                              
                                 
                                    Γ
                                 
                                 
                                    E
                                 
                              
                           
                        
                     
                  

We take the construction of NBFs of node 1 in the x direction as an illustration. For the linear boundary conditions, the values of the bilinear shape function are used as the given values of the x-direction on the boundary of the sub-grid, i.e.
                        
                           (16)
                           
                              
                                 
                                    u
                                 
                                 
                                    x
                                 
                              
                              =
                              
                                 
                                    N
                                 
                                 
                                    I
                                 
                                 
                                    0
                                 
                              
                              
                              on
                              
                              
                                 
                                    Γ
                                 
                                 
                                    E
                                 
                              
                           
                        
                     
                  

At the same time, the boundary nodes of the sub-grid are all constrained in the y-direction. The displacement results of x and y directions are denoted as N
                     1xx
                      and N
                     1yx
                     , respectively. Thus the base functions {N
                     1xx
                     ,N
                     1yx
                     }T are obtained, where N
                     1yx
                      is an additional coupled term which is the component of displacement field in the y-direction induced by an unit displacement of node 1 in the x-direction. Other components of the NBFs can be constructed similarly.

As indicated by the researchers, the boundary conditions are crucial for the accuracy of the NBFs and the multiscale method. Various boundary conditions (such as linear [40], oscillating [40] and periodic [42]) and techniques (oversampling technique [40], new oversampling technique [42]) have been developed by researchers to improve the accuracy. The research of different boundary conditions is beyond the scope of the present paper, and the NBFs constructed using the linear boundary conditions at the initial temperature state are used in the following computations. The upscale as well as the downscale computation can be implemented through the NBFs constructed above.

In the thermoelastic problems with temperature-dependent material properties, the element matrices change along with the evolution of temperature. To avoid costly re-construction of NBFs, the NBFs constructed at the initial temperature state are used. On the other hand, the influence of microscopic unbalanced forces in the nonlinear heat conduction analysis and microscopic heat load in thermoelastic analysis has to be considered both on the macroscale and microscale. To solve these difficulties, the pre-correction multiscale strategy is developed in this section.

The purpose of the pre-correction is to consider the inaccuracy of the NBFs and the influence of the microscopic load. The microscopic perturbed results can be seen as the local relaxation (or equilibration modification) to the macroscopic results as shown in 
                        Fig. 2. Then the modified ‘true’ microscopic temperature and displacement results of a sub-grid element e can be expressed by using the NBFs constructed in the previous section as
                           
                              (17)
                              
                                 
                                    
                                       T
                                    
                                    
                                       e
                                    
                                 
                                 =
                                 
                                    
                                       G
                                    
                                    
                                       e
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       T
                                    
                                    
                                       E
                                    
                                 
                                 +
                                 
                                    
                                       
                                          T
                                          ˜
                                       
                                    
                                    
                                       e
                                    
                                 
                                 ,
                                 
                                    
                                       G
                                    
                                    
                                       e
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            e
                                                            1
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            e
                                                            2
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            e
                                                            3
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            e
                                                            4
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    T
                                 
                              
                           
                        
                        
                           
                              (18)
                              
                                 
                                    
                                       u
                                    
                                    
                                       e
                                    
                                 
                                 =
                                 
                                    
                                       G
                                    
                                    
                                       e
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       E
                                    
                                 
                                 +
                                 
                                    
                                       
                                          u
                                          ˜
                                       
                                    
                                    
                                       e
                                    
                                 
                                 ,
                                 
                                    
                                       G
                                    
                                    
                                       e
                                    
                                 
                                 =
                                 
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            e
                                                            1
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            e
                                                            2
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            e
                                                            3
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            e
                                                            4
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    T
                                 
                              
                           
                        where T
                        
                           e
                         and u
                        
                           e
                         are the temperature and displacement vectors of the sub-grid element e, respectively; T
                        
                           E
                         and u
                        
                           E
                         are the temperature and displacement vectors of the coarse element E, respectively; G
                        
                           e
                        
                        t and G
                        
                           e
                         are the transition matrices from macroscale to microscopic for temperature and displacement, respectively; 
                           
                              
                                 
                                    T
                                    ˜
                                 
                              
                              
                                 e
                              
                           
                         and 
                           
                              
                                 
                                    u
                                    ˜
                                 
                              
                              
                                 e
                              
                           
                         are the microscopic perturbed results which are corrections to the macroscopic results. 
                           
                              
                                 R
                              
                              
                                 J
                              
                              
                                 t
                              
                           
                         and 
                           
                              
                                 R
                              
                              
                                 J
                              
                           
                         are expressed as
                           
                              (19)
                              
                                 
                                    
                                       R
                                    
                                    
                                       J
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      (
                                                      J
                                                      )
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            2
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      (
                                                      J
                                                      )
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            3
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      (
                                                      J
                                                      )
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            4
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      (
                                                      J
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    T
                                 
                              
                           
                        
                        
                           
                              (20)
                              
                                 
                                    
                                       R
                                    
                                    
                                       J
                                    
                                 
                                 =
                                 
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            1
                                                            x
                                                            x
                                                         
                                                      
                                                      (
                                                      J
                                                      )
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            1
                                                            x
                                                            y
                                                         
                                                      
                                                      (
                                                      J
                                                      )
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            2
                                                            x
                                                            x
                                                         
                                                      
                                                      (
                                                      J
                                                      )
                                                   
                                                
                                                
                                                   
                                                      ..
                                                      .
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            4
                                                            x
                                                            y
                                                         
                                                      
                                                      (
                                                      J
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            1
                                                            y
                                                            x
                                                         
                                                      
                                                      (
                                                      J
                                                      )
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            1
                                                            y
                                                            y
                                                         
                                                      
                                                      (
                                                      J
                                                      )
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            2
                                                            y
                                                            x
                                                         
                                                      
                                                      (
                                                      J
                                                      )
                                                   
                                                
                                                
                                                   
                                                      ..
                                                      .
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            4
                                                            y
                                                            y
                                                         
                                                      
                                                      (
                                                      J
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    T
                                 
                              
                           
                        where J=1,2,…,n indicates the sub-grid nodes. We construct the microscopic perturbed correction using the following two steps.

First, considering the structure with microscopic loads and boundary conditions as shown in 
                        Fig. 3(a), the loads and the boundary conditions for solving the perturbed results on the sub-grid are shown in Fig. 3(b)–(d). Besides the loads and boundary conditions from the original structure, artificial boundary conditions are added to the coarse element boundaries where the internal boundaries (boundaries that original connected to other coarse element domains) are constrained as shown in Fig. 3(b)–(d). Then the results of the coarse element region Ω
                           E
                         are denoted as 
                           
                              
                                 
                                    T
                                    ¯
                                 
                              
                              
                                 e
                              
                           
                         (or 
                           
                              
                                 
                                    u
                                    ¯
                                 
                              
                              
                                 e
                              
                           
                        ). Furthermore, the oversampling technique can be used to better account for the perturbed results in the boundary regions. A larger region Ω
                           E′
                         which covers the target coarse element region Ω
                           E
                         is considered and the boundaries are constrained as shown in Fig. 3(e)–(g). The local boundary value problem is solved and then the results of the target coarse element region Ω
                           E
                         are extracted from Ω
                           E′
                         and are also denoted as 
                           
                              
                                 
                                    T
                                    ¯
                                 
                              
                              
                                 e
                              
                           
                         (or 
                           
                              
                                 
                                    u
                                    ¯
                                 
                              
                              
                                 e
                              
                           
                        ).

Second, the corresponding results at the corner nodes (corresponding to the macroscopic element nodes) are extracted and denoted as 
                           
                              
                                 
                                    T
                                    ^
                                 
                              
                              
                                 E
                              
                           
                         (or 
                           
                              
                                 
                                    u
                                    ^
                                 
                              
                              
                                 E
                              
                           
                        ). To exclude the influence of the inaccuracy of the NBFs, and to guarantee that the temperature (or displacement) of the corner nodes equals zero, the results interpolated by 
                           
                              
                                 
                                    T
                                    ^
                                 
                              
                              
                                 E
                              
                           
                         (or 
                           
                              
                                 
                                    u
                                    ^
                                 
                              
                              
                                 E
                              
                           
                        ) and the NBFs are subtracted. They are denoted as 
                           
                              
                                 
                                    T
                                    ^
                                 
                              
                              
                                 e
                              
                           
                         (or 
                           
                              
                                 
                                    u
                                    ^
                                 
                              
                              
                                 e
                              
                           
                        ) and then the microscopic perturbed results are expressed as
                           
                              (21a, b)
                              
                                 
                                    
                                       
                                          T
                                          ˜
                                       
                                    
                                    
                                       e
                                    
                                 
                                 =
                                 
                                    
                                       
                                          T
                                          ¯
                                       
                                    
                                    
                                       e
                                    
                                 
                                 −
                                 
                                    
                                       
                                          T
                                          ^
                                       
                                    
                                    
                                       e
                                    
                                 
                                 =
                                 
                                    
                                       
                                          T
                                          ¯
                                       
                                    
                                    
                                       e
                                    
                                 
                                 −
                                 
                                    
                                       G
                                    
                                    
                                       e
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       
                                          T
                                          ^
                                       
                                    
                                    
                                       E
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          u
                                          ˜
                                       
                                    
                                    
                                       e
                                    
                                 
                                 =
                                 
                                    
                                       
                                          u
                                          ¯
                                       
                                    
                                    
                                       e
                                    
                                 
                                 −
                                 
                                    
                                       
                                          u
                                          ^
                                       
                                    
                                    
                                       e
                                    
                                 
                                 =
                                 
                                    
                                       
                                          u
                                          ¯
                                       
                                    
                                    
                                       e
                                    
                                 
                                 −
                                 
                                    
                                       G
                                    
                                    
                                       e
                                    
                                 
                                 
                                    
                                       
                                          u
                                          ^
                                       
                                    
                                    
                                       E
                                    
                                 
                              
                           
                        
                     

As an example, we consider a steady heat conduction model of structure with heterogeneous material as shown in 
                        Fig. 4(a); the convection and heat flux boundary conditions are considered for the left and right hand side boundaries, respectively. As the reference solution the microscopic solution is shown in Fig. 4(a), where the height of the contour plot indicates the amplitude of the temperature results. It can be seen that the temperature oscillates with the variation of material distribution. Fig. 4(b)–(d) and (e)–(g) shows in order the results of 
                           
                              
                                 
                                    T
                                    ¯
                                 
                              
                              
                                 e
                              
                           
                        , 
                           
                              
                                 
                                    T
                                    ^
                                 
                              
                              
                                 e
                              
                           
                        , and 
                           
                              
                                 
                                    T
                                    ˜
                                 
                              
                              
                                 e
                              
                           
                         solved on the mesh of coarse element domain Ω
                           E
                         and oversampling domain Ω′
                           E
                         respectively. From the figures it can be seen that the perturbed result solved in the oversampling regions oscillates at both the internal and external boundaries, which will provide more accurate correction to the macroscopic results.

In the works of Zhang et al. [41,47], the microscopic perturbed results are considered in the post-processor of downscale computation. In the present research they are also considered in the solving of macroscopic equivalent equations, because of which it is called a pre-correction.

Within every fine element, the discretization of temperature and displacement yields the thermal functional 
                           
                              
                                 φ
                              
                              
                                 e
                              
                           
                         and strain energy Π
                        
                           e
                         for every fine element e 
                        [47]
                        
                           
                              (22)
                              
                                 
                                    
                                       φ
                                    
                                    
                                       e
                                    
                                 
                                 =
                                 
                                    1
                                    2
                                 
                                 
                                    
                                       T
                                    
                                    
                                       e
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       K
                                    
                                    
                                       e
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       T
                                    
                                    
                                       e
                                    
                                 
                                 +
                                 
                                    
                                       
                                          T
                                          ̇
                                       
                                    
                                    
                                       e
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       C
                                    
                                    
                                       e
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       T
                                    
                                    
                                       e
                                    
                                 
                                 −
                                 
                                    
                                       F
                                    
                                    
                                       e
                                    
                                    
                                       t
                                    
                                 
                                 
                                    T
                                    e
                                    
                                    
                                    
                                    T
                                 
                                 +
                                 
                                    
                                       c
                                    
                                    
                                       0
                                    
                                 
                              
                           
                        
                        
                           
                              (23)
                              
                                 
                                    
                                       Π
                                    
                                    
                                       e
                                    
                                 
                                 =
                                 
                                    1
                                    2
                                 
                                 
                                    
                                       u
                                    
                                    
                                       e
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       K
                                    
                                    
                                       e
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       e
                                    
                                 
                                 −
                                 
                                    
                                       F
                                    
                                    
                                       e
                                    
                                 
                                 
                                    u
                                    e
                                    
                                    
                                    
                                    T
                                 
                              
                           
                        where T
                        
                           e
                         and u
                        
                           e
                         are, respectively, the temperature and displacement vectors for fine element e, and c
                        0 is a constant. The element matrices and load vectors are express as
                           
                              (24a–c)
                              
                                 
                                    
                                       K
                                    
                                    
                                       e
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    ∫
                                    
                                       
                                          
                                             Ω
                                          
                                          e
                                       
                                    
                                 
                                 
                                    ∇
                                    
                                       
                                          
                                             N
                                          
                                          
                                             t
                                          
                                       
                                       T
                                    
                                    k
                                    ∇
                                    
                                       
                                          N
                                       
                                       
                                          t
                                       
                                    
                                    d
                                    Ω
                                 
                                 +
                                 
                                    ∫
                                    
                                       
                                          
                                             Γ
                                          
                                          
                                             h
                                          
                                          
                                             e
                                          
                                       
                                    
                                 
                                 
                                    h
                                    
                                       
                                          
                                             N
                                          
                                          
                                             t
                                          
                                       
                                       T
                                    
                                    
                                       
                                          N
                                       
                                       
                                          t
                                       
                                    
                                    d
                                    Γ
                                 
                                 ,
                                 
                                    
                                       C
                                    
                                    
                                       e
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    ∫
                                    
                                       
                                          
                                             Ω
                                          
                                          e
                                       
                                    
                                 
                                 
                                    ρ
                                    c
                                    
                                       
                                          
                                             N
                                          
                                          
                                             t
                                          
                                       
                                       T
                                    
                                    
                                       
                                          N
                                       
                                       
                                          t
                                       
                                    
                                    d
                                    Ω
                                 
                                 
                                    
                                       F
                                    
                                    
                                       e
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    ∫
                                    
                                       
                                          
                                             Ω
                                          
                                          e
                                       
                                    
                                 
                                 
                                    Q
                                    
                                       
                                          N
                                       
                                       
                                          t
                                       
                                    
                                    d
                                    Ω
                                 
                                 +
                                 
                                    ∫
                                    
                                       
                                          
                                             Γ
                                          
                                          
                                             q
                                          
                                          
                                             e
                                          
                                       
                                    
                                 
                                 
                                    
                                       q
                                       ^
                                    
                                    
                                       
                                          N
                                       
                                       
                                          t
                                       
                                    
                                    d
                                    Γ
                                 
                                 +
                                 
                                    ∫
                                    
                                       
                                          
                                             Γ
                                          
                                          
                                             h
                                          
                                          
                                             e
                                          
                                       
                                    
                                 
                                 
                                    h
                                    
                                       
                                          T
                                       
                                       
                                          ∞
                                       
                                    
                                    
                                       
                                          N
                                       
                                       
                                          t
                                       
                                    
                                    d
                                    Γ
                                 
                              
                           
                        
                        
                           
                              (25a, b)
                              
                                 
                                    
                                       K
                                    
                                    
                                       e
                                    
                                 
                                 =
                                 
                                    ∫
                                    
                                       
                                          
                                             Ω
                                          
                                          
                                             e
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          B
                                       
                                       T
                                    
                                    DB
                                    d
                                    
                                       
                                          Ω
                                       
                                       
                                          e
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       F
                                    
                                    
                                       e
                                    
                                 
                                 =
                                 
                                    ∫
                                    
                                       
                                          
                                             Ω
                                          
                                          
                                             e
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          B
                                       
                                       T
                                    
                                    D
                                    
                                       
                                          ε
                                       
                                       0
                                    
                                    d
                                    
                                       
                                          Ω
                                       
                                       
                                          e
                                       
                                    
                                 
                                 +
                                 
                                    ∫
                                    
                                       
                                          
                                             Ω
                                          
                                          
                                             e
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          f
                                       
                                       T
                                    
                                    
                                       
                                          N
                                       
                                       
                                          u
                                       
                                    
                                    d
                                    
                                       
                                          Ω
                                       
                                       
                                          e
                                       
                                    
                                 
                                 +
                                 
                                    ∫
                                    
                                       
                                          
                                             Γ
                                          
                                          
                                             σ
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             σ
                                             ^
                                          
                                       
                                       T
                                    
                                    
                                       
                                          N
                                       
                                       
                                          u
                                       
                                    
                                    d
                                    Γ
                                 
                              
                           
                        where N
                        t and N
                        u are the shape function matrices (standard FEM) of the fine element for thermal and structure analysis, respectively. Adding all the functional and strain energy of fine elements within a coarse element, using Eqs. (17) and (18) and ignoring the constant items yield
                           
                              (26)
                              
                                 
                                    
                                       ϕ
                                    
                                    
                                       E
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       e
                                       =
                                       1
                                    
                                    m
                                 
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          e
                                       
                                    
                                 
                                 =
                                 
                                    1
                                    2
                                 
                                 
                                    
                                       T
                                    
                                    
                                       E
                                    
                                 
                                 
                                    K
                                    
                                       E
                                    
                                    
                                       t
                                    
                                    
                                    
                                    T
                                 
                                 
                                    
                                       T
                                    
                                    
                                       E
                                    
                                 
                                 +
                                 
                                    
                                       
                                          T
                                          ̇
                                       
                                    
                                    
                                       E
                                    
                                 
                                 
                                    C
                                    
                                       E
                                    
                                    
                                       t
                                    
                                    
                                    
                                    T
                                 
                                 
                                    
                                       T
                                    
                                    
                                       E
                                    
                                 
                                 −
                                 
                                    
                                       F
                                    
                                    
                                       E
                                    
                                    
                                       t
                                    
                                 
                                 
                                    T
                                    E
                                    
                                    
                                    
                                    T
                                 
                              
                           
                        
                        
                           
                              (27)
                              
                                 
                                    
                                       Π
                                    
                                    
                                       E
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       e
                                       =
                                       1
                                    
                                    m
                                 
                                 
                                    
                                       
                                          Π
                                       
                                       
                                          e
                                       
                                    
                                 
                                 =
                                 
                                    1
                                    2
                                 
                                 
                                    
                                       u
                                    
                                    
                                       E
                                    
                                 
                                 
                                    K
                                    E
                                    
                                    
                                    
                                    T
                                 
                                 
                                    
                                       u
                                    
                                    
                                       E
                                    
                                 
                                 −
                                 
                                    
                                       F
                                    
                                    
                                       E
                                    
                                 
                                 
                                    u
                                    E
                                    
                                    
                                    
                                    T
                                 
                              
                           
                        where m is the number of fine grid elements within a coarse grid element. The equivalent element matrices and vectors are
                           
                              (28a–c)
                              
                                 
                                    
                                       K
                                    
                                    
                                       E
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       e
                                       =
                                       1
                                    
                                    m
                                 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   G
                                                
                                                
                                                   e
                                                
                                                
                                                   t
                                                
                                             
                                          
                                          )
                                       
                                       T
                                    
                                    
                                       
                                          K
                                       
                                       
                                          e
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          G
                                       
                                       
                                          e
                                       
                                       
                                          t
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       C
                                    
                                    
                                       E
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       e
                                       =
                                       1
                                    
                                    m
                                 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   G
                                                
                                                
                                                   e
                                                
                                                
                                                   t
                                                
                                             
                                          
                                          )
                                       
                                       T
                                    
                                    
                                       
                                          C
                                       
                                       
                                          e
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          G
                                       
                                       
                                          e
                                       
                                       
                                          t
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       F
                                    
                                    
                                       E
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       e
                                       =
                                       1
                                    
                                    m
                                 
                                 
                                    
                                       (
                                       
                                          
                                             
                                                F
                                             
                                             
                                                e
                                             
                                             
                                                t
                                             
                                          
                                          −
                                          
                                             
                                                K
                                             
                                             
                                                e
                                             
                                             
                                                t
                                             
                                          
                                          
                                             
                                                
                                                   T
                                                   ˜
                                                
                                             
                                             
                                                e
                                             
                                          
                                       
                                       )
                                    
                                    
                                       
                                          G
                                       
                                       
                                          e
                                       
                                       
                                          t
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (29a, b)
                              
                                 
                                    
                                       K
                                    
                                    
                                       E
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       e
                                       =
                                       1
                                    
                                    m
                                 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                G
                                             
                                             
                                                e
                                             
                                          
                                          )
                                       
                                       T
                                    
                                    
                                       
                                          K
                                       
                                       
                                          e
                                       
                                    
                                    
                                       
                                          G
                                       
                                       
                                          e
                                       
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       F
                                    
                                    
                                       E
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       e
                                       =
                                       1
                                    
                                    m
                                 
                                 
                                    (
                                    
                                       
                                          F
                                       
                                       
                                          e
                                       
                                    
                                    −
                                    
                                       
                                          K
                                       
                                       
                                          e
                                       
                                    
                                    
                                       
                                          
                                             u
                                             ˜
                                          
                                       
                                       
                                          e
                                       
                                    
                                    )
                                    
                                       
                                          G
                                       
                                       
                                          e
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 K
                              
                              
                                 e
                              
                              
                                 t
                              
                           
                           
                              
                                 
                                    T
                                    ˜
                                 
                              
                              
                                 e
                              
                           
                         and 
                           
                              
                                 K
                              
                              
                                 e
                              
                           
                           
                              
                                 
                                    u
                                    ˜
                                 
                              
                              
                                 e
                              
                           
                         are the internal loads induced by the pre-corrections. From the above derivation it can be found that the material properties are evaluated directly on the microscopic structure and transformed to the macroscale using the NBFs. Then the equivalent element matrices and vectors are determined, so there is no notion of effective material properties in the present research which is different from the homogenization method.

Considering the stationarity of the functional and strain energy yields
                           
                              (30)
                              
                                 
                                    
                                       C
                                    
                                    t
                                 
                                 
                                    T
                                    ̇
                                 
                                 +
                                 
                                    
                                       K
                                    
                                    t
                                 
                                 T
                                 =
                                 
                                    
                                       F
                                    
                                    t
                                 
                              
                           
                        
                        
                           
                              (31)
                              
                                 KU
                                 =
                                 F
                              
                           
                        where the matrices are assembled from the macroscopic element matrices, i.e.
                           
                              (32a–e)
                              
                                 
                                    
                                       K
                                    
                                    t
                                 
                                 =
                                 
                                    A
                                    
                                       i
                                       =
                                       1
                                    
                                    M
                                 
                                 
                                    
                                       K
                                    
                                    
                                       E
                                       i
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       C
                                    
                                    t
                                 
                                 =
                                 
                                    A
                                    
                                       i
                                       =
                                       1
                                    
                                    M
                                 
                                 
                                    
                                       C
                                    
                                    
                                       E
                                       i
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       F
                                    
                                    t
                                 
                                 =
                                 
                                    A
                                    
                                       i
                                       =
                                       1
                                    
                                    M
                                 
                                 
                                    
                                       F
                                    
                                    
                                       E
                                       i
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 K
                                 =
                                 
                                    A
                                    
                                       i
                                       =
                                       1
                                    
                                    M
                                 
                                 
                                    
                                       K
                                    
                                    
                                       E
                                       i
                                    
                                 
                                 ,
                                 F
                                 =
                                 
                                    A
                                    
                                       i
                                       =
                                       1
                                    
                                    M
                                 
                                 
                                    
                                       F
                                    
                                    
                                       E
                                       i
                                    
                                 
                              
                           
                        where 
                           
                              A
                              
                                 i
                                 =
                                 1
                              
                              M
                           
                         is the assemble operator and M is the number of coarse elements.

Using the macroscopic equivalent matrices and load vectors, the nonlinear thermoelastic analysis can be carried out on the macroscale. Considering the temperature-dependent material properties, Eq. (30) is a nonlinear parabolic partial differential equation. Using the direct integration in time domain, we have
                           
                              (33)
                              
                                 
                                    
                                       (
                                       
                                          
                                             
                                                d
                                                T
                                             
                                             
                                                d
                                                t
                                             
                                          
                                       
                                       )
                                    
                                    
                                       n
                                       +
                                       β
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                 
                                 −
                                 
                                    
                                       T
                                    
                                    
                                       n
                                    
                                 
                                 )
                                 /
                                 Δ
                                 t
                                 ,
                                 
                                    
                                       T
                                    
                                    
                                       n
                                       +
                                       β
                                    
                                 
                                 =
                                 (
                                 1
                                 −
                                 β
                                 )
                                 
                                    
                                       T
                                    
                                    
                                       n
                                    
                                 
                                 +
                                 β
                                 
                                    
                                       T
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                 
                              
                           
                        where β is a constant and satisfies 0≤β≤1. Substituting Eq. (33) into Eq. (30) yields
                           
                              (34)
                              
                                 
                                    (
                                    
                                       
                                          1
                                          
                                             Δ
                                             t
                                          
                                       
                                       
                                          
                                             C
                                          
                                          t
                                       
                                       +
                                       β
                                       
                                          
                                             K
                                          
                                          t
                                       
                                    
                                    )
                                 
                                 
                                    
                                       T
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          1
                                          
                                             Δ
                                             t
                                          
                                       
                                       
                                          
                                             C
                                          
                                          t
                                       
                                       −
                                       
                                          (
                                          
                                             1
                                             −
                                             β
                                          
                                          )
                                       
                                       
                                          
                                             K
                                          
                                          t
                                       
                                    
                                    )
                                 
                                 
                                    
                                       T
                                    
                                    
                                       n
                                    
                                 
                                 +
                                 
                                    
                                       F
                                    
                                    
                                       n
                                       +
                                       β
                                    
                                    
                                       t
                                    
                                 
                              
                           
                        where C, K and F are evaluated at time t
                        
                           n+β
                        . The nonlinear equation is expressed as
                           
                              (35)
                              
                                 Ψ
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                 
                                 )
                                 =
                                 
                                    (
                                    
                                       
                                          1
                                          
                                             Δ
                                             t
                                          
                                       
                                       
                                          
                                             C
                                          
                                          t
                                       
                                       +
                                       β
                                       
                                          
                                             K
                                          
                                          t
                                       
                                    
                                    )
                                 
                                 
                                    
                                       T
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                 
                                 −
                                 
                                    (
                                    
                                       
                                          1
                                          
                                             Δ
                                             t
                                          
                                       
                                       
                                          
                                             C
                                          
                                          t
                                       
                                       −
                                       (
                                       1
                                       −
                                       β
                                       )
                                       
                                          
                                             K
                                          
                                          t
                                       
                                    
                                    )
                                 
                                 
                                    
                                       T
                                    
                                    
                                       n
                                    
                                 
                                 −
                                 
                                    
                                       F
                                    
                                    
                                       n
                                       +
                                       β
                                    
                                    
                                       t
                                    
                                 
                              
                           
                        Then the following equation is solved in each iteration step i of a time step n+1:
                           
                              (36)
                              
                                 Ψ
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 =
                                 −
                                 
                                    
                                       
                                          
                                             
                                                ∂
                                                Ψ
                                             
                                             
                                                ∂
                                                T
                                             
                                          
                                       
                                       |
                                    
                                    
                                       
                                          
                                             T
                                          
                                          
                                             n
                                             +
                                             1
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 Δ
                                 
                                    
                                       T
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        where
                           
                              (37)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∂
                                                Ψ
                                             
                                             
                                                ∂
                                                T
                                             
                                          
                                       
                                       |
                                    
                                    
                                       
                                          
                                             T
                                          
                                          
                                             n
                                             +
                                             1
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 =
                                 
                                    1
                                    
                                       Δ
                                       t
                                    
                                 
                                 
                                    
                                       C
                                    
                                    t
                                 
                                 +
                                 β
                                 
                                    
                                       K
                                    
                                    t
                                 
                              
                           
                        is the Jacobian matrix, or the tangent stiffness matrix and 
                           Δ
                           
                              
                                 T
                              
                              
                                 n
                                 +
                                 1
                              
                              
                                 i
                              
                           
                         is temperature increment. The temperature vector for time step t
                        
                           n+1 is updated after each iteration step as
                           
                              (38)
                              
                                 
                                    
                                       T
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       T
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 Δ
                                 
                                    
                                       T
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        
                     

The material properties of thermoelastic analysis are evaluated after the nonlinear heat conduction computation, where the thermoelastic analysis (31) is a linear process. The flow chart of the pre-correction multiscale strategy for nonlinear heat conduction analysis and the thermoelastic analysis is, respectively, shown in 
                        
                        Figs. 5 and 6. The NBFs for the temperature and displacement fields are constructed at the initial state and are not updated with changes of temperature. In the flow chart for the heat conduction analysis, the nonlinear iteration is the Newton–Raphson iterative procedure. If the Jacobian matrix at the initial iteration step is used the iterative procedure is the modified Newton–Raphson iteration, which is used in the following computations of the present paper.

The downscale computation can be implemented through the mapping relationship between coarse element and fine element expressed in Eqs. (17) and (18). Then the microscopic strain and stress information can be obtained directly which is particularly important for the nonlinear analysis because the microscopic variables should be well captured along with the evolution of macroscopic displacement response.

Once the microscopic stress is determined, the direct micromechanical failure analysis process can be implemented. To evaluate the strength of the heterogeneous material, the factor of safety is computed for the microscopic material point. The von Mises failure criterion is used for the ductile material and the factor of safety is computed as [50]
                        
                           
                              (39)
                              
                                 
                                    
                                       
                                          F
                                       
                                       
                                          s
                                       
                                    
                                    d
                                 
                                 (
                                 x
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             y
                                          
                                       
                                    
                                    
                                       
                                          
                                             3
                                             
                                                
                                                   J
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 σ
                              
                              
                                 y
                              
                           
                         is the yield strength and 
                           
                              
                                 J
                              
                              
                                 2
                              
                           
                         is the second deviator invariant of stresses. For the brittle materials, a modified-Mohr criterion is utilized in which the factor of safety is given as [50]
                        
                           
                              (40)
                              
                                 
                                    
                                       
                                          F
                                       
                                       
                                          s
                                       
                                    
                                    b
                                 
                                 (
                                 x
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             u
                                             t
                                          
                                       
                                    
                                    
                                       max
                                       (
                                       
                                          
                                             C
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             C
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             C
                                          
                                          
                                             3
                                          
                                       
                                       ,
                                       
                                          
                                             σ
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             σ
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             σ
                                          
                                          
                                             3
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        where 
                           
                              
                                 σ
                              
                              
                                 i
                              
                           
                         are the principal stresses; 
                           
                              
                                 C
                              
                              
                                 i
                              
                           
                         are the Dowling coefficients [50]:
                           
                              (41)
                              
                                 
                                    
                                       C
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 [
                                 |
                                 
                                    
                                       σ
                                    
                                    
                                       1
                                    
                                 
                                 −
                                 
                                    
                                       σ
                                    
                                    
                                       2
                                    
                                 
                                 |
                                 +
                                 
                                    
                                       c
                                    
                                    
                                       σ
                                    
                                 
                                 (
                                 
                                    
                                       σ
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       σ
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 ]
                                 /
                                 2
                                 
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 [
                                 |
                                 
                                    
                                       σ
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 
                                    
                                       σ
                                    
                                    
                                       3
                                    
                                 
                                 |
                                 +
                                 
                                    
                                       c
                                    
                                    
                                       σ
                                    
                                 
                                 (
                                 
                                    
                                       σ
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       σ
                                    
                                    
                                       3
                                    
                                 
                                 )
                                 ]
                                 /
                                 2
                                 
                                    
                                       C
                                    
                                    
                                       3
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 [
                                 |
                                 
                                    
                                       σ
                                    
                                    
                                       3
                                    
                                 
                                 −
                                 
                                    
                                       σ
                                    
                                    
                                       1
                                    
                                 
                                 |
                                 +
                                 
                                    
                                       c
                                    
                                    
                                       σ
                                    
                                 
                                 (
                                 
                                    
                                       σ
                                    
                                    
                                       3
                                    
                                 
                                 +
                                 
                                    
                                       σ
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 ]
                                 /
                                 2
                              
                           
                        where 
                           
                              
                                 c
                              
                              
                                 σ
                              
                           
                           =
                           (
                           |
                           
                              
                                 σ
                              
                              
                                 u
                                 c
                              
                           
                           |
                           −
                           2
                           
                              
                                 σ
                              
                              
                                 u
                                 t
                              
                           
                           )
                           /
                           (
                           |
                           
                              
                                 σ
                              
                              
                                 u
                                 c
                              
                           
                           |
                           )
                        ; 
                           
                              
                                 σ
                              
                              
                                 u
                                 t
                              
                           
                         and 
                           
                              
                                 σ
                              
                              
                                 u
                                 c
                              
                           
                         are the ultimate tensile and compressive strengths of the brittle material, respectively. It should be noted that 
                           
                              
                                 σ
                              
                              
                                 y
                              
                           
                        , 
                           
                              
                                 σ
                              
                              
                                 u
                                 t
                              
                           
                         and 
                           
                              
                                 σ
                              
                              
                                 u
                                 c
                              
                           
                         are bulk material strengths. The factory of safety of the entire structure is the minimum of 
                           
                              
                                 F
                              
                              
                                 s
                              
                           
                           (
                           x
                           )
                         occurring in 
                           Ω
                         as discussed in [21].

The main purpose of the multiscale methods is to solve the problems that cannot be solved by the direct methods using even the modern supercomputer. In the framework of CEMsFEM, the microscopic information is transformed to the macroscale through the micro–macro mapping relationship established by the NBFs. The computation of global equation is implemented on the macroscale. In this section we make a rough estimation of the computation effort of nonlinear thermoelastic for the CEMsFEM, and compare it with the traditional FEM.

Let us consider a fine scale model with a total number of nodes L. The total number of coarse elements is M. Then the total number of nodes within each coarse element is L/M approximately. We assume that the total number of coarse nodes is M.

In the finite element computation, when the number of DOFs is large, the memory and CPU time are mainly used for the storage and decomposition of the global stiffness matrix. Because the FEM is directly solved on the fine scale model the memory needed is O
                     2(L), while in the framework of CEMsFEM the memory needed is O
                     2(M)+MO
                     2(L/M). In the decomposition of stiffness matrix the operation count is O
                     2(L) for the FEM, while for the proposed method the operation count is about O
                     2(M)+M·O
                     2(L/M). It can be seen that when the structure is large, the memory and CPU time could be reduced significantly using the present method.

By using the present method, the iteration is performed on the macroscale and the number of DOFs is greatly reduced. One can find that, in the present method, most of the CPU time is spent on the solving of microscopic perturbed results. In these computations, different coarse elements are decoupled which is convenient for the parallel computation.

In this section, the accuracy and validity of the proposed method are demonstrated by several representative numerical examples. In the following computations, the results of traditional FEM on the fine grid are taken as the reference solutions and are denoted as FEM-F. The results of the original CEMsFEM presented in [47] are denoted as CEMs and the results of the pre-correction multiscale strategy are denoted as CEMs-Pre.

In the following computations, the regular and random microstructures are investigated. The random morphology description functions (RMDF) method as depicted in [20] is used to create typical random microstructures. The RMDF is defined as a sum of two-dimensional Gaussian functions:
                        
                           (42)
                           
                              f
                              (
                              Ω
                              )
                              =
                              
                                 ∑
                                 
                                    i
                                    =
                                    1
                                 
                                 N
                              
                              
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       e
                                    
                                    
                                       −
                                       
                                          [
                                          
                                             
                                                
                                                   
                                                      
                                                         (
                                                         x
                                                         −
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               (
                                                               i
                                                               )
                                                            
                                                         
                                                         )
                                                      
                                                      2
                                                   
                                                   +
                                                   
                                                      
                                                         (
                                                         y
                                                         −
                                                         
                                                            
                                                               y
                                                            
                                                            
                                                               (
                                                               i
                                                               )
                                                            
                                                         
                                                         )
                                                      
                                                      2
                                                   
                                                
                                                
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                    
                                 
                              
                           
                        
                     where N is the total number of Gaussian functions. The magnitudes c
                     
                        i
                      are randomly chosen in [−1,1], and the centers 
                        (
                        
                           
                              x
                           
                           
                              (
                              i
                              )
                           
                        
                        ,
                        
                           
                              y
                           
                           
                              (
                              i
                              )
                           
                        
                        )
                        ∈
                        Ω
                      of the Gaussian functions are chosen randomly. The spatial widths of the individual Gaussian functions w
                     
                        i
                      are chosen as
                        
                           (43)
                           
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                              
                              =
                              l
                              /
                              
                                 N
                              
                           
                        
                     where l is the characteristic length of the structure. The RMDF and cutoff value f
                     0 are used to define the two-phase microstructure. The material property p(x) at a location within the domain is defined as
                        
                           (44)
                           
                              p
                              (
                              x
                              )
                              =
                              
                                 {
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      (
                                                      1
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                                if
                                                
                                                
                                                   f
                                                   ¯
                                                
                                                (
                                                Ω
                                                )
                                                >
                                                
                                                   
                                                      
                                                         f
                                                         ¯
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      (
                                                      2
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                                if
                                                
                                                
                                                   f
                                                   ¯
                                                
                                                (
                                                Ω
                                                )
                                                <
                                                
                                                   
                                                      
                                                         f
                                                         ¯
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where p
                     (i) denotes the material property of phase i; 
                        
                           f
                           ¯
                        
                        
                           (
                           Ω
                           )
                        
                      and 
                        
                           
                              
                                 f
                                 ¯
                              
                           
                           
                              0
                           
                        
                      are the normalized RMDF function and normalized cutoff value, respectively. The volume fraction V
                     1 of the first material phase is computed by
                        
                           (45)
                           
                              
                                 
                                    V
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 1
                                 
                                    |
                                    Ω
                                    |
                                 
                              
                              
                                 ∫
                                 Ω
                              
                              
                                 H
                                 (
                                 
                                    f
                                    ¯
                                 
                                 (
                                 Ω
                                 )
                                 −
                                 
                                    
                                       
                                          f
                                          ¯
                                       
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 d
                                 Ω
                              
                           
                        
                     where 
                        H
                        (
                        ⋅
                        )
                      is the Heaviside step function. The cutoff value f
                     0 is properly chosen to yield the desired volume fraction.

As indicated by researchers, strong boundary effect can affect the accuracy of the multiscale methods, which is hard to be reduced. In this section, the boundary effect of the proposed method is tested. Without loss of generality, the tests are performed on structures composed of a single unit cell. In fact, the smaller the number of coarse elements, the more significant the boundary effects.

The size of the structure is 1×1mm2 and meshed by one coarse element as shown in 
                        Fig. 7(a). The load and boundary conditions for the structure are also shown in Fig. 7(a). The temperature on the left hand side (LHS) of the structure is fixed at 0°C. The right hand side (RHS) of the structure is subjected to a uniformly distributed heat flux load q
                        0. The displacement on the LHS is constrained in the normal direction. The displacement of the lower left corner is fixed to avoid the rigid body displacement. The plane strain problem is considered for the structure analysis.

A Ti/ZrO2 two-phase microstructure material is considered. The colors of Ti and ZrO2 are depicted in Fig. 7 and are the same as those in the following other models. The temperature-dependent materials are expressed in a general form as [49]
                        
                           
                              (46)
                              
                                 p
                                 (
                                 n
                                 )
                                 =
                                 
                                    
                                       p
                                    
                                    
                                       0
                                    
                                 
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 /
                                 T
                                 +
                                 1
                                 +
                                 
                                    
                                       p
                                    
                                    
                                       1
                                    
                                 
                                 T
                                 +
                                 
                                    
                                       p
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       T
                                    
                                    2
                                 
                                 +
                                 
                                    
                                       p
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       T
                                    
                                    3
                                 
                                 )
                              
                           
                        
                     

The coefficients in Eq. (46) for material Ti and ZrO2 are shown in 
                        Table 1, where coefficients p
                        −1 for these two materials are both equal to zero. Three representative unit cells are considered. Except for the Ti matrix reinforced with ZrO2 rectangular inclusion and ZrO2 matrix reinforced with Ti circular inclusion, the random inclusion generated by RMDF method is also considered with the number of Gaussian functions N=800 and volume fraction V
                        Ti=0.5. The sub-grids of these unit cells are shown in Fig. 7(b)–(d).

The results of temperature and the von Mises stress for the three unit cells are shown in 
                        
                        Figs. 8 and 9. It can be observed that the results of the present method are consistent with the reference solution on the left half of the model and a little differences exist on the right half of the model. Errors of temperature are induced by the approximation of pre-correction solved at initial temperature distribution. The material properties of thermoelastic analysis are evaluated at the final convergent temperature field value and errors of von Mises stress are introduced by the inaccuracy of the temperature field.


                        
                        Fig. 10 shows the microscopic perturbed pre-corrections of temperature and displacement for the three unit cells. It can be found that the pre-corrections are oscillatory and affected by the material distribution, loads and boundaries. The pre-corrections can provide modifications to the macroscopic results at both the internal and the boundary of the structures.

Temperature rising in the structure often causes the weakening of the structure bearing external mechanical loads. In this subsection, the accuracy of the proposed pre-correction strategy is tested by a cantilever beam structure subjected to thermal and mechanics loads together. The model, loads and boundary conditions are shown in 
                        Fig. 11. The size of the structure is 24mm×6mm. The LHS of the structure is constrained in the x-direction and faces a time varying heat flux load
                           
                              (47)
                              
                                 q
                                 (
                                 t
                                 )
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         [
                                                         4
                                                         t
                                                         (
                                                         
                                                            
                                                               t
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                         −
                                                         t
                                                         )
                                                         /
                                                         
                                                            
                                                               t
                                                            
                                                            
                                                               0
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         ]
                                                      
                                                      4
                                                   
                                                   ,
                                                
                                             
                                             
                                                
                                                   0
                                                   ≤
                                                   t
                                                   ≤
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   0
                                                   ,
                                                
                                             
                                             
                                                
                                                   t
                                                   >
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where q
                        0=2E5W/m2 and t
                        0=75s. The other boundaries of the structure are convection boundary conditions where the convection coefficient is 10W/(m2
                        K) and the ambient temperature is 0°C. A uniform force is exerted on the top side of the model. The intensity is −1E6N/m and located at x=21–24mm. Four types of unit cells are considered as shown in Fig. 11(a)–(d), i.e. homogeneous, circular inclusion, circular void and random inclusion, where the material of the matrix is ZrO2 and that of the inclusion is Ti. For the homogeneous and random inclusion, 1.4×1.4 of the original coarse element regions are used in the oversampling technique for the pre-correction results. To investigate the influence of temperature-dependent material properties on the response of the structure the results of temperature independent properties are also computed, where the properties are evaluated at temperature T=0°C. The results of temperature-dependent and temperature-independent materials properties are denoted as NL and L respectively. The initial temperature is chosen as 0°C. The transient problem is solved for 100 time steps with a time incremental Δt=1s. The plane strain problem is considered for the structure analysis.

The temperature and vertical displacement response at points A–D (as shown in Fig. 11) for the four unit cells are shown in 
                        
                        Figs. 12 and 13, respectively. It can be found that the results of the pre-correction strategy fit better with the reference solutions especially in the nonlinear cases, which indicates that the pre-correction strategy can improve the accuracy of the macroscopic responses. On the other hand, when the temperature-dependence of the material is omitted, the predicted temperature results are much higher and the displacement results are independent of temperature, while for the temperature-dependent cases the displacement results increase as the temperature arise.


                        
                        
                        
                        
                        Figs. 14–17 illustrate the von Mises stress distribution in the structure at t=100s for the four unit cells, and only the nonlinear results are given here in order to save space. 
                        Fig. 18 shows the von Mises stress in the structure at x=0.5mm for t=20s and t=100s. From these figures we can see that there exist relatively large errors at the boundaries of the coarse elements when the original CEMsFEM method is directly used in the nonlinear thermoelastic problem. The proposed pre-correction strategy can make corrections to these errors and the results fit fairly well with the reference solutions. From Fig. 18 it can be also found that much higher predicted values of von Mises stress are obtained for the temperature-independent cases. The differences of temperature, displacement and stress results between temperature-dependent and temperature-independent cases indicate that the temperature-dependent properties should not be omitted when the structure is subjected to large changes in temperature.

The functionally graded materials (FGM) have attracted considerable attention in recent years. In this subsection, the nonlinear thermoelastic behaviors of FGM are modeled by the proposed method. The microscopic structure of Ti/ZrO2 FGM model is generated using the RMDF method. As shown in 
                        Fig. 19, the RMDF function is generated with N=7210 Gaussian functions. The volume fraction V
                        Ti is 1.0 and 0.0 at the LHS and RHS of the structure, respectively, and varies linearly in the x-direction. The cutoff value f
                        0 is properly chosen to satisfy the linear variation of volume fraction V
                        Ti.

The load, boundary conditions and the mesh discretization are shown in 
                        Fig. 20. The LHS of the structure faces convection boundary condition where the convection coefficient is 1.0E3W/(m2
                        K) and the ambient temperature is 0°C. The RHS of the structure is subjected to a time-varying heat flux load as shown in Eq. (46) where q
                        0=2E5W/(m2
                        s) and t
                        0=37.5s. The top and bottom sides of the structure are constrained in the normal direction. The lower left corner of the structure is constrained to avoid rigid body movement. The plane stress problem is considered for the structure analysis. The initial temperature is 0°C. The transient problem is solved for 50 time steps with a time incremental Δt=1s. For the pre-correction strategy, a 1.4×1.4 oversampling region is used.


                        
                        Fig. 21 shows the temperature response at points A and B and safety factor for materials Ti and ZrO2. It can be found that the CEMs-Pre fits fairly well with the reference solution. The minimum safety factor occurs at t=24s. 
                        Fig. 22 shows the contour plots of safety factor at t=24s obtained by these methods at the microscale. The relative errors of minimum safety factor at t=24s of CEMs and CEMs-Pre are 8.42% and 3.55% respectively. For the original CEMsFEM, the boundary effect is seen at the boundary of the coarse element regions. In the pre-correction strategy, the boundary correction is performed through the oversampling technique and the results fit the reference solution very well.

The statistical characterization of microstructure generated using RMDF method has been discussed by Vel and Goupee [20] using n-point probability functions and cluster-type functions due to the randomness of the distribution of the material properties. The macroscopic safety factor field of the current problem is shown in 
                        Fig. 23 as well as the direct microscopic results of safety factor. The macroscopic safety factor is obtained by using the volume average of microscopic safety factor over each coarse element region. The relative errors of macroscopic safety factor of CEMs and CEMs-Pre are, respectively, 20.01% and 0.47%. This demonstrates the accuracy of the proposed method. Furthermore, there exist high stress regions at the heated side due to the heat expansion effect and the FGM exhibits good performance in alleviating the internal thermal stress on its transitional layer.

Thermal management remains challenge for many small-scale applications; an effective approach is to use a fluid channel by forcing convection to enhance local cooling of the structures. A cooling structure of ZrO2 material enforced with 20×5 circular inclusions and imbedded with 150 fluid channels as shown in 
                        Fig. 24 is considered. The size of the structure is 25mm×10mm. The temperature and the convection coefficient of the cooling fluid are 0°C and 1.0E3W/(m2
                        K), respectively. Part of the bottom surface of the structure is subjected to a heat flux as given in Eq. (47) with q
                        0=1E5W/(m2
                        s) and t
                        0=37.5s as shown in Fig. 24. The bottom and the LHS of the structure are mechanically constrained in their normal directions. The plane stress problem is considered for the structure analysis. The initial temperature is 0°C. The transient problem is solved for 100 time steps with a time incremental Δt=0.5s.

As illustrated in Fig. 24, 250 coarse elements are generated on this structure, and the sub-grids for the coarse elements are also shown in Fig. 24. The temperature response for points A and B and safety factor for materials Ti and ZrO2 by different methods are shown in 
                        Fig. 25. It can be found that the cooling system designed can effectively reduce the local temperature of the structure. Moreover, the accuracy of the CEMs is satisfactory except for the magnitude at the peak point of the curves while CEMs-Pre is quit consistent with the reference solution. The minimum safety factor occurs at t=27.5s. The factor of safety of the cooling structure at t=27.5s can be found in 
                        Fig. 26. Due to the heat expansion of the heated region, there exists tension stress at the outer region of the brittle ZrO2 which causes a low safety factor distribution. This indicates that the size and shape of the channel should be optimized to increase the strength. Furthermore the CEMs-Pre shows satisfactory accuracy compared to FEM-F, while errors exists in the boundary regions of the coarse elements for the CEMs. Moreover, since the global equation is directly solved on the macroscopic structure, the proposed method can have relatively higher numerical efficiency than that by the traditional FEM in the multiscale analysis of the heterogeneous multiphase materials.

W/Cu FGM have great development potential as heat sink material, plasma facing material or contacts material due to their ability to alleviate the internal thermal stress on its transitional layers. The model of W/Cu FGM has been studied by Goupee and Vel [21] using the asymptotic expansion homogenization (AEH) method. Their homogeneous material properties match the experimental data very well. In this subsection, the results of the present method are compared with that of AEH method from Ref. [21]. The microstructure of the W/Cu FGM is created using the morphology description functions (MDF) method as shown in [21], where a particular MDF is chosen:
                           
                              (48)
                              
                                 f
                                 (
                                 Ω
                                 )
                                 =
                                 [
                                 2
                                 −
                                 
                                 cos
                                 (
                                 2
                                 π
                                 x
                                 /
                                 
                                    
                                       l
                                    
                                    
                                       x
                                    
                                 
                                 )
                                 −
                                 
                                 cos
                                 (
                                 2
                                 π
                                 y
                                 /
                                 
                                    
                                       l
                                    
                                    
                                       y
                                    
                                 
                                 )
                                 ]
                                 /
                                 4
                              
                           
                        where 
                           
                              
                                 l
                              
                              
                                 x
                              
                           
                         and 
                           
                              
                                 l
                              
                              
                                 y
                              
                           
                         are chosen as the length of the coarse element in the two directions. The size of the structure is 9×32mm2 and only the right half of the plane stress body is modeled due to symmetry conditions. The load, boundary conditions and the mesh discretization are shown in 
                        Fig. 27, where the size of the coarse element is 0.5×0.5mm2. The material properties for W and Cu are as shown in 
                        Table 2. The transient heat flux loading is expressed as
                           
                              (49)
                              
                                 q
                                 (
                                 t
                                 )
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   2.5
                                                   (
                                                   1
                                                   −
                                                   t
                                                   )
                                                   
                                                   
                                                      
                                                         MW
                                                         /
                                                         m
                                                      
                                                      2
                                                   
                                                   ,
                                                
                                             
                                             
                                                
                                                   0
                                                   <
                                                   t
                                                   <
                                                   1
                                                   
                                                   s
                                                
                                             
                                          
                                          
                                             
                                                
                                                   0
                                                   ,
                                                
                                             
                                             
                                                
                                                   t
                                                   ≥
                                                   1
                                                   
                                                   s
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

A transient finite element analysis is performed with a time step Δt=0.025s. Results of the present method are compared with that from Goupee and Vel [21] as shown in 
                        Fig. 28. The trend of transient temperature response at point x=0.5, y=0.45 fits the results obtained by using the AEH method in Ref. [21]. The coordinates of critical location, transient factor of safety and transient von Mises stress are shown in order in Fig. 28(b)–(d). The results of the present method are in accordance with that of the AEH method to a certain extent. But there also exist differences between them which are mainly caused by the scale effect and the different mesh discretization schemes. On one hand, the material distribution within the coarse element can be modeled according to the actual structure while the scale effect is omitted in the homogenization method. On the other hand, the discontinuity of the material properties causes stress concentration in local regions which is sensitive to the mesh discretization scheme. Different from the homogeneous methods, the microscopic stress can be easily recovered using the NBFs in the present method once the macroscopic displacement is obtained. This is convenient for the direct micromechanical failure analysis.

@&#CONCLUSIONS@&#

A new multiscale strategy based on the coupling extended multiscale finite element framework is developed to predict nonlinear thermoelastic behaviors of heterogeneous multiphase materials. The NBFs are constructed to bring the microscopic heterogeneous properties to the macroscale. Microscopic perturbed pre-corrections are constructed for the modification of the macroscopic response and the local microscopic results. Then the multiscale strategy is implemented for the nonlinear thermoelastic analysis. Based on the NBFs, the thermoelastic behaviors of the heterogeneous material can be successfully simulated on a coarse grid, which will greatly reduce the CPU time and memory storage space.

Finally, several numerical examples are presented to assess the multiscale strategy developed. These numerical examples demonstrate that the proposed strategy can effectively solve the nonlinear thermoelastic problems and the pre-correction can modify the unbalance of the results obtained using the direct downscale computation. The multiscale thermoelastic analyses of the Ti/ZrO2 FGM and the cooling structure are conducted. The results indicate that the FGM exhibit good performance in alleviating the internal thermal stress on its transitional layer. The shape and size of the fluid channels embedded in the cooling structure should be optimized to eliminate high stress regions. Compared to the original CEMsFEM method for the linear thermoelastic problems, the proposed method has minor advantages for the macroscopic response. However, the improvements to the stress and safety factor are distinguishable, especially the peak value which is important for the strength judgment. Finally the model of W/Cu FGM is analyzed and the results of the present method can fit that of the homogenization method. Different from the homogenization method, the scale effect can be automatically considered and the downscale computation can be implemented conveniently for the present method. The proposed method can be easily parallelized and used for simulation, designing and optimizing of heterogeneous multiphase materials.

@&#ACKNOWLEDGMENTS@&#

The supports of the National Natural Science Foundation of China (11232003, 11072051, 90715037, and 91315302), the National Basic Research Program of China (2010CB832704), the 111 Project (No. B08014) and the Ph.D. Programs Foundation of Ministry of Education of the People׳s Republic of China (20130041110050) are gratefully acknowledged.

@&#REFERENCES@&#

