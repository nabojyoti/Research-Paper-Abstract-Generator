@&#MAIN-TITLE@&#On the optimization of HDD arms with piezoelectric actuation

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           We apply topology optimization to design HDD arms.


                        
                        
                           
                           The optimization covers optimal material distribution and piezoelectric polarization.


                        
                        
                           
                           We maximize displacements, with appropriate structural stiffness, and avoid resonance.


                        
                        
                           
                           We model the HDD are with multi-layer piezoelectric shell element.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Topology optimization

HDD arm

Piezoelectric laminated plates

Finite element method

Structural optimization

@&#ABSTRACT@&#


               
               
                  As storage data density in hard-disk drives (HDDs) increases, precision positioning of HDD heads becomes a more relevant issue to ensure enormous amounts of data to be properly written and read. Since the traditional single-stage voice coil motor cannot satisfy the positioning requirement of high-density tracks per inch HDDs, dual-stage servo systems have been proposed to overcome this matter, by using voice coil motors to coarsely move the HDD head while piezoelectric actuators provide fine and fast positioning. Thus, the aim of this work is to apply topology optimization to design HDD arms, by finding optimal placement of base-plate and piezoelectric material for high precision positioning HDD heads. Topology optimization is a structural optimization technique that combines the finite element method with optimization algorithms, and it uses a rational approximation of material properties to vary the material properties between “void” and “filled” portions. The design problem consists in generating optimized structures that provide maximized displacements, appropriate structural stiffness, and resonance phenomena avoidance. The requirements are achieved by applying formulations to maximize displacement, first resonance frequency, and structural stiffness. The implementation of the algorithm and results that confirm the feasibility of the approach in obtaining improved conceptual designs are presented.
               
            

@&#INTRODUCTION@&#

With the constant increase in data storage capacity of hard drives, providing proper focusing and track-seeking capabilities becomes major issues to be solved, in order to ensure continuous development of these devices. In Fig. 1(a) it is possible to see a schematic representation of a HDD arm and the focusing and track-seeking displacement directions needed for a proper positioning of the HDD head.

Most of the investigation made in the field of HDD head positioning aims at optimizing the structural compliance in order to provide proper control of displacements. Traditional electromagnetic actuators are used to control both focusing and track-seeking positioning. The maximization of eigenfrequencies is also considered in order to avoid the resonance phenomena to appear within the working range of the HDD arm [1,2]. In addition, dynamic performance criterion has been directly optimized in [3]. Although the obtained resonance frequencies are smaller, authors claim that the optimized structures may outperform structures from previous works in terms of dynamic response. Most recently, as an alternative to manage the limitations in positioning found by using electromagnetic actuators, some approaches consider the use of piezoelectric laminated structures to improve the performance of HDD arms [4], see Fig. 1
                     . Additionally, piezoelectric material can provide passive damping.

Laminated piezoelectric have found increasing usage in Engineering, specially in the field of smart structures where they can be used both for sensing and actuation. Applications may include airplane wings deformation control [5], automotive frames, reflective antennae [6], deformable mirrors and many others.

In most of works regarding laminated piezoelectric transducer design, parametric optimization algorithms are applied to determine optimized piezoelectric material distribution [7], within certain limitations once these approaches demand a previous knowledge of shape and number of patches to be placed. As a more generic and robust approach, once previous knowledge of the design is not required, topology optimization has been applied to the static design of laminated piezoelectric plate and shell actuators to maximize displacements at certain points of the domain by distributing material and choosing material polarization sign [8]. The problem of static shape control has also been developed to find an optimal material layout in a static problem that aims at mimicking a vibration mode by either distributing material considering constant voltage distribution [9] or by finding optimal voltage distribution over the domain [10].

Recently, topology optimization has been applied to the design of HDD actuator arms. Sun et al. [11] have optimized the PZT transducer attached to the HDD arm to reduce structural vibration by means of piezoelectric shunt damping. Kim et al. [12] have optimized the HDD arm to reduce bending resonance-induced vibrations off-tracks.

Recently, topology optimization has been applied to design a PZT transducer attached to a HDD actuator arm [11] (the piezoelectric transducer is modeled as a plate layer by using shell finite elements in the ANSYS software). The idea is to reduce structural vibration by means of piezoelectric shunt damping.

In the present work, on the other hand, topology optimization is applied to design the whole HDD arm (including a laminated piezoelectric structure), for optimized positioning capabilities. In other words, the topology optimization algorithm distributes piezoelectric material over an elastic base layer, chooses its polarization, and optimizes the elastic base layer (which is not carried out in [11]). Thus, a non-intuitive conceptual design of a HDD arm with improved performance is obtained.

The maximization of track-seeking displacements together with maximization of the first resonance frequency, which is meant to reduce structural vibration, is considered. However, it is known in topology optimization problems of piezoelectric actuators that the maximization of displacements tends to seek unpractical solutions that abuse the linear model and void material, resulting in structures that are discontinuous between the boundary condition and the actuation point, as it is demonstrated in Section 5. The maximization of the first resonance frequency itself does not solve this problem as there is no information of the actuation point in the modal analysis. Therefore, the maximization of the stiffness of the structure between the boundary conditions and the actuation point is also carried out, together with the previous mentioned functions. However, stiffness maximization counteracts displacement maximization, and thus, a proper multi-objective function must be formulated to balance these functions.

This paper is organized as follows. In Section 2, a brief description of the piezoelectric shell element, particularized to plate structures, is presented. In Section 3, the basic concept of topology optimization is presented. In Section 3.2, the design problem considered in this work is formulated. Section 4 discusses the numerical implementation. In Section 5, some examples are shown to demonstrate the proposed methodology, and, finally, in Section 6, some concluding remarks are inferred.

In this work, the HDD structures are modeled using the finite element method (FEM). An appropriate element for this case is the 8-node multi-layer piezoelectric shell element [13,14]. However, as the HDD structures can be designed by plate structures, the FEM formulation presented here is simplified for plate elements. The full FEM formulation for the piezoelectric shell element can be checked in the literature [13,14].

The piezoelectric constitutive equations describe the correlation between the mechanical and electrical fields [15]. Considering the plane stress state that develops in thin plates and shells, it is assumed that 
                           
                              
                                 σ
                              
                              
                                 33
                              
                           
                           =
                           0
                        , and the transverse shear strain ε
                        33 can be eliminated by condensation. Thus, piezoelectric constitutive equations can be written in matrix notation as
                           
                              (1)
                              
                                 
                                    
                                       
                                    
                                 
                              
                           
                        or
                           
                              (2)
                              
                                 {
                                 
                                    
                                       
                                          
                                             σ
                                          
                                       
                                       
                                          
                                             D
                                          
                                       
                                    
                                 
                                 }
                                 =
                                 [
                                 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             e
                                          
                                       
                                       
                                          
                                             
                                                
                                                   e
                                                
                                                
                                                   T
                                                
                                             
                                          
                                          
                                             −
                                             ϵ
                                          
                                       
                                    
                                 
                                 ]
                                 {
                                 
                                    
                                       
                                          
                                             ε
                                          
                                       
                                       
                                          
                                             −
                                             E
                                          
                                       
                                    
                                 
                                 }
                              
                           
                        where 1, 2, and 3 correspond to the cartesian axis x, y, and z, respectively. k
                        
                           s
                         is the shear correction factor known from elastic plate and shell theory [16], and it is usually equal to 
                           
                              
                                 k
                              
                              
                                 s
                              
                           
                           =
                           5
                           /
                           6
                         
                        [17]. The coefficients with 
                           
                              
                              
                                 ⁎
                              
                           
                         appear because of the reduction of ε
                        33:
                           
                              (3)
                              
                                 
                                    
                                       C
                                    
                                    
                                       11
                                    
                                    
                                       ⁎
                                    
                                 
                                 =
                                 
                                    
                                       C
                                    
                                    
                                       11
                                    
                                 
                                 −
                                 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             13
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       
                                          
                                             C
                                          
                                          
                                             33
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       C
                                    
                                    
                                       12
                                    
                                    
                                       ⁎
                                    
                                 
                                 =
                                 
                                    
                                       C
                                    
                                    
                                       12
                                    
                                 
                                 −
                                 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             13
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       
                                          
                                             C
                                          
                                          
                                             33
                                          
                                       
                                    
                                 
                                 
                                    
                                       e
                                    
                                    
                                       31
                                    
                                    
                                       ⁎
                                    
                                 
                                 =
                                 
                                    
                                       e
                                    
                                    
                                       31
                                    
                                 
                                 −
                                 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             13
                                          
                                       
                                       
                                          
                                             e
                                          
                                          
                                             33
                                          
                                       
                                    
                                    
                                       
                                          
                                             C
                                          
                                          
                                             33
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       ϵ
                                    
                                    
                                       33
                                    
                                    
                                       ⁎
                                    
                                 
                                 =
                                 
                                    
                                       ϵ
                                    
                                    
                                       33
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             e
                                          
                                          
                                             33
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       
                                          
                                             C
                                          
                                          
                                             33
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The piezoelectric shell element kinematics are described using a first-order shear deformation theory based on the Reissner–Mindlin assumptions for moderately thick plates and considering a quadratic variation of the electric potential through the thickness direction [17,18,13]. Reinforcing that only plate structures are modeled in this work, the 8-node shell element used in this work can be represented by a flat structure, designed in the 
                           x
                           −
                           y
                         plane, as it can be seen in Fig. 2
                        , with global (x, y, z) and local (r, s, t) coordinate systems. Each node k=1…8 has 1 electrical and 5 mechanical (3 displacements and 2 rotations) degrees of freedom, as represented in Fig. 2. An additional electrical degree of freedom for each element is considered, which represents the voltage applied between the electrodes. Thus, the finite element totalizes 49 degrees of freedom.

Within these assumptions, and considering constant thickness h, the global coordinates of any arbitrary point in the domain can be expressed by using the nodal coordinates and isoparametric formulation as
                           
                              (4)
                              
                                 {
                                 
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          
                                             y
                                          
                                       
                                       
                                          
                                             z
                                          
                                       
                                    
                                 
                                 }
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       8
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 r
                                 ,
                                 s
                                 )
                                 {
                                 
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   y
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   z
                                                
                                                
                                                   k
                                                
                                             
                                             +
                                             t
                                             
                                                
                                                   h
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                                 }
                              
                           
                        and the displacement and electrical field in the element can be approximated by [17,18]
                        
                           
                              (5)
                              
                                 u
                                 (
                                 r
                                 ,
                                 s
                                 ,
                                 t
                                 )
                                 =
                                 {
                                 
                                    
                                       
                                          
                                             u
                                             (
                                             r
                                             ,
                                             s
                                             ,
                                             t
                                             )
                                          
                                       
                                       
                                          
                                             v
                                             (
                                             r
                                             ,
                                             s
                                             ,
                                             t
                                             )
                                          
                                       
                                       
                                          
                                             w
                                             (
                                             r
                                             ,
                                             s
                                             ,
                                             t
                                             )
                                          
                                       
                                    
                                 
                                 }
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       8
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 r
                                 ,
                                 s
                                 )
                                 {
                                 
                                    
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   k
                                                
                                             
                                             +
                                             t
                                             
                                                
                                                   h
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   θ
                                                
                                                
                                                   y
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   k
                                                
                                             
                                             −
                                             t
                                             
                                                
                                                   h
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   θ
                                                
                                                
                                                   x
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   w
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                    
                                 
                                 }
                              
                           
                        
                        
                           
                              (6)
                              
                                 ϕ
                                 (
                                 r
                                 ,
                                 s
                                 ,
                                 t
                                 )
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 t
                                 +
                                 
                                    
                                       t
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 Δ
                                 
                                    
                                       ϕ
                                    
                                    
                                       e
                                    
                                 
                                 +
                                 (
                                 1
                                 −
                                 
                                    
                                       t
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       4
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 r
                                 ,
                                 s
                                 )
                                 
                                    
                                       ϕ
                                    
                                    
                                       m
                                    
                                    
                                       k
                                    
                                 
                              
                           
                        
                     

Thus, the strains 
                           ε
                         and the electrical field 
                           E
                         can be written as
                           
                              (7)
                              
                                 ε
                                 =
                                 
                                    
                                       
                                          
                                             [
                                             
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         b
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         −
                                                         e
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         a
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         −
                                                         d
                                                      
                                                      
                                                         e
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         c
                                                      
                                                      
                                                         b
                                                      
                                                      
                                                         −
                                                         g
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         a
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         g
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                          
                                             ︸
                                          
                                       
                                    
                                    
                                       
                                          
                                             B
                                          
                                          
                                             u
                                          
                                       
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       e
                                    
                                 
                                 
                                 E
                                 =
                                 −
                                 
                                    
                                       
                                          
                                             
                                                
                                                   J
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             [
                                             
                                                
                                                   
                                                      
                                                         (
                                                         1
                                                         −
                                                         
                                                            
                                                               t
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         )
                                                         
                                                            
                                                               ∂
                                                               N
                                                            
                                                            
                                                               ∂
                                                               r
                                                            
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         (
                                                         1
                                                         −
                                                         
                                                            
                                                               t
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         )
                                                         
                                                            
                                                               ∂
                                                               N
                                                            
                                                            
                                                               ∂
                                                               s
                                                            
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         −
                                                         2
                                                         t
                                                         N
                                                      
                                                      
                                                         0.5
                                                         +
                                                         t
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                          
                                             ︸
                                          
                                       
                                    
                                    
                                       
                                          
                                             B
                                          
                                          
                                             ϕ
                                          
                                       
                                    
                                 
                                 
                                    
                                       ϕ
                                    
                                    
                                       e
                                    
                                 
                              
                           
                        where 
                           
                              
                                 u
                              
                              
                                 e
                              
                           
                         and 
                           
                              
                                 ϕ
                              
                              
                                 e
                              
                           
                         are vectors containing the nodal displacements and electric potentials of element e arranged as
                           
                              (8)
                              
                                 
                                    
                                       u
                                    
                                    
                                       e
                                    
                                 
                                 =
                                 
                                    
                                       {
                                       
                                          
                                             u
                                          
                                          
                                             1
                                          
                                       
                                       ⋯
                                       
                                          
                                             u
                                          
                                          
                                             8
                                          
                                       
                                       
                                       
                                          
                                             v
                                          
                                          
                                             1
                                          
                                       
                                       ⋯
                                       
                                          
                                             v
                                          
                                          
                                             8
                                          
                                       
                                       
                                       
                                          
                                             w
                                          
                                          
                                             1
                                          
                                       
                                       ⋯
                                       
                                          
                                             w
                                          
                                          
                                             8
                                          
                                       
                                       
                                       
                                          
                                             θ
                                          
                                          
                                             x
                                          
                                          
                                             1
                                          
                                       
                                       ⋯
                                       
                                          
                                             θ
                                          
                                          
                                             x
                                          
                                          
                                             8
                                          
                                       
                                       
                                       
                                          
                                             θ
                                          
                                          
                                             y
                                          
                                          
                                             1
                                          
                                       
                                       ⋯
                                       
                                          
                                             θ
                                          
                                          
                                             y
                                          
                                          
                                             8
                                          
                                       
                                       }
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       ϕ
                                    
                                    
                                       e
                                    
                                 
                                 =
                                 
                                    
                                       {
                                       
                                          
                                             ϕ
                                          
                                          
                                             m
                                          
                                          
                                             1
                                          
                                       
                                       ⋯
                                       
                                          
                                             ϕ
                                          
                                          
                                             m
                                          
                                          
                                             8
                                          
                                       
                                       
                                       Δ
                                       
                                          
                                             ϕ
                                          
                                          
                                             e
                                          
                                       
                                       }
                                    
                                    
                                       T
                                    
                                 
                              
                           
                        
                     

The terms 
                           a
                        , 
                           b
                        , 
                           c
                        , 
                           d
                        , 
                           e
                        , 
                           g
                        , 
                           N
                        , and 
                           J
                         are defined in Appendix A.

Using the method of weighted residuals [19], and assuming small deformations (linear theory), the equilibrium equation system that describes the static behavior of the FEM is written as
                           
                              (9)
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                
                                                   K
                                                
                                                
                                                   uu
                                                
                                             
                                          
                                          
                                             
                                                
                                                   K
                                                
                                                
                                                   u
                                                   ϕ
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   K
                                                
                                                
                                                   u
                                                   ϕ
                                                
                                                
                                                   T
                                                
                                             
                                          
                                          
                                             
                                                
                                                   K
                                                
                                                
                                                   ϕ
                                                   ϕ
                                                
                                             
                                          
                                       
                                    
                                 
                                 ]
                                 {
                                 
                                    
                                       
                                          
                                             U
                                          
                                       
                                       
                                          
                                             Φ
                                          
                                       
                                    
                                 
                                 }
                                 =
                                 {
                                 
                                    
                                       
                                          
                                             F
                                          
                                       
                                       
                                          
                                             Q
                                          
                                       
                                    
                                 
                                 }
                                 
                                 or
                                 
                                 
                                    
                                       K
                                    
                                    
                                       ˜
                                    
                                 
                                 
                                    
                                       U
                                    
                                    
                                       ˜
                                    
                                 
                                 =
                                 
                                    
                                       F
                                    
                                    
                                       ˜
                                    
                                 
                              
                           
                        where 
                           U
                        , 
                           Φ
                        , 
                           F
                        , and 
                           Q
                         are the mechanical displacements, electric potentials, mechanical force, and electric charge global vectors, respectively. 
                           
                              
                                 K
                              
                              
                                 uu
                              
                           
                        , 
                           
                              
                                 K
                              
                              
                                 u
                                 ϕ
                              
                           
                        , and 
                           
                              
                                 K
                              
                              
                                 ϕ
                                 ϕ
                              
                           
                         are the stiffness, piezoelectric, and dielectric, global matrices, respectively, which are adequately built using the respective element matrices, given by
                           
                              (10)
                              
                                 
                                    
                                       K
                                    
                                    
                                       uu
                                    
                                    
                                       e
                                    
                                 
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       
                                          
                                             Ω
                                          
                                          
                                             e
                                          
                                       
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       u
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       CB
                                    
                                    
                                       u
                                    
                                 
                                 
                                 d
                                 Ω
                                 
                                    
                                       K
                                    
                                    
                                       u
                                       ϕ
                                    
                                    
                                       e
                                    
                                 
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       
                                          
                                             Ω
                                          
                                          
                                             e
                                          
                                       
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       u
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       eB
                                    
                                    
                                       ϕ
                                    
                                 
                                 
                                 d
                                 Ω
                                 
                                    
                                       K
                                    
                                    
                                       ϕ
                                       ϕ
                                    
                                    
                                       e
                                    
                                 
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       
                                          
                                             Ω
                                          
                                          
                                             e
                                          
                                       
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       ϕ
                                    
                                    
                                       T
                                    
                                 
                                 ϵ
                                 
                                    
                                       B
                                    
                                    
                                       ϕ
                                    
                                 
                                 
                                 d
                                 Ω
                              
                           
                        
                     

This work uses the layer-wise theory to model the multi-layer structure. This theory assumes that two adjacent layers are perfectly bonded, and the displacement field must be continuous at the interface between the two layers. Thus, the equilibrium equation system is modified to [13,18]
                        
                           
                              (11)
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                
                                                   K
                                                
                                                
                                                   uu
                                                
                                             
                                          
                                          
                                             
                                                
                                                   K
                                                
                                                
                                                   u
                                                   ϕ
                                                
                                             
                                          
                                          
                                             
                                                
                                                   B
                                                
                                                
                                                   b
                                                
                                                
                                                   T
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   K
                                                
                                                
                                                   u
                                                   ϕ
                                                
                                                
                                                   T
                                                
                                             
                                          
                                          
                                             
                                                
                                                   K
                                                
                                                
                                                   ϕ
                                                   ϕ
                                                
                                             
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             
                                                
                                                   B
                                                
                                                
                                                   b
                                                
                                             
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 ]
                                 {
                                 
                                    
                                       
                                          
                                             U
                                          
                                       
                                       
                                          
                                             Φ
                                          
                                       
                                       
                                          
                                             L
                                          
                                       
                                    
                                 
                                 }
                                 =
                                 {
                                 
                                    
                                       
                                          
                                             F
                                          
                                       
                                       
                                          
                                             Q
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                    
                                 
                                 }
                                 
                                 or
                                 
                                 
                                    
                                       K
                                    
                                    
                                       ^
                                    
                                 
                                 
                                    
                                       U
                                    
                                    
                                       ^
                                    
                                 
                                 =
                                 
                                    
                                       F
                                    
                                    
                                       ^
                                    
                                 
                              
                           
                        where 
                           L
                         are the Lagrange multipliers and 
                           
                              
                                 B
                              
                              
                                 b
                              
                           
                         is the global coupling matrix which contains all constraint equations defined for each pair of nodes from adjacent layers. Considering bottom layer m and top layer n, and node k from each layer, the constraint equations are given by
                           
                              (12)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  [
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              1
                                                                           
                                                                           
                                                                              0
                                                                           
                                                                           
                                                                              0
                                                                           
                                                                           
                                                                              0
                                                                           
                                                                           
                                                                              
                                                                                 
                                                                                    
                                                                                       
                                                                                          h
                                                                                       
                                                                                       
                                                                                          m
                                                                                       
                                                                                    
                                                                                 
                                                                                 
                                                                                    2
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              0
                                                                           
                                                                           
                                                                              1
                                                                           
                                                                           
                                                                              0
                                                                           
                                                                           
                                                                              −
                                                                              
                                                                                 
                                                                                    
                                                                                       
                                                                                          h
                                                                                       
                                                                                       
                                                                                          m
                                                                                       
                                                                                    
                                                                                 
                                                                                 
                                                                                    2
                                                                                 
                                                                              
                                                                           
                                                                           
                                                                              0
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              0
                                                                           
                                                                           
                                                                              0
                                                                           
                                                                           
                                                                              1
                                                                           
                                                                           
                                                                              0
                                                                           
                                                                           
                                                                              0
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                               
                                                                  ︷
                                                               
                                                            
                                                         
                                                         
                                                            dof
                                                            ’
                                                            s
                                                            
                                                            of
                                                            
                                                            node
                                                            
                                                            k
                                                            
                                                            of
                                                            
                                                            layer
                                                            
                                                            m
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              −
                                                                              1
                                                                           
                                                                           
                                                                              0
                                                                           
                                                                           
                                                                              0
                                                                           
                                                                           
                                                                              0
                                                                           
                                                                           
                                                                              
                                                                                 
                                                                                    
                                                                                       
                                                                                          h
                                                                                       
                                                                                       
                                                                                          n
                                                                                       
                                                                                    
                                                                                 
                                                                                 
                                                                                    2
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              0
                                                                           
                                                                           
                                                                              −
                                                                              1
                                                                           
                                                                           
                                                                              0
                                                                           
                                                                           
                                                                              −
                                                                              
                                                                                 
                                                                                    
                                                                                       
                                                                                          h
                                                                                       
                                                                                       
                                                                                          n
                                                                                       
                                                                                    
                                                                                 
                                                                                 
                                                                                    2
                                                                                 
                                                                              
                                                                           
                                                                           
                                                                              0
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              0
                                                                           
                                                                           
                                                                              0
                                                                           
                                                                           
                                                                              −
                                                                              1
                                                                           
                                                                           
                                                                              0
                                                                           
                                                                           
                                                                              0
                                                                           
                                                                        
                                                                     
                                                                  
                                                                  ]
                                                               
                                                               
                                                                  ︷
                                                               
                                                            
                                                         
                                                         
                                                            dof׳s
                                                            
                                                            of
                                                            
                                                            node
                                                            
                                                            k
                                                            
                                                            of
                                                            
                                                            layer
                                                            
                                                            n
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             ︸
                                          
                                       
                                    
                                    
                                       
                                          
                                             B
                                          
                                          
                                             b
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 {
                                 
                                    
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   k
                                                   ,
                                                   m
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   k
                                                   ,
                                                   n
                                                
                                             
                                          
                                       
                                    
                                 
                                 }
                                 =
                                 {
                                 
                                    
                                       
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                    
                                 
                                 }
                              
                           
                        where h
                        
                           m
                         and h
                        
                           n
                         are the thickness of layers m and n, respectively, and 
                           
                              
                                 u
                              
                              
                                 k
                                 ,
                                 m
                              
                           
                         and 
                           
                              
                                 u
                              
                              
                                 k
                                 ,
                                 n
                              
                           
                         are the mechanical degrees of freedom of nodes k from layers m and n, respectively.

Finally, to evaluate the eigenvalues of the problem, the following equilibrium equation is solved:
                           
                              (13)
                              
                                 (
                                 −
                                 
                                    
                                       λ
                                    
                                    
                                       j
                                    
                                 
                                 
                                    
                                       M
                                    
                                    
                                       ^
                                    
                                 
                                 +
                                 
                                    
                                       K
                                    
                                    
                                       ^
                                    
                                 
                                 )
                                 
                                    
                                       Φ
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 0
                                 .
                              
                           
                        where λ
                        
                           j
                         is the jth eigenvalue, and the corresponding resonance frequency is equal to 
                           
                              
                                 f
                              
                              
                                 j
                              
                           
                           =
                           
                              
                                 
                                    
                                       λ
                                    
                                    
                                       j
                                    
                                 
                              
                           
                           /
                           2
                           π
                        . 
                           
                              
                                 Φ
                              
                              
                                 j
                              
                           
                         is the jth eigenvector, and 
                           
                              
                                 M
                              
                              
                                 ^
                              
                           
                         is the mass matrix given by
                           
                              (14)
                              
                                 
                                    
                                       M
                                    
                                    
                                       ^
                                    
                                 
                                 =
                                 [
                                 
                                    
                                       
                                          
                                             
                                                
                                                   M
                                                
                                                
                                                   uu
                                                
                                             
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 ]
                              
                           
                        
                     


                        
                           
                              
                                 M
                              
                              
                                 uu
                              
                           
                         is the global mass matrix which can be properly assembled by using the element mass matrices:
                           
                              (15)
                              
                                 
                                    
                                       M
                                    
                                    
                                       uu
                                    
                                    
                                       e
                                    
                                 
                                 =
                                 
                                    
                                       m
                                    
                                    
                                       d
                                    
                                 
                                 
                                    
                                       ∫
                                    
                                    
                                       
                                          
                                             Ω
                                          
                                          
                                             e
                                          
                                       
                                    
                                 
                                 
                                    
                                       A
                                    
                                    
                                       T
                                    
                                 
                                 A
                                 
                                 d
                                 Ω
                              
                           
                        where m
                        
                           d
                         is the material density, and 
                           A
                         is the shape function matrix described in Appendix A.

This work applies the Topology Optimization Method, which is a powerful structural technique that combines the finite element method with an optimization algorithm to set an optimal material distribution inside a given design domain [20].

The scheme of the Topology Optimization Method can be seen in Fig. 3
                     . It consists in defining an initial domain, which is discretized into finite elements, and, by applying optimization algorithms, material can be properly distributed over the design domain to accomplish with the design requirements. The final topology can be post-processed, verified and finally manufactured in order to validate the results achieved by the algorithm (it is highlighted that post-processing, verification and manufacturing are not carried out in this work).

The main issue to be addressed in the topology optimization is how to change the material property from zero (void) to one (solid material). The discrete (0–1) problem depends on mesh discretization and it has multiple local minima, thus, it is ill-posed. To circumvent this problem, the optimization problem is relaxed by defining a continuous material model which allows the material to assume intermediate material properties. The formulation for intermediate materials (between 0 and 1) defines the level of problem relaxation.

This work employs the PEMAP-P (Piezoelectric Material with Penalization and Polarization) material model [8] in the following way:
                           
                              (16)
                              
                                 C
                                 =
                                 
                                    
                                       ρ
                                    
                                    
                                       1
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             c
                                          
                                       
                                    
                                 
                                 
                                    
                                       C
                                    
                                    
                                       0
                                    
                                 
                              
                           
                        
                        
                           
                              (17)
                              
                                 
                                    
                                       C
                                    
                                    
                                       D
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             ρ
                                          
                                          
                                             1
                                          
                                       
                                    
                                    
                                       1
                                       +
                                       
                                          
                                             p
                                          
                                          
                                             c
                                          
                                       
                                       (
                                       1
                                       −
                                       
                                          
                                             ρ
                                          
                                          
                                             1
                                          
                                       
                                       )
                                    
                                 
                                 
                                    
                                       C
                                    
                                    
                                       0
                                    
                                 
                              
                           
                        
                        
                           
                              (18)
                              
                                 e
                                 =
                                 
                                    
                                       ρ
                                    
                                    
                                       1
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             e
                                          
                                       
                                    
                                 
                                 
                                    
                                       (
                                       2
                                       
                                          
                                             ρ
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       1
                                       )
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    
                                       e
                                    
                                    
                                       0
                                    
                                 
                              
                           
                        
                        
                           
                              (19)
                              
                                 ε
                                 =
                                 
                                    
                                       ρ
                                    
                                    
                                       1
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ε
                                          
                                       
                                    
                                 
                                 
                                    
                                       ε
                                    
                                    
                                       0
                                    
                                 
                              
                           
                        
                        
                           
                              (20)
                              
                                 
                                    
                                       m
                                    
                                    
                                       d
                                    
                                 
                                 =
                                 
                                    
                                       ρ
                                    
                                    
                                       1
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             m
                                          
                                       
                                    
                                 
                                 
                                    
                                       m
                                    
                                    
                                       d
                                       0
                                    
                                 
                              
                           
                        where: 
                           0
                           <
                           
                              
                                 ρ
                              
                              
                                 1
                              
                           
                           ≤
                           1
                         and 
                           0
                           ≤
                           
                              
                                 ρ
                              
                              
                                 2
                              
                           
                           ≤
                           1
                         are the design variables of the optimization problem (where 
                           
                              
                                 ρ
                              
                              
                                 1
                              
                           
                           →
                           0
                        , and 
                           
                              
                                 ρ
                              
                              
                                 1
                              
                           
                           =
                           1
                         means the absence and presence of material, respectively, while 
                           
                              
                                 ρ
                              
                              
                                 2
                              
                           
                           =
                           0
                         and 
                           
                              
                                 ρ
                              
                              
                                 2
                              
                           
                           =
                           1
                         means negative and positive polarization, respectively) and 
                           
                              
                                 C
                              
                              
                                 0
                              
                           
                        , 
                           
                              
                                 e
                              
                              
                                 0
                              
                           
                        , and 
                           
                              
                                 ε
                              
                              
                                 0
                              
                           
                         are the elasticity, piezoelectricity and permittivity tensors of the piezoelectric material. The effective property 
                           
                              
                                 C
                              
                              
                                 D
                              
                           
                        , which is given by the RAMP model [21], is employed to calculate the resonance frequency of the transducer, while 
                           C
                         is used in the remaining computations (note that 
                           
                              
                                 C
                              
                              
                                 D
                              
                           
                           =
                           C
                         for 
                           
                              
                                 ρ
                              
                              
                                 1
                              
                           
                           =
                           0
                        , or 
                           
                              
                                 ρ
                              
                              
                                 1
                              
                           
                           =
                           1
                        ). This procedure is carried out because the design of structures with dynamic requirements by using topology optimization is susceptible to the appearance of intermediate values of ρ
                        1 in the optimization results [22]. In fact, the proposed procedure has reduced intermediate values in the results. The last equation describes the mass relaxation (m
                        
                           d0 is the mass density of the piezoelectric material). In the case of the elastic base layer, only Eqs. (16), (17) and (20) are employed. We use empirical values for the parameters p
                        
                           c
                        , p
                        
                           e
                        , 
                           
                              
                                 p
                              
                              
                                 ϵ
                              
                           
                        , p
                        
                           i
                         and p
                        
                           m
                        . For an elaborated criterion to choose these parameters values, see the work by Kim et al. [23].

In this work, different optimization objectives are combined into a multi-objective function to accomplish with the proposed goals of the HDD arm design.

The first objective function involves the maximization of the output displacement u
                        
                           out
                        
                        
                           A
                         at a given direction along the tracking plane in order to improve the positioning precision of the HDD head. This displacement is generated by the application of an electric voltage between electrodes (equipotential surfaces on top of each piezoelectric layer). Thus, it is necessary to prescribe the electric potential degrees of freedom to calculate the displacements of the domain, as demonstrated in Section 4. Fig. 4
                         shows a representation of the domain, containing the boundary condition, voltage application and output displacement for this objective function.

The second objective function is the maximization of the first resonance frequency λ
                        1, which is meant to avoid the appearance of resonance phenomena in the working range of the device. In this case, the same boundary conditions of Fig. 4 are used, and additionally, the electrodes are grounded. More reference on eigenvalue optimization problems can be found in [24–27].

The third objective function is the minimization of the mean compliance of the structure, which is applied to avoid unpractical results, like void or disconnected structures, as mentioned previously. The minimization of the mean compliance is carried out in the same direction of the output displacement maximization (see Fig. 5
                        ).

Considering that the load t
                        31 is applied in only one node, the mean compliance function (L
                        31) is equal to the displacement that this load generates, at the same point and the same direction. Thus,
                           
                              (21)
                              
                                 
                                    
                                       L
                                    
                                    
                                       31
                                    
                                 
                                 =
                                 
                                    
                                       u
                                    
                                    
                                       31
                                    
                                    
                                       A
                                    
                                 
                              
                           
                        where u
                        31
                        
                           A
                         is obtained from the equilibrium equation:
                           
                              (22)
                              
                                 
                                    
                                       K
                                    
                                    
                                       ^
                                    
                                 
                                 
                                    
                                       
                                          
                                             U
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       31
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             F
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       31
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    
                                       F
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 31
                              
                           
                         contains only one non-zero value, which is 
                           
                              
                                 t
                              
                              
                                 31
                              
                           
                           =
                           1
                        .

The proposed multi-objective function for the design of HDD arms can be given by
                           
                              (23)
                              
                                 F
                                 =
                                 (
                                 1
                                 −
                                 
                                    
                                       w
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 {
                                 
                                    
                                       w
                                    
                                    
                                       2
                                    
                                 
                                 ln
                                 
                                    
                                       L
                                    
                                    
                                       31
                                    
                                 
                                 −
                                 (
                                 1
                                 −
                                 
                                    
                                       w
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 ln
                                 
                                    
                                       u
                                    
                                    
                                       out
                                    
                                    
                                       A
                                    
                                 
                                 }
                                 −
                                 
                                    
                                       w
                                    
                                    
                                       1
                                    
                                 
                                 ln
                                 
                                    
                                       λ
                                    
                                    
                                       1
                                    
                                 
                              
                           
                        where w
                        1 and w
                        2 are weighting coefficients, which allow to control the contribution of each function. The natural logarithms are meant to scale the functions such that the scaled terms will all have comparable orders of magnitude.

The actuators modeled in this work are driven by electric potential, which is the 
                        Δ
                        ϕ
                      degree of freedom. Thus, it is necessary to prescribe the electric potential in Eq. (9) in order to obtain the mechanical displacements and the remaining nodal electric potentials (ϕ
                     
                        m
                     ). First, let us separate the electrical degrees of freedom in ϕ
                     1 and ϕ
                     2, which correspond to ϕ
                     
                        m
                      and 
                        Δ
                        ϕ
                     , respectively:
                        
                           (24)
                           
                              [
                              
                                 
                                    
                                       
                                          
                                             
                                                K
                                             
                                             
                                                uu
                                             
                                          
                                       
                                       
                                          
                                             
                                                K
                                             
                                             
                                                u
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                K
                                             
                                             
                                                u
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                B
                                             
                                             
                                                b
                                             
                                             
                                                T
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                K
                                             
                                             
                                                u
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                             
                                                T
                                             
                                          
                                       
                                       
                                          
                                             
                                                K
                                             
                                             
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                K
                                             
                                             
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          
                                             
                                                K
                                             
                                             
                                                u
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                T
                                             
                                          
                                       
                                       
                                          
                                             
                                                K
                                             
                                             
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                T
                                             
                                          
                                       
                                       
                                          
                                             
                                                K
                                             
                                             
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          
                                             
                                                B
                                             
                                             
                                                b
                                             
                                          
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                              ]
                              {
                              
                                 
                                    
                                       
                                          U
                                       
                                    
                                    
                                       
                                          
                                             
                                                ϕ
                                             
                                             
                                                m
                                             
                                          
                                       
                                    
                                    
                                       
                                          Δ
                                          ϕ
                                       
                                    
                                    
                                       
                                          λ
                                       
                                    
                                 
                              
                              }
                              =
                              {
                              
                                 
                                    
                                       
                                          F
                                       
                                    
                                    
                                       
                                          
                                             
                                                Q
                                             
                                             
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                Q
                                             
                                             
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          0
                                       
                                    
                                 
                              
                              }
                           
                        
                     
                  

By prescribing the electric potential between the electrodes, and assuming there are no external forces or electrical charges applied (
                        F
                        =
                        0
                      and 
                        Q
                        =
                        0
                     , Eq. (24) can be rewritten as
                        
                           (25)
                           
                              [
                              
                                 
                                    
                                       
                                          
                                             
                                                K
                                             
                                             
                                                uu
                                             
                                          
                                       
                                       
                                          
                                             
                                                K
                                             
                                             
                                                u
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                B
                                             
                                             
                                                b
                                             
                                             
                                                T
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                K
                                             
                                             
                                                u
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                             
                                                T
                                             
                                          
                                       
                                       
                                          
                                             
                                                K
                                             
                                             
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          
                                             
                                                B
                                             
                                             
                                                b
                                             
                                          
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                              ]
                              {
                              
                                 
                                    
                                       
                                          U
                                       
                                    
                                    
                                       
                                          
                                             
                                                ϕ
                                             
                                             
                                                m
                                             
                                          
                                       
                                    
                                    
                                       
                                          λ
                                       
                                    
                                 
                              
                              }
                              =
                              {
                              
                                 
                                    
                                       
                                          
                                             
                                                K
                                             
                                             
                                                u
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                K
                                             
                                             
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          0
                                       
                                    
                                 
                              
                              }
                              Δ
                              ϕ
                           
                        
                     
                     
                        
                           (26)
                           
                              or
                              
                              
                                 
                                    K
                                 
                                 
                                    ¯
                                 
                              
                              
                                 
                                    U
                                 
                                 
                                    ¯
                                 
                              
                              =
                              
                                 
                                    F
                                 
                                 
                                    ¯
                                 
                              
                           
                        
                     
                  

The expressions for the output displacement u
                     
                        out
                     
                     
                        A
                     , and the mean compliance function (L
                     31) can be written, respectively, in matricial notation as
                        
                           (27)
                           
                              
                                 
                                    u
                                 
                                 
                                    out
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          F
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    2
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    
                                       
                                          U
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                           
                        
                     
                     
                        
                           (28)
                           
                              
                                 
                                    L
                                 
                                 
                                    31
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          F
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    31
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    
                                       
                                          U
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    31
                                 
                              
                           
                        
                     where 
                        
                           
                              
                                 
                                    F
                                 
                                 
                                    ¯
                                 
                              
                           
                           
                              2
                           
                        
                      is a dummy-vector, which selects u
                     
                        out
                     
                     
                        A
                      out of the terms of 
                        
                           
                              
                                 
                                    U
                                 
                                 
                                    ¯
                                 
                              
                           
                           
                              1
                           
                        
                     . In other words, 
                        
                           
                              
                                 
                                    F
                                 
                                 
                                    ^
                                 
                              
                           
                           
                              2
                           
                           
                              T
                           
                        
                        =
                        [
                        0
                        
                        …
                        
                        0
                        
                        1
                        
                        0
                        
                        …
                        
                        0
                        ]
                     , where the position of the non-zero term corresponds to the position of u
                     
                        out
                     
                     
                        A
                      in 
                        
                           
                              
                                 
                                    U
                                 
                                 
                                    ¯
                                 
                              
                           
                           
                              1
                           
                        
                     .

An iterative algorithm solves the optimization problem. At each iteration, the objective function (see Eq. (23)) is differentiated with respect to the design variables, and a new approximation is then obtained by the GCMMA (Globally Convergent version of the Method of Moving Asymptotes) by Svanberg [28]. The optimization continues until the convergence criterion of the objective function is satisfied.

Topology optimization is subjected to a number of common issues [20], such as checkerboard patterns and mesh-dependency. Most commonly, filtering techniques may be applied to manage those problems [20,29,30]. In this work, the heaviside projection function with β-continuation proposed by Guest et al. [31] is used. In this technique, the design variable 
                        
                           
                              ρ
                           
                           
                              
                                 
                                    1
                                 
                                 
                                    e
                                 
                              
                           
                        
                     , here called pseudo-density, is calculated by the following expression [31]:
                        
                           (29)
                           
                              
                                 
                                    ρ
                                 
                                 
                                    1
                                    e
                                 
                              
                              =
                              1
                              −
                              exp
                              (
                              −
                              β
                              
                                 
                                    μ
                                 
                                 
                                    e
                                 
                              
                              )
                              +
                              
                                 
                                    μ
                                 
                                 
                                    e
                                 
                              
                              exp
                              (
                              −
                              β
                              )
                           
                        
                     where the parameter β dictates the curvature of the heaviside step function. μ
                     
                        e
                      is a weighted average of the nodal design variables d
                     
                        i
                      in the neighborhood N
                     
                        e
                      of element e within a specified radius r
                     
                        min
                      (see Fig. 6
                     ), given by [32]
                     
                        
                           (30)
                           
                              
                                 
                                    μ
                                 
                                 
                                    e
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          
                                             
                                                N
                                             
                                             
                                                e
                                             
                                          
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          d
                                       
                                    
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                    −
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          e
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          
                                             
                                                N
                                             
                                             
                                                e
                                             
                                          
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          d
                                       
                                    
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                    −
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          e
                                       
                                    
                                    )
                                 
                              
                              ,
                              
                              and
                              
                                 
                                    w
                                 
                                 
                                    d
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              −
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    e
                                 
                              
                              )
                              =
                              {
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         min
                                                      
                                                   
                                                   −
                                                   ∥
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                      
                                                      
                                                         e
                                                      
                                                   
                                                   ∥
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         min
                                                      
                                                   
                                                
                                             
                                          
                                          ,
                                       
                                       
                                          if
                                          
                                          i
                                          ∈
                                          
                                             
                                                N
                                             
                                             
                                                e
                                             
                                          
                                          ;
                                       
                                    
                                    
                                       
                                          0
                                       
                                       
                                          otherwise
                                          .
                                       
                                    
                                 
                              
                           
                        
                     and 
                        ∥
                        
                           
                              x
                           
                           
                              i
                           
                        
                        −
                        
                           
                              
                                 
                                    x
                                 
                                 
                                    ¯
                                 
                              
                           
                           
                              e
                           
                        
                        ∥
                      is the distance between the centroid of element e to the neighbor node i.

Thus, the optimization problem can be written in its discrete form as
                        
                           (31)
                           
                              
                                 
                                    
                                       
                                          Minimize
                                          :
                                       
                                       
                                          ︸
                                       
                                    
                                 
                                 
                                    
                                       
                                          ρ
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    d
                                    )
                                    ,
                                    
                                       
                                          ρ
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              
                              F
                              (
                              
                                 
                                    ρ
                                 
                                 
                                    1
                                 
                              
                              (
                              d
                              )
                              ,
                              
                                 
                                    ρ
                                 
                                 
                                    2
                                 
                              
                              )
                              subject
                              
                              to:
                              
                              
                                 
                                    K
                                 
                                 
                                    ¯
                                 
                              
                              
                              
                                 
                                    
                                       
                                          U
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          F
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                              
                              
                                 
                                    K
                                 
                                 
                                    ^
                                 
                              
                              
                                 
                                    
                                       
                                          U
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    31
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          F
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    31
                                 
                              
                              
                              (
                              −
                              
                                 
                                    λ
                                 
                                 
                                    j
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    M
                                 
                                 
                                    ^
                                 
                              
                              +
                              
                                 
                                    K
                                 
                                 
                                    ^
                                 
                              
                              )
                              
                              
                                 
                                    Φ
                                 
                                 
                                    j
                                 
                              
                              =
                              0
                              
                              
                                 
                                    d
                                 
                                 
                                    min
                                    ,
                                    i
                                 
                              
                              ≤
                              
                                 
                                    d
                                 
                                 
                                    i
                                 
                              
                              ≤
                              1
                              ,
                              i
                              =
                              1
                              …
                              
                                 
                                    n
                                 
                                 
                                    n
                                 
                              
                              
                              0
                              ≤
                              
                                 
                                    ρ
                                 
                                 
                                    2
                                    ,
                                    e
                                 
                              
                              ≤
                              1
                              ,
                              e
                              =
                              1
                              …
                              
                                 
                                    n
                                 
                                 
                                    pe
                                 
                              
                              
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          e
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                ve
                                             
                                          
                                       
                                    
                                    
                                       
                                          ρ
                                       
                                       
                                          1
                                          ,
                                          e
                                       
                                    
                                    
                                       
                                          V
                                       
                                       
                                          ve
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          e
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                ve
                                             
                                          
                                       
                                    
                                    
                                       
                                          V
                                       
                                       
                                          ve
                                       
                                    
                                 
                              
                              ≤
                              
                                 
                                    Θ
                                 
                                 
                                    v
                                 
                              
                              
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          e
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                pe
                                             
                                          
                                       
                                    
                                    
                                       
                                          ρ
                                       
                                       
                                          1
                                          ,
                                          e
                                       
                                    
                                    
                                       
                                          V
                                       
                                       
                                          pe
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          e
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                pe
                                             
                                          
                                       
                                    
                                    
                                       
                                          V
                                       
                                       
                                          pe
                                       
                                    
                                 
                              
                              ≤
                              
                                 
                                    Θ
                                 
                                 
                                    p
                                 
                              
                           
                        
                     where n
                     
                        n
                      is the number of nodes in the entire domain, and n
                     
                        ve
                      and n
                     
                        pe
                      are the number of elements in the metallic and piezoelectric layers, respectively. 
                        
                           
                              d
                           
                           
                              min
                              ,
                              i
                           
                        
                        =
                        
                           
                              10
                           
                           
                              −
                              6
                           
                        
                      is the minimum allowed value for the design variable d
                     
                        i
                      to avoid numerical singularities.

Because mean compliance minimization is carried out, volume constraints are enforced to avoid fully occupied design domains. 
                        
                           
                              V
                           
                           
                              ve
                           
                        
                      and V
                     
                        pe
                      are the volumes of the eth element for the metallic and piezoelectric layers, respectively. Θ
                     
                        v
                      and Θ
                     
                        p
                      are the maximum amounts of metallic and piezoelectric material, respectively.

All implementations are performed using MATLAB environment. The FEM implementation uses sparse matrices.

The gradients of the objective functions are needed so that the GCMMA optimization routine can update the design variables at each iteration.

The gradient of Eq. (23) with respect to ρ is given by
                           
                              (32)
                              
                                 
                                    
                                       ∂
                                       F
                                    
                                    
                                       ∂
                                       ρ
                                    
                                 
                                 =
                                 (
                                 1
                                 −
                                 
                                    
                                       w
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 {
                                 
                                    
                                       
                                          
                                             
                                                w
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          
                                             
                                                L
                                             
                                             
                                                31
                                             
                                          
                                       
                                    
                                    
                                       
                                          ∂
                                          
                                             
                                                L
                                             
                                             
                                                31
                                             
                                          
                                       
                                       
                                          ∂
                                          ρ
                                       
                                    
                                    −
                                    
                                       
                                          (
                                          1
                                          −
                                          
                                             
                                                w
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       
                                          
                                             
                                                u
                                             
                                             
                                                out
                                             
                                          
                                       
                                    
                                    
                                       
                                          ∂
                                          
                                             
                                                u
                                             
                                             
                                                out
                                             
                                             
                                                A
                                             
                                          
                                       
                                       
                                          ∂
                                          ρ
                                       
                                    
                                 
                                 }
                                 −
                                 
                                    
                                       
                                          
                                             w
                                          
                                          
                                             1
                                          
                                       
                                    
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 
                                    
                                       ∂
                                       
                                          
                                             λ
                                          
                                          
                                             1
                                          
                                       
                                    
                                    
                                       ∂
                                       ρ
                                    
                                 
                              
                           
                        where ρ might represent ρ
                        1 or ρ
                        2. The differentiation of an eigenvalue λ
                        
                           j
                         is computed through [33]
                        
                           
                              (33)
                              
                                 
                                    
                                       ∂
                                       
                                          
                                             λ
                                          
                                          
                                             j
                                          
                                       
                                    
                                    
                                       ∂
                                       ρ
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             Φ
                                          
                                          
                                             j
                                          
                                          
                                             T
                                          
                                       
                                       [
                                       
                                          
                                             
                                                
                                                   ∂
                                                   K
                                                
                                                
                                                   ∂
                                                   ρ
                                                
                                             
                                          
                                          −
                                          
                                             
                                                λ
                                             
                                             
                                                j
                                             
                                          
                                          
                                             
                                                
                                                   ∂
                                                   M
                                                
                                                
                                                   ∂
                                                   ρ
                                                
                                             
                                          
                                       
                                       ]
                                       
                                          
                                             Φ
                                          
                                          
                                             j
                                          
                                       
                                    
                                    
                                       
                                          
                                             Φ
                                          
                                          
                                             j
                                          
                                          
                                             T
                                          
                                       
                                       M
                                       
                                          
                                             Φ
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The differentiation of u
                        
                           out
                        
                        
                           A
                         is calculated by
                           
                              (34)
                              
                                 
                                    
                                       ∂
                                       
                                          
                                             u
                                          
                                          
                                             out
                                          
                                          
                                             A
                                          
                                       
                                    
                                    
                                       ∂
                                       ρ
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             F
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       2
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       ∂
                                       
                                          
                                             
                                                
                                                   U
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                    
                                    
                                       ∂
                                       ρ
                                    
                                 
                              
                           
                        
                     

The sensitivity of 
                           
                              
                                 
                                    
                                       U
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 1
                              
                           
                         with respect to ρ can be obtained by differentiating 
                           
                              
                                 K
                              
                              
                                 ¯
                              
                           
                           
                              
                                 
                                    
                                       U
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 
                                    
                                       F
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 1
                              
                           
                        , which leads to
                           
                              (35)
                              
                                 
                                    
                                       ∂
                                       
                                          
                                             
                                                
                                                   U
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                    
                                    
                                       ∂
                                       ρ
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             K
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 [
                                 
                                    
                                       
                                          ∂
                                          
                                             
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                1
                                             
                                          
                                       
                                       
                                          ∂
                                          ρ
                                       
                                    
                                    −
                                    
                                       
                                          ∂
                                          
                                             
                                                K
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          ∂
                                          ρ
                                       
                                    
                                    
                                       
                                          
                                             
                                                U
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          1
                                       
                                    
                                 
                                 ]
                              
                           
                        
                     

By substituting Eq. (35) into Eq. (34) we have
                           
                              (36)
                              
                                 
                                    
                                       ∂
                                       
                                          
                                             u
                                          
                                          
                                             out
                                          
                                          
                                             A
                                          
                                       
                                    
                                    
                                       ∂
                                       ρ
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             F
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       2
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       
                                          
                                             K
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 [
                                 
                                    
                                       
                                          ∂
                                          
                                             
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                1
                                             
                                          
                                       
                                       
                                          ∂
                                          ρ
                                       
                                    
                                    −
                                    
                                       
                                          ∂
                                          
                                             
                                                K
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          ∂
                                          ρ
                                       
                                    
                                    
                                       
                                          
                                             
                                                U
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          1
                                       
                                    
                                 
                                 ]
                              
                           
                        
                     

However, to calculate a matrix inversion is computationally inefficient. Thus, we use the adjoint method, which substitutes the matrix inversion by linear equations system solution, which is more efficient. Hence, Eq. (37) can be rewritten as
                           
                              (37)
                              
                                 
                                    
                                       ∂
                                       
                                          
                                             u
                                          
                                          
                                             out
                                          
                                          
                                             A
                                          
                                       
                                    
                                    
                                       ∂
                                       ρ
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             U
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       2
                                    
                                    
                                       T
                                    
                                 
                                 [
                                 
                                    
                                       
                                          ∂
                                          
                                             
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                1
                                             
                                          
                                       
                                       
                                          ∂
                                          ρ
                                       
                                    
                                    −
                                    
                                       
                                          ∂
                                          
                                             
                                                K
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          ∂
                                          ρ
                                       
                                    
                                    
                                       
                                          
                                             
                                                U
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          1
                                       
                                    
                                 
                                 ]
                              
                           
                        where 
                           
                              
                                 
                                    
                                       U
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 2
                              
                           
                         is the adjoint vector obtained by solving the linear equations system 
                           
                              
                                 K
                              
                              
                                 ¯
                              
                           
                           
                              
                                 
                                    
                                       U
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 2
                              
                           
                           =
                           
                              
                                 
                                    
                                       F
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 2
                              
                           
                        .

Analogously, the sensitivity of L
                        31 can be calculated by
                           
                              (38)
                              
                                 
                                    
                                       ∂
                                       
                                          
                                             L
                                          
                                          
                                             31
                                          
                                       
                                    
                                    
                                       ∂
                                       ρ
                                    
                                 
                                 =
                                 −
                                 
                                    
                                       
                                          
                                             U
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       31
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       ∂
                                       
                                          
                                             K
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       ∂
                                       ρ
                                    
                                 
                                 
                                    
                                       
                                          
                                             U
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       31
                                    
                                 
                              
                           
                        
                     

The differentiation of the stiffness and mass matrices are calculated, essentially, by differentiating Eqs. (16) to (20), which gives
                           
                              (39)
                              
                                 
                                    
                                       ∂
                                       C
                                    
                                    
                                       ∂
                                       
                                          
                                             ρ
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       p
                                    
                                    
                                       c
                                    
                                 
                                 
                                    
                                       ρ
                                    
                                    
                                       1
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             c
                                          
                                       
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       C
                                    
                                    
                                       0
                                    
                                 
                              
                           
                        
                        
                           
                              (40)
                              
                                 
                                    
                                       ∂
                                       
                                          
                                             C
                                          
                                          
                                             D
                                          
                                       
                                    
                                    
                                       ∂
                                       
                                          
                                             ρ
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       1
                                       +
                                       
                                          
                                             p
                                          
                                          
                                             c
                                          
                                       
                                    
                                    
                                       
                                          
                                             [
                                             1
                                             +
                                             
                                                
                                                   p
                                                
                                                
                                                   c
                                                
                                             
                                             (
                                             1
                                             −
                                             
                                                
                                                   ρ
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             ]
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    
                                       C
                                    
                                    
                                       0
                                    
                                 
                              
                           
                        
                        
                           
                              (41)
                              
                                 
                                    
                                       ∂
                                       e
                                    
                                    
                                       ∂
                                       
                                          
                                             ρ
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       p
                                    
                                    
                                       e
                                    
                                 
                                 
                                    
                                       ρ
                                    
                                    
                                       1
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             e
                                          
                                       
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       (
                                       2
                                       
                                          
                                             ρ
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       1
                                       )
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    
                                       e
                                    
                                    
                                       0
                                    
                                 
                              
                           
                        
                        
                           
                              (42)
                              
                                 
                                    
                                       ∂
                                       e
                                    
                                    
                                       ∂
                                       
                                          
                                             ρ
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       ρ
                                    
                                    
                                       1
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             e
                                          
                                       
                                    
                                 
                                 2
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       (
                                       2
                                       
                                          
                                             ρ
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       1
                                       )
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             i
                                          
                                       
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       e
                                    
                                    
                                       0
                                    
                                 
                              
                           
                        
                        
                           
                              (43)
                              
                                 
                                    
                                       ∂
                                       ε
                                    
                                    
                                       ∂
                                       
                                          
                                             ρ
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       p
                                    
                                    
                                       ε
                                    
                                 
                                 
                                    
                                       ρ
                                    
                                    
                                       1
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ε
                                          
                                       
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       ε
                                    
                                    
                                       0
                                    
                                 
                              
                           
                        
                        
                           
                              (44)
                              
                                 
                                    
                                       ∂
                                       
                                          
                                             m
                                          
                                          
                                             d
                                          
                                       
                                    
                                    
                                       ∂
                                       
                                          
                                             ρ
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       p
                                    
                                    
                                       m
                                    
                                 
                                 
                                    
                                       ρ
                                    
                                    
                                       1
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             m
                                          
                                       
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       m
                                    
                                    
                                       d
                                       0
                                    
                                 
                              
                           
                        
                     

Finally, because of the heaviside projection technique, we must use the chain rule to differentiate the objective function 
                           F
                         with respect to d
                        
                           i
                        , which yields in:
                           
                              (45)
                              
                                 
                                    
                                       ∂
                                       F
                                    
                                    
                                       ∂
                                       
                                          
                                             d
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       ∂
                                       F
                                    
                                    
                                       ∂
                                       
                                          
                                             ρ
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 
                                    
                                       ∂
                                       
                                          
                                             ρ
                                          
                                          
                                             1
                                          
                                       
                                    
                                    
                                       ∂
                                       
                                          
                                             d
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                           
                        and 
                           ∂
                           
                              
                                 ρ
                              
                              
                                 1
                              
                           
                           /
                           ∂
                           d
                         is obtained by differentiating Eq. (29), and then, Eq. (30), which results in
                           
                              (46)
                              
                                 
                                    
                                       ∂
                                       
                                          
                                             ρ
                                          
                                          
                                             1
                                          
                                       
                                    
                                    
                                       ∂
                                       
                                          
                                             d
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 =
                                 [
                                 
                                    β
                                    exp
                                    (
                                    −
                                    β
                                    
                                       
                                          μ
                                       
                                       
                                          e
                                       
                                    
                                    )
                                    )
                                    +
                                    exp
                                    (
                                    −
                                    β
                                    )
                                 
                                 ]
                                 
                                    
                                       ∂
                                       
                                          
                                             μ
                                          
                                          
                                             e
                                          
                                       
                                    
                                    
                                       ∂
                                       
                                          
                                             d
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (47)
                              
                                 
                                    
                                       ∂
                                       
                                          
                                             μ
                                          
                                          
                                             e
                                          
                                       
                                    
                                    
                                       ∂
                                       
                                          
                                             d
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             w
                                          
                                          
                                             d
                                          
                                       
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       −
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             e
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             ∈
                                             
                                                
                                                   N
                                                
                                                
                                                   e
                                                
                                             
                                          
                                       
                                       
                                          
                                             w
                                          
                                          
                                             d
                                          
                                       
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             j
                                          
                                       
                                       −
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             e
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        
                     

In all examples, PZT is employed for the piezoelectric layers and its material properties are given in Table 1
                     . The metallic layer considered in the examples is made of Aluminum, with Young׳s modulus E=71GPa, Poisson׳s ratio 
                        ν
                        =
                        0.334
                     , and mass density 
                        ρ
                        =
                        2700
                        
                        kg
                        /
                        
                           
                              m
                           
                           
                              3
                           
                        
                     .

Three layers are employed, see Fig. 7
                     . As it can be seen, only one side (Γ
                     1) of the aluminum layer is clamped. The design domain regarding the aluminum layer has dimensions equal to 20×5mm. The design domains for the piezoelectric layers, on the other hand, are 9×5mm, and they do not reach the hard-disk drive head. The reason for avoiding piezoelectric material near this particular region is that it is desired to avoid electric current flow in the head, whose operation, based on electromagnetic effects, could then be jeopardized. Black and white finite elements at the top and bottom meshes regarding the piezoelectric layers (see Fig. 7) indicate that the polarization initial guesses are equal to one (positive) and zero (negative), respectively.

The middle aluminum layer is 0.08mm thick and the top and bottom piezoelectric layers are 0.20mm thick. They are discretized in 160×40 and 72×40 finite elements, respectively. The projection radius is equal to 
                        
                           
                              r
                           
                           
                              min
                           
                        
                        =
                        0.5
                        
                        mm
                      and the heaviside parameter β is equal to zero (linear projection) in the beginning of the optimization process. The continuation method is applied where β is increased by unit every five iterations between iterations 
                        30
                        ≤
                        it
                        <
                        80
                     , and than, it is increased by 5 units, also every five iterations, between iterations 
                        80
                        ≤
                        it
                        <
                        100
                     . This approach is used to reduce the appearance of intermediate material in the final result. The PEMAP-P penalization parameters used in the examples presented are equal to 
                        
                           
                              p
                           
                           
                              c
                           
                        
                        =
                        
                           
                              p
                           
                           
                              e
                           
                        
                        =
                        6
                      and 
                        
                           
                              p
                           
                           
                              ϵ
                           
                        
                        =
                        
                           
                              p
                           
                           
                              i
                           
                        
                        =
                        
                           
                              p
                           
                           
                              m
                           
                        
                        =
                        1
                     . These parameters (r
                     
                        min
                     , β, p
                     
                        c
                     , p
                     
                        e
                     , 
                        
                           
                              p
                           
                           
                              ϵ
                           
                        
                     , p
                     
                        i
                     , p
                     
                        m
                     , w
                     1, w
                     2, Θ
                     
                        v
                     , and Θ
                     
                        p
                     ) have great influence on the optimized result, such as the output displacement u
                     
                        out
                     
                     
                        A
                     , resonance frequency and appearance of intermediate values. Several examples with different values of w
                     1, w
                     2, Θ
                     
                        v
                     , and Θ
                     
                        p
                      are presented.

To enforce only in-plane displacements, two symmetry conditions are applied to the design variables. The first symmetry condition is the mirror symmetry where an imaginary mirror is positioned in the plane 
                        y
                        −
                        z
                      at the middle of the plate width (x=2.5mm), making the variables d and ρ
                     1 to be reflected on both sides. In the case of the variable ρ
                     2, the reflection must have opposite polarization, and thus, 
                        
                           
                              ρ
                           
                           
                              2
                              ,
                              left
                           
                        
                        =
                        1
                        −
                        
                           
                              ρ
                           
                           
                              2
                              ,
                              right
                           
                        
                     . The second symmetry condition is the layer symmetry, where both piezoelectric layer must have same variables d and ρ
                     1, and opposite polarization, 
                        
                           
                              ρ
                           
                           
                              2
                              ,
                              bottom
                           
                        
                        =
                        1
                        −
                        
                           
                              ρ
                           
                           
                              2
                              ,
                              top
                           
                        
                     . Because of this second symmetry condition, only the top piezoelectric layer is displayed in the optimization result figures.

In the first example, the weighting coefficients are equal to 
                        
                           
                              w
                           
                           
                              1
                           
                        
                        =
                        0.3
                      and 
                        
                           
                              w
                           
                           
                              2
                           
                        
                        =
                        0.5
                     , and the target amounts of metallic and piezoelectric materials Θ
                     
                        v
                      and Θ
                     
                        p
                      are equal to 0.4 and 0.3, respectively. This example is called here the quasi-static design, which considers the optimization of the output displacement and the maximization of the first resonance frequency (minimization of mean compliance is also considered). The material distribution (ρ
                     1) optimization results of the top piezoelectric and middle aluminum layers are presented in Fig. 8
                     a and c, respectively, remembering that top and bottom piezoelectric layers are equal. Black and white elements represent solid and void materials, respectively. Grayscaled elements represent intermediate material which can be further post-processed into solid or void elements, depending on a threshold value. However, post-processing is beyond the scope of this work. The polarization (ρ
                     2) optimization result of the top piezoelectric layer if presented in Fig. 8b, remembering that the polarization of the bottom piezoelectric layer has opposite polarization sign than the top layer. The polarization optimization result of void elements has no physical meaning, and thus, they are not displayed. In this case, the output displacement is equal to 
                        
                           
                              u
                           
                           
                              out
                           
                           
                              A
                           
                        
                        =
                        0.92
                        
                        μ
                        m
                      and the first resonance frequency is equal to 
                        
                           
                              f
                           
                           
                              1
                           
                        
                        =
                        392
                        
                        Hz
                     .


                     Fig. 9
                      presents the top view of the deformed shape of the optimized result of example 1 (actuated as demonstrated in Fig. 4), where red elements represent the aluminum material and blue and green elements represent the piezoelectric material with positive and negative polarizations, respectively, where positive polarization follows the positive direction of z axis (see Fig. 4).

In the second example, only the parameter w
                     1 is changed, and it is equal to 
                        
                           
                              w
                           
                           
                              1
                           
                        
                        =
                        0
                     , which means that a pure static design is performed. The optimization results figures are shown in Fig. 10
                     .


                     Fig. 11
                      presents the top view of the deformed shape of the optimized result of example 2. The output displacement is equal to 
                        
                           
                              u
                           
                           
                              out
                           
                           
                              A
                           
                        
                        =
                        0.81
                        
                        μ
                        m
                      and the first resonance frequency is equal to 
                        
                           
                              f
                           
                           
                              1
                           
                        
                        =
                        228
                        
                        Hz
                     .

As expected, the first resonance frequency value of this example is lower than the value of example 1. However, the output displacement is also reduced, which means that the mean compliance function has predominant effect in the static design, even with the same value of w
                     2 for the quasi-static design.

In the third example, the weighting coefficients are equal to w
                     1=0.3 and 
                        
                           
                              w
                           
                           
                              2
                           
                        
                        =
                        0
                     , which means that the mean compliance function is not used. The material distribution figure (Fig. 12
                     ) shows that this case does not generate a valid solution, thus, the polarization optimization result is not presented. As expected, without the mean compliance function, the structure has no connectivity between the boundary condition and point A. So, this example is discarded. The same problem is observed for 
                        
                           
                              w
                           
                           
                              1
                           
                        
                        =
                        1
                      (w
                     2 is neglected), where only eigenfrequency maximization is considered. However, the reason is different here. The maximization of the first resonance frequency is obtained by concentrating material near the boundary condition and making the structure shorter. Also, the modal analysis does not have any information about point A, so this case is not considered to be presented.

The last example presented here uses the same weighting coefficients than the first example (
                        
                           
                              w
                           
                           
                              1
                           
                        
                        =
                        0.3
                      and 
                        
                           
                              w
                           
                           
                              2
                           
                        
                        =
                        0.5
                     ), however, the target amounts of material are changed to 
                        
                           
                              Θ
                           
                           
                              v
                           
                        
                        =
                        
                           
                              Θ
                           
                           
                              p
                           
                        
                        =
                        0.5
                     . The optimization results figures are shown in Fig. 13
                     .


                     Fig. 14
                      presents the top view of the deformed shape of the optimized result of example 4. The output displacement is equal to 
                        
                           
                              u
                           
                           
                              out
                           
                           
                              A
                           
                        
                        =
                        0.94
                        
                        μ
                        m
                      and the first resonance frequency is equal to 
                        
                           
                              f
                           
                           
                              1
                           
                        
                        =
                        345
                        
                        Hz
                     .

In this case, the output displacement is the greatest because there is more piezoelectric material to actuate. However, this larger amount of piezoelectric and metallic material has decreased the resonance frequency.

Therefore, Table 2
                      summarizes the results presented in this paper.

@&#CONCLUSIONS AND FUTURE WORK@&#

The conceptual results in this paper show that by applying a topology optimization algorithm in the field of laminated piezoelectric HDD arms is a very promising approach to deal with the increasingly demanding requirements in computer storage area. Namely, a laminated structure with optimized positioning capabilities, increased resonance frequencies (and thus, reduced structural oscillation), and maximized stiffness has been obtained.

The future work for this project includes the study and implementation of manufacturing constraints in the software; further investigation of the HDD design requirements in order to propose more refined designs; and also an experimental stage by manufacturing some transducers and performing their characterization to validate the results obtained with the software.

@&#ACKNOWLEDGMENTS@&#

The authors thank Krister Svanberg for providing the GCMMA code to CYK. CYK thanks FAPESP (State of São Paulo Research Foundation, Brazil) for his postdoctoral research scholarship (grant number 2009/18210-6). LAMM also thanks FAPESP for his postdoctoral research scholarship (grant number 2009/18210-6). PHN and ECNS would like to acknowledge FAPESP for the doctoral fellowship (grant number 06/50640-2) and research project (grant number 2011/02387-4), respectively, provided to developing this study. ECNS also acknowledges the financial support of the National Council for Scientific and Technological Development (grant number: 304121/2013-4).

In this section, some complementary terms of the piezoelectric shell element formulation are presented, without further detailing.


                     
                        N
                      is the shape functions vector
                        
                           (A.1)
                           
                              N
                              =
                              {
                              
                                 
                                    N
                                 
                                 
                                    1
                                 
                              
                              
                              
                                 
                                    N
                                 
                                 
                                    2
                                 
                              
                              
                              
                                 
                                    N
                                 
                                 
                                    3
                                 
                              
                              
                              
                                 
                                    N
                                 
                                 
                                    4
                                 
                              
                              
                              
                                 
                                    N
                                 
                                 
                                    5
                                 
                              
                              
                              
                                 
                                    N
                                 
                                 
                                    6
                                 
                              
                              
                              
                                 
                                    N
                                 
                                 
                                    7
                                 
                              
                              
                              
                                 
                                    N
                                 
                                 
                                    8
                                 
                              
                              }
                              
                                 
                                    N
                                 
                                 
                                    1
                                 
                              
                              =
                              −
                              0.25
                              (
                              1
                              +
                              r
                              )
                              (
                              1
                              +
                              s
                              )
                              (
                              1
                              −
                              r
                              −
                              s
                              )
                              
                              
                                 
                                    N
                                 
                                 
                                    5
                                 
                              
                              =
                              0.5
                              (
                              1
                              −
                              
                                 
                                    r
                                 
                                 
                                    2
                                 
                              
                              )
                              (
                              1
                              +
                              s
                              )
                              
                                 
                                    N
                                 
                                 
                                    2
                                 
                              
                              =
                              −
                              0.25
                              (
                              1
                              −
                              r
                              )
                              (
                              1
                              +
                              s
                              )
                              (
                              1
                              +
                              r
                              −
                              s
                              )
                              
                              
                                 
                                    N
                                 
                                 
                                    6
                                 
                              
                              =
                              0.5
                              (
                              1
                              −
                              r
                              )
                              (
                              1
                              −
                              
                                 
                                    s
                                 
                                 
                                    2
                                 
                              
                              )
                              
                                 
                                    N
                                 
                                 
                                    3
                                 
                              
                              =
                              −
                              0.25
                              (
                              1
                              −
                              r
                              )
                              (
                              1
                              −
                              s
                              )
                              (
                              1
                              +
                              r
                              +
                              s
                              )
                              
                              
                                 
                                    N
                                 
                                 
                                    7
                                 
                              
                              =
                              0.5
                              (
                              1
                              −
                              
                                 
                                    r
                                 
                                 
                                    2
                                 
                              
                              )
                              (
                              1
                              −
                              s
                              )
                              
                                 
                                    N
                                 
                                 
                                    4
                                 
                              
                              =
                              −
                              0.25
                              (
                              1
                              +
                              r
                              )
                              (
                              1
                              −
                              s
                              )
                              (
                              1
                              −
                              r
                              +
                              s
                              )
                              
                              
                                 
                                    N
                                 
                                 
                                    8
                                 
                              
                              =
                              0.5
                              (
                              1
                              +
                              r
                              )
                              (
                              1
                              −
                              
                                 
                                    s
                                 
                                 
                                    2
                                 
                              
                              )
                           
                        
                     
                  


                     
                        J
                      is the Jacobian matrix
                        
                           (A.2)
                           
                              J
                              =
                              [
                              
                                 
                                    
                                       
                                          
                                             
                                                ∂
                                                x
                                             
                                             
                                                ∂
                                                r
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∂
                                                y
                                             
                                             
                                                ∂
                                                r
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∂
                                                z
                                             
                                             
                                                ∂
                                                r
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                ∂
                                                x
                                             
                                             
                                                ∂
                                                s
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∂
                                                y
                                             
                                             
                                                ∂
                                                s
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∂
                                                z
                                             
                                             
                                                ∂
                                                s
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                ∂
                                                x
                                             
                                             
                                                ∂
                                                t
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∂
                                                y
                                             
                                             
                                                ∂
                                                t
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∂
                                                z
                                             
                                             
                                                ∂
                                                t
                                             
                                          
                                       
                                    
                                 
                              
                              ]
                           
                        
                     which components can be obtained by differentiating Eq. (4) with respect to r, s, and t.

The vectors 
                        a
                     , 
                        b
                     , 
                        c
                     , 
                        d
                     , 
                        e
                     , and 
                        g
                      are obtained by:
                        
                           (A.3)
                           
                              {
                              
                                 
                                    
                                       
                                          a
                                       
                                    
                                    
                                       
                                          b
                                       
                                    
                                    
                                       
                                          c
                                       
                                    
                                 
                              
                              }
                              =
                              [
                              
                                 
                                    
                                       
                                          
                                             
                                                J
                                             
                                             
                                                11
                                             
                                             
                                                ⁎
                                             
                                          
                                       
                                       
                                          
                                             
                                                J
                                             
                                             
                                                12
                                             
                                             
                                                ⁎
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                J
                                             
                                             
                                                21
                                             
                                             
                                                ⁎
                                             
                                          
                                       
                                       
                                          
                                             
                                                J
                                             
                                             
                                                22
                                             
                                             
                                                ⁎
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                J
                                             
                                             
                                                31
                                             
                                             
                                                ⁎
                                             
                                          
                                       
                                       
                                          
                                             
                                                J
                                             
                                             
                                                32
                                             
                                             
                                                ⁎
                                             
                                          
                                       
                                    
                                 
                              
                              ]
                              [
                              
                                 
                                    
                                       
                                          
                                             
                                                ∂
                                                N
                                             
                                             
                                                ∂
                                                r
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                ∂
                                                N
                                             
                                             
                                                ∂
                                                s
                                             
                                          
                                       
                                    
                                 
                              
                              ]
                           
                        
                     
                     
                        
                           (A.4)
                           
                              {
                              
                                 
                                    
                                       
                                          d
                                       
                                    
                                    
                                       
                                          e
                                       
                                    
                                    
                                       
                                          g
                                       
                                    
                                 
                              
                              }
                              =
                              
                                 
                                    h
                                 
                                 
                                    2
                                 
                              
                              (
                              
                                 t
                                 {
                                 
                                    
                                       
                                          
                                             a
                                          
                                       
                                       
                                          
                                             b
                                          
                                       
                                       
                                          
                                             c
                                          
                                       
                                    
                                 
                                 }
                                 +
                                 [
                                 
                                    
                                       
                                          
                                             
                                                
                                                   J
                                                
                                                
                                                   13
                                                
                                                
                                                   ⁎
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   J
                                                
                                                
                                                   23
                                                
                                                
                                                   ⁎
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   J
                                                
                                                
                                                   33
                                                
                                                
                                                   ⁎
                                                
                                             
                                          
                                       
                                    
                                 
                                 ]
                                 N
                              
                              )
                           
                        
                     where 
                        
                           
                              J
                           
                           
                              ij
                           
                           
                              ⁎
                           
                        
                      are the components of the inverse of the Jacobian matrix (Eq. (A.2)).

Finally, the shape function matrix 
                        A
                      from Eq. (15) is given by:
                        
                           (A.5)
                           
                              A
                              =
                              [
                              
                                 
                                    
                                       
                                          N
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          t
                                          
                                             
                                                h
                                             
                                             
                                                2
                                             
                                          
                                          N
                                       
                                    
                                    
                                       
                                          0
                                       
                                       
                                          N
                                       
                                       
                                          0
                                       
                                       
                                          −
                                          t
                                          
                                             
                                                h
                                             
                                             
                                                2
                                             
                                          
                                          N
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          N
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                              ]
                           
                        
                     
                  

@&#REFERENCES@&#

