@&#MAIN-TITLE@&#X-FEM modeling of dynamic ductile fracture problems with a nonlocal damage-viscoplasticity model

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           A dynamic large X-FEM deformation is presented for modeling dynamic ductile fracture.


                        
                        
                           
                           An explicit algorithm is used with mass lumping, reduced integration and numerical damping.


                        
                        
                           
                           The material nonlinearity is modeled with the Johnson–Cook visco-plastic model.


                        
                        
                           
                           The micro void nucleation, growth and coalescence is modeled with an isotropic damage model.


                        
                        
                           
                           Localization of damage and thermal softening is captured with a nonlocal visco-plastic model.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Ductile fracture

Nonlocal damage visco-plasticity

X-FEM

Explicit dynamic

@&#ABSTRACT@&#


               
               
                  In this paper, the dynamic large deformation X-FEM method is presented for modeling the full process of dynamic ductile fracture based on a nonlocal damage visco-plasticity model. The effect of inertia is modeled using an explicit central difference scheme which is enhanced through the use of mass lumping, reduced integration with hourglass control, and numerical damping. The material nonlinearity and the flow stress dependency on strain rate, hardening and temperature are modeled with the Johnson–Cook visco-plastic model. The micro-void nucleation, growth and coalescence are modeled macroscopically with an isotropic damage model. The localization phenomenon due to the damage and thermal softening is suppressed by using the visco-plastic regularization in combination with the nonlocal visco-plastic model. The large deformation and large strain formulations are implemented within the X-FEM framework to model the macro crack discontinuities using an updated Lagrangian approach. Crack propagation and crack direction criteria are presented and the issues relating to the combination of X-FEM with the damage visco-plasticity model are addressed. Finally, the robustness and accuracy of the proposed method are verified through several numerical examples.
               
            

@&#INTRODUCTION@&#

Dynamic fracture is a branch of fracture mechanics that considers the fracture phenomena for which the material inertia becomes important. Inertia effect can result from dynamic loadings on a cracked body or from rapid crack propagation [1]. Many physical and engineering applications involve dynamic fracture of ductile metals; examples are fast manufacturing processes like forging and metal perforation, automotive crashworthiness, earthquakes, impacts and explosions. Predicting the behavior of ductile metals under these extreme conditions, up to the final failure stage is of great interest to engineers and scientists. Observations show that the behavior of the metals under dynamic loading differs from the quasi-static condition. Material rate dependency can be modeled using the visco-plasticity models that can be categorized into the physics based models and the phenomenological or empirical models; from another point of view these models can be categorized into overstress flow and consistency based models. In the overstress models the plasticity multiplier is explicitly expressed as a function of state variables and the stress does not remain on the yield surface. Phenomenological models, such as those presented by Perzyna and Duvant-Lions, are the most famous models in this category [2]. In consistency based models, the yield condition has a consistency condition like rate independent plasticity models; thus the stress remains on the yield surface. This issue simplifies the introduction of such models into the existing codes. The Johnson–Cook [3], the Zerilli–Armstrong [4] and the Steinberg–Cochran–Guinan–Lund [5] models are in this category. The Johnson–Cook model is a purely empirical model which is the most widely used model in high strain rate applications. The model is made of von-Mises yield surface and a flow stress which accounts for the effects of strain hardening, strain rate and temperature dependency.

From experimental point of view the ductile failure has three distinguished phases; firstly, the accumulation of damage, secondly the initiation of cracks, and lastly the crack propagation. Microscopically the ductile damage is the result of void nucleation, growth and coalescence, shear band movement and propagation of micro-cracks. The first attempts for numerical simulation of ductile fracture were presented based on the McClintock׳s cylindrical void growth model [6] and the Rice–Tracy׳s spherical void growth model [7]. It was shown that the fracture of ductile metals is strongly related to the hydrostatic stress. Atkins and Mai [8] illustrated that the fracture strain depends on the hydrostatic pressure. Other observations presented that the fracture strain of ductile metals depends on the stress triaxiality [9], Lode angle [10], strain rate and temperature [3]. Original ductile models were based on the accumulative damage criteria, in which the fracture occurs when the weighted accumulative plastic strain reaches the fracture strain. Different models have been proposed for the weighting function and fracture strain, such as the Johnson–Cook model [3], the Xue–Wierzbicki model [10], the Wilkins model [11], and the Cockcroft–Latham model [12]. In the field of continuum mechanics, there are various approaches towards modeling the ductile fracture; some models are based on the porous metal plasticity, among them the Gurson [13] and Tvergaard and Needleman [14] models are the most appreciated ones. The other groups are based on the continuum damage mechanics [15]; for example in the model proposed by Kachanov [16], a scalar isotropic damage variable was introduced to model the material degradation. The damage is an internal state variable which is a macroscopic measure of the voids, microcracks and defects [17]. The continuum models of ductile fracture are capable of modeling the highly nonlinear behavior in fracture process zone; however, they suffer from the drawback of modeling the material behavior only up to the onset of fracture, so they cannot model the discrete cracks.

The remedy to the above problem is the introduction of discontinuities into the displacement field. The simplest method for this purpose was based on the element deletion, in which the element is deleted whenever a predefined fracture criterion is satisfied. However, the method is mesh sensitive and does not conserve the mass of the system [18]. Adaptive finite element strategy has been an alternative approach used by researchers, in which the mesh is altered due to the crack propagation or element distortion. For examples, Mediavilia et al. [19], Moslemi and Khoei [20] and Khoei et al. [21] employed the adaptive FEM method to 2D and 3D quasi-static and dynamic ductile fracture problems. The meshless methods such as the element free Galerkin method have also been used to model the ductile fracture [22,23]. Among various techniques, the partition of unity X-FEM method is the most desired one [24]. The X-FEM technique was originally proposed by Belytschko and Black [25] and Dolbow et al. [26]; in contrast to the standard-FEM the mesh does not need to be confined to the crack body and hence the remeshing strategy is removed in the crack propagation. In this technique, the discontinuities are taken into account by adding appropriate functions into the standard approximation spaces through a partition of unity method. A complete survey of the X-FEM method and its applications can be obtained from Belytschko et al. [27] and Khoei [28]. The X-FEM has been successfully applied to dynamic fracture problems [29–31]; the method has been enhanced in explicit dynamics by different lumping methods [32–36]; and the technique has been applied into the elasto-plastic fracture mechanics [37,38]. Recently, Seabra et al. [39] and Broumand and Khoei [40,41] employed the X-FEM method to model the ductile fracture in equilibrium, low cycle fatigue and rate independent dynamic loadings.

An important issue in ductile fracture problems with high strain rates and short time periods is that the heat generated by the plastic work does not have time to be transferred through the convection and conduction; thus the process can be assumed adiabatic [3]. The adiabatic temperature rise, manifest itself by thermal softening which might lead to adiabatic shear band [42]. The introduction of damage and adiabatic heating into the constitutive equations results in material softening. If the overall softening overcomes the strain hardening due to isotropic hardening and strain rate effect, localization issues emerge and the problem becomes mesh dependant. Mathematically, the mesh dependent problem is due to the fact that the governing partial differential equation loses its hyperbolicity and becomes ill-posed [43]. This pathological localization effect can be avoided by using regularization methods, such as the non-local approaches [44,45], or the gradient damage methods [46,47], and the rate dependent viscous models [48,49].

In the present paper, a large deformation X-FEM formulation is developed for modeling the dynamic ductile fracture problems based on a nonlocal damage visco-plasticity model in the framework of an explicit central difference scheme which is enhanced through the use of mass lumping, reduced integration with hourglass control and numerical damping. The Johnson–Cook visco-plastic model is used to model the flow stress dependency on strain rate, isotropic hardening and temperature. The micro void nucleation, growth and coalescence are modeled using an isotropic damage model. The plan of the paper is as follows; in Section 2, the governing equation of a fractured body is derived based on an updated Lagrangian large deformation formulation, and the equation of motion is discretized using the X-FEM method. The implementation of dynamic central difference method is also discussed in this section. Section 3 is devoted to constitutive equations; first, the Johson–Cook visco-plastic method is explained and then, the nonlocal damage visco-plastic method that is used to overcome the localization phenomenon is discussed. In Section 4, issues which are related to the combination of X-FEM with the damage-viscoplasticity model are discussed and the crack propagation and crack direction detection criteria are presented. In Section 5, the accuracy and robustness of the proposed method is verified through several numerical examples. Finally, some concluding remarks are given in Section 6.

Consider a cracked body 0Ω bounded externally by surface 
                           ∂
                           
                              Ω
                              
                              
                              
                              
                              0
                           
                         in reference configuration 
                           
                              ℭ
                              
                              
                              
                              
                              0
                           
                        . The crack faces, 
                           
                              
                                 Γ
                              
                              
                                 c
                              
                              
                                 +
                              
                           
                         and 
                           
                              
                                 Γ
                              
                              
                                 c
                              
                              
                                 −
                              
                           
                         corresponding to the either sides of the crack are assumed traction free. Under the loading and boundary conditions, the body deforms and occupies the new configuration 
                           
                              ℭ
                              
                              
                              
                              
                              t
                           
                        . The motion of a particle is described at the reference position 0
                        
                           x
                         and the current position 
                           t
                        
                        
                           x
                         at time t with the mapping 
                           
                              x
                              
                              
                              
                              
                              t
                           
                           =
                           ψ
                           (
                           
                              x
                              
                              
                              
                              
                              0
                           
                           ,
                           t
                           )
                        . The equation of motion of the current configuration at time t can be expressed as
                           
                              (1)
                              
                                 
                                    ρ
                                    
                                    
                                    
                                    
                                    t
                                 
                                 
                                    
                                       u
                                       ¨
                                    
                                    
                                    
                                    
                                    
                                    t
                                 
                                 =
                                 ∇
                                 .
                                 
                                    σ
                                    
                                    
                                    
                                    
                                    t
                                 
                                 +
                                 
                                    b
                                    
                                    
                                    
                                    
                                    t
                                 
                                 
                                 in
                                 
                                 
                                    Ω
                                    
                                    
                                    
                                    
                                    t
                                 
                              
                           
                        which is subjected to the boundary and initial conditions as
                           
                              (2)
                              
                                 
                                    
                                       
                                          
                                             
                                                u
                                                
                                                
                                                
                                                
                                                t
                                             
                                             
                                                (
                                                
                                                   
                                                      x
                                                      
                                                      
                                                      
                                                      
                                                      0
                                                   
                                                   ,
                                                   t
                                                
                                                )
                                             
                                             =
                                             
                                                u
                                                d
                                                
                                                
                                                
                                                t
                                             
                                             
                                                (
                                                
                                                   
                                                      x
                                                      
                                                      
                                                      
                                                      
                                                      0
                                                   
                                                   ,
                                                   t
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                          
                                             on
                                          
                                          
                                          
                                          
                                       
                                       
                                          
                                             ∂
                                             
                                                Ω
                                                u
                                                
                                                
                                                
                                                t
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                σ
                                                
                                                
                                                
                                                
                                                t
                                             
                                             .
                                             
                                                n
                                                
                                                
                                                
                                                
                                                t
                                             
                                             =
                                             
                                                t
                                                
                                                
                                                
                                                
                                                t
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                          
                                             on
                                          
                                          
                                          
                                          
                                       
                                       
                                          
                                             ∂
                                             
                                                Ω
                                                t
                                                
                                                
                                                
                                                t
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                σ
                                                
                                                
                                                
                                                
                                                t
                                             
                                             .
                                             
                                                n
                                                c
                                                
                                                
                                                
                                                t
                                             
                                             =
                                             0
                                          
                                       
                                       
                                          
                                          
                                          
                                          
                                             on
                                          
                                          
                                          
                                          
                                       
                                       
                                          
                                             
                                                Γ
                                                c
                                                
                                                   +
                                                
                                                
                                                
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                σ
                                                
                                                
                                                
                                                
                                                t
                                             
                                             .
                                             (
                                             −
                                             
                                                n
                                                c
                                                
                                                
                                                
                                                t
                                             
                                             )
                                             =
                                             0
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                          
                                             on
                                          
                                          
                                          
                                          
                                       
                                       
                                          
                                             
                                                Γ
                                                c
                                                
                                                   −
                                                
                                                
                                                
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                u
                                                
                                                
                                                
                                                
                                                0
                                             
                                             
                                                (
                                                
                                                   
                                                      x
                                                      
                                                      
                                                      
                                                      
                                                      0
                                                   
                                                   ,
                                                   0
                                                
                                                )
                                             
                                             =
                                             
                                                
                                                   u
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      x
                                                      
                                                      
                                                      
                                                      
                                                      0
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                          
                                             in
                                          
                                          
                                          
                                          
                                       
                                       
                                          
                                             
                                                Ω
                                                
                                                
                                                
                                                
                                                0
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   u
                                                   ̇
                                                
                                                
                                                
                                                
                                                
                                                0
                                             
                                             
                                                (
                                                
                                                   
                                                      x
                                                      
                                                      
                                                      
                                                      
                                                      0
                                                   
                                                   ,
                                                   0
                                                
                                                )
                                             
                                             =
                                             
                                                
                                                   
                                                      u
                                                      ̇
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      x
                                                      
                                                      
                                                      
                                                      
                                                      0
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                          
                                             in
                                          
                                          
                                          
                                          
                                       
                                       
                                          
                                             
                                                Ω
                                                
                                                
                                                
                                                
                                                0
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           t
                        
                        ρ is the density, 
                           t
                        
                        u is the displacement vector, 
                           t
                        
                        
                           σ
                         is the Cauchy stress tensor, 
                           t
                        
                        b is the body force vector, 
                           t
                        
                        
                           t
                         is surface traction, 
                           t
                        
                        n is the normal to the body surface. The left superscript represents the configuration with respect to which the variables are considered. Here (∇.) stands for the divergence operator and the derivatives with respect to the time are shown with dotted symbols.

In the dynamic explicit formulation within an updated Lagrangian framework, the equation of motion is considered at time step 
                           t
                         and all variables are determined at time step t+Δt. Since 
                           
                              x
                              
                              
                              
                              
                              
                                 t
                                 +
                                 Δ
                                 t
                              
                           
                           =
                           
                              x
                              
                              
                              
                              
                              0
                           
                           +
                           
                              u
                              
                              
                              
                              
                              
                                 t
                                 +
                                 Δ
                                 t
                              
                           
                         and 
                           
                              x
                              
                              
                              
                              
                              t
                           
                           =
                           
                              x
                              
                              
                              
                              
                              0
                           
                           +
                           
                              u
                              
                              
                              
                              
                              t
                           
                        , it can be stated that 
                           
                              x
                              
                              
                              
                              
                              
                                 t
                                 +
                                 Δ
                                 t
                              
                           
                           =
                           
                              x
                              
                              
                              
                              
                              t
                           
                           +
                           
                              u
                              
                              
                              
                              t
                              
                           
                         where 
                           
                              u
                              
                              
                              
                              t
                              
                           
                           =
                           
                              u
                              
                              
                              
                              
                              
                                 t
                                 +
                                 Δ
                                 t
                              
                           
                           −
                           
                              u
                              
                              
                              
                              
                              t
                           
                        . Applying the virtual work principle to the configuration at time t and employing the Gauss-Green Divergence theorem, it leads to
                           
                              (3)
                              
                                 
                                    ∫
                                    
                                       
                                          Ω
                                          
                                          
                                          
                                          
                                          t
                                       
                                    
                                 
                                 
                                    δ
                                    
                                       
                                          u
                                       
                                       T
                                    
                                    
                                       ρ
                                       
                                       
                                       
                                       
                                       t
                                    
                                    
                                       
                                          u
                                          ¨
                                       
                                       
                                       
                                       
                                       
                                       t
                                    
                                    
                                       
                                          d
                                       
                                       t
                                    
                                    Ω
                                 
                                 =
                                 −
                                 
                                    ∫
                                    
                                       
                                          Ω
                                          
                                          
                                          
                                          
                                          t
                                       
                                    
                                 
                                 
                                    
                                       
                                          δ
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          ϵ
                                       
                                       T
                                    
                                    
                                       σ
                                       
                                       
                                       
                                       
                                       t
                                    
                                    
                                       
                                          d
                                       
                                       t
                                    
                                    Ω
                                 
                                 +
                                 
                                    ∫
                                    
                                       
                                          Ω
                                          
                                          
                                          
                                          
                                          t
                                       
                                    
                                 
                                 
                                    δ
                                    
                                       
                                          u
                                       
                                       
                                          T
                                          t
                                       
                                    
                                    b
                                    d
                                    
                                       Ω
                                       
                                       
                                       
                                       
                                       t
                                    
                                 
                                 +
                                 
                                    ∫
                                    
                                       
                                          
                                             ∂
                                          
                                          t
                                       
                                       
                                          
                                             Ω
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                                 
                                    δ
                                    
                                       
                                          u
                                       
                                       T
                                    
                                    
                                       t
                                       
                                       
                                       
                                       
                                       t
                                    
                                    
                                       
                                          d
                                       
                                       t
                                    
                                    Γ
                                 
                              
                           
                        where δ
                        u is the virtual displacement imposed at time t, and 
                           
                              
                                 δ
                              
                              
                                 t
                              
                           
                           ϵ
                           =
                           δ
                           
                              (
                              
                                 
                                    
                                       ∇
                                    
                                    s
                                 
                                 
                                    u
                                    
                                    
                                    
                                    t
                                    
                                 
                              
                              )
                           
                           =
                           1
                           /
                           2
                           [
                           (
                           ∂
                           δ
                           u
                           /
                           ∂
                           
                              x
                              
                              
                              
                              
                              t
                           
                           )
                           +
                           
                              
                                 (
                                 ∂
                                 δ
                                 u
                                 /
                                 ∂
                                 
                                    x
                                    
                                    
                                    
                                    
                                    t
                                 
                                 )
                              
                              T
                           
                           ]
                         is the corresponding virtual strain and ∇
                           s
                         is the symmetric gradient operator. In the above formulation, all derivatives are taken with respect to coordinates at time t and all integrals are calculated with respect to the configuration at this time.

The X-FEM method is employed to model the discontinuity in the displacement field. The crack body is modeled using the Heaviside function defined as
                           
                              (4)
                              
                                 H
                                 (
                                 x
                                 )
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   −
                                                   1
                                                
                                             
                                             
                                                
                                                   ϕ
                                                   (
                                                   x
                                                   )
                                                   >
                                                   0
                                                
                                             
                                          
                                          
                                             
                                                
                                                   +
                                                   1
                                                
                                             
                                             
                                                
                                                   ϕ
                                                   
                                                      (
                                                      x
                                                      )
                                                   
                                                   ≤
                                                   0
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where ϕ(
                           x
                        ) is the signed distance function. On the basis of the partition of unity method, the displacement field can be defined through the standard and enriched parts as
                           
                              (5)
                              
                                 u
                                 
                                    (
                                    x
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   I
                                                   ∈
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         s
                                                         t
                                                         d
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   N
                                                
                                                
                                                   I
                                                
                                             
                                             
                                                (
                                                x
                                                )
                                             
                                             
                                                
                                                   
                                                      d
                                                      ¯
                                                   
                                                
                                                
                                                   I
                                                
                                             
                                          
                                          
                                             ︸
                                          
                                       
                                    
                                    
                                       Standard
                                       
                                       part
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   I
                                                   ∈
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         H
                                                         e
                                                         v
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   N
                                                
                                                
                                                   I
                                                
                                             
                                             
                                                (
                                                x
                                                )
                                             
                                             
                                                H
                                                ¯
                                             
                                             
                                                (
                                                
                                                   
                                                      x
                                                      
                                                      
                                                      
                                                      
                                                      0
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   
                                                      a
                                                      ¯
                                                   
                                                
                                                
                                                   I
                                                
                                             
                                          
                                          
                                             ︸
                                          
                                       
                                    
                                    
                                       
                                       Enriched
                                       
                                       part
                                    
                                 
                              
                           
                        where 
                           
                              H
                              ¯
                           
                           (
                           
                              x
                              
                              
                              
                              
                              0
                           
                           )
                           =
                           H
                           
                              (
                              
                                 
                                    x
                                    
                                    
                                    
                                    
                                    0
                                 
                              
                              )
                           
                           −
                           H
                           
                              (
                              
                                 
                                    x
                                    I
                                    
                                    
                                    
                                    0
                                 
                              
                              )
                           
                        is the shifted Heaviside function; 
                           
                              
                                 
                                    d
                                    ¯
                                 
                              
                              
                                 I
                              
                           
                         and 
                           
                              
                                 
                                    a
                                    ¯
                                 
                              
                              
                                 I
                              
                           
                         are the corresponding standard and Heaviside nodal degrees of freedom. In a simplified form, the above equation can be written as 
                           u
                           =
                           N
                           
                              u
                              ¯
                           
                           
                        , where 
                           
                              u
                              ¯
                           
                           =
                           
                              
                                 〈
                                 
                                    d
                                    ¯
                                 
                                 ,
                                 
                                    a
                                    ¯
                                 
                                 〉
                              
                              T
                           
                         is the set of nodal values.

The discretized matrix form of the equation of motion can be obtained by substitution of relation (5) into (3), it yields to
                           
                              (6)
                              
                                 M
                                 
                                 
                                    
                                       
                                          
                                             
                                                u
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          ⋅⋅
                                       
                                    
                                    
                                    
                                    
                                    
                                    t
                                 
                                 =
                                 
                                    R
                                    
                                    
                                    
                                    
                                    t
                                 
                                 −
                                 
                                    F
                                    
                                    
                                    
                                    
                                    t
                                 
                              
                           
                        where 
                           
                              
                                 
                                    u
                                    ¯
                                 
                                 ¨
                              
                              
                              
                              
                              
                              t
                           
                        is the nodal acceleration vector, and M, 
                           t
                        
                        R and 
                           t
                        
                        F are defined as
                           
                              (7–a)
                              
                                 M
                                 =
                                 
                                    ∫
                                    
                                       
                                          Ω
                                          
                                          
                                          
                                          
                                          t
                                       
                                    
                                 
                                 
                                    
                                       ρ
                                       
                                       
                                       
                                       
                                       t
                                    
                                    
                                       
                                          N
                                       
                                       T
                                    
                                    N
                                    d
                                    
                                       Ω
                                       
                                       
                                       
                                       
                                       t
                                    
                                 
                                 
                                 (
                                 inertial
                                 
                                 term
                                 )
                              
                           
                        
                        
                           
                              (7–b)
                              
                                 
                                    R
                                    
                                    
                                    
                                    
                                    t
                                 
                                 =
                                 
                                    ∫
                                    
                                       
                                          
                                             ∂
                                          
                                          t
                                       
                                       
                                          
                                             Ω
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          N
                                       
                                       T
                                    
                                    
                                       t
                                       
                                       
                                       
                                       
                                       t
                                    
                                    d
                                    
                                       Γ
                                       
                                       
                                       
                                       
                                       t
                                    
                                 
                                 +
                                 
                                    ∫
                                    
                                       
                                          Ω
                                          
                                          
                                          
                                          
                                          t
                                       
                                    
                                 
                                 
                                    
                                       
                                          N
                                       
                                       T
                                    
                                    
                                       b
                                       
                                       
                                       
                                       
                                       t
                                    
                                    d
                                    
                                       Ω
                                       
                                       
                                       
                                       
                                       t
                                    
                                 
                                 
                                 (
                                 external
                                 
                                 force
                                 
                                 term
                                 )
                              
                           
                        
                        
                           
                              (7–c)
                              
                                 
                                    F
                                    
                                    
                                    
                                    
                                    t
                                 
                                 =
                                 
                                    ∫
                                    
                                       
                                          Ω
                                          
                                          
                                          
                                          
                                          t
                                       
                                    
                                 
                                 
                                    
                                       
                                          B
                                       
                                       
                                          L
                                       
                                       
                                          T
                                       
                                       
                                       
                                          t
                                       
                                       
                                          t
                                       
                                    
                                    
                                    
                                       
                                          σ
                                       
                                       
                                       
                                       
                                       
                                       
                                          t
                                       
                                    
                                    
                                    d
                                    
                                       Ω
                                       
                                       
                                       
                                       
                                       t
                                    
                                 
                                 
                                 (
                                 internal
                                 
                                 force
                                 
                                 term
                                 )
                              
                           
                        Considering the 2D plane stress/strain, or an axisymmetric condition, the matrices N and 
                           
                              B
                              L
                              
                              
                              t
                              t
                           
                         for each node I can be defined as
                           
                              (8)
                              
                                 
                                    
                                       (
                                       N
                                       )
                                    
                                    
                                       I
                                    
                                 
                                 =
                                 
                                    [
                                    
                                       
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      s
                                                      t
                                                      d
                                                   
                                                
                                             
                                             )
                                          
                                          
                                             I
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      H
                                                      e
                                                      v
                                                   
                                                
                                             
                                             )
                                          
                                          
                                             I
                                          
                                       
                                    
                                    ]
                                 
                              
                           
                        
                        
                           
                              (9)
                              
                                 
                                    
                                       (
                                       
                                          
                                             B
                                             L
                                             
                                             
                                             t
                                             t
                                          
                                       
                                       )
                                    
                                    
                                       I
                                    
                                 
                                 =
                                 
                                    [
                                    
                                       
                                       
                                          
                                             (
                                             
                                                
                                                   B
                                                   
                                                      L
                                                   
                                                   
                                                      s
                                                      t
                                                      d
                                                   
                                                   
                                                   t
                                                   t
                                                
                                             
                                             )
                                          
                                          
                                             I
                                          
                                       
                                       ,
                                       
                                          
                                             (
                                             
                                                
                                                   B
                                                   
                                                      L
                                                   
                                                   
                                                      H
                                                      e
                                                      v
                                                   
                                                   
                                                   t
                                                   t
                                                
                                             
                                             )
                                          
                                          
                                             I
                                          
                                       
                                    
                                    ]
                                 
                              
                           
                        where
                           
                              (10)
                              
                                 
                                    
                                       (
                                       
                                          
                                             
                                                N
                                             
                                             
                                                s
                                                t
                                                d
                                             
                                          
                                       
                                       )
                                    
                                    
                                       I
                                    
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         I
                                                      
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         I
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 
                                 and
                                 
                                 
                                    
                                       (
                                       
                                          
                                             
                                                N
                                             
                                             
                                                H
                                                e
                                                v
                                             
                                          
                                       
                                       )
                                    
                                    
                                       I
                                    
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         I
                                                      
                                                   
                                                   
                                                      H
                                                      ¯
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            x
                                                            
                                                            
                                                            
                                                            
                                                            0
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         I
                                                      
                                                   
                                                   
                                                      H
                                                      ¯
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            x
                                                            
                                                            
                                                            
                                                            
                                                            0
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                              
                           
                        and
                           
                              (11)
                              
                                 
                                    
                                       
                                    
                                 
                              
                           
                        in which the first three rows of relations (11) are used for plane stress/strain problems and all four rows are employed for axisymmetric problems.

Since the crack-tip enrichment is not considered in the above formulation, it is needed to utilize a special enrichment strategy to model the stress concentration at the crack-tip region. In this approach, the crack-tip always intersects an element edge and it is not allowed to be inside of an element. Consider an old crack as shown in 
                        Fig. 1(a); the new crack segment is added if the crack growth criterion is satisfied. All elements which are cut by the crack are enhanced and all corresponding nodal points are enriched using the Heaviside function. The only exception is the element that contains the crack-tip; in this element only the nodes of an edge (a–d) which is cut by the crack body and not by the crack-tip, are enriched. Note that in the case that an edge (a–b) is cut by the crack tip and has the node (a) in common with an edge (a–d) which is cut by the crack body, the common node (a) is not enriched as illustrated in Fig. 1(b).

The time integration of the equation of motion is performed using the central difference method, which is an explicit direct time integration method with the second-order accuracy. The method is enhanced for the X-FEM by employing a special mass lumping method proposed by Menouillard et al. [50]. The artificial linear and quadratic bulk viscosities are also considered in the formulation to damp out the oscillations behind the shock fronts, and to smear the shocks over several elements [51].

In the dynamic explicit method proposed here, the main source of computational cost is the numerical calculation of internal force term t
                        F at the Gauss integration points. Reducing the number of Gauss points not only reduces the calculation cost of the integrals but also reduces the number of solutions required for the expensive material constitutive equations. For this purpose, the reduced integration method is employed by using only one integration point for a Q4 bilinear element. This method is a remedy for the locking issue in lower-order elements of incompressible, or nearly incompressible material. In addition, an artificial stiffness method originally proposed by Flanagan and Belytschko [52], is used to control the hourglass shape modes resulting from the reduced integration method. The hourglass control method is only applied to the standard elements.

Although the above large deformation formulation accounts for large rotations, it needs special treatment for large strain problems [53,54]. In this study, the large strain formulation proposed in [2] is implemented on the basis of multiplicative decomposition of deformation gradient [55] that utilizes a hyper-elastic constitutive equation based on the Hencky logarithmic strain. Based on this technique the classical infinitesimal elasto-viscoplasticity formulation is extended to the finite strain range. It must be noted that due to the existence of the discontinuity in crack body elements the vector of coordinates cannot be calculated from the standard finite element definition of 
                           
                              x
                              
                              
                              
                              
                              t
                           
                           =
                           Σ
                           
                              
                                 N
                              
                              
                                 I
                              
                           
                           
                              x
                              I
                              
                              
                              
                              t
                           
                        , as explained in [40]. Hence in the enriched elements, the vector of coordinates must be computed by
                           
                              (12)
                              
                                 
                                    x
                                    
                                    
                                    
                                    
                                    t
                                 
                                 =
                                 
                                    ∑
                                    
                                       I
                                       ∈
                                       
                                          
                                             I
                                          
                                          
                                             s
                                             t
                                             d
                                          
                                       
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       I
                                    
                                 
                                 
                                    x
                                    I
                                    
                                    
                                    
                                    0
                                 
                                 +
                                 
                                    ∑
                                    
                                       I
                                       ∈
                                       
                                          
                                             I
                                          
                                          
                                             s
                                             t
                                             d
                                          
                                       
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       I
                                    
                                 
                                 
                                    
                                       d
                                       ¯
                                    
                                    I
                                    
                                    
                                    
                                    t
                                 
                                 +
                                 
                                    ∑
                                    
                                       I
                                       ∈
                                       
                                          
                                             I
                                          
                                          
                                             H
                                             e
                                             v
                                          
                                       
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       I
                                    
                                 
                                 
                                    H
                                    ¯
                                 
                                 
                                    (
                                    
                                       
                                          x
                                          
                                          
                                          
                                          
                                          0
                                       
                                    
                                    )
                                 
                                 
                                    
                                       a
                                       ¯
                                    
                                    I
                                    
                                    
                                    
                                    t
                                 
                                 ≡
                                 
                                    ∑
                                    
                                       I
                                       ∈
                                       
                                          
                                             I
                                          
                                          
                                             s
                                             t
                                             d
                                          
                                       
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       I
                                    
                                 
                                 
                                    x
                                    I
                                    
                                    
                                    
                                    t
                                 
                                 +
                                 
                                    ∑
                                    
                                       I
                                       ∈
                                       
                                          
                                             I
                                          
                                          
                                             H
                                             e
                                             v
                                          
                                       
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       I
                                    
                                 
                                 
                                    H
                                    ¯
                                 
                                 
                                    (
                                    
                                       
                                          x
                                          
                                          
                                          
                                          
                                          0
                                       
                                    
                                    )
                                 
                                 
                                    
                                       a
                                       ¯
                                    
                                    I
                                    
                                    
                                    
                                    t
                                 
                              
                           
                        in which the deformation gradient and the Jacobian matrix can be obtained from the above definition.

In order to simulate the non-linear behavior of ductile metals under dynamic and impact loading conditions, a thermo-visco-plastic damage model is employed here. As stated in the previous section, the large strain formulation allows the extension of infinitesimal formulation to large strain range. Hence, on the basis of an infinitesimal formulation the additive decomposition of the total strain tensor can be expressed as
                           
                              (13)
                              
                                 ϵ
                                 =
                                 
                                    
                                       ϵ
                                    
                                    e
                                 
                                 +
                                 
                                    
                                       ϵ
                                    
                                    
                                       v
                                       p
                                    
                                 
                                 +
                                 
                                    
                                       ϵ
                                    
                                    
                                       t
                                       h
                                    
                                 
                              
                           
                        where 
                           
                              
                                 ϵ
                              
                              e
                           
                           ,
                           
                              
                                 ϵ
                              
                              
                                 v
                                 p
                              
                           
                           
                           and
                           
                           
                              
                                 ϵ
                              
                              
                                 t
                                 h
                              
                           
                         are the elastic, visco-plastic, and thermal parts of the strain tensor. In order to model the micro void nucleation, growth and coalescence and the effect of micro cracks, a macroscopic scalar damage parameter D is employed; so the effective stress tensor 
                           
                              σ
                              ¯
                           
                         is defined as
                           
                              (14)
                              
                                 
                                    σ
                                    ¯
                                 
                                 =
                                 
                                    σ
                                    
                                       1
                                       −
                                       D
                                    
                                 
                              
                           
                        The hypothesis of strain equivalence states that the strain behavior of a damaged material can be obtained using the constitutive equations of an undamaged material, and the effective stress can be employed instead of the conventional stress field [17]. Hence, the deviatoric and volumetric parts of the effective stress tensor can be expressed as
                           
                              (15)
                              
                                 
                                    s
                                    ¯
                                 
                                 =
                                 2
                                 G
                                 
                                    
                                       ϵ
                                    
                                    
                                       d
                                       e
                                       v
                                    
                                    
                                       e
                                    
                                 
                                 
                                    p
                                    ¯
                                 
                                 =
                                 K
                                 
                                    
                                       ϵ
                                    
                                    
                                       v
                                       o
                                       l
                                    
                                 
                                 −
                                 3
                                 K
                                 α
                                 
                                    (
                                    
                                       T
                                       −
                                       
                                          
                                             T
                                          
                                          
                                             0
                                          
                                       
                                    
                                    )
                                 
                              
                           
                        where 
                           
                              s
                              ¯
                           
                         and 
                           
                              p
                              ¯
                           
                         are the deviatoric and volumetric parts of the effective stress tensor, 
                           
                              
                                 ϵ
                              
                              
                                 d
                                 e
                                 v
                              
                              
                                 e
                              
                           
                         is the deviatoric part of the elastic strain tensor and 
                           
                              
                                 ϵ
                              
                              
                                 v
                                 o
                                 l
                              
                           
                         is the total volumetric strain, G and K are the virgin shear and bulk modulus, α is the thermal expansion coefficient and, T and T
                        0 are the current and reference temperatures of the body.

The material rate dependency is modeled using the Johnson–Cook visco-plasticity model in which the damage is introduced through the use of effective stress. In this model, the material is modeled using the von-Mises yield criterion and the flow stress is chosen as a function of the isotropic hardening, visco-plastic strain rate and temperature as follows
                           
                              (16)
                              
                                 f
                                 =
                                 
                                    
                                       
                                          3
                                          2
                                       
                                    
                                 
                                 ‖
                                 
                                    s
                                    ¯
                                 
                                 ‖
                                 −
                                 
                                    
                                       
                                          
                                             [
                                             
                                                A
                                                +
                                                B
                                                
                                                   
                                                      r
                                                   
                                                   κ
                                                
                                             
                                             ]
                                          
                                          
                                             ︸
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   isotropic
                                                
                                             
                                          
                                          
                                             
                                                
                                                   hardeing
                                                
                                             
                                          
                                          
                                             
                                                
                                                   dependance
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                 
                                    
                                       
                                          
                                             [
                                             
                                                1
                                                +
                                                C
                                                
                                                ln
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            r
                                                            ̇
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     ϵ
                                                                     ̇
                                                                  
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   )
                                                
                                             
                                             ]
                                          
                                          
                                             ︸
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   strain
                                                   
                                                   rate
                                                
                                             
                                          
                                          
                                             
                                                
                                                   dependance
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                 
                                    
                                       
                                          
                                             [
                                             
                                                1
                                                −
                                                
                                                   
                                                      T
                                                   
                                                   
                                                      
                                                      ⁎
                                                      
                                                      m
                                                   
                                                
                                             
                                             ]
                                          
                                          
                                             ︸
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   temperature
                                                
                                             
                                          
                                          
                                             
                                                
                                                   dependance
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where A and B are the material hardening constants, κ is the hardening exponent, C is the rate dependency coefficient, 
                           
                              r
                              ̇
                           
                         is the time rate of the hardening parameter r, 
                           
                              
                                 
                                    ϵ
                                    ̇
                                 
                              
                              
                                 0
                              
                           
                         is the reference strain rate at which the calibration is performed, m is the thermal softening exponent, and T
                        
                        ⁎ is the relative temperature defined as 
                           
                              
                                 T
                              
                              ⁎
                           
                           =
                           (
                           T
                           −
                           
                              
                                 T
                              
                              
                                 0
                              
                           
                           )
                           /
                           (
                           
                              
                                 T
                              
                              
                                 m
                              
                           
                           −
                           
                              
                                 T
                              
                              
                                 0
                              
                           
                           )
                        , where T
                        0 and T
                        
                           m
                         are the surrounding and melting temperatures, respectively.

The evolution of visco-plastic strain can be obtained using an associated flow rule as
                           
                              (17)
                              
                                 
                                    
                                       
                                          ϵ
                                          ̇
                                       
                                    
                                    
                                       v
                                       p
                                    
                                 
                                 =
                                 
                                    λ
                                    ̇
                                 
                                 
                                 
                                    
                                       n
                                    
                                    
                                       f
                                    
                                 
                                 
                              
                           
                        where 
                           
                              λ
                              ̇
                           
                         is the visco-plastic multiplier which is equal to 
                           
                              r
                              ̇
                           
                        , and 
                           
                              
                                 n
                              
                              
                                 f
                              
                           
                           =
                           ∂
                           f
                           /
                           ∂
                           σ
                         is the gradient of the yield surface defined as
                           
                              (18)
                              
                                 
                                    
                                       n
                                    
                                    
                                       f
                                    
                                 
                                 =
                                 
                                    
                                       
                                          3
                                          2
                                       
                                    
                                 
                                 
                                 
                                    1
                                    
                                       1
                                       −
                                       D
                                    
                                 
                                 
                                 
                                    
                                       s
                                       ¯
                                    
                                    
                                       ‖
                                       
                                          s
                                          ¯
                                       
                                       ‖
                                    
                                 
                                 
                                 
                              
                           
                        
                     

The visco-plastic multiplier is subjected to the Kuhn–Tucker loading/unloading condition that is defined by f≤0, 
                           
                              λ
                              ̇
                           
                           ≥
                           0
                         and 
                           
                              λ
                              ̇
                           
                           f
                           =
                           0
                        . The rate of equivalent visco-plastic strain 
                           
                              
                                 
                                    ϵ
                                    ̇
                                 
                              
                              
                                 v
                                 p
                              
                           
                         can then be defined as
                           
                              (19)
                              
                                 
                                    
                                       
                                          ϵ
                                          ̇
                                       
                                    
                                    
                                       v
                                       p
                                    
                                 
                                 =
                                 
                                    
                                       
                                          2
                                          3
                                       
                                       
                                       
                                          
                                             
                                                ϵ
                                                ̇
                                             
                                          
                                          
                                             v
                                             p
                                          
                                       
                                       :
                                       
                                          
                                             
                                                ϵ
                                                ̇
                                             
                                          
                                          
                                             v
                                             p
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       r
                                       ̇
                                    
                                    
                                       1
                                       −
                                       D
                                    
                                 
                                 
                              
                           
                        
                     

The evolution of the thermal strain can be obtained from the thermal expansion equation as
                           
                              (20)
                              
                                 
                                    
                                       
                                          ϵ
                                          ̇
                                       
                                    
                                    
                                       t
                                       h
                                    
                                 
                                 =
                                 α
                                 
                                    T
                                    ̇
                                 
                                 I
                              
                           
                        
                     

The Johnson–Cook model is accompanied using a definition for the fracture strain. The fracture strain 
                           
                              
                                 ϵ
                              
                              
                                 F
                              
                           
                         can be defined as a function of the stress triaxiality η=p/q, strain rate, and temperature as [3]
                        
                           
                              (21)
                              
                                 
                                    
                                       ϵ
                                    
                                    
                                       F
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             [
                                             
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      2
                                                   
                                                
                                                exp
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            D
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                      η
                                                   
                                                   )
                                                
                                             
                                             ]
                                          
                                          
                                             ︸
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   s
                                                   t
                                                   r
                                                   e
                                                   s
                                                   s
                                                   
                                                   t
                                                   r
                                                   i
                                                   a
                                                   x
                                                   i
                                                   a
                                                   l
                                                   i
                                                   t
                                                   y
                                                
                                             
                                          
                                          
                                             
                                                
                                                   d
                                                   e
                                                   p
                                                   e
                                                   n
                                                   d
                                                   a
                                                   n
                                                   c
                                                   e
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                 
                                    
                                       
                                          
                                             [
                                             
                                                1
                                                +
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      4
                                                   
                                                
                                                
                                                ln
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            r
                                                            ̇
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     ϵ
                                                                     ̇
                                                                  
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   )
                                                
                                             
                                             ]
                                          
                                          
                                             ︸
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   strain
                                                   
                                                   rate
                                                
                                             
                                          
                                          
                                             
                                                
                                                   dependance
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                 
                                    
                                       
                                          
                                             [
                                             
                                                1
                                                +
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      5
                                                   
                                                
                                                
                                                   
                                                      T
                                                   
                                                   ⁎
                                                
                                             
                                             ]
                                          
                                          
                                             ︸
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   temperature
                                                
                                             
                                          
                                          
                                             
                                                
                                                   dependance
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where D
                        1 to D
                        5 are the material constants, p and q are the pressure and von-Mises stresses. Based on the Lemaitre damage model [17], the damage evolution law for ductile materials under proportional loading can be expressed as
                           
                              (22)
                              
                                 
                                    D
                                    ̇
                                 
                                 =
                                 
                                    
                                       
                                          
                                             D
                                          
                                          
                                             c
                                          
                                       
                                    
                                    
                                       
                                          
                                             ϵ
                                          
                                          
                                             F
                                          
                                       
                                       −
                                       
                                          
                                             ϵ
                                          
                                          
                                             D
                                          
                                          
                                             p
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ϵ
                                          ̇
                                       
                                    
                                    
                                       v
                                       p
                                    
                                 
                              
                           
                        where D
                        
                           c
                        ≤1 is the material critical damage and 
                           
                              
                                 ϵ
                              
                              
                                 D
                              
                              
                                 p
                              
                           
                         is the plastic strain corresponding to the damage initiation threshold that is often taken equal to zero. The above relation was used by Børvik et al. [56] to simulate the damage evolution in the perforation of a ductile plate by a steel bullet.

A major portion of visco-plastic work in ductile fracture is generally dissipated into the heat. Due to dynamic nature of the process, there is no time for heat transferring through the conduction or convection, so the problem is considered as an adiabatic process. The assumption of adiabatic condition simplifies the procedure of solution; in such case the temperature is not considered as a nodal degree of freedom, and the energy equation is decoupled from the equation of motion and it is solved at each integration point separately. The energy equation for the adiabatic condition can approximately be expressed as
                           
                              (23)
                              
                                 ρ
                                 
                                    
                                       C
                                    
                                    
                                       p
                                    
                                 
                                 
                                    T
                                    ̇
                                 
                                 ≈
                                 χ
                                 σ
                                 :
                                 
                                    
                                       
                                          ϵ
                                          ̇
                                       
                                    
                                    
                                       v
                                       p
                                    
                                 
                              
                           
                        where C
                        
                           p
                         is the specific heat in the constant pressure, 
                           
                              T
                              ̇
                           
                         is the time rate of the temperature, and χ is the Taylor–Quinney empirical constant [56], which is the fraction of the visco-plastic work rate that is converted into the heat and it is often assigned to the value of 0.9.

In the above constitutive equations, the material behavior is assumed to be non-isothermal, where the dependence of yield stress on the temperature is explicitly expressed using the Johnson–Cook formula for flow stress. In order to express the temperature dependant material properties, a linear relation for the temperature dependence of the Young modulus is employed here, which was originally proposed by Børvik et al. [56], as
                           
                              (24)
                              
                                 E
                                 =
                                 
                                    
                                       E
                                    
                                    
                                       0
                                    
                                 
                                 (
                                 1
                                 −
                                 ξ
                                 
                                    
                                       T
                                    
                                    ⁎
                                 
                                 )
                              
                           
                        where ξ is a material constant. This relation states that the stiffness decreases linearly with an increase of the temperature. The above set of constitutive equations must be solved simultaneously. An implicit return mapping algorithm for the solution of these equations is presented in Appendix A.

The Johnson–Cook visco-plastic model proposed here introduces an implicit characteristic length into the model [48] that alleviates the localization problem; however, there are still some special cases that the localization can be observed [57]. In order to improve the performance of the formulation in localization phenomena, a nonlocal plasticity model is utilized which is similar to the method originally proposed by Mediavilla et al. [19] and Cesar de Sa et al. [58], and previously used by the authors to solve the localization issues in ductile fracture problems [40]. In this technique, since both the damage and temperature are functions of the visco-plastic strain, the nonlocal values of these two variables are computed using a nonlocal equivalent visco-plastic strain 
                           
                              
                                 
                                    ϵ
                                    ¯
                                 
                              
                              
                                 v
                                 p
                              
                           
                        ; this strain is obtained from the local equivalent visco-plastic strain 
                           
                              
                                 ϵ
                              
                              
                                 v
                                 p
                              
                           
                         using the solution of a scalar Helmholtz type equation. In contrast to the infinitesimal framework, in large deformation formulation the Helmholtz equation can be stated on both the reference and current configurations; however, it was shown by Geers et al. [59] that if the current configuration is selected, the regularization behavior under tension and compression varies, the internal characteristic length is deformation dependant, and localization issues may occur in moderately large deformation regimes. Hence, the Helmholtz equation is employed on the reference (undeformed) configuration as
                           
                              (25)
                              
                                 
                                    
                                       
                                          ϵ
                                          ¯
                                       
                                    
                                    
                                       v
                                       p
                                    
                                 
                                 −
                                 
                                    
                                       ℓ
                                    
                                    2
                                 
                                 
                                    
                                       ∇
                                    
                                    
                                       0
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          ϵ
                                          ¯
                                       
                                    
                                    
                                       v
                                       p
                                    
                                 
                                 =
                                 
                                    
                                       ϵ
                                    
                                    
                                       v
                                       p
                                    
                                 
                              
                           
                        where 
                           
                              
                                 ∇
                              
                              
                                 0
                              
                              
                                 2
                              
                           
                         is the Laplacian operator in which the subscript 0 denotes the initial configuration, and 
                           ℓ
                         is the internal characteristic length which sets the width of the localization band. The above PDE equation is subjected to the Neumann type boundary condition, i.e.
                           
                              (26)
                              
                                 
                                    
                                       ∇
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       
                                          ϵ
                                          ¯
                                       
                                    
                                    
                                       v
                                       p
                                    
                                 
                                 .
                                 
                                    n
                                    
                                    
                                    
                                    
                                    0
                                 
                                 =
                                 0
                              
                           
                        where 0
                        n is the unit normal vector to the boundary surface Γ0. The discrete form of the Helmholtz equation can be obtained by implementation of the virtual work principle as
                           
                              (27)
                              
                                 
                                    ∫
                                    
                                       
                                          Ω
                                          
                                          
                                          
                                          
                                          0
                                       
                                    
                                 
                                 
                                    δ
                                    w
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   ϵ
                                                   ¯
                                                
                                             
                                             
                                                v
                                                p
                                             
                                          
                                          −
                                          
                                             
                                                ℓ
                                             
                                             2
                                          
                                          
                                             
                                                ∇
                                             
                                             
                                                0
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                
                                                   ϵ
                                                   ¯
                                                
                                             
                                             
                                                v
                                                p
                                             
                                          
                                       
                                       )
                                    
                                    
                                       
                                          d
                                       
                                       0
                                    
                                    Ω
                                 
                                 =
                                 
                                    ∫
                                    
                                       
                                          Ω
                                          
                                          
                                          
                                          
                                          0
                                       
                                    
                                 
                                 
                                    δ
                                    w
                                    
                                    
                                       
                                          ϵ
                                       
                                       
                                          v
                                          p
                                       
                                    
                                    
                                       
                                          d
                                       
                                       0
                                    
                                    Ω
                                 
                              
                           
                        where δw is a test function. Applying the Gauss theorem in combination with the boundary condition (26) leads to
                           
                              (28)
                              
                                 
                                    ∫
                                    
                                       
                                          Ω
                                          
                                          
                                          
                                          
                                          0
                                       
                                    
                                 
                                 
                                    δ
                                    w
                                    
                                       
                                          
                                             ϵ
                                             ¯
                                          
                                       
                                       
                                          v
                                          p
                                       
                                    
                                    
                                    
                                       
                                          d
                                       
                                       0
                                    
                                    Ω
                                 
                                 +
                                 
                                    ∫
                                    
                                       
                                          Ω
                                          
                                          
                                          
                                          
                                          0
                                       
                                    
                                 
                                 
                                    
                                       
                                          ℓ
                                       
                                       2
                                    
                                    ∇
                                    δ
                                    w
                                    .
                                    ∇
                                    
                                       
                                          
                                             ϵ
                                             ¯
                                          
                                       
                                       
                                          v
                                          p
                                       
                                    
                                    
                                    d
                                    
                                       Ω
                                       
                                       
                                       
                                       
                                       0
                                    
                                 
                                 =
                                 
                                    ∫
                                    
                                       
                                          Ω
                                          
                                          
                                          
                                          
                                          0
                                       
                                    
                                 
                                 
                                    δ
                                    w
                                    
                                    
                                       
                                          ϵ
                                       
                                       
                                          v
                                          p
                                       
                                    
                                    d
                                    
                                       Ω
                                       
                                       
                                       
                                       
                                       0
                                    
                                 
                              
                           
                        Since the equivalent visco-plastic strain is a scalar value, one degree of freedom is introduced for both the standard and Heaviside enrichment parts. Thus, the equivalent visco-plastic strain field can be defined as
                           
                              (29)
                              
                                 
                                    
                                       ϵ
                                    
                                    
                                       v
                                       p
                                    
                                 
                                 
                                    (
                                    x
                                    )
                                 
                                 =
                                 
                                    ∑
                                    
                                       I
                                       ∈
                                       
                                          
                                             I
                                          
                                          
                                             s
                                             t
                                             d
                                          
                                       
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       I
                                    
                                 
                                 
                                    (
                                    x
                                    )
                                 
                                 
                                    
                                       
                                          b
                                          ¯
                                       
                                    
                                    
                                       I
                                    
                                 
                                 +
                                 
                                    ∑
                                    
                                       I
                                       ∈
                                       
                                          
                                             I
                                          
                                          
                                             H
                                             e
                                             v
                                          
                                       
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       I
                                    
                                 
                                 
                                    (
                                    x
                                    )
                                 
                                 
                                    H
                                    ¯
                                 
                                 
                                    (
                                    
                                       
                                          x
                                          
                                          
                                          
                                          
                                          0
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          c
                                          ¯
                                       
                                    
                                    
                                       I
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    b
                                    ¯
                                 
                              
                              
                                 I
                              
                           
                         and 
                           
                              
                                 
                                    c
                                    ¯
                                 
                              
                              
                                 I
                              
                           
                         are the nodal degrees of freedom corresponding to the standard and Heaviside enrichment of equivalent visco-plastic strain. Substituting Eq. (29) into (28) leads to the following system of equations as
                           
                              (30)
                              
                                 
                                    
                                       K
                                    
                                    
                                       ϵ
                                    
                                 
                                 
                                 
                                    
                                       d
                                    
                                    
                                       ϵ
                                    
                                 
                                 =
                                 
                                    
                                       F
                                    
                                    
                                       ϵ
                                    
                                 
                              
                           
                        where 
                           
                              
                                 d
                              
                              
                                 ϵ
                              
                           
                         is the vector of nodal nonlocal visco-plastic strains defined as 
                           
                              
                                 d
                              
                              
                                 ϵ
                              
                           
                           =
                           
                              
                                 〈
                                 
                                    b
                                    ¯
                                 
                                 ,
                                 
                                    c
                                    ¯
                                 
                                 〉
                              
                              T
                           
                         and
                           
                              (31)
                              
                                 
                                    
                                       K
                                    
                                    
                                       ϵ
                                    
                                 
                                 =
                                 
                                    ∫
                                    
                                       
                                          
                                             Ω
                                          
                                          
                                             e
                                          
                                       
                                    
                                 
                                 
                                    
                                       (
                                       
                                          
                                             
                                                N
                                             
                                             T
                                          
                                          N
                                          −
                                          
                                             
                                                ℓ
                                             
                                             2
                                          
                                          
                                             
                                                B
                                             
                                             
                                                ϵ
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                B
                                             
                                             
                                                ϵ
                                             
                                          
                                       
                                       )
                                    
                                    d
                                    Ω
                                 
                                 
                                    
                                       F
                                    
                                    
                                       ϵ
                                    
                                 
                                 =
                                 
                                    ∫
                                    
                                       
                                          
                                             Ω
                                          
                                          
                                             e
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          N
                                       
                                       T
                                    
                                    
                                       
                                          ϵ
                                       
                                       
                                          v
                                          p
                                       
                                    
                                    d
                                    Ω
                                 
                              
                           
                        where Ω
                           e
                         is the domain of an element and, N and 
                           
                              
                                 B
                              
                              
                                 ϵ
                              
                           
                         are the matrices of nodal shape functions and gradients of the shape functions, respectively. These two matrices are defined for each node I based on the standard and Heaviside enrichment parts as
                           
                              (32)
                              
                                 
                                    
                                       (
                                       N
                                       )
                                    
                                    
                                       I
                                    
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         I
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         I
                                                      
                                                   
                                                   
                                                      H
                                                      ¯
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            x
                                                            
                                                            
                                                            
                                                            
                                                            0
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 
                                    
                                       (
                                       
                                          
                                             
                                                B
                                             
                                             
                                                ϵ
                                             
                                          
                                       
                                       )
                                    
                                    
                                       I
                                    
                                 
                                 =
                                 
                                    [
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∂
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               I
                                                            
                                                         
                                                      
                                                      
                                                         ∂
                                                         
                                                            x
                                                            1
                                                            
                                                            
                                                            
                                                            0
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         ∂
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               I
                                                            
                                                         
                                                      
                                                      
                                                         ∂
                                                         
                                                            x
                                                            1
                                                            
                                                            
                                                            
                                                            0
                                                         
                                                      
                                                   
                                                   
                                                      H
                                                      ¯
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            x
                                                            
                                                            
                                                            
                                                            
                                                            0
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         ∂
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               I
                                                            
                                                         
                                                      
                                                      
                                                         ∂
                                                         
                                                            x
                                                            2
                                                            
                                                            
                                                            
                                                            0
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         ∂
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               I
                                                            
                                                         
                                                      
                                                      
                                                         ∂
                                                         
                                                            x
                                                            2
                                                            
                                                            
                                                            
                                                            0
                                                         
                                                      
                                                   
                                                   
                                                      H
                                                      ¯
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            x
                                                            
                                                            
                                                            
                                                            
                                                            0
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                              
                           
                        
                     

It must be noted that the PDE Eq. (25) should be solved simultaneously with the equation of motion (1) applying the corresponding boundary conditions, i.e.
                           
                              
                                 {
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ρ
                                                   
                                                   
                                                   
                                                   
                                                   t
                                                
                                                
                                                   
                                                      u
                                                      ¨
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   t
                                                
                                                =
                                                ∇
                                                .
                                                
                                                   σ
                                                   
                                                   
                                                   
                                                   
                                                   t
                                                
                                                +
                                                
                                                   b
                                                   
                                                   
                                                   
                                                   
                                                   t
                                                
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   repeated
                                                   –
                                                   1
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ϵ
                                                         ¯
                                                      
                                                   
                                                   
                                                      v
                                                      p
                                                   
                                                
                                                −
                                                
                                                   
                                                      ℓ
                                                   
                                                   2
                                                
                                                
                                                   
                                                      ∇
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      
                                                         ϵ
                                                         ¯
                                                      
                                                   
                                                   
                                                      v
                                                      p
                                                   
                                                
                                                =
                                                
                                                   
                                                      ϵ
                                                   
                                                   
                                                      v
                                                      p
                                                   
                                                
                                             
                                          
                                          
                                             
                                                (
                                                repeated
                                                –
                                                25
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The strategy for the solution of above coupled system of equations can be performed using the operator-split technique. In this method, the coupled system of equations can be splitted into two uncoupled equations; the first is an equation of motion with the fixed nonlocal 
                           
                              
                                 
                                    ϵ
                                    ¯
                                 
                              
                              
                                 v
                                 p
                              
                           
                         and the second is the nonlocal Eq. (25) on the initial configuration as
                           
                              (33)
                              
                                 
                                    
                                       
                                    
                                 
                              
                           
                        
                     

In order to solve the uncoupled system of Eq. (33) numerically, consider that the position vector 
                           
                              x
                              
                              
                              
                              
                              t
                           
                        , the nonlocal equivalent visco-plastic strain 
                           
                              
                                 ϵ
                                 ¯
                              
                              
                                 v
                                 p
                              
                              
                              
                              
                              t
                           
                        , the nonlocal damage variable 
                           
                              
                                 D
                                 ¯
                              
                              
                              
                              
                              
                              t
                           
                         and the nonlocal temperature 
                           
                              
                                 T
                                 ¯
                              
                              
                              
                              
                              
                              t
                           
                         are known at time step t. Based on the first part of Eq. (33), i.e. the equation of motion with the fixed values of damage 
                           
                              
                                 D
                                 ¯
                              
                              
                              
                              
                              
                              t
                           
                         and temperature 
                           
                              
                                 T
                                 ¯
                              
                              
                              
                              
                              
                              t
                           
                        , the position vector 
                           
                              x
                              
                              
                              
                              
                              
                                 t
                                 +
                                 Δ
                                 t
                              
                           
                         and the local equivalent visco-plastic strain 
                           
                              ϵ
                              
                                 v
                                 p
                              
                              
                              
                              
                              
                                 t
                                 +
                                 Δ
                                 t
                              
                           
                         can be obtained. The second part of Eq. (33), i.e. the nonlocal phase, can then be solved on the initial configuration to obtain the nonlocal equivalent visco-plastic strain 
                           
                              
                                 ϵ
                                 ¯
                              
                              
                                 v
                                 p
                              
                              
                              
                              
                              
                                 t
                                 +
                                 Δ
                                 t
                              
                           
                        . By substituting the nonlocal equivalent visco-plastic strain increment 
                           Δ
                           
                              
                                 
                                    ϵ
                                    ¯
                                 
                              
                              
                                 v
                                 p
                              
                           
                         into its local counterpart in Eqs. (22) and (23), the nonlocal values of damage 
                           
                              
                                 D
                                 ¯
                              
                              
                              
                              
                              
                              
                                 t
                                 +
                                 Δ
                                 t
                              
                           
                         and temperature 
                           
                              
                                 T
                                 ¯
                              
                              
                              
                              
                              
                              
                                 t
                                 +
                                 Δ
                                 t
                              
                           
                         can be obtained.

The main drawback of the above formulation is its computational cost. Since, in an explicit dynamic scheme the critical time step is small, the solution of system of equations of the nonlocal phase is very expensive at each time step. In order to decrease the computational costs, the solution of nonlocal phase is performed at every n increments. It must be noted that since the above coupled system of equations are approximated with two uncoupled systems there may be some inconsistencies in the solution of equations, however using a small value of Δt and choosing an appropriate value of n the inconsistencies can be removed. Another important issue in the solution of nonlocal phase is the numerical integration of Eq. (30). In fact, the solution of equation of motion is performed using an explicit dynamic scheme with the reduced integration algorithm. However, the implementation of reduced integration algorithm to matrix 
                           
                              
                                 K
                              
                              
                                 ϵ
                              
                           
                         results in a singular matrix. Hence, the standard integration rule with 2×2 integration points is employed for the calculation of matrix 
                           
                              
                                 K
                              
                              
                                 ϵ
                              
                           
                        , however as far as the values of damage are only available at the reduced Gauss points, the vector 
                           
                              
                                 F
                              
                              
                                 ϵ
                              
                           
                         is calculated over the domain of an element Ω
                           e
                         using the reduced integration algorithm.

There are two important factors that need to be considered for crack propagation simulation; the crack initiation and the crack propagation direction criteria. In linear fracture mechanics, various criteria have been proposed for the mixed mode fracture based on the critical stress intensity factor and fracture toughness, including: the minimum strain energy density criterion [60], the maximum hoop stress criterion [60], and the maximum energy release rate [61]. Since the above criteria are generally based on the overall state of the structure, they cannot accurately predict the behavior of fracture process zone and as a result the local non-linearity at the crack tip region. In this study, a robust technique is presented on the basis of damage state that provides a local crack growth criterion at the fracture process zone. The idea behind the method is that the crack grows whenever the whole length covering the new crack segment 
                           
                              
                                 ℓ
                              
                              
                                 c
                              
                           
                         is damaged. The value of crack segment length is arbitrary and it is determined by the user. In this manner, the damage is calculated at the damage calculation points (DCP) which are placed at the distant 
                           
                              
                                 ℓ
                              
                              
                                 d
                              
                           
                         from the crack tip at various angles of θ
                        
                           CP
                         in the range of −90≤θ
                        
                           CP
                        ≤90, as depicted in 
                        Fig. 2. The value of damage at each DCP is calculated using the weighted average value of damage at all neighboring Gauss points by
                           
                              (34)
                              
                                 
                                    
                                       D
                                    
                                    
                                       C
                                       P
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                          j
                                       
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   D
                                                
                                                
                                                   j
                                                
                                             
                                             /
                                             
                                                
                                                   r
                                                
                                                
                                                   j
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          )
                                       
                                    
                                    
                                       
                                          ∑
                                          j
                                       
                                       
                                          (
                                          
                                             1
                                             /
                                             
                                                
                                                   r
                                                
                                                
                                                   j
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          )
                                       
                                    
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                              
                           
                        where D
                        
                           CP
                         is the damage at the damage calculation point and, D
                        
                           j
                         and r
                        
                           j
                         are respectively the damage and the distance from a calculation point at a nearby Gauss point. In relation (34), the closer a Gauss point is to the DCP the higher is its effect on the damage value. In fact, the damage parameter D
                        
                           CP
                         is computed for all calculation points at each loading step, and their values are compared with a critical damage value D
                        
                           cr
                        ; if D
                        
                           CP
                        ≥D
                        
                           cr
                         the crack propagates in the direction θ
                        
                           CP
                         of the DCP with the maximum damage value. It must be noted that the weighted average value of damage parameter and the crack growth direction are computed on the initial (undeformed) configuration in the large X-FEM deformation analysis.

An important issue with the above criterion is the selection of parameter 
                           
                              
                                 ℓ
                              
                              
                                 d
                              
                           
                        ; the first candidate for this value is 
                           
                              
                                 ℓ
                              
                              
                                 d
                              
                           
                           =
                           
                              
                                 ℓ
                              
                              
                                 c
                              
                           
                        , however, it was observed that the value of 
                           
                              
                                 ℓ
                              
                              
                                 d
                              
                           
                           =
                           
                              
                                 ℓ
                              
                              
                                 c
                              
                           
                         results in a non-smooth zig-zag pattern of crack growth; the reason is that when a crack segment propagates, the new crack tip may be placed within a damaged area, and in such case the next crack propagation may be followed in a backward direction. One remedy to this issue is to select a value of 
                           
                              
                                 ℓ
                              
                              
                                 d
                              
                           
                           >
                           
                              
                                 ℓ
                              
                              
                                 c
                              
                           
                         so the new crack tip can be placed within a region in which there is a damaged area in front of the crack tip and a smoother crack growth pattern emerges. In this study, a value of 
                           
                              
                                 ℓ
                              
                              
                                 d
                              
                           
                           =
                           1.5
                           
                              
                                 ℓ
                              
                              
                                 c
                              
                           
                         provides good results for numerical simulations proposed in Section 5. Another key issue observed here is that if the material characteristic length is large compared to the FE mesh size; several DCP points may reach the critical value simultaneously. In this way, an alternative criterion is employed on the basis of damage gradient, in which the point with a minimum value of the damage gradient norm is chosen as the crack propagation direction.

In linear fracture mechanics, the X-FEM analysis can be performed independently for each step of loading. In fact, during the crack propagation simulation the geometry of problem changes by adding the new crack segment into the X-FEM mesh. The new boundary interfaces are defined independent of the X-FEM mesh based on the geometry of body, and the X-FEM analysis can be performed from the beginning of loading. However in large deformation X-FEM damage-viscoplasticity analysis, the geometry and material behavior are dependent on the history of loading and the analysis must be carried out incrementally. The crack propagation process occurs in two stages; in the first stage, as the crack initiation criterion is met, a new crack segment is added and the element sub-divisions are performed which is followed by the data transfer process. At this stage the new crack segment is inactive; while in the second stage, the enrichments are updated and the crack becomes active in the simulation.

Due to discontinuous displacement field, the new cracked elements need special numerical integration rule. In 
                        Fig. 3, the element triangulation scheme and the element rectangular subdivision approach that are the most common strategies in the literature are presented. In the element triangulation scheme, each side of the cracked element in current configuration is divided into several sub-triangles, in which the numerical integration is performed using the Gauss quadrature points of each sub-triangle. In this method, the numerical integration can be performed precisely but the implementation is cumbersome since the Delaunay triangulation must be employed. In the rectangular subdivision strategy, the parent element is partitioned into uniform structured sub-rectangles, where the Gauss points of each sub-rectangle are used for numerical integration. This strategy is easy to implement but introduces some integration errors since the interface does not coincide with the rectangular edges. In this study, the rectangular subdivision method is performed by increasing the number of sub-quadrilaterals to achieve an accurate solution of numerical integration.

During the crack propagation, the mesh is not changed and hence the nodal values do not require data transfer but since in the produced enriched elements, the element subdivisions and hence the Gauss points are updated, the variables of old Gauss points are transferred into new Gauss points. The data transfer process is performed in a similar manner to DCP damage values calculations. For each new enriched element, all neighboring elements including the enriched element are selected in a set called ϒ. The transferred data at each new Gauss point is obtained using a weighted average of the data in the old Gauss points of the set ϒ as
                           
                              (35)
                              
                                 
                                    Α
                                    ^
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                          j
                                       
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   j
                                                
                                             
                                             /
                                             
                                                
                                                   r
                                                
                                                
                                                   j
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          )
                                       
                                    
                                    
                                       
                                          ∑
                                          j
                                       
                                       
                                          (
                                          
                                             1
                                             /
                                             
                                                
                                                   r
                                                
                                                
                                                   j
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          )
                                       
                                    
                                 
                                 
                                 j
                                 ∈
                                 ϒ
                              
                           
                        where 
                           
                              A
                              ^
                           
                         is the transferred data into the new Gauss point, A
                        
                           j
                         is the data in the old Gauss point j, and r
                        
                           j
                         is the distance between the new Gauss point and the old Gauss point j. It must be noted that the transfer operator employed in Eq. (35) does not necessarily retain the nonlinear relationship that exists among the original state variables, i.e. stresses, strains and damage parameter, in the transferred state variables. Hence, the equation of motion and constitutive equations cannot be satisfied and the inconsistency can be caused in the solution.

The equation of motion of the system can be restored by using an artificial null step, in which no new loading is employed to the structure, and the system is allowed to obtain an equilibrium in one single time step Δt. Since the null step only eliminates the unwanted unbalances produced by the data transfer process, which are not the result of physical deformation, an elastic constitutive behavior is assumed in this step. The problem of inconsistency between the yield surface and the stress values obtained from the null step can be resolved by scaling the flow stress to the equivalent effective stress 
                           
                              
                                 
                                    σ
                                    ¯
                                 
                              
                              
                                 e
                                 q
                              
                           
                           =
                           
                              
                                 3
                                 /
                                 2
                              
                           
                           ‖
                           
                              s
                              ¯
                           
                           ‖
                         corresponding to the transferred stress tensor. The new value of hardening parameter r
                        
                           new
                        =r+Δr can be obtained by the solution of the following nonlinear equation as
                           
                              (36)
                              
                                 
                                    
                                       
                                          σ
                                          ¯
                                       
                                    
                                    
                                       e
                                       q
                                    
                                 
                                 =
                                 
                                    [
                                    
                                       A
                                       +
                                       B
                                       
                                          
                                             (
                                             
                                                r
                                                +
                                                Δ
                                                r
                                             
                                             )
                                          
                                          κ
                                       
                                    
                                    ]
                                 
                                 
                                    [
                                    
                                       1
                                       +
                                       C
                                       
                                       ln
                                       
                                          (
                                          
                                             
                                                
                                                   Δ
                                                   r
                                                
                                                
                                                   
                                                      
                                                         
                                                            ϵ
                                                            ̇
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   Δ
                                                   t
                                                
                                             
                                          
                                          )
                                       
                                    
                                    ]
                                 
                                 
                                    [
                                    
                                       1
                                       −
                                       
                                          
                                             T
                                          
                                          
                                             ⁎
                                             
                                             m
                                          
                                       
                                    
                                    ]
                                 
                              
                           
                        It must be noted that in the static analysis of ductile fracture problem, a relaxation phase is generally employed in the new boundary condition of crack propagation simulation [40]. In this relaxation phase, the extra tractions at the new crack surface are removed with a few relaxation increments that were in a self-equilibrium condition at the old crack-tip. However, this step is not necessary in a dynamic simulation since the work produced by these extra tractions is automatically transferred into the kinematic energy at the elements of the crack tip region.

In order to illustrate the robustness of proposed computational algorithm, three numerical examples are simulated. For all examples, the bilinear 2D elements are employed, and the enriched elements are subdivided into 5×5 sub-rectangles with four Gauss points at each sub-rectangle. The reduced integration algorithm is used within the standard elements using the stiffness hour-glassing control.

The first example is the necking of a tensile specimen, which is a benchmark test in nonlinear computational mechanics. The tensile specimen is a circular bar with radius of 1cm and height of 10cm, as shown in 
                        Fig. 4. Due to the symmetry of the problem, only one quarter of the specimen is modeled using an axisymmetric simulation. The loading is applied using a prescribed displacement control at the left edge of the specimen, as shown in Fig. 4. Since the necking can take place at any points of the specimen, a geometric imperfection of 1% reduction in the radius is introduced at the mid-point of the specimen. The specimen is considered at the room temperature of 293°K and the material properties of the specimen are given in 
                        Table 1. Note that the steel alloy properties are similar to 4340 steel reported in reference [3], but the damage variables D
                        1 to D
                        5 given in this reference are calibrated for an uncoupled damage model. In the simulation proposed here, the same values of damage variables are assumed for the coupled damage model, so the specimen can be considered as a steel alloy.

In the first part of the numerical simulation, the robustness of proposed Johnson–Cook model is verified. Neglecting the damage softening, two loading conditions are employed to account for the rate dependency effects. In the first loading condition (case I) a prescribed displacement of 1cm is applied in 0.001s, while in the second loading condition (case II) a prescribed displacement of 1cm is applied in 0.0001s. In 
                        Fig. 5, the force–displacement curves are plotted for both cases I and II, where the thermal effects are neglected and the geometric nonlinearity is the only source of softening behavior. In these diagrams, the predicted numerical results are compared with those obtained from the ABAQUS program that shows a complete agreement for both loading cases. In 
                        Fig. 6, the von-Mises stress contours are presented for both cases in the absence of thermal effects. It can be observed from this figure that the necking occurs at the bottom edge in the loading case I, while it happens at the top region of the specimen in the loading case II. Although it was expected to observe the necking behavior at the bottom edge of one-quarter specimen for both loading conditions due to a geometric imperfection at this area, the interaction of input waves in the second case before reaching the bottom edge of the specimen, results in the plastic yielding of the top region and changes the pattern of necking in the specimen. The predicted results are again in good agreement with those obtained from the ABAQUS program that illustrates the accuracy of proposed Johnson–Cook model within the computational algorithm. In 
                        Fig. 7, the force–displacement diagrams are plotted for both loading conditions considering the thermal effects of plastic heat generation. Comparing the curves of this figure with those given in Fig. 5, it can be seen that the plastic heat generation results in more softening behavior particularly at the necking stage. In 
                        Fig. 8, the temperature contours are presented for both loading conditions. Obviously, the temperature at the necking area increases 300°K in the loading case I and 110°K in the loading case II.

In the second part of the numerical simulation, the efficiency of non-local visco-plastic formulation is investigated by evolution of the damage and temperature, and the mesh independence of proposed computational model is studied. The material properties are considered as rate dependant, where the softening behavior is modeled employing the damage and thermal effects. For simplicity of the solution, it is assumed that the value of damage remains constant when the damage reaches its critical value D
                        
                           c
                        , and no cracks are added into the system. A ramped prescribed displacement of 1cm is applied at the left edge of the specimen in 0.001s, as shown in Fig. 4. The numerical simulations are performed using four meshes with densities of 5×20, 10×40, 20×80 and 30×120. In 
                        Fig. 9, the force–displacement diagrams are plotted for various meshes. Obviously, the only difference between the results can be seen at the final stages of softening behavior, however by reducing the size of the mesh, the results converge to a unique solution. A comparison between the results of Fig. 9 and Fig. 7(a) illustrates that the combination of geometric nonlinearity, temperature and damage result in more softening behavior. In 
                        Fig. 10, a comparison of the damage and temperature contours is performed among various meshes at t=0.00066s. As can be expected, the damage first accumulates at the center of the specimen and then propagates toward the outer surface; a similar pattern also holds for the temperature. Obviously, the damage and temperature profiles of meshes 5×20 and 10×40 are slightly different, however, the results converge to an identical solution by reducing the size of the elements in meshes 20×80 and 30×120.

In the final part of the current numerical simulation, the effect of nonlocal parameter n is investigated on the accuracy of the solution. In this case, a ramped prescribed displacement of 1cm is applied at the left edge of the specimen in 0.001s, as shown in Fig. 4; a mesh of 5×20 elements is used for numerical modeling, and the critical time step is set to Δt=10−8
                        s. The problem is solved for n=1, 10, 100, 1000 and 10,000, and the corresponding force–displacement diagrams are plotted in 
                        Fig. 11. The results are almost identical for n=1, 10, 100 and 1000, however, the solution becomes unstable as can be observed from unrealistic oscillations at n=10,000. In this case, the damage and temperature are only calculated at ten time steps during the whole process of the solution; it can be seen that for each time step that the damage and temperature are calculated, a jump appears in the curve and the solution becomes completely unstable at the final softening branch of the diagram. It clearly illustrates that a good combination of Δt and n must be employed to obtain an accurate result.

The next example is chosen to illustrate the capability of proposed computational algorithm in a complex geometry with mixed mode crack propagation under dynamic loading. The problem is a plate with two asymmetrically notches at the top and bottom of the specimen, as shown in 
                        Fig. 12. The geometry and boundary conditions of the problem are shown in this figure. The plate is in plane strain condition with an initial temperature of 293°K that is made from a steel alloy with the material properties given in Table 1. The characteristic length is assumed as 
                           ℓ
                           =
                           0.1
                           
                           mm
                        . The specimen is subjected to a prescribed displacement of 1.2mm in y–direction at the top and left edges, while the right and the bottom edges are fixed.

In the first part of the numerical simulation, the prescribed displacement is applied as a ramp function within a time interval of τ=0.001s. In 
                        Fig. 13(a), the contour of stress triaxiality is shown at t=1.9×10−4
                        s. As can be observed, the triaxiality has a maximum value at the central part of the plate. However, the visco-plastic strain has maximum values at the top and bottom notches, as can be seen from Fig. 13(b). According to the damage evolution law given in relations (21) and (22), the effect of triaxiality is much higher than the visco-plastic strain; hence, the damage grows at the central part of the plate, as shown in Fig. 13(c). This growth pattern is in contrast with the observations reported in previous works [19,40], where the triaxiality effect was neglected. In order to obtain a similar crack pattern, the fracture strain is set to a constant value of 
                           
                              
                                 ϵ
                              
                              
                                 F
                              
                           
                           =
                           0.4
                         in the following parts of the simulation.

In the second part of the numerical simulation, the prescribed displacement is applied as a ramp function within two time intervals of τ=0.001s and 0.0001s. The criteria for the crack propagation and the crack direction detection are based on the procedure described in Section 4. In 
                        Fig. 14, the corresponding damage contours are shown at different time steps of crack propagation for the time interval of τ=0.0001s. It is apparent that a region of strain localization emerges from the top and bottom notches, as shown in Fig. 14(a). When the damage reaches the critical value D
                        
                           c
                        , a crack emanates from the top notch which is followed by another one from the bottom notch after a few steps, as shown in Fig. 14(b). The cracks propagate in an almost symmetrical mode until the final fracture occurs in the plate, as shown in Fig. 14(c)–(d). In 
                        Fig. 15, the contours of von-Mises stress are presented at various time steps. It can be seen that due to effects of the damage, thermal softening and crack propagation, the stress level reduces at various time steps in the localization area as well as the whole plate. Note that in Figs. 14 and 15, the results are shown on deformed configurations of the plate. In 
                        Fig. 16, the contours of temperature distribution are presented at various time steps. It is interesting to note that due to adiabatic heating, the temperature increases about 163°K in the localization area. It can also be observed that the elements are excessively distorted in the localization area. This distortion reduces the critical time step in these elements; in some extreme cases it was observed that the determinant of Jacobian matrix becomes negative at some Gauss points that leads to termination of the solution. It suggests that although the X-FEM eliminates the need for remeshing in the crack propagation stage, the remeshing may be necessary in the case of highly element distortion. It is worth to mention that similar results have been observed in the case that the rising time is 
                           0.001
                           
                           s
                        , which are not reported here. In 
                        Fig. 17(a), a comparison of the force–displacement diagrams is performed for two time intervals of τ=0.001 and 0.0001s; in the case of τ=0.0001s, the dynamic jumps can be observed in the elastic part of the diagram. Moreover, the effect of strain rate increases the value of predicted force in the nonlinear part of the diagram. Due to the crack propagation, the jumps can be observed at the final parts of the diagrams. In Fig. 17(b), the pattern of crack growths are shown for both cases on the deformed configuration; it is clear that the cracks propagate in almost similar fashion.

In the final part of present numerical simulation, the effect of crack length on the fracture pattern is investigated. In this case, the X-FEM analysis is carried out with the rising time of 
                           τ
                           =
                           0.001
                           
                           s
                         using the crack lengths of 
                           
                              
                                 ℓ
                              
                              
                                 c
                              
                           
                           =
                           0.35
                         and 0.5mm. In 
                        Fig. 18, the force–displacement diagram and crack growth pattern are plotted for the two crack lengths. It is obvious that although some differences may exist the overall results are almost identical.

The last example is chosen to illustrate the performance of proposed computational algorithm in a more complex dynamic crack propagation problem. The specimen is a plate of steel with two holes which is fixed at the bottom edge and is subjected to a prescribed displacement at the top edge. The geometry and boundary conditions of the problem are shown in 
                        Fig. 19. The plate is in plane strain condition with an initial temperature of 293°K that is made from a steel alloy with the material properties given in Table 1. The fracture strain is assumed to be constant with the value of 
                           
                              
                                 ϵ
                              
                              
                                 F
                              
                           
                           =
                           0.4
                        , and the characteristic length is taken as 
                           ℓ
                           =
                           0.1
                           
                           mm
                        .

In the first part of the numerical simulation, a prescribed vertical displacement of 2cm is applied as a ramp function within two time intervals of τ=0.01s (case I) and 0.001s (case II). In 
                        Fig. 20, the damage contours are shown at different stages of crack propagation for the time interval of τ=0.01s. It is obvious that the damage first grows at the exterior thin ligaments of the left and right holes (Fig. 20a). This issue can be interpreted as the result of high stress and strain concentration in these areas which eventually leads to the crack initiation, propagation and complete separation of the ligaments (Fig. 20b). Obviously, the two cracks grow in a 45° direction with respect to horizon; it clearly shows that the shear mode is dominant in these areas. By increasing the load, the damage accumulates in the other sides of the holes (Fig. 20c), and as a result two cracks emanate from the top and bottom holes when the damage reaches its critical value; in this circumstance, a shear band zone appears between the two holes in which the cracks propagates in an approximately symmetric manner (Fig. 20d). In 
                        Fig. 21, the distribution of von-Mises stress contours are presented at different stages of crack propagation. In 
                        Fig. 22(a), a comparison of the force–displacement diagram is performed between two loading conditions. Obviously, the force–displacement diagram of case I illustrates three distinct stages; firstly a linear and nonlinear behavior before the crack propagation, secondly a drop in the diagram due to rapid crack growth in the ligaments, and lastly the crack propagation process in the central part of the specimen. In case II, the dynamic behavior is clearly dominant however, the overall performance follows the force–displacement diagram represented in case I. In Fig. 22(b), the crack trajectories are shown for two loading conditions on the deformed configuration; it is clear that the cracks propagate in almost similar pattern.

In the second part of the numerical simulation, the overall performance of the specimen is investigated to the nonlocal characteristic length. For this purpose, the loading cases I and II are employed to simulate the specimen for the characteristic lengths of 
                           ℓ
                           =
                           0.1
                        , 
                           0.2
                         and 0.3mm. In 
                        Fig. 23(a) and (b), the force–displacement diagrams are respectively plotted for the loading cases I and II. It is obvious from two diagrams that the larger value of the characteristic length results in the higher ductility of the specimen.

In the final part of the numerical simulation, a mesh sensitivity analysis is performed on the specimen; a coarse mesh is compared with a fine mesh for the two proposed loading conditions. In 
                        Fig. 24, the damage contours are shown together with the crack trajectories for the coarse and fine meshes in two loading cases I and II. Also, the corresponding force–displacement diagrams are plotted in 
                        Fig. 25 for the two loading conditions. It can be observed that for both loading conditions the overall crack trajectory is identical however, the specimen with finer mesh represents a more brittle behavior and the crack propagates earlier than the coarse meshed specimen.

@&#CONCLUSIONS@&#

In the present paper, a new computational method was presented based on coupling of the dynamic large deformation, large strain X-FEM method with the Johnson–Cook visco-plastic damage model to simulate the dynamic ductile fracture problems. An explicit central difference algorithm was employed in combination with the mass lumping, reduced integration with hourglass control, and numerical damping. The localization behavior due to geometric, damage and thermal softening was suppressed with a combination of visco-plasticity regularization and a non-local gradient method. Crack propagation criteria and issues related to the combination of X-FEM with a damage-viscoplastic constitutive model were addressed. Finally, the robustness and accuracy of the proposed computational method were verified using three numerical examples. The first example was chosen to illustrate the accuracy of proposed model for a benchmark problem in the necking of a tensile specimen. The numerical simulation was performed to present the robustness of Johnson–Cook model under two loading conditions where the rate dependence effects were taken into account. Moreover, the efficiency of non-local visco-plastic model was studied by evolution of the damage and temperature, and the mesh independence of proposed computational model was investigated. The second and third examples were proposed to illustrate the capability of computational algorithm in the complex geometry of a plate with two asymmetrically notches and a plate with two holes under mixed mode crack propagation subjected to dynamic loading. It was shown that the proposed computational algorithm is capable of predicting the complete process of crack initiation up to the final fracture stage even in complex geometries and loading conditions.

@&#ACKNOWLEDGMENT@&#

The senior author is grateful for the research support of the Iran National Science Foundation (INSF).

In this section, the computational formulation of the return mapping algorithm is presented for an implicit Johnson–Cook visco-plastic nonlocal damage model. The algorithm follows the general elastic predictor/plastic corrector scheme [43]. In order to obtain a single non-linear equation for constitutive equations, the energy equation and damage evolution law are decoupled from governing equations. Consider that the strain increment tensor 
                        Δ
                        ϵ
                      is obtained from the finite element solution. The trial elastic stress can be calculated by
                        
                           (A.1)
                           
                              
                                 
                                    
                                       s
                                       ¯
                                    
                                 
                                 
                                    n
                                    +
                                    1
                                 
                                 
                                    t
                                    r
                                    i
                                    a
                                    l
                                 
                              
                              =
                              2
                              
                                 
                                    G
                                 
                                 
                                    n
                                 
                              
                              
                                 (
                                 
                                    
                                       
                                          ϵ
                                       
                                       
                                          d
                                          e
                                          v
                                          
                                          n
                                       
                                       
                                          e
                                       
                                    
                                    +
                                    Δ
                                    
                                       
                                          ϵ
                                       
                                       
                                          d
                                          e
                                          v
                                       
                                    
                                 
                                 )
                              
                           
                        
                     
                  

If the stress state lies below the yield surface, i.e. f≤0, the integration point is in elastic state, hence
                        
                           (A.2)
                           
                              
                                 
                                    
                                       s
                                       ¯
                                    
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    
                                       s
                                       ¯
                                    
                                 
                                 
                                    n
                                    +
                                    1
                                 
                                 
                                    t
                                    r
                                    i
                                    a
                                    l
                                 
                              
                              
                                 
                                    ϵ
                                 
                                 
                                    n
                                    +
                                    1
                                 
                                 
                                    v
                                    p
                                 
                              
                              =
                              
                                 
                                    ϵ
                                 
                                 
                                    n
                                 
                                 
                                    v
                                    p
                                 
                              
                              
                                 
                                    
                                       T
                                       ¯
                                    
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    
                                       T
                                       ¯
                                    
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    
                                       p
                                       ¯
                                    
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    K
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    ϵ
                                 
                                 
                                    v
                                    o
                                    l
                                    
                                    n
                                    +
                                    1
                                 
                              
                              −
                              3
                              
                                 
                                    K
                                 
                                 
                                    n
                                 
                              
                              α
                              
                                 (
                                 
                                    
                                       
                                          
                                             T
                                             ¯
                                          
                                       
                                       
                                          n
                                          +
                                          1
                                       
                                    
                                    −
                                    
                                       
                                          T
                                       
                                       
                                          0
                                       
                                    
                                 
                                 )
                              
                           
                        
                     where 
                        
                           
                              
                                 T
                                 ¯
                              
                           
                           
                              n
                              +
                              1
                           
                        
                      is the nonlocal temperature value at time t+Δt. If f>0, the return mapping algorithm must be performed. Based on an implicit scheme, the discretized form of the constitutive equations can be derived as
                        
                           (A.3)
                           
                              
                                 
                                    f
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    
                                       3
                                       2
                                    
                                 
                              
                              ‖
                              
                                 
                                    
                                       s
                                       ¯
                                    
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                              ‖
                              −
                              
                                 [
                                 
                                    A
                                    +
                                    B
                                    
                                       
                                          r
                                       
                                       
                                          n
                                          +
                                          1
                                       
                                       
                                          κ
                                       
                                    
                                 
                                 ]
                              
                              
                                 [
                                 
                                    1
                                    +
                                    C
                                    
                                    ln
                                    
                                       (
                                       
                                          
                                             
                                                Δ
                                                r
                                             
                                             
                                                
                                                   
                                                      
                                                         ϵ
                                                         ̇
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                
                                                Δ
                                                t
                                             
                                          
                                       
                                       )
                                    
                                 
                                 ]
                              
                              
                                 [
                                 
                                    1
                                    −
                                    
                                       
                                          T
                                       
                                       
                                          n
                                          +
                                          1
                                       
                                       
                                          
                                             
                                                ⁎
                                             
                                             m
                                          
                                       
                                    
                                 
                                 ]
                              
                           
                        
                     
                     
                        
                           (A.4)
                           
                              
                                 
                                    
                                       s
                                       ¯
                                    
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                              =
                              2
                              
                                 
                                    G
                                 
                                 
                                    n
                                 
                              
                              
                                 (
                                 
                                    
                                       
                                          ϵ
                                       
                                       
                                          d
                                          e
                                          v
                                          
                                          n
                                       
                                       
                                          e
                                       
                                    
                                    +
                                    Δ
                                    
                                       
                                          ϵ
                                       
                                       
                                          d
                                          e
                                          v
                                       
                                    
                                    −
                                    
                                       
                                          
                                             3
                                             2
                                          
                                       
                                    
                                    
                                    
                                       
                                          Δ
                                          r
                                       
                                       
                                          1
                                          −
                                          
                                             
                                                
                                                   D
                                                   ¯
                                                
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   s
                                                   ¯
                                                
                                             
                                             
                                                n
                                                +
                                                1
                                             
                                          
                                       
                                       
                                          ‖
                                          
                                             
                                                
                                                   s
                                                   ¯
                                                
                                             
                                             
                                                n
                                                +
                                                1
                                             
                                          
                                          ‖
                                       
                                    
                                 
                                 )
                              
                           
                        
                     where 
                        
                           
                              ϵ
                           
                           
                              d
                              e
                              v
                              
                              n
                           
                           
                              e
                           
                        
                      is the elastic deviatoric strain at the end of the step n, Δr is the increment of hardening parameter, and 
                        
                           
                              
                                 D
                                 ¯
                              
                           
                           
                              n
                           
                        
                      is the nonlocal damage at time t. Eq. (A.4) can be rewritten according to (A.1) as
                        
                           (A.5)
                           
                              
                                 
                                    
                                       s
                                       ¯
                                    
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    
                                       s
                                       ¯
                                    
                                 
                                 
                                    n
                                    +
                                    1
                                 
                                 
                                    t
                                    r
                                    i
                                    a
                                    l
                                 
                              
                              −
                              2
                              
                                 
                                    G
                                 
                                 
                                    n
                                 
                              
                              
                                 (
                                 
                                    
                                       
                                          
                                             3
                                             2
                                          
                                       
                                    
                                    
                                    
                                       
                                          Δ
                                          r
                                       
                                       
                                          1
                                          −
                                          
                                             
                                                
                                                   D
                                                   ¯
                                                
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   s
                                                   ¯
                                                
                                             
                                             
                                                n
                                                +
                                                1
                                             
                                          
                                       
                                       
                                          ‖
                                          
                                             
                                                
                                                   s
                                                   ¯
                                                
                                             
                                             
                                                n
                                                +
                                                1
                                             
                                          
                                          ‖
                                       
                                    
                                 
                                 )
                              
                           
                        
                     which leads to
                        
                           (A.6)
                           
                              
                                 
                                    
                                       s
                                       ¯
                                    
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    
                                       s
                                       ¯
                                    
                                 
                                 
                                    n
                                    +
                                    1
                                 
                                 
                                    t
                                    r
                                    i
                                    a
                                    l
                                 
                              
                              
                              
                                 (
                                 
                                    1
                                    −
                                    
                                       6
                                    
                                    
                                       
                                          G
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          Δ
                                          r
                                       
                                       
                                          1
                                          −
                                          
                                             
                                                
                                                   D
                                                   ¯
                                                
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   s
                                                   ¯
                                                
                                             
                                             
                                                n
                                                +
                                                1
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   s
                                                   ¯
                                                
                                             
                                             
                                                n
                                                +
                                                1
                                             
                                             
                                                t
                                                r
                                                i
                                                a
                                                l
                                             
                                          
                                       
                                    
                                    
                                       1
                                       
                                          ‖
                                          
                                             
                                                
                                                   s
                                                   ¯
                                                
                                             
                                             
                                                n
                                                +
                                                1
                                             
                                          
                                          ‖
                                       
                                    
                                 
                                 )
                              
                           
                        
                     
                  

It can be stated that
                        
                           (A.7)
                           
                              
                                 
                                    
                                       
                                          
                                             s
                                             ¯
                                          
                                       
                                       
                                          n
                                          +
                                          1
                                       
                                    
                                 
                                 
                                    ‖
                                    
                                       
                                          
                                             s
                                             ¯
                                          
                                       
                                       
                                          n
                                          +
                                          1
                                       
                                    
                                    ‖
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             s
                                             ¯
                                          
                                       
                                       
                                          n
                                          +
                                          1
                                       
                                       
                                          t
                                          r
                                          i
                                          a
                                          l
                                       
                                    
                                 
                                 
                                    ‖
                                    
                                       
                                          
                                             s
                                             ¯
                                          
                                       
                                       
                                          n
                                          +
                                          1
                                       
                                       
                                          t
                                          r
                                          i
                                          a
                                          l
                                       
                                    
                                    ‖
                                 
                              
                           
                        
                     
                  

Substituting the above equation into (A.6), it yields to
                        
                           (A.8)
                           
                              
                                 
                                    
                                       s
                                       ¯
                                    
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    
                                       s
                                       ¯
                                    
                                 
                                 
                                    n
                                    +
                                    1
                                 
                                 
                                    t
                                    r
                                    i
                                    a
                                    l
                                 
                              
                              
                                 (
                                 
                                    1
                                    −
                                    
                                       
                                          
                                             6
                                          
                                          
                                             
                                                G
                                             
                                             
                                                n
                                             
                                          
                                          Δ
                                          r
                                       
                                       
                                          1
                                          −
                                          
                                             
                                                
                                                   D
                                                   ¯
                                                
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                    
                                       1
                                       
                                          ‖
                                          
                                             
                                                
                                                   s
                                                   ¯
                                                
                                             
                                             
                                                n
                                                +
                                                1
                                             
                                             
                                                t
                                                r
                                                i
                                                a
                                                l
                                             
                                          
                                          ‖
                                       
                                    
                                 
                                 )
                              
                           
                        
                     
                  

Thus,
                        
                           (A.9)
                           
                              ‖
                              
                                 
                                    
                                       s
                                       ¯
                                    
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                              ‖
                              =
                              ‖
                              
                                 
                                    
                                       s
                                       ¯
                                    
                                 
                                 
                                    n
                                    +
                                    1
                                 
                                 
                                    t
                                    r
                                    i
                                    a
                                    l
                                 
                              
                              ‖
                              −
                              
                                 
                                    
                                       6
                                    
                                    
                                       
                                          G
                                       
                                       
                                          n
                                       
                                    
                                    Δ
                                    r
                                 
                                 
                                    1
                                    −
                                    
                                       
                                          
                                             D
                                             ¯
                                          
                                       
                                       
                                          n
                                       
                                    
                                 
                              
                           
                        
                     and the yield surface (A.3) can be written according to the above equation as
                        
                           (A.10)
                           
                              
                                 
                                    f
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    
                                       3
                                       2
                                    
                                 
                              
                              ‖
                              
                                 
                                    
                                       s
                                       ¯
                                    
                                 
                                 
                                    n
                                    +
                                    1
                                 
                                 
                                    t
                                    r
                                    i
                                    a
                                    l
                                 
                              
                              ‖
                              −
                              
                                 
                                    3
                                    
                                       
                                          G
                                       
                                       
                                          n
                                       
                                    
                                    Δ
                                    r
                                 
                                 
                                    1
                                    −
                                    
                                       
                                          D
                                       
                                       
                                          n
                                       
                                    
                                 
                              
                              −
                              
                                 [
                                 
                                    A
                                    +
                                    B
                                    
                                       
                                          r
                                       
                                       
                                          n
                                          +
                                          1
                                       
                                       
                                          κ
                                       
                                    
                                 
                                 ]
                              
                              
                                 [
                                 
                                    1
                                    +
                                    C
                                    
                                    ln
                                    
                                       (
                                       
                                          
                                             
                                                Δ
                                                r
                                             
                                             
                                                
                                                   
                                                      
                                                         ϵ
                                                         ̇
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                
                                                Δ
                                                t
                                             
                                          
                                       
                                       )
                                    
                                 
                                 ]
                              
                              
                                 [
                                 
                                    1
                                    −
                                    
                                       
                                          T
                                       
                                       
                                          n
                                          +
                                          1
                                       
                                       
                                          
                                             
                                                ⁎
                                             
                                             m
                                          
                                       
                                    
                                 
                                 ]
                              
                           
                        
                     
                  

In the above equation, the only unknown is Δr that can be obtained using the Newton-Raphson procedure. Consider an iteration i of the Newton-Raphson algorithm, it results
                        
                           (A.11)
                           
                              
                                 
                                    f
                                 
                                 
                                    n
                                    +
                                    1
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    f
                                 
                                 
                                    n
                                    +
                                    1
                                 
                                 
                                    i
                                 
                              
                              +
                              
                                 
                                    (
                                    
                                       
                                          
                                             ∂
                                             f
                                          
                                          
                                             ∂
                                             Δ
                                             r
                                          
                                       
                                    
                                    )
                                 
                                 
                                    n
                                    +
                                    1
                                 
                                 
                                    i
                                 
                              
                              d
                              Δ
                              r
                              =
                              0
                           
                        
                     or
                        
                           (A.12)
                           
                              d
                              Δ
                              r
                              =
                              −
                              
                                 
                                    [
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      ∂
                                                      f
                                                   
                                                   
                                                      ∂
                                                      Δ
                                                      r
                                                   
                                                
                                             
                                             )
                                          
                                          
                                             n
                                             +
                                             1
                                          
                                          
                                             i
                                          
                                       
                                    
                                    ]
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 
                                    f
                                 
                                 
                                    n
                                    +
                                    1
                                 
                                 
                                    i
                                 
                              
                           
                        
                     where 
                        Δ
                        
                           
                              r
                           
                           
                              i
                              +
                              1
                           
                        
                        =
                        Δ
                        
                           
                              r
                           
                           i
                        
                        +
                        
                        d
                        Δ
                        r
                     , and the derivative 
                        
                           
                              (
                              
                                 ∂
                                 f
                                 /
                                 ∂
                                 Δ
                                 r
                              
                              )
                           
                           
                              n
                              +
                              1
                           
                           
                              i
                           
                        
                      can be obtained as
                        
                           (A.13)
                           
                              
                                 
                                    (
                                    
                                       
                                          
                                             ∂
                                             f
                                          
                                          
                                             ∂
                                             Δ
                                             r
                                          
                                       
                                    
                                    )
                                 
                                 
                                    n
                                    +
                                    1
                                 
                                 
                                    i
                                 
                              
                              =
                              −
                              
                                 
                                    3
                                    
                                       
                                          G
                                       
                                       
                                          n
                                       
                                    
                                 
                                 
                                    1
                                    −
                                    
                                       
                                          
                                             D
                                             ¯
                                          
                                       
                                       
                                          n
                                       
                                    
                                 
                              
                              −
                              κ
                              B
                              
                                 
                                    (
                                    
                                       
                                          
                                             r
                                          
                                          
                                             n
                                             +
                                             1
                                          
                                          
                                             κ
                                             −
                                             1
                                          
                                       
                                    
                                    )
                                 
                                 i
                              
                              
                                 [
                                 
                                    1
                                    +
                                    C
                                    
                                    ln
                                    
                                       (
                                       
                                          
                                             
                                                Δ
                                                r
                                             
                                             
                                                
                                                   
                                                      
                                                         ϵ
                                                         ̇
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                
                                                Δ
                                                t
                                             
                                          
                                       
                                       )
                                    
                                 
                                 ]
                              
                              
                                 [
                                 
                                    1
                                    −
                                    
                                       
                                          T
                                       
                                       
                                          n
                                          +
                                          1
                                       
                                       
                                          
                                             
                                                ⁎
                                             
                                             m
                                          
                                       
                                    
                                 
                                 ]
                              
                              −
                              
                                 C
                                 
                                    Δ
                                    r
                                 
                              
                              
                                 [
                                 
                                    A
                                    +
                                    B
                                    
                                       
                                          r
                                       
                                       
                                          n
                                          +
                                          1
                                       
                                       
                                          κ
                                       
                                    
                                 
                                 ]
                              
                              
                                 [
                                 
                                    1
                                    −
                                    
                                       
                                          T
                                       
                                       
                                          n
                                          +
                                          1
                                       
                                       
                                          
                                             
                                                ⁎
                                             
                                             m
                                          
                                       
                                    
                                 
                                 ]
                              
                           
                        
                     by obtaining the value of Δr, the updated values of stress, elastic strain and local value of viscoplastic strain can be evaluated.

Finally, by solution of the nonlocal Helmholtz Eq. (25), the nonlocal values of viscoplastic strain and then 
                        Δ
                        
                           r
                           ¯
                        
                      can be calculated. The energy equation and damage evolution law are discretized using an explicit scheme and the values of nonlocal damage and temperature can be obtained as
                        
                           (A.14)
                           
                              
                                 
                                    
                                       D
                                       ¯
                                    
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    
                                       D
                                       ¯
                                    
                                 
                                 
                                    n
                                 
                              
                              +
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                D
                                             
                                             
                                                c
                                             
                                          
                                       
                                       
                                          
                                             
                                                ϵ
                                             
                                             
                                                F
                                             
                                          
                                          −
                                          
                                             
                                                ϵ
                                             
                                             
                                                D
                                             
                                             
                                                p
                                             
                                          
                                       
                                    
                                 
                                 ]
                              
                              
                                 
                                    Δ
                                    r
                                 
                                 
                                    1
                                    −
                                    
                                       
                                          
                                             D
                                             ¯
                                          
                                       
                                       
                                          n
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (A.15)
                           
                              
                                 
                                    
                                       T
                                       ¯
                                    
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    
                                       T
                                       ¯
                                    
                                 
                                 
                                    n
                                 
                              
                              +
                              
                                 χ
                                 
                                    ρ
                                    
                                       
                                          C
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       3
                                       2
                                    
                                 
                              
                              
                              
                                 
                                    Δ
                                    r
                                 
                                 
                                    1
                                    −
                                    
                                       
                                          
                                             D
                                             ¯
                                          
                                       
                                       
                                          n
                                       
                                    
                                 
                              
                              ‖
                              
                                 
                                    
                                       s
                                       ¯
                                    
                                 
                                 
                                    n
                                 
                              
                              ‖
                           
                        
                     
                  

@&#REFERENCES@&#

